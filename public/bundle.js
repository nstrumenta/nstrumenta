function Hs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Bs(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Vr={exports:{}},Hr={exports:{}},dc=Hr.exports,Ki;function hc(){return Ki||(Ki=1,(function(e){/**
 * @license long.js (c) 2013 Daniel Wirtz <dcode@dcode.io>
 * Released under the Apache License, Version 2.0
 * see: https://github.com/dcodeIO/long.js for details
 */(function(t,r){typeof Bs=="function"&&e&&e.exports?e.exports=r():(t.dcodeIO=t.dcodeIO||{}).Long=r()})(dc,function(){function t(P,$,z){this.low=P|0,this.high=$|0,this.unsigned=!!z}t.prototype.__isLong__,Object.defineProperty(t.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1});function r(P){return(P&&P.__isLong__)===!0}t.isLong=r;var n={},s={};function a(P,$){var z,L,Z;return $?(P>>>=0,(Z=0<=P&&P<256)&&(L=s[P],L)?L:(z=d(P,(P|0)<0?-1:0,!0),Z&&(s[P]=z),z)):(P|=0,(Z=-128<=P&&P<128)&&(L=n[P],L)?L:(z=d(P,P<0?-1:0,!1),Z&&(n[P]=z),z))}t.fromInt=a;function u(P,$){if(isNaN(P)||!isFinite(P))return $?h:m;if($){if(P<0)return h;if(P>=c)return k}else{if(P<=-f)return C;if(P+1>=f)return E}return P<0?u(-P,$).neg():d(P%o|0,P/o|0,$)}t.fromNumber=u;function d(P,$,z){return new t(P,$,z)}t.fromBits=d;var p=Math.pow;function _(P,$,z){if(P.length===0)throw Error("empty string");if(P==="NaN"||P==="Infinity"||P==="+Infinity"||P==="-Infinity")return m;if(typeof $=="number"?(z=$,$=!1):$=!!$,z=z||10,z<2||36<z)throw RangeError("radix");var L;if((L=P.indexOf("-"))>0)throw Error("interior hyphen");if(L===0)return _(P.substring(1),$,z).neg();for(var Z=u(p(z,8)),Q=m,ae=0;ae<P.length;ae+=8){var le=Math.min(8,P.length-ae),ee=parseInt(P.substring(ae,ae+le),z);if(le<8){var he=u(p(z,le));Q=Q.mul(he).add(u(ee))}else Q=Q.mul(Z),Q=Q.add(u(ee))}return Q.unsigned=$,Q}t.fromString=_;function v(P){return P instanceof t?P:typeof P=="number"?u(P):typeof P=="string"?_(P):d(P.low,P.high,P.unsigned)}t.fromValue=v;var b=65536,i=1<<24,o=b*b,c=o*o,f=c/2,l=a(i),m=a(0);t.ZERO=m;var h=a(0,!0);t.UZERO=h;var g=a(1);t.ONE=g;var w=a(1,!0);t.UONE=w;var y=a(-1);t.NEG_ONE=y;var E=d(-1,2147483647,!1);t.MAX_VALUE=E;var k=d(-1,-1,!0);t.MAX_UNSIGNED_VALUE=k;var C=d(0,-2147483648,!1);t.MIN_VALUE=C;var T=t.prototype;return T.toInt=function(){return this.unsigned?this.low>>>0:this.low},T.toNumber=function(){return this.unsigned?(this.high>>>0)*o+(this.low>>>0):this.high*o+(this.low>>>0)},T.toString=function($){if($=$||10,$<2||36<$)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(C)){var z=u($),L=this.div(z),Z=L.mul(z).sub(this);return L.toString($)+Z.toInt().toString($)}else return"-"+this.neg().toString($);for(var Q=u(p($,6),this.unsigned),ae=this,le="";;){var ee=ae.div(Q),he=ae.sub(ee.mul(Q)).toInt()>>>0,M=he.toString($);if(ae=ee,ae.isZero())return M+le;for(;M.length<6;)M="0"+M;le=""+M+le}},T.getHighBits=function(){return this.high},T.getHighBitsUnsigned=function(){return this.high>>>0},T.getLowBits=function(){return this.low},T.getLowBitsUnsigned=function(){return this.low>>>0},T.getNumBitsAbs=function(){if(this.isNegative())return this.eq(C)?64:this.neg().getNumBitsAbs();for(var $=this.high!=0?this.high:this.low,z=31;z>0&&($&1<<z)==0;z--);return this.high!=0?z+33:z+1},T.isZero=function(){return this.high===0&&this.low===0},T.isNegative=function(){return!this.unsigned&&this.high<0},T.isPositive=function(){return this.unsigned||this.high>=0},T.isOdd=function(){return(this.low&1)===1},T.isEven=function(){return(this.low&1)===0},T.equals=function($){return r($)||($=v($)),this.unsigned!==$.unsigned&&this.high>>>31===1&&$.high>>>31===1?!1:this.high===$.high&&this.low===$.low},T.eq=T.equals,T.notEquals=function($){return!this.eq($)},T.neq=T.notEquals,T.lessThan=function($){return this.comp($)<0},T.lt=T.lessThan,T.lessThanOrEqual=function($){return this.comp($)<=0},T.lte=T.lessThanOrEqual,T.greaterThan=function($){return this.comp($)>0},T.gt=T.greaterThan,T.greaterThanOrEqual=function($){return this.comp($)>=0},T.gte=T.greaterThanOrEqual,T.compare=function($){if(r($)||($=v($)),this.eq($))return 0;var z=this.isNegative(),L=$.isNegative();return z&&!L?-1:!z&&L?1:this.unsigned?$.high>>>0>this.high>>>0||$.high===this.high&&$.low>>>0>this.low>>>0?-1:1:this.sub($).isNegative()?-1:1},T.comp=T.compare,T.negate=function(){return!this.unsigned&&this.eq(C)?C:this.not().add(g)},T.neg=T.negate,T.add=function($){r($)||($=v($));var z=this.high>>>16,L=this.high&65535,Z=this.low>>>16,Q=this.low&65535,ae=$.high>>>16,le=$.high&65535,ee=$.low>>>16,he=$.low&65535,M=0,N=0,j=0,A=0;return A+=Q+he,j+=A>>>16,A&=65535,j+=Z+ee,N+=j>>>16,j&=65535,N+=L+le,M+=N>>>16,N&=65535,M+=z+ae,M&=65535,d(j<<16|A,M<<16|N,this.unsigned)},T.subtract=function($){return r($)||($=v($)),this.add($.neg())},T.sub=T.subtract,T.multiply=function($){if(this.isZero()||(r($)||($=v($)),$.isZero()))return m;if(this.eq(C))return $.isOdd()?C:m;if($.eq(C))return this.isOdd()?C:m;if(this.isNegative())return $.isNegative()?this.neg().mul($.neg()):this.neg().mul($).neg();if($.isNegative())return this.mul($.neg()).neg();if(this.lt(l)&&$.lt(l))return u(this.toNumber()*$.toNumber(),this.unsigned);var z=this.high>>>16,L=this.high&65535,Z=this.low>>>16,Q=this.low&65535,ae=$.high>>>16,le=$.high&65535,ee=$.low>>>16,he=$.low&65535,M=0,N=0,j=0,A=0;return A+=Q*he,j+=A>>>16,A&=65535,j+=Z*he,N+=j>>>16,j&=65535,j+=Q*ee,N+=j>>>16,j&=65535,N+=L*he,M+=N>>>16,N&=65535,N+=Z*ee,M+=N>>>16,N&=65535,N+=Q*le,M+=N>>>16,N&=65535,M+=z*he+L*ee+Z*le+Q*ae,M&=65535,d(j<<16|A,M<<16|N,this.unsigned)},T.mul=T.multiply,T.divide=function($){if(r($)||($=v($)),$.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?h:m;var z,L,Z;if(this.unsigned){if($.unsigned||($=$.toUnsigned()),$.gt(this))return h;if($.gt(this.shru(1)))return w;Z=h}else{if(this.eq(C)){if($.eq(g)||$.eq(y))return C;if($.eq(C))return g;var Q=this.shr(1);return z=Q.div($).shl(1),z.eq(m)?$.isNegative()?g:y:(L=this.sub($.mul(z)),Z=z.add(L.div($)),Z)}else if($.eq(C))return this.unsigned?h:m;if(this.isNegative())return $.isNegative()?this.neg().div($.neg()):this.neg().div($).neg();if($.isNegative())return this.div($.neg()).neg();Z=m}for(L=this;L.gte($);){z=Math.max(1,Math.floor(L.toNumber()/$.toNumber()));for(var ae=Math.ceil(Math.log(z)/Math.LN2),le=ae<=48?1:p(2,ae-48),ee=u(z),he=ee.mul($);he.isNegative()||he.gt(L);)z-=le,ee=u(z,this.unsigned),he=ee.mul($);ee.isZero()&&(ee=g),Z=Z.add(ee),L=L.sub(he)}return Z},T.div=T.divide,T.modulo=function($){return r($)||($=v($)),this.sub(this.div($).mul($))},T.mod=T.modulo,T.not=function(){return d(~this.low,~this.high,this.unsigned)},T.and=function($){return r($)||($=v($)),d(this.low&$.low,this.high&$.high,this.unsigned)},T.or=function($){return r($)||($=v($)),d(this.low|$.low,this.high|$.high,this.unsigned)},T.xor=function($){return r($)||($=v($)),d(this.low^$.low,this.high^$.high,this.unsigned)},T.shiftLeft=function($){return r($)&&($=$.toInt()),($&=63)===0?this:$<32?d(this.low<<$,this.high<<$|this.low>>>32-$,this.unsigned):d(0,this.low<<$-32,this.unsigned)},T.shl=T.shiftLeft,T.shiftRight=function($){return r($)&&($=$.toInt()),($&=63)===0?this:$<32?d(this.low>>>$|this.high<<32-$,this.high>>$,this.unsigned):d(this.high>>$-32,this.high>=0?0:-1,this.unsigned)},T.shr=T.shiftRight,T.shiftRightUnsigned=function($){if(r($)&&($=$.toInt()),$&=63,$===0)return this;var z=this.high;if($<32){var L=this.low;return d(L>>>$|z<<32-$,z>>>$,this.unsigned)}else return $===32?d(z,0,this.unsigned):d(z>>>$-32,0,this.unsigned)},T.shru=T.shiftRightUnsigned,T.toSigned=function(){return this.unsigned?d(this.low,this.high,!1):this},T.toUnsigned=function(){return this.unsigned?this:d(this.low,this.high,!0)},T.toBytes=function(P){return P?this.toBytesLE():this.toBytesBE()},T.toBytesLE=function(){var P=this.high,$=this.low;return[$&255,$>>>8&255,$>>>16&255,$>>>24&255,P&255,P>>>8&255,P>>>16&255,P>>>24&255]},T.toBytesBE=function(){var P=this.high,$=this.low;return[P>>>24&255,P>>>16&255,P>>>8&255,P&255,$>>>24&255,$>>>16&255,$>>>8&255,$&255]},t})})(Hr)),Hr.exports}var fc=Vr.exports,Gi;function pc(){return Gi||(Gi=1,(function(e){/**
 * @license bytebuffer.js (c) 2015 Daniel Wirtz <dcode@dcode.io>
 * Backing buffer: ArrayBuffer, Accessor: Uint8Array
 * Released under the Apache License, Version 2.0
 * see: https://github.com/dcodeIO/bytebuffer.js for details
 */(function(t,r){typeof Bs=="function"&&e&&e.exports?e.exports=(function(){var n;try{n=hc()}catch{}return r(n)})():(t.dcodeIO=t.dcodeIO||{}).ByteBuffer=r(t.dcodeIO.Long)})(fc,function(t){var r=function(i,o,c){if(typeof i>"u"&&(i=r.DEFAULT_CAPACITY),typeof o>"u"&&(o=r.DEFAULT_ENDIAN),typeof c>"u"&&(c=r.DEFAULT_NOASSERT),!c){if(i=i|0,i<0)throw RangeError("Illegal capacity");o=!!o,c=!!c}this.buffer=i===0?s:new ArrayBuffer(i),this.view=i===0?null:new Uint8Array(this.buffer),this.offset=0,this.markedOffset=-1,this.limit=i,this.littleEndian=o,this.noAssert=c};r.VERSION="5.0.1",r.LITTLE_ENDIAN=!0,r.BIG_ENDIAN=!1,r.DEFAULT_CAPACITY=16,r.DEFAULT_ENDIAN=r.BIG_ENDIAN,r.DEFAULT_NOASSERT=!1,r.Long=t||null;var n=r.prototype;n.__isByteBuffer__,Object.defineProperty(n,"__isByteBuffer__",{value:!0,enumerable:!1,configurable:!1});var s=new ArrayBuffer(0),a=String.fromCharCode;function u(i){var o=0;return function(){return o<i.length?i.charCodeAt(o++):null}}function d(){var i=[],o=[];return function(){if(arguments.length===0)return o.join("")+a.apply(String,i);i.length+arguments.length>1024&&(o.push(a.apply(String,i)),i.length=0),Array.prototype.push.apply(i,arguments)}}r.accessor=function(){return Uint8Array},r.allocate=function(i,o,c){return new r(i,o,c)},r.concat=function(i,o,c,f){(typeof o=="boolean"||typeof o!="string")&&(f=c,c=o,o=void 0);for(var l=0,m=0,h=i.length,g;m<h;++m)r.isByteBuffer(i[m])||(i[m]=r.wrap(i[m],o)),g=i[m].limit-i[m].offset,g>0&&(l+=g);if(l===0)return new r(0,c,f);var w=new r(l,c,f),y;for(m=0;m<h;)y=i[m++],g=y.limit-y.offset,!(g<=0)&&(w.view.set(y.view.subarray(y.offset,y.limit),w.offset),w.offset+=g);return w.limit=w.offset,w.offset=0,w},r.isByteBuffer=function(i){return(i&&i.__isByteBuffer__)===!0},r.type=function(){return ArrayBuffer},r.wrap=function(i,o,c,f){if(typeof o!="string"&&(f=c,c=o,o=void 0),typeof i=="string")switch(typeof o>"u"&&(o="utf8"),o){case"base64":return r.fromBase64(i,c);case"hex":return r.fromHex(i,c);case"binary":return r.fromBinary(i,c);case"utf8":return r.fromUTF8(i,c);case"debug":return r.fromDebug(i,c);default:throw Error("Unsupported encoding: "+o)}if(i===null||typeof i!="object")throw TypeError("Illegal buffer");var l;if(r.isByteBuffer(i))return l=n.clone.call(i),l.markedOffset=-1,l;if(i instanceof Uint8Array)l=new r(0,c,f),i.length>0&&(l.buffer=i.buffer,l.offset=i.byteOffset,l.limit=i.byteOffset+i.byteLength,l.view=new Uint8Array(i.buffer));else if(i instanceof ArrayBuffer)l=new r(0,c,f),i.byteLength>0&&(l.buffer=i,l.offset=0,l.limit=i.byteLength,l.view=i.byteLength>0?new Uint8Array(i):null);else if(Object.prototype.toString.call(i)==="[object Array]"){l=new r(i.length,c,f),l.limit=i.length;for(var m=0;m<i.length;++m)l.view[m]=i[m]}else throw TypeError("Illegal buffer");return l},n.writeBitSet=function(i,o){var c=typeof o>"u";if(c&&(o=this.offset),!this.noAssert){if(!(i instanceof Array))throw TypeError("Illegal BitSet: Not an array");if(typeof o!="number"||o%1!==0)throw TypeError("Illegal offset: "+o+" (not an integer)");if(o>>>=0,o<0||o+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+o+" (+0) <= "+this.buffer.byteLength)}var f=o,l=i.length,m=l>>3,h=0,g;for(o+=this.writeVarint32(l,o);m--;)g=!!i[h++]&1|(!!i[h++]&1)<<1|(!!i[h++]&1)<<2|(!!i[h++]&1)<<3|(!!i[h++]&1)<<4|(!!i[h++]&1)<<5|(!!i[h++]&1)<<6|(!!i[h++]&1)<<7,this.writeByte(g,o++);if(h<l){var w=0;for(g=0;h<l;)g=g|(!!i[h++]&1)<<w++;this.writeByte(g,o++)}return c?(this.offset=o,this):o-f},n.readBitSet=function(i){var o=typeof i>"u";o&&(i=this.offset);var c=this.readVarint32(i),f=c.value,l=f>>3,m=0,h=[],g;for(i+=c.length;l--;)g=this.readByte(i++),h[m++]=!!(g&1),h[m++]=!!(g&2),h[m++]=!!(g&4),h[m++]=!!(g&8),h[m++]=!!(g&16),h[m++]=!!(g&32),h[m++]=!!(g&64),h[m++]=!!(g&128);if(m<f){var w=0;for(g=this.readByte(i++);m<f;)h[m++]=!!(g>>w++&1)}return o&&(this.offset=i),h},n.readBytes=function(i,o){var c=typeof o>"u";if(c&&(o=this.offset),!this.noAssert){if(typeof o!="number"||o%1!==0)throw TypeError("Illegal offset: "+o+" (not an integer)");if(o>>>=0,o<0||o+i>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+o+" (+"+i+") <= "+this.buffer.byteLength)}var f=this.slice(o,o+i);return c&&(this.offset+=i),f},n.writeBytes=n.append,n.writeInt8=function(i,o){var c=typeof o>"u";if(c&&(o=this.offset),!this.noAssert){if(typeof i!="number"||i%1!==0)throw TypeError("Illegal value: "+i+" (not an integer)");if(i|=0,typeof o!="number"||o%1!==0)throw TypeError("Illegal offset: "+o+" (not an integer)");if(o>>>=0,o<0||o+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+o+" (+0) <= "+this.buffer.byteLength)}o+=1;var f=this.buffer.byteLength;return o>f&&this.resize((f*=2)>o?f:o),o-=1,this.view[o]=i,c&&(this.offset+=1),this},n.writeByte=n.writeInt8,n.readInt8=function(i){var o=typeof i>"u";if(o&&(i=this.offset),!this.noAssert){if(typeof i!="number"||i%1!==0)throw TypeError("Illegal offset: "+i+" (not an integer)");if(i>>>=0,i<0||i+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+1) <= "+this.buffer.byteLength)}var c=this.view[i];return(c&128)===128&&(c=-(255-c+1)),o&&(this.offset+=1),c},n.readByte=n.readInt8,n.writeUint8=function(i,o){var c=typeof o>"u";if(c&&(o=this.offset),!this.noAssert){if(typeof i!="number"||i%1!==0)throw TypeError("Illegal value: "+i+" (not an integer)");if(i>>>=0,typeof o!="number"||o%1!==0)throw TypeError("Illegal offset: "+o+" (not an integer)");if(o>>>=0,o<0||o+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+o+" (+0) <= "+this.buffer.byteLength)}o+=1;var f=this.buffer.byteLength;return o>f&&this.resize((f*=2)>o?f:o),o-=1,this.view[o]=i,c&&(this.offset+=1),this},n.writeUInt8=n.writeUint8,n.readUint8=function(i){var o=typeof i>"u";if(o&&(i=this.offset),!this.noAssert){if(typeof i!="number"||i%1!==0)throw TypeError("Illegal offset: "+i+" (not an integer)");if(i>>>=0,i<0||i+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+1) <= "+this.buffer.byteLength)}var c=this.view[i];return o&&(this.offset+=1),c},n.readUInt8=n.readUint8,n.writeInt16=function(i,o){var c=typeof o>"u";if(c&&(o=this.offset),!this.noAssert){if(typeof i!="number"||i%1!==0)throw TypeError("Illegal value: "+i+" (not an integer)");if(i|=0,typeof o!="number"||o%1!==0)throw TypeError("Illegal offset: "+o+" (not an integer)");if(o>>>=0,o<0||o+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+o+" (+0) <= "+this.buffer.byteLength)}o+=2;var f=this.buffer.byteLength;return o>f&&this.resize((f*=2)>o?f:o),o-=2,this.littleEndian?(this.view[o+1]=(i&65280)>>>8,this.view[o]=i&255):(this.view[o]=(i&65280)>>>8,this.view[o+1]=i&255),c&&(this.offset+=2),this},n.writeShort=n.writeInt16,n.readInt16=function(i){var o=typeof i>"u";if(o&&(i=this.offset),!this.noAssert){if(typeof i!="number"||i%1!==0)throw TypeError("Illegal offset: "+i+" (not an integer)");if(i>>>=0,i<0||i+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+2) <= "+this.buffer.byteLength)}var c=0;return this.littleEndian?(c=this.view[i],c|=this.view[i+1]<<8):(c=this.view[i]<<8,c|=this.view[i+1]),(c&32768)===32768&&(c=-(65535-c+1)),o&&(this.offset+=2),c},n.readShort=n.readInt16,n.writeUint16=function(i,o){var c=typeof o>"u";if(c&&(o=this.offset),!this.noAssert){if(typeof i!="number"||i%1!==0)throw TypeError("Illegal value: "+i+" (not an integer)");if(i>>>=0,typeof o!="number"||o%1!==0)throw TypeError("Illegal offset: "+o+" (not an integer)");if(o>>>=0,o<0||o+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+o+" (+0) <= "+this.buffer.byteLength)}o+=2;var f=this.buffer.byteLength;return o>f&&this.resize((f*=2)>o?f:o),o-=2,this.littleEndian?(this.view[o+1]=(i&65280)>>>8,this.view[o]=i&255):(this.view[o]=(i&65280)>>>8,this.view[o+1]=i&255),c&&(this.offset+=2),this},n.writeUInt16=n.writeUint16,n.readUint16=function(i){var o=typeof i>"u";if(o&&(i=this.offset),!this.noAssert){if(typeof i!="number"||i%1!==0)throw TypeError("Illegal offset: "+i+" (not an integer)");if(i>>>=0,i<0||i+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+2) <= "+this.buffer.byteLength)}var c=0;return this.littleEndian?(c=this.view[i],c|=this.view[i+1]<<8):(c=this.view[i]<<8,c|=this.view[i+1]),o&&(this.offset+=2),c},n.readUInt16=n.readUint16,n.writeInt32=function(i,o){var c=typeof o>"u";if(c&&(o=this.offset),!this.noAssert){if(typeof i!="number"||i%1!==0)throw TypeError("Illegal value: "+i+" (not an integer)");if(i|=0,typeof o!="number"||o%1!==0)throw TypeError("Illegal offset: "+o+" (not an integer)");if(o>>>=0,o<0||o+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+o+" (+0) <= "+this.buffer.byteLength)}o+=4;var f=this.buffer.byteLength;return o>f&&this.resize((f*=2)>o?f:o),o-=4,this.littleEndian?(this.view[o+3]=i>>>24&255,this.view[o+2]=i>>>16&255,this.view[o+1]=i>>>8&255,this.view[o]=i&255):(this.view[o]=i>>>24&255,this.view[o+1]=i>>>16&255,this.view[o+2]=i>>>8&255,this.view[o+3]=i&255),c&&(this.offset+=4),this},n.writeInt=n.writeInt32,n.readInt32=function(i){var o=typeof i>"u";if(o&&(i=this.offset),!this.noAssert){if(typeof i!="number"||i%1!==0)throw TypeError("Illegal offset: "+i+" (not an integer)");if(i>>>=0,i<0||i+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+4) <= "+this.buffer.byteLength)}var c=0;return this.littleEndian?(c=this.view[i+2]<<16,c|=this.view[i+1]<<8,c|=this.view[i],c+=this.view[i+3]<<24>>>0):(c=this.view[i+1]<<16,c|=this.view[i+2]<<8,c|=this.view[i+3],c+=this.view[i]<<24>>>0),c|=0,o&&(this.offset+=4),c},n.readInt=n.readInt32,n.writeUint32=function(i,o){var c=typeof o>"u";if(c&&(o=this.offset),!this.noAssert){if(typeof i!="number"||i%1!==0)throw TypeError("Illegal value: "+i+" (not an integer)");if(i>>>=0,typeof o!="number"||o%1!==0)throw TypeError("Illegal offset: "+o+" (not an integer)");if(o>>>=0,o<0||o+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+o+" (+0) <= "+this.buffer.byteLength)}o+=4;var f=this.buffer.byteLength;return o>f&&this.resize((f*=2)>o?f:o),o-=4,this.littleEndian?(this.view[o+3]=i>>>24&255,this.view[o+2]=i>>>16&255,this.view[o+1]=i>>>8&255,this.view[o]=i&255):(this.view[o]=i>>>24&255,this.view[o+1]=i>>>16&255,this.view[o+2]=i>>>8&255,this.view[o+3]=i&255),c&&(this.offset+=4),this},n.writeUInt32=n.writeUint32,n.readUint32=function(i){var o=typeof i>"u";if(o&&(i=this.offset),!this.noAssert){if(typeof i!="number"||i%1!==0)throw TypeError("Illegal offset: "+i+" (not an integer)");if(i>>>=0,i<0||i+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+4) <= "+this.buffer.byteLength)}var c=0;return this.littleEndian?(c=this.view[i+2]<<16,c|=this.view[i+1]<<8,c|=this.view[i],c+=this.view[i+3]<<24>>>0):(c=this.view[i+1]<<16,c|=this.view[i+2]<<8,c|=this.view[i+3],c+=this.view[i]<<24>>>0),o&&(this.offset+=4),c},n.readUInt32=n.readUint32,t&&(n.writeInt64=function(i,o){var c=typeof o>"u";if(c&&(o=this.offset),!this.noAssert){if(typeof i=="number")i=t.fromNumber(i);else if(typeof i=="string")i=t.fromString(i);else if(!(i&&i instanceof t))throw TypeError("Illegal value: "+i+" (not an integer or Long)");if(typeof o!="number"||o%1!==0)throw TypeError("Illegal offset: "+o+" (not an integer)");if(o>>>=0,o<0||o+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+o+" (+0) <= "+this.buffer.byteLength)}typeof i=="number"?i=t.fromNumber(i):typeof i=="string"&&(i=t.fromString(i)),o+=8;var f=this.buffer.byteLength;o>f&&this.resize((f*=2)>o?f:o),o-=8;var l=i.low,m=i.high;return this.littleEndian?(this.view[o+3]=l>>>24&255,this.view[o+2]=l>>>16&255,this.view[o+1]=l>>>8&255,this.view[o]=l&255,o+=4,this.view[o+3]=m>>>24&255,this.view[o+2]=m>>>16&255,this.view[o+1]=m>>>8&255,this.view[o]=m&255):(this.view[o]=m>>>24&255,this.view[o+1]=m>>>16&255,this.view[o+2]=m>>>8&255,this.view[o+3]=m&255,o+=4,this.view[o]=l>>>24&255,this.view[o+1]=l>>>16&255,this.view[o+2]=l>>>8&255,this.view[o+3]=l&255),c&&(this.offset+=8),this},n.writeLong=n.writeInt64,n.readInt64=function(i){var o=typeof i>"u";if(o&&(i=this.offset),!this.noAssert){if(typeof i!="number"||i%1!==0)throw TypeError("Illegal offset: "+i+" (not an integer)");if(i>>>=0,i<0||i+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+8) <= "+this.buffer.byteLength)}var c=0,f=0;this.littleEndian?(c=this.view[i+2]<<16,c|=this.view[i+1]<<8,c|=this.view[i],c+=this.view[i+3]<<24>>>0,i+=4,f=this.view[i+2]<<16,f|=this.view[i+1]<<8,f|=this.view[i],f+=this.view[i+3]<<24>>>0):(f=this.view[i+1]<<16,f|=this.view[i+2]<<8,f|=this.view[i+3],f+=this.view[i]<<24>>>0,i+=4,c=this.view[i+1]<<16,c|=this.view[i+2]<<8,c|=this.view[i+3],c+=this.view[i]<<24>>>0);var l=new t(c,f,!1);return o&&(this.offset+=8),l},n.readLong=n.readInt64,n.writeUint64=function(i,o){var c=typeof o>"u";if(c&&(o=this.offset),!this.noAssert){if(typeof i=="number")i=t.fromNumber(i);else if(typeof i=="string")i=t.fromString(i);else if(!(i&&i instanceof t))throw TypeError("Illegal value: "+i+" (not an integer or Long)");if(typeof o!="number"||o%1!==0)throw TypeError("Illegal offset: "+o+" (not an integer)");if(o>>>=0,o<0||o+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+o+" (+0) <= "+this.buffer.byteLength)}typeof i=="number"?i=t.fromNumber(i):typeof i=="string"&&(i=t.fromString(i)),o+=8;var f=this.buffer.byteLength;o>f&&this.resize((f*=2)>o?f:o),o-=8;var l=i.low,m=i.high;return this.littleEndian?(this.view[o+3]=l>>>24&255,this.view[o+2]=l>>>16&255,this.view[o+1]=l>>>8&255,this.view[o]=l&255,o+=4,this.view[o+3]=m>>>24&255,this.view[o+2]=m>>>16&255,this.view[o+1]=m>>>8&255,this.view[o]=m&255):(this.view[o]=m>>>24&255,this.view[o+1]=m>>>16&255,this.view[o+2]=m>>>8&255,this.view[o+3]=m&255,o+=4,this.view[o]=l>>>24&255,this.view[o+1]=l>>>16&255,this.view[o+2]=l>>>8&255,this.view[o+3]=l&255),c&&(this.offset+=8),this},n.writeUInt64=n.writeUint64,n.readUint64=function(i){var o=typeof i>"u";if(o&&(i=this.offset),!this.noAssert){if(typeof i!="number"||i%1!==0)throw TypeError("Illegal offset: "+i+" (not an integer)");if(i>>>=0,i<0||i+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+8) <= "+this.buffer.byteLength)}var c=0,f=0;this.littleEndian?(c=this.view[i+2]<<16,c|=this.view[i+1]<<8,c|=this.view[i],c+=this.view[i+3]<<24>>>0,i+=4,f=this.view[i+2]<<16,f|=this.view[i+1]<<8,f|=this.view[i],f+=this.view[i+3]<<24>>>0):(f=this.view[i+1]<<16,f|=this.view[i+2]<<8,f|=this.view[i+3],f+=this.view[i]<<24>>>0,i+=4,c=this.view[i+1]<<16,c|=this.view[i+2]<<8,c|=this.view[i+3],c+=this.view[i]<<24>>>0);var l=new t(c,f,!0);return o&&(this.offset+=8),l},n.readUInt64=n.readUint64);function p(i,o,c,f,l){var m,h,g=l*8-f-1,w=(1<<g)-1,y=w>>1,E=-7,k=c?l-1:0,C=c?-1:1,T=i[o+k];for(k+=C,m=T&(1<<-E)-1,T>>=-E,E+=g;E>0;m=m*256+i[o+k],k+=C,E-=8);for(h=m&(1<<-E)-1,m>>=-E,E+=f;E>0;h=h*256+i[o+k],k+=C,E-=8);if(m===0)m=1-y;else{if(m===w)return h?NaN:(T?-1:1)*(1/0);h=h+Math.pow(2,f),m=m-y}return(T?-1:1)*h*Math.pow(2,m-f)}function _(i,o,c,f,l,m){var h,g,w,y=m*8-l-1,E=(1<<y)-1,k=E>>1,C=l===23?Math.pow(2,-24)-Math.pow(2,-77):0,T=f?0:m-1,P=f?1:-1,$=o<0||o===0&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(g=isNaN(o)?1:0,h=E):(h=Math.floor(Math.log(o)/Math.LN2),o*(w=Math.pow(2,-h))<1&&(h--,w*=2),h+k>=1?o+=C/w:o+=C*Math.pow(2,1-k),o*w>=2&&(h++,w/=2),h+k>=E?(g=0,h=E):h+k>=1?(g=(o*w-1)*Math.pow(2,l),h=h+k):(g=o*Math.pow(2,k-1)*Math.pow(2,l),h=0));l>=8;i[c+T]=g&255,T+=P,g/=256,l-=8);for(h=h<<l|g,y+=l;y>0;i[c+T]=h&255,T+=P,h/=256,y-=8);i[c+T-P]|=$*128}n.writeFloat32=function(i,o){var c=typeof o>"u";if(c&&(o=this.offset),!this.noAssert){if(typeof i!="number")throw TypeError("Illegal value: "+i+" (not a number)");if(typeof o!="number"||o%1!==0)throw TypeError("Illegal offset: "+o+" (not an integer)");if(o>>>=0,o<0||o+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+o+" (+0) <= "+this.buffer.byteLength)}o+=4;var f=this.buffer.byteLength;return o>f&&this.resize((f*=2)>o?f:o),o-=4,_(this.view,i,o,this.littleEndian,23,4),c&&(this.offset+=4),this},n.writeFloat=n.writeFloat32,n.readFloat32=function(i){var o=typeof i>"u";if(o&&(i=this.offset),!this.noAssert){if(typeof i!="number"||i%1!==0)throw TypeError("Illegal offset: "+i+" (not an integer)");if(i>>>=0,i<0||i+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+4) <= "+this.buffer.byteLength)}var c=p(this.view,i,this.littleEndian,23,4);return o&&(this.offset+=4),c},n.readFloat=n.readFloat32,n.writeFloat64=function(i,o){var c=typeof o>"u";if(c&&(o=this.offset),!this.noAssert){if(typeof i!="number")throw TypeError("Illegal value: "+i+" (not a number)");if(typeof o!="number"||o%1!==0)throw TypeError("Illegal offset: "+o+" (not an integer)");if(o>>>=0,o<0||o+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+o+" (+0) <= "+this.buffer.byteLength)}o+=8;var f=this.buffer.byteLength;return o>f&&this.resize((f*=2)>o?f:o),o-=8,_(this.view,i,o,this.littleEndian,52,8),c&&(this.offset+=8),this},n.writeDouble=n.writeFloat64,n.readFloat64=function(i){var o=typeof i>"u";if(o&&(i=this.offset),!this.noAssert){if(typeof i!="number"||i%1!==0)throw TypeError("Illegal offset: "+i+" (not an integer)");if(i>>>=0,i<0||i+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+8) <= "+this.buffer.byteLength)}var c=p(this.view,i,this.littleEndian,52,8);return o&&(this.offset+=8),c},n.readDouble=n.readFloat64,r.MAX_VARINT32_BYTES=5,r.calculateVarint32=function(i){return i=i>>>0,i<128?1:i<16384?2:i<1<<21?3:i<1<<28?4:5},r.zigZagEncode32=function(i){return((i|=0)<<1^i>>31)>>>0},r.zigZagDecode32=function(i){return i>>>1^-(i&1)|0},n.writeVarint32=function(i,o){var c=typeof o>"u";if(c&&(o=this.offset),!this.noAssert){if(typeof i!="number"||i%1!==0)throw TypeError("Illegal value: "+i+" (not an integer)");if(i|=0,typeof o!="number"||o%1!==0)throw TypeError("Illegal offset: "+o+" (not an integer)");if(o>>>=0,o<0||o+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+o+" (+0) <= "+this.buffer.byteLength)}var f=r.calculateVarint32(i),l;o+=f;var m=this.buffer.byteLength;for(o>m&&this.resize((m*=2)>o?m:o),o-=f,i>>>=0;i>=128;)l=i&127|128,this.view[o++]=l,i>>>=7;return this.view[o++]=i,c?(this.offset=o,this):f},n.writeVarint32ZigZag=function(i,o){return this.writeVarint32(r.zigZagEncode32(i),o)},n.readVarint32=function(i){var o=typeof i>"u";if(o&&(i=this.offset),!this.noAssert){if(typeof i!="number"||i%1!==0)throw TypeError("Illegal offset: "+i+" (not an integer)");if(i>>>=0,i<0||i+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+1) <= "+this.buffer.byteLength)}var c=0,f=0,l;do{if(!this.noAssert&&i>this.limit){var m=Error("Truncated");throw m.truncated=!0,m}l=this.view[i++],c<5&&(f|=(l&127)<<7*c),++c}while((l&128)!==0);return f|=0,o?(this.offset=i,f):{value:f,length:c}},n.readVarint32ZigZag=function(i){var o=this.readVarint32(i);return typeof o=="object"?o.value=r.zigZagDecode32(o.value):o=r.zigZagDecode32(o),o},t&&(r.MAX_VARINT64_BYTES=10,r.calculateVarint64=function(i){typeof i=="number"?i=t.fromNumber(i):typeof i=="string"&&(i=t.fromString(i));var o=i.toInt()>>>0,c=i.shiftRightUnsigned(28).toInt()>>>0,f=i.shiftRightUnsigned(56).toInt()>>>0;return f==0?c==0?o<16384?o<128?1:2:o<1<<21?3:4:c<16384?c<128?5:6:c<1<<21?7:8:f<128?9:10},r.zigZagEncode64=function(i){return typeof i=="number"?i=t.fromNumber(i,!1):typeof i=="string"?i=t.fromString(i,!1):i.unsigned!==!1&&(i=i.toSigned()),i.shiftLeft(1).xor(i.shiftRight(63)).toUnsigned()},r.zigZagDecode64=function(i){return typeof i=="number"?i=t.fromNumber(i,!1):typeof i=="string"?i=t.fromString(i,!1):i.unsigned!==!1&&(i=i.toSigned()),i.shiftRightUnsigned(1).xor(i.and(t.ONE).toSigned().negate()).toSigned()},n.writeVarint64=function(i,o){var c=typeof o>"u";if(c&&(o=this.offset),!this.noAssert){if(typeof i=="number")i=t.fromNumber(i);else if(typeof i=="string")i=t.fromString(i);else if(!(i&&i instanceof t))throw TypeError("Illegal value: "+i+" (not an integer or Long)");if(typeof o!="number"||o%1!==0)throw TypeError("Illegal offset: "+o+" (not an integer)");if(o>>>=0,o<0||o+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+o+" (+0) <= "+this.buffer.byteLength)}typeof i=="number"?i=t.fromNumber(i,!1):typeof i=="string"?i=t.fromString(i,!1):i.unsigned!==!1&&(i=i.toSigned());var f=r.calculateVarint64(i),l=i.toInt()>>>0,m=i.shiftRightUnsigned(28).toInt()>>>0,h=i.shiftRightUnsigned(56).toInt()>>>0;o+=f;var g=this.buffer.byteLength;switch(o>g&&this.resize((g*=2)>o?g:o),o-=f,f){case 10:this.view[o+9]=h>>>7&1;case 9:this.view[o+8]=f!==9?h|128:h&127;case 8:this.view[o+7]=f!==8?m>>>21|128:m>>>21&127;case 7:this.view[o+6]=f!==7?m>>>14|128:m>>>14&127;case 6:this.view[o+5]=f!==6?m>>>7|128:m>>>7&127;case 5:this.view[o+4]=f!==5?m|128:m&127;case 4:this.view[o+3]=f!==4?l>>>21|128:l>>>21&127;case 3:this.view[o+2]=f!==3?l>>>14|128:l>>>14&127;case 2:this.view[o+1]=f!==2?l>>>7|128:l>>>7&127;case 1:this.view[o]=f!==1?l|128:l&127}return c?(this.offset+=f,this):f},n.writeVarint64ZigZag=function(i,o){return this.writeVarint64(r.zigZagEncode64(i),o)},n.readVarint64=function(i){var o=typeof i>"u";if(o&&(i=this.offset),!this.noAssert){if(typeof i!="number"||i%1!==0)throw TypeError("Illegal offset: "+i+" (not an integer)");if(i>>>=0,i<0||i+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+1) <= "+this.buffer.byteLength)}var c=i,f=0,l=0,m=0,h=0;if(h=this.view[i++],f=h&127,h&128&&(h=this.view[i++],f|=(h&127)<<7,(h&128||this.noAssert&&typeof h>"u")&&(h=this.view[i++],f|=(h&127)<<14,(h&128||this.noAssert&&typeof h>"u")&&(h=this.view[i++],f|=(h&127)<<21,(h&128||this.noAssert&&typeof h>"u")&&(h=this.view[i++],l=h&127,(h&128||this.noAssert&&typeof h>"u")&&(h=this.view[i++],l|=(h&127)<<7,(h&128||this.noAssert&&typeof h>"u")&&(h=this.view[i++],l|=(h&127)<<14,(h&128||this.noAssert&&typeof h>"u")&&(h=this.view[i++],l|=(h&127)<<21,(h&128||this.noAssert&&typeof h>"u")&&(h=this.view[i++],m=h&127,(h&128||this.noAssert&&typeof h>"u")&&(h=this.view[i++],m|=(h&127)<<7,h&128||this.noAssert&&typeof h>"u"))))))))))throw Error("Buffer overrun");var g=t.fromBits(f|l<<28,l>>>4|m<<24,!1);return o?(this.offset=i,g):{value:g,length:i-c}},n.readVarint64ZigZag=function(i){var o=this.readVarint64(i);return o&&o.value instanceof t?o.value=r.zigZagDecode64(o.value):o=r.zigZagDecode64(o),o}),n.writeCString=function(i,o){var c=typeof o>"u";c&&(o=this.offset);var f,l=i.length;if(!this.noAssert){if(typeof i!="string")throw TypeError("Illegal str: Not a string");for(f=0;f<l;++f)if(i.charCodeAt(f)===0)throw RangeError("Illegal str: Contains NULL-characters");if(typeof o!="number"||o%1!==0)throw TypeError("Illegal offset: "+o+" (not an integer)");if(o>>>=0,o<0||o+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+o+" (+0) <= "+this.buffer.byteLength)}l=b.calculateUTF16asUTF8(u(i))[1],o+=l+1;var m=this.buffer.byteLength;return o>m&&this.resize((m*=2)>o?m:o),o-=l+1,b.encodeUTF16toUTF8(u(i),(function(h){this.view[o++]=h}).bind(this)),this.view[o++]=0,c?(this.offset=o,this):l},n.readCString=function(i){var o=typeof i>"u";if(o&&(i=this.offset),!this.noAssert){if(typeof i!="number"||i%1!==0)throw TypeError("Illegal offset: "+i+" (not an integer)");if(i>>>=0,i<0||i+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+1) <= "+this.buffer.byteLength)}var c=i,f,l=-1;return b.decodeUTF8toUTF16((function(){if(l===0)return null;if(i>=this.limit)throw RangeError("Illegal range: Truncated data, "+i+" < "+this.limit);return l=this.view[i++],l===0?null:l}).bind(this),f=d(),!0),o?(this.offset=i,f()):{string:f(),length:i-c}},n.writeIString=function(i,o){var c=typeof o>"u";if(c&&(o=this.offset),!this.noAssert){if(typeof i!="string")throw TypeError("Illegal str: Not a string");if(typeof o!="number"||o%1!==0)throw TypeError("Illegal offset: "+o+" (not an integer)");if(o>>>=0,o<0||o+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+o+" (+0) <= "+this.buffer.byteLength)}var f=o,l;l=b.calculateUTF16asUTF8(u(i),this.noAssert)[1],o+=4+l;var m=this.buffer.byteLength;if(o>m&&this.resize((m*=2)>o?m:o),o-=4+l,this.littleEndian?(this.view[o+3]=l>>>24&255,this.view[o+2]=l>>>16&255,this.view[o+1]=l>>>8&255,this.view[o]=l&255):(this.view[o]=l>>>24&255,this.view[o+1]=l>>>16&255,this.view[o+2]=l>>>8&255,this.view[o+3]=l&255),o+=4,b.encodeUTF16toUTF8(u(i),(function(h){this.view[o++]=h}).bind(this)),o!==f+4+l)throw RangeError("Illegal range: Truncated data, "+o+" == "+(o+4+l));return c?(this.offset=o,this):o-f},n.readIString=function(i){var o=typeof i>"u";if(o&&(i=this.offset),!this.noAssert){if(typeof i!="number"||i%1!==0)throw TypeError("Illegal offset: "+i+" (not an integer)");if(i>>>=0,i<0||i+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+4) <= "+this.buffer.byteLength)}var c=i,f=this.readUint32(i),l=this.readUTF8String(f,r.METRICS_BYTES,i+=4);return i+=l.length,o?(this.offset=i,l.string):{string:l.string,length:i-c}},r.METRICS_CHARS="c",r.METRICS_BYTES="b",n.writeUTF8String=function(i,o){var c=typeof o>"u";if(c&&(o=this.offset),!this.noAssert){if(typeof o!="number"||o%1!==0)throw TypeError("Illegal offset: "+o+" (not an integer)");if(o>>>=0,o<0||o+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+o+" (+0) <= "+this.buffer.byteLength)}var f,l=o;f=b.calculateUTF16asUTF8(u(i))[1],o+=f;var m=this.buffer.byteLength;return o>m&&this.resize((m*=2)>o?m:o),o-=f,b.encodeUTF16toUTF8(u(i),(function(h){this.view[o++]=h}).bind(this)),c?(this.offset=o,this):o-l},n.writeString=n.writeUTF8String,r.calculateUTF8Chars=function(i){return b.calculateUTF16asUTF8(u(i))[0]},r.calculateUTF8Bytes=function(i){return b.calculateUTF16asUTF8(u(i))[1]},r.calculateString=r.calculateUTF8Bytes,n.readUTF8String=function(i,o,c){typeof o=="number"&&(c=o,o=void 0);var f=typeof c>"u";if(f&&(c=this.offset),typeof o>"u"&&(o=r.METRICS_CHARS),!this.noAssert){if(typeof i!="number"||i%1!==0)throw TypeError("Illegal length: "+i+" (not an integer)");if(i|=0,typeof c!="number"||c%1!==0)throw TypeError("Illegal offset: "+c+" (not an integer)");if(c>>>=0,c<0||c+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+c+" (+0) <= "+this.buffer.byteLength)}var l=0,m=c,h;if(o===r.METRICS_CHARS){if(h=d(),b.decodeUTF8((function(){return l<i&&c<this.limit?this.view[c++]:null}).bind(this),function(w){++l,b.UTF8toUTF16(w,h)}),l!==i)throw RangeError("Illegal range: Truncated data, "+l+" == "+i);return f?(this.offset=c,h()):{string:h(),length:c-m}}else if(o===r.METRICS_BYTES){if(!this.noAssert){if(typeof c!="number"||c%1!==0)throw TypeError("Illegal offset: "+c+" (not an integer)");if(c>>>=0,c<0||c+i>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+c+" (+"+i+") <= "+this.buffer.byteLength)}var g=c+i;if(b.decodeUTF8toUTF16((function(){return c<g?this.view[c++]:null}).bind(this),h=d(),this.noAssert),c!==g)throw RangeError("Illegal range: Truncated data, "+c+" == "+g);return f?(this.offset=c,h()):{string:h(),length:c-m}}else throw TypeError("Unsupported metrics: "+o)},n.readString=n.readUTF8String,n.writeVString=function(i,o){var c=typeof o>"u";if(c&&(o=this.offset),!this.noAssert){if(typeof i!="string")throw TypeError("Illegal str: Not a string");if(typeof o!="number"||o%1!==0)throw TypeError("Illegal offset: "+o+" (not an integer)");if(o>>>=0,o<0||o+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+o+" (+0) <= "+this.buffer.byteLength)}var f=o,l,m;l=b.calculateUTF16asUTF8(u(i),this.noAssert)[1],m=r.calculateVarint32(l),o+=m+l;var h=this.buffer.byteLength;if(o>h&&this.resize((h*=2)>o?h:o),o-=m+l,o+=this.writeVarint32(l,o),b.encodeUTF16toUTF8(u(i),(function(g){this.view[o++]=g}).bind(this)),o!==f+l+m)throw RangeError("Illegal range: Truncated data, "+o+" == "+(o+l+m));return c?(this.offset=o,this):o-f},n.readVString=function(i){var o=typeof i>"u";if(o&&(i=this.offset),!this.noAssert){if(typeof i!="number"||i%1!==0)throw TypeError("Illegal offset: "+i+" (not an integer)");if(i>>>=0,i<0||i+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+1) <= "+this.buffer.byteLength)}var c=i,f=this.readVarint32(i),l=this.readUTF8String(f.value,r.METRICS_BYTES,i+=f.length);return i+=l.length,o?(this.offset=i,l.string):{string:l.string,length:i-c}},n.append=function(i,o,c){(typeof o=="number"||typeof o!="string")&&(c=o,o=void 0);var f=typeof c>"u";if(f&&(c=this.offset),!this.noAssert){if(typeof c!="number"||c%1!==0)throw TypeError("Illegal offset: "+c+" (not an integer)");if(c>>>=0,c<0||c+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+c+" (+0) <= "+this.buffer.byteLength)}i instanceof r||(i=r.wrap(i,o));var l=i.limit-i.offset;if(l<=0)return this;c+=l;var m=this.buffer.byteLength;return c>m&&this.resize((m*=2)>c?m:c),c-=l,this.view.set(i.view.subarray(i.offset,i.limit),c),i.offset+=l,f&&(this.offset+=l),this},n.appendTo=function(i,o){return i.append(this,o),this},n.assert=function(i){return this.noAssert=!i,this},n.capacity=function(){return this.buffer.byteLength},n.clear=function(){return this.offset=0,this.limit=this.buffer.byteLength,this.markedOffset=-1,this},n.clone=function(i){var o=new r(0,this.littleEndian,this.noAssert);return i?(o.buffer=new ArrayBuffer(this.buffer.byteLength),o.view=new Uint8Array(o.buffer)):(o.buffer=this.buffer,o.view=this.view),o.offset=this.offset,o.markedOffset=this.markedOffset,o.limit=this.limit,o},n.compact=function(i,o){if(typeof i>"u"&&(i=this.offset),typeof o>"u"&&(o=this.limit),!this.noAssert){if(typeof i!="number"||i%1!==0)throw TypeError("Illegal begin: Not an integer");if(i>>>=0,typeof o!="number"||o%1!==0)throw TypeError("Illegal end: Not an integer");if(o>>>=0,i<0||i>o||o>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+i+" <= "+o+" <= "+this.buffer.byteLength)}if(i===0&&o===this.buffer.byteLength)return this;var c=o-i;if(c===0)return this.buffer=s,this.view=null,this.markedOffset>=0&&(this.markedOffset-=i),this.offset=0,this.limit=0,this;var f=new ArrayBuffer(c),l=new Uint8Array(f);return l.set(this.view.subarray(i,o)),this.buffer=f,this.view=l,this.markedOffset>=0&&(this.markedOffset-=i),this.offset=0,this.limit=c,this},n.copy=function(i,o){if(typeof i>"u"&&(i=this.offset),typeof o>"u"&&(o=this.limit),!this.noAssert){if(typeof i!="number"||i%1!==0)throw TypeError("Illegal begin: Not an integer");if(i>>>=0,typeof o!="number"||o%1!==0)throw TypeError("Illegal end: Not an integer");if(o>>>=0,i<0||i>o||o>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+i+" <= "+o+" <= "+this.buffer.byteLength)}if(i===o)return new r(0,this.littleEndian,this.noAssert);var c=o-i,f=new r(c,this.littleEndian,this.noAssert);return f.offset=0,f.limit=c,f.markedOffset>=0&&(f.markedOffset-=i),this.copyTo(f,0,i,o),f},n.copyTo=function(i,o,c,f){var l,m;if(!this.noAssert&&!r.isByteBuffer(i))throw TypeError("Illegal target: Not a ByteBuffer");if(o=(m=typeof o>"u")?i.offset:o|0,c=(l=typeof c>"u")?this.offset:c|0,f=typeof f>"u"?this.limit:f|0,o<0||o>i.buffer.byteLength)throw RangeError("Illegal target range: 0 <= "+o+" <= "+i.buffer.byteLength);if(c<0||f>this.buffer.byteLength)throw RangeError("Illegal source range: 0 <= "+c+" <= "+this.buffer.byteLength);var h=f-c;return h===0?i:(i.ensureCapacity(o+h),i.view.set(this.view.subarray(c,f),o),l&&(this.offset+=h),m&&(i.offset+=h),this)},n.ensureCapacity=function(i){var o=this.buffer.byteLength;return o<i?this.resize((o*=2)>i?o:i):this},n.fill=function(i,o,c){var f=typeof o>"u";if(f&&(o=this.offset),typeof i=="string"&&i.length>0&&(i=i.charCodeAt(0)),typeof o>"u"&&(o=this.offset),typeof c>"u"&&(c=this.limit),!this.noAssert){if(typeof i!="number"||i%1!==0)throw TypeError("Illegal value: "+i+" (not an integer)");if(i|=0,typeof o!="number"||o%1!==0)throw TypeError("Illegal begin: Not an integer");if(o>>>=0,typeof c!="number"||c%1!==0)throw TypeError("Illegal end: Not an integer");if(c>>>=0,o<0||o>c||c>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+o+" <= "+c+" <= "+this.buffer.byteLength)}if(o>=c)return this;for(;o<c;)this.view[o++]=i;return f&&(this.offset=o),this},n.flip=function(){return this.limit=this.offset,this.offset=0,this},n.mark=function(i){if(i=typeof i>"u"?this.offset:i,!this.noAssert){if(typeof i!="number"||i%1!==0)throw TypeError("Illegal offset: "+i+" (not an integer)");if(i>>>=0,i<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}return this.markedOffset=i,this},n.order=function(i){if(!this.noAssert&&typeof i!="boolean")throw TypeError("Illegal littleEndian: Not a boolean");return this.littleEndian=!!i,this},n.LE=function(i){return this.littleEndian=typeof i<"u"?!!i:!0,this},n.BE=function(i){return this.littleEndian=typeof i<"u"?!i:!1,this},n.prepend=function(i,o,c){(typeof o=="number"||typeof o!="string")&&(c=o,o=void 0);var f=typeof c>"u";if(f&&(c=this.offset),!this.noAssert){if(typeof c!="number"||c%1!==0)throw TypeError("Illegal offset: "+c+" (not an integer)");if(c>>>=0,c<0||c+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+c+" (+0) <= "+this.buffer.byteLength)}i instanceof r||(i=r.wrap(i,o));var l=i.limit-i.offset;if(l<=0)return this;var m=l-c;if(m>0){var h=new ArrayBuffer(this.buffer.byteLength+m),g=new Uint8Array(h);g.set(this.view.subarray(c,this.buffer.byteLength),l),this.buffer=h,this.view=g,this.offset+=m,this.markedOffset>=0&&(this.markedOffset+=m),this.limit+=m,c+=m}else new Uint8Array(this.buffer);return this.view.set(i.view.subarray(i.offset,i.limit),c-l),i.offset=i.limit,f&&(this.offset-=l),this},n.prependTo=function(i,o){return i.prepend(this,o),this},n.printDebug=function(i){typeof i!="function"&&(i=console.log.bind(console)),i(this.toString()+`
-------------------------------------------------------------------
`+this.toDebug(!0))},n.remaining=function(){return this.limit-this.offset},n.reset=function(){return this.markedOffset>=0?(this.offset=this.markedOffset,this.markedOffset=-1):this.offset=0,this},n.resize=function(i){if(!this.noAssert){if(typeof i!="number"||i%1!==0)throw TypeError("Illegal capacity: "+i+" (not an integer)");if(i|=0,i<0)throw RangeError("Illegal capacity: 0 <= "+i)}if(this.buffer.byteLength<i){var o=new ArrayBuffer(i),c=new Uint8Array(o);c.set(this.view),this.buffer=o,this.view=c}return this},n.reverse=function(i,o){if(typeof i>"u"&&(i=this.offset),typeof o>"u"&&(o=this.limit),!this.noAssert){if(typeof i!="number"||i%1!==0)throw TypeError("Illegal begin: Not an integer");if(i>>>=0,typeof o!="number"||o%1!==0)throw TypeError("Illegal end: Not an integer");if(o>>>=0,i<0||i>o||o>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+i+" <= "+o+" <= "+this.buffer.byteLength)}return i===o?this:(Array.prototype.reverse.call(this.view.subarray(i,o)),this)},n.skip=function(i){if(!this.noAssert){if(typeof i!="number"||i%1!==0)throw TypeError("Illegal length: "+i+" (not an integer)");i|=0}var o=this.offset+i;if(!this.noAssert&&(o<0||o>this.buffer.byteLength))throw RangeError("Illegal length: 0 <= "+this.offset+" + "+i+" <= "+this.buffer.byteLength);return this.offset=o,this},n.slice=function(i,o){if(typeof i>"u"&&(i=this.offset),typeof o>"u"&&(o=this.limit),!this.noAssert){if(typeof i!="number"||i%1!==0)throw TypeError("Illegal begin: Not an integer");if(i>>>=0,typeof o!="number"||o%1!==0)throw TypeError("Illegal end: Not an integer");if(o>>>=0,i<0||i>o||o>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+i+" <= "+o+" <= "+this.buffer.byteLength)}var c=this.clone();return c.offset=i,c.limit=o,c},n.toBuffer=function(i){var o=this.offset,c=this.limit;if(!this.noAssert){if(typeof o!="number"||o%1!==0)throw TypeError("Illegal offset: Not an integer");if(o>>>=0,typeof c!="number"||c%1!==0)throw TypeError("Illegal limit: Not an integer");if(c>>>=0,o<0||o>c||c>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+o+" <= "+c+" <= "+this.buffer.byteLength)}if(!i&&o===0&&c===this.buffer.byteLength)return this.buffer;if(o===c)return s;var f=new ArrayBuffer(c-o);return new Uint8Array(f).set(new Uint8Array(this.buffer).subarray(o,c),0),f},n.toArrayBuffer=n.toBuffer,n.toString=function(i,o,c){if(typeof i>"u")return"ByteBufferAB(offset="+this.offset+",markedOffset="+this.markedOffset+",limit="+this.limit+",capacity="+this.capacity()+")";switch(typeof i=="number"&&(i="utf8",o=i,c=o),i){case"utf8":return this.toUTF8(o,c);case"base64":return this.toBase64(o,c);case"hex":return this.toHex(o,c);case"binary":return this.toBinary(o,c);case"debug":return this.toDebug();case"columns":return this.toColumns();default:throw Error("Unsupported encoding: "+i)}};var v=(function(){for(var i={},o=[65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,48,49,50,51,52,53,54,55,56,57,43,47],c=[],f=0,l=o.length;f<l;++f)c[o[f]]=f;return i.encode=function(m,h){for(var g,w;(g=m())!==null;)h(o[g>>2&63]),w=(g&3)<<4,(g=m())!==null?(w|=g>>4&15,h(o[(w|g>>4&15)&63]),w=(g&15)<<2,(g=m())!==null?(h(o[(w|g>>6&3)&63]),h(o[g&63])):(h(o[w&63]),h(61))):(h(o[w&63]),h(61),h(61))},i.decode=function(m,h){var g,w,y;function E(k){throw Error("Illegal character code: "+k)}for(;(g=m())!==null;)if(w=c[g],typeof w>"u"&&E(g),(g=m())!==null&&(y=c[g],typeof y>"u"&&E(g),h(w<<2>>>0|(y&48)>>4),(g=m())!==null)){if(w=c[g],typeof w>"u"){if(g===61)break;E(g)}if(h((y&15)<<4>>>0|(w&60)>>2),(g=m())!==null){if(y=c[g],typeof y>"u"){if(g===61)break;E(g)}h((w&3)<<6>>>0|y)}}},i.test=function(m){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(m)},i})();n.toBase64=function(i,o){if(typeof i>"u"&&(i=this.offset),typeof o>"u"&&(o=this.limit),i=i|0,o=o|0,i<0||o>this.capacity||i>o)throw RangeError("begin, end");var c;return v.encode((function(){return i<o?this.view[i++]:null}).bind(this),c=d()),c()},r.fromBase64=function(i,o){if(typeof i!="string")throw TypeError("str");var c=new r(i.length/4*3,o),f=0;return v.decode(u(i),function(l){c.view[f++]=l}),c.limit=f,c},r.btoa=function(i){return r.fromBinary(i).toBase64()},r.atob=function(i){return r.fromBase64(i).toBinary()},n.toBinary=function(i,o){if(typeof i>"u"&&(i=this.offset),typeof o>"u"&&(o=this.limit),i|=0,o|=0,i<0||o>this.capacity()||i>o)throw RangeError("begin, end");if(i===o)return"";for(var c=[],f=[];i<o;)c.push(this.view[i++]),c.length>=1024&&(f.push(String.fromCharCode.apply(String,c)),c=[]);return f.join("")+String.fromCharCode.apply(String,c)},r.fromBinary=function(i,o){if(typeof i!="string")throw TypeError("str");for(var c=0,f=i.length,l,m=new r(f,o);c<f;){if(l=i.charCodeAt(c),l>255)throw RangeError("illegal char code: "+l);m.view[c++]=l}return m.limit=f,m},n.toDebug=function(i){for(var o=-1,c=this.buffer.byteLength,f,l="",m="",h="";o<c;){if(o!==-1&&(f=this.view[o],f<16?l+="0"+f.toString(16).toUpperCase():l+=f.toString(16).toUpperCase(),i&&(m+=f>32&&f<127?String.fromCharCode(f):".")),++o,i&&o>0&&o%16===0&&o!==c){for(;l.length<51;)l+=" ";h+=l+m+`
`,l=m=""}o===this.offset&&o===this.limit?l+=o===this.markedOffset?"!":"|":o===this.offset?l+=o===this.markedOffset?"[":"<":o===this.limit?l+=o===this.markedOffset?"]":">":l+=o===this.markedOffset?"'":i||o!==0&&o!==c?" ":""}if(i&&l!==" "){for(;l.length<51;)l+=" ";h+=l+m+`
`}return i?h:l},r.fromDebug=function(i,o,c){for(var f=i.length,l=new r((f+1)/3|0,o,c),m=0,h=0,g,w,y=!1,E=!1,k=!1,C=!1,T=!1;m<f;){switch(g=i.charAt(m++)){case"!":if(!c){if(E||k||C){T=!0;break}E=k=C=!0}l.offset=l.markedOffset=l.limit=h,y=!1;break;case"|":if(!c){if(E||C){T=!0;break}E=C=!0}l.offset=l.limit=h,y=!1;break;case"[":if(!c){if(E||k){T=!0;break}E=k=!0}l.offset=l.markedOffset=h,y=!1;break;case"<":if(!c){if(E){T=!0;break}E=!0}l.offset=h,y=!1;break;case"]":if(!c){if(C||k){T=!0;break}C=k=!0}l.limit=l.markedOffset=h,y=!1;break;case">":if(!c){if(C){T=!0;break}C=!0}l.limit=h,y=!1;break;case"'":if(!c){if(k){T=!0;break}k=!0}l.markedOffset=h,y=!1;break;case" ":y=!1;break;default:if(!c&&y){T=!0;break}if(w=parseInt(g+i.charAt(m++),16),!c&&(isNaN(w)||w<0||w>255))throw TypeError("Illegal str: Not a debug encoded string");l.view[h++]=w,y=!0}if(T)throw TypeError("Illegal str: Invalid symbol at "+m)}if(!c){if(!E||!C)throw TypeError("Illegal str: Missing offset or limit");if(h<l.buffer.byteLength)throw TypeError("Illegal str: Not a debug encoded string (is it hex?) "+h+" < "+f)}return l},n.toHex=function(i,o){if(i=typeof i>"u"?this.offset:i,o=typeof o>"u"?this.limit:o,!this.noAssert){if(typeof i!="number"||i%1!==0)throw TypeError("Illegal begin: Not an integer");if(i>>>=0,typeof o!="number"||o%1!==0)throw TypeError("Illegal end: Not an integer");if(o>>>=0,i<0||i>o||o>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+i+" <= "+o+" <= "+this.buffer.byteLength)}for(var c=new Array(o-i),f;i<o;)f=this.view[i++],f<16?c.push("0",f.toString(16)):c.push(f.toString(16));return c.join("")},r.fromHex=function(i,o,c){if(!c){if(typeof i!="string")throw TypeError("Illegal str: Not a string");if(i.length%2!==0)throw TypeError("Illegal str: Length not a multiple of 2")}for(var f=i.length,l=new r(f/2|0,o),m,h=0,g=0;h<f;h+=2){if(m=parseInt(i.substring(h,h+2),16),!c&&(!isFinite(m)||m<0||m>255))throw TypeError("Illegal str: Contains non-hex characters");l.view[g++]=m}return l.limit=g,l};var b=(function(){var i={};return i.MAX_CODEPOINT=1114111,i.encodeUTF8=function(o,c){var f=null;for(typeof o=="number"&&(f=o,o=function(){return null});f!==null||(f=o())!==null;)f<128?c(f&127):f<2048?(c(f>>6&31|192),c(f&63|128)):f<65536?(c(f>>12&15|224),c(f>>6&63|128),c(f&63|128)):(c(f>>18&7|240),c(f>>12&63|128),c(f>>6&63|128),c(f&63|128)),f=null},i.decodeUTF8=function(o,c){for(var f,l,m,h,g=function(w){w=w.slice(0,w.indexOf(null));var y=Error(w.toString());throw y.name="TruncatedError",y.bytes=w,y};(f=o())!==null;)if((f&128)===0)c(f);else if((f&224)===192)(l=o())===null&&g([f,l]),c((f&31)<<6|l&63);else if((f&240)===224)((l=o())===null||(m=o())===null)&&g([f,l,m]),c((f&15)<<12|(l&63)<<6|m&63);else if((f&248)===240)((l=o())===null||(m=o())===null||(h=o())===null)&&g([f,l,m,h]),c((f&7)<<18|(l&63)<<12|(m&63)<<6|h&63);else throw RangeError("Illegal starting byte: "+f)},i.UTF16toUTF8=function(o,c){for(var f,l=null;(f=l!==null?l:o())!==null;){if(f>=55296&&f<=57343&&(l=o())!==null&&l>=56320&&l<=57343){c((f-55296)*1024+l-56320+65536),l=null;continue}c(f)}l!==null&&c(l)},i.UTF8toUTF16=function(o,c){var f=null;for(typeof o=="number"&&(f=o,o=function(){return null});f!==null||(f=o())!==null;)f<=65535?c(f):(f-=65536,c((f>>10)+55296),c(f%1024+56320)),f=null},i.encodeUTF16toUTF8=function(o,c){i.UTF16toUTF8(o,function(f){i.encodeUTF8(f,c)})},i.decodeUTF8toUTF16=function(o,c){i.decodeUTF8(o,function(f){i.UTF8toUTF16(f,c)})},i.calculateCodePoint=function(o){return o<128?1:o<2048?2:o<65536?3:4},i.calculateUTF8=function(o){for(var c,f=0;(c=o())!==null;)f+=c<128?1:c<2048?2:c<65536?3:4;return f},i.calculateUTF16asUTF8=function(o){var c=0,f=0;return i.UTF16toUTF8(o,function(l){++c,f+=l<128?1:l<2048?2:l<65536?3:4}),[c,f]},i})();return n.toUTF8=function(i,o){if(typeof i>"u"&&(i=this.offset),typeof o>"u"&&(o=this.limit),!this.noAssert){if(typeof i!="number"||i%1!==0)throw TypeError("Illegal begin: Not an integer");if(i>>>=0,typeof o!="number"||o%1!==0)throw TypeError("Illegal end: Not an integer");if(o>>>=0,i<0||i>o||o>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+i+" <= "+o+" <= "+this.buffer.byteLength)}var c;try{b.decodeUTF8toUTF16((function(){return i<o?this.view[i++]:null}).bind(this),c=d())}catch{if(i!==o)throw RangeError("Illegal range: Truncated data, "+i+" != "+o)}return c()},r.fromUTF8=function(i,o,c){if(!c&&typeof i!="string")throw TypeError("Illegal str: Not a string");var f=new r(b.calculateUTF16asUTF8(u(i),!0)[1],o,c),l=0;return b.encodeUTF16toUTF8(u(i),function(m){f.view[l++]=m}),f.limit=l,f},r})})(Vr)),Vr.exports}var mc=pc();const Wr=Hs(mc);var it;(function(e){e[e.BUS_MESSAGE_TYPES_BEGIN=100]="BUS_MESSAGE_TYPES_BEGIN",e[e.Json=101]="Json",e[e.Buffer=102]="Buffer",e[e.BUS_MESSAGE_TYPES_END=103]="BUS_MESSAGE_TYPES_END"})(it||(it={}));const Wi=(e,t)=>new Wr().writeUint32(it.Json).writeIString(e).writeIString(JSON.stringify(t)).flip().toBuffer(),gc=(e,t)=>{const r=t instanceof ArrayBuffer||t instanceof SharedArrayBuffer?new Uint8Array(t):t;return new Wr().writeUint32(it.Buffer).writeIString(e).append(r).flip().toBuffer()},_c=e=>{if(e instanceof ArrayBuffer){const t=new Wr(e.byteLength);return new Uint8Array(e).forEach(r=>{t.writeUint8(r)}),t.flip(),Ji(t)}else{const t=new Wr(e.byteLength);return t.buffer=e,Ji(t)}},Ji=e=>{const t=e.readInt32();if(t<=it.BUS_MESSAGE_TYPES_BEGIN||t>=it.BUS_MESSAGE_TYPES_END)throw`unknown busMessageType ${t}: ${e}`;const r=e.readIString();let n;switch(t){case it.Json:n=JSON.parse(e.readIString());break;case it.Buffer:n=e.buffer.slice(e.offset);break}return{channel:r,busMessageType:t,contents:n}},vc=Object.freeze({status:"aborted"});function U(e,t,r){function n(d,p){if(d._zod||Object.defineProperty(d,"_zod",{value:{def:p,constr:u,traits:new Set},enumerable:!1}),d._zod.traits.has(e))return;d._zod.traits.add(e),t(d,p);const _=u.prototype,v=Object.keys(_);for(let b=0;b<v.length;b++){const i=v[b];i in d||(d[i]=_[i].bind(d))}}const s=(r==null?void 0:r.Parent)??Object;class a extends s{}Object.defineProperty(a,"name",{value:e});function u(d){var p;const _=r!=null&&r.Parent?new a:this;n(_,d),(p=_._zod).deferred??(p.deferred=[]);for(const v of _._zod.deferred)v();return _}return Object.defineProperty(u,"init",{value:n}),Object.defineProperty(u,Symbol.hasInstance,{value:d=>{var p,_;return r!=null&&r.Parent&&d instanceof r.Parent?!0:(_=(p=d==null?void 0:d._zod)==null?void 0:p.traits)==null?void 0:_.has(e)}}),Object.defineProperty(u,"name",{value:e}),u}class Rt extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class Ks extends Error{constructor(t){super(`Encountered unidirectional transform during encode: ${t}`),this.name="ZodEncodeError"}}const Gs={};function ot(e){return Gs}function yc(e){const t=Object.values(e).filter(n=>typeof n=="number");return Object.entries(e).filter(([n,s])=>t.indexOf(+n)===-1).map(([n,s])=>s)}function Vn(e,t){return typeof t=="bigint"?t.toString():t}function cn(e){return{get value(){{const t=e();return Object.defineProperty(this,"value",{value:t}),t}}}}function gi(e){return e==null}function _i(e){const t=e.startsWith("^")?1:0,r=e.endsWith("$")?e.length-1:e.length;return e.slice(t,r)}function wc(e,t){const r=(e.toString().split(".")[1]||"").length,n=t.toString();let s=(n.split(".")[1]||"").length;if(s===0&&/\d?e-\d?/.test(n)){const p=n.match(/\d?e-(\d?)/);p!=null&&p[1]&&(s=Number.parseInt(p[1]))}const a=r>s?r:s,u=Number.parseInt(e.toFixed(a).replace(".","")),d=Number.parseInt(t.toFixed(a).replace(".",""));return u%d/10**a}const Yi=Symbol("evaluating");function fe(e,t,r){let n;Object.defineProperty(e,t,{get(){if(n!==Yi)return n===void 0&&(n=Yi,n=r()),n},set(s){Object.defineProperty(e,t,{value:s})},configurable:!0})}function mt(e,t,r){Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!0,configurable:!0})}function gt(...e){const t={};for(const r of e){const n=Object.getOwnPropertyDescriptors(r);Object.assign(t,n)}return Object.defineProperties({},t)}function Qi(e){return JSON.stringify(e)}function bc(e){return e.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,"")}const Ws="captureStackTrace"in Error?Error.captureStackTrace:(...e)=>{};function Ht(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}const Ec=cn(()=>{var e;if(typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)!=null&&e.includes("Cloudflare")))return!1;try{const t=Function;return new t(""),!0}catch{return!1}});function Nt(e){if(Ht(e)===!1)return!1;const t=e.constructor;if(t===void 0||typeof t!="function")return!0;const r=t.prototype;return!(Ht(r)===!1||Object.prototype.hasOwnProperty.call(r,"isPrototypeOf")===!1)}function Js(e){return Nt(e)?{...e}:Array.isArray(e)?[...e]:e}const $c=new Set(["string","number","symbol"]);function Ot(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function at(e,t,r){const n=new e._zod.constr(t??e._zod.def);return(!t||r!=null&&r.parent)&&(n._zod.parent=e),n}function B(e){const t=e;if(!t)return{};if(typeof t=="string")return{error:()=>t};if((t==null?void 0:t.message)!==void 0){if((t==null?void 0:t.error)!==void 0)throw new Error("Cannot specify both `message` and `error` params");t.error=t.message}return delete t.message,typeof t.error=="string"?{...t,error:()=>t.error}:t}function Sc(e){return Object.keys(e).filter(t=>e[t]._zod.optin==="optional"&&e[t]._zod.optout==="optional")}const kc={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function Tc(e,t){const r=e._zod.def,n=gt(e._zod.def,{get shape(){const s={};for(const a in t){if(!(a in r.shape))throw new Error(`Unrecognized key: "${a}"`);t[a]&&(s[a]=r.shape[a])}return mt(this,"shape",s),s},checks:[]});return at(e,n)}function Ic(e,t){const r=e._zod.def,n=gt(e._zod.def,{get shape(){const s={...e._zod.def.shape};for(const a in t){if(!(a in r.shape))throw new Error(`Unrecognized key: "${a}"`);t[a]&&delete s[a]}return mt(this,"shape",s),s},checks:[]});return at(e,n)}function Rc(e,t){if(!Nt(t))throw new Error("Invalid input to extend: expected a plain object");const r=e._zod.def.checks;if(r&&r.length>0)throw new Error("Object schemas containing refinements cannot be extended. Use `.safeExtend()` instead.");const s=gt(e._zod.def,{get shape(){const a={...e._zod.def.shape,...t};return mt(this,"shape",a),a},checks:[]});return at(e,s)}function Pc(e,t){if(!Nt(t))throw new Error("Invalid input to safeExtend: expected a plain object");const r={...e._zod.def,get shape(){const n={...e._zod.def.shape,...t};return mt(this,"shape",n),n},checks:e._zod.def.checks};return at(e,r)}function Nc(e,t){const r=gt(e._zod.def,{get shape(){const n={...e._zod.def.shape,...t._zod.def.shape};return mt(this,"shape",n),n},get catchall(){return t._zod.def.catchall},checks:[]});return at(e,r)}function Oc(e,t,r){const n=gt(t._zod.def,{get shape(){const s=t._zod.def.shape,a={...s};if(r)for(const u in r){if(!(u in s))throw new Error(`Unrecognized key: "${u}"`);r[u]&&(a[u]=e?new e({type:"optional",innerType:s[u]}):s[u])}else for(const u in s)a[u]=e?new e({type:"optional",innerType:s[u]}):s[u];return mt(this,"shape",a),a},checks:[]});return at(t,n)}function Cc(e,t,r){const n=gt(t._zod.def,{get shape(){const s=t._zod.def.shape,a={...s};if(r)for(const u in r){if(!(u in a))throw new Error(`Unrecognized key: "${u}"`);r[u]&&(a[u]=new e({type:"nonoptional",innerType:s[u]}))}else for(const u in s)a[u]=new e({type:"nonoptional",innerType:s[u]});return mt(this,"shape",a),a},checks:[]});return at(t,n)}function St(e,t=0){var r;if(e.aborted===!0)return!0;for(let n=t;n<e.issues.length;n++)if(((r=e.issues[n])==null?void 0:r.continue)!==!0)return!0;return!1}function kt(e,t){return t.map(r=>{var n;return(n=r).path??(n.path=[]),r.path.unshift(e),r})}function Xt(e){return typeof e=="string"?e:e==null?void 0:e.message}function st(e,t,r){var s,a,u,d,p,_;const n={...e,path:e.path??[]};if(!e.message){const v=Xt((u=(a=(s=e.inst)==null?void 0:s._zod.def)==null?void 0:a.error)==null?void 0:u.call(a,e))??Xt((d=t==null?void 0:t.error)==null?void 0:d.call(t,e))??Xt((p=r.customError)==null?void 0:p.call(r,e))??Xt((_=r.localeError)==null?void 0:_.call(r,e))??"Invalid input";n.message=v}return delete n.inst,delete n.continue,t!=null&&t.reportInput||delete n.input,n}function vi(e){return Array.isArray(e)?"array":typeof e=="string"?"string":"unknown"}function Bt(...e){const[t,r,n]=e;return typeof t=="string"?{message:t,code:"custom",input:r,inst:n}:{...t}}const Ys=(e,t)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:t,enumerable:!1}),e.message=JSON.stringify(t,Vn,2),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})},Qs=U("$ZodError",Ys),Xs=U("$ZodError",Ys,{Parent:Error});function Ac(e,t=r=>r.message){const r={},n=[];for(const s of e.issues)s.path.length>0?(r[s.path[0]]=r[s.path[0]]||[],r[s.path[0]].push(t(s))):n.push(t(s));return{formErrors:n,fieldErrors:r}}function Fc(e,t=r=>r.message){const r={_errors:[]},n=s=>{for(const a of s.issues)if(a.code==="invalid_union"&&a.errors.length)a.errors.map(u=>n({issues:u}));else if(a.code==="invalid_key")n({issues:a.issues});else if(a.code==="invalid_element")n({issues:a.issues});else if(a.path.length===0)r._errors.push(t(a));else{let u=r,d=0;for(;d<a.path.length;){const p=a.path[d];d===a.path.length-1?(u[p]=u[p]||{_errors:[]},u[p]._errors.push(t(a))):u[p]=u[p]||{_errors:[]},u=u[p],d++}}};return n(e),r}const yi=e=>(t,r,n,s)=>{const a=n?Object.assign(n,{async:!1}):{async:!1},u=t._zod.run({value:r,issues:[]},a);if(u instanceof Promise)throw new Rt;if(u.issues.length){const d=new((s==null?void 0:s.Err)??e)(u.issues.map(p=>st(p,a,ot())));throw Ws(d,s==null?void 0:s.callee),d}return u.value},wi=e=>async(t,r,n,s)=>{const a=n?Object.assign(n,{async:!0}):{async:!0};let u=t._zod.run({value:r,issues:[]},a);if(u instanceof Promise&&(u=await u),u.issues.length){const d=new((s==null?void 0:s.Err)??e)(u.issues.map(p=>st(p,a,ot())));throw Ws(d,s==null?void 0:s.callee),d}return u.value},un=e=>(t,r,n)=>{const s=n?{...n,async:!1}:{async:!1},a=t._zod.run({value:r,issues:[]},s);if(a instanceof Promise)throw new Rt;return a.issues.length?{success:!1,error:new(e??Qs)(a.issues.map(u=>st(u,s,ot())))}:{success:!0,data:a.value}},ea=un(Xs),ln=e=>async(t,r,n)=>{const s=n?Object.assign(n,{async:!0}):{async:!0};let a=t._zod.run({value:r,issues:[]},s);return a instanceof Promise&&(a=await a),a.issues.length?{success:!1,error:new e(a.issues.map(u=>st(u,s,ot())))}:{success:!0,data:a.value}},zc=ln(Xs),Uc=e=>(t,r,n)=>{const s=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return yi(e)(t,r,s)},qc=e=>(t,r,n)=>yi(e)(t,r,n),jc=e=>async(t,r,n)=>{const s=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return wi(e)(t,r,s)},Mc=e=>async(t,r,n)=>wi(e)(t,r,n),xc=e=>(t,r,n)=>{const s=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return un(e)(t,r,s)},Lc=e=>(t,r,n)=>un(e)(t,r,n),Dc=e=>async(t,r,n)=>{const s=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return ln(e)(t,r,s)},Zc=e=>async(t,r,n)=>ln(e)(t,r,n),Vc=/^[cC][^\s-]{8,}$/,Hc=/^[0-9a-z]+$/,Bc=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,Kc=/^[0-9a-vA-V]{20}$/,Gc=/^[A-Za-z0-9]{27}$/,Wc=/^[a-zA-Z0-9_-]{21}$/,Jc=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,Yc=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,Xi=e=>e?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${e}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,Qc=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,Xc="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function eu(){return new RegExp(Xc,"u")}const tu=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ru=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,nu=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,iu=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,ou=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,ta=/^[A-Za-z0-9_-]*$/,su=/^\+(?:[0-9]){6,14}[0-9]$/,ra="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",au=new RegExp(`^${ra}$`);function na(e){const t="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof e.precision=="number"?e.precision===-1?`${t}`:e.precision===0?`${t}:[0-5]\\d`:`${t}:[0-5]\\d\\.\\d{${e.precision}}`:`${t}(?::[0-5]\\d(?:\\.\\d+)?)?`}function cu(e){return new RegExp(`^${na(e)}$`)}function uu(e){const t=na({precision:e.precision}),r=["Z"];e.local&&r.push(""),e.offset&&r.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");const n=`${t}(?:${r.join("|")})`;return new RegExp(`^${ra}T(?:${n})$`)}const lu=e=>{const t=e?`[\\s\\S]{${(e==null?void 0:e.minimum)??0},${(e==null?void 0:e.maximum)??""}}`:"[\\s\\S]*";return new RegExp(`^${t}$`)},du=/^-?\d+$/,hu=/^-?\d+(?:\.\d+)?/,fu=/^(?:true|false)$/i,pu=/^null$/i,mu=/^[^A-Z]*$/,gu=/^[^a-z]*$/,Me=U("$ZodCheck",(e,t)=>{var r;e._zod??(e._zod={}),e._zod.def=t,(r=e._zod).onattach??(r.onattach=[])}),ia={number:"number",bigint:"bigint",object:"date"},oa=U("$ZodCheckLessThan",(e,t)=>{Me.init(e,t);const r=ia[typeof t.value];e._zod.onattach.push(n=>{const s=n._zod.bag,a=(t.inclusive?s.maximum:s.exclusiveMaximum)??Number.POSITIVE_INFINITY;t.value<a&&(t.inclusive?s.maximum=t.value:s.exclusiveMaximum=t.value)}),e._zod.check=n=>{(t.inclusive?n.value<=t.value:n.value<t.value)||n.issues.push({origin:r,code:"too_big",maximum:t.value,input:n.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),sa=U("$ZodCheckGreaterThan",(e,t)=>{Me.init(e,t);const r=ia[typeof t.value];e._zod.onattach.push(n=>{const s=n._zod.bag,a=(t.inclusive?s.minimum:s.exclusiveMinimum)??Number.NEGATIVE_INFINITY;t.value>a&&(t.inclusive?s.minimum=t.value:s.exclusiveMinimum=t.value)}),e._zod.check=n=>{(t.inclusive?n.value>=t.value:n.value>t.value)||n.issues.push({origin:r,code:"too_small",minimum:t.value,input:n.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),_u=U("$ZodCheckMultipleOf",(e,t)=>{Me.init(e,t),e._zod.onattach.push(r=>{var n;(n=r._zod.bag).multipleOf??(n.multipleOf=t.value)}),e._zod.check=r=>{if(typeof r.value!=typeof t.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof r.value=="bigint"?r.value%t.value===BigInt(0):wc(r.value,t.value)===0)||r.issues.push({origin:typeof r.value,code:"not_multiple_of",divisor:t.value,input:r.value,inst:e,continue:!t.abort})}}),vu=U("$ZodCheckNumberFormat",(e,t)=>{var u;Me.init(e,t),t.format=t.format||"float64";const r=(u=t.format)==null?void 0:u.includes("int"),n=r?"int":"number",[s,a]=kc[t.format];e._zod.onattach.push(d=>{const p=d._zod.bag;p.format=t.format,p.minimum=s,p.maximum=a,r&&(p.pattern=du)}),e._zod.check=d=>{const p=d.value;if(r){if(!Number.isInteger(p)){d.issues.push({expected:n,format:t.format,code:"invalid_type",continue:!1,input:p,inst:e});return}if(!Number.isSafeInteger(p)){p>0?d.issues.push({input:p,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:n,continue:!t.abort}):d.issues.push({input:p,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:n,continue:!t.abort});return}}p<s&&d.issues.push({origin:"number",input:p,code:"too_small",minimum:s,inclusive:!0,inst:e,continue:!t.abort}),p>a&&d.issues.push({origin:"number",input:p,code:"too_big",maximum:a,inst:e})}}),yu=U("$ZodCheckMaxLength",(e,t)=>{var r;Me.init(e,t),(r=e._zod.def).when??(r.when=n=>{const s=n.value;return!gi(s)&&s.length!==void 0}),e._zod.onattach.push(n=>{const s=n._zod.bag.maximum??Number.POSITIVE_INFINITY;t.maximum<s&&(n._zod.bag.maximum=t.maximum)}),e._zod.check=n=>{const s=n.value;if(s.length<=t.maximum)return;const u=vi(s);n.issues.push({origin:u,code:"too_big",maximum:t.maximum,inclusive:!0,input:s,inst:e,continue:!t.abort})}}),wu=U("$ZodCheckMinLength",(e,t)=>{var r;Me.init(e,t),(r=e._zod.def).when??(r.when=n=>{const s=n.value;return!gi(s)&&s.length!==void 0}),e._zod.onattach.push(n=>{const s=n._zod.bag.minimum??Number.NEGATIVE_INFINITY;t.minimum>s&&(n._zod.bag.minimum=t.minimum)}),e._zod.check=n=>{const s=n.value;if(s.length>=t.minimum)return;const u=vi(s);n.issues.push({origin:u,code:"too_small",minimum:t.minimum,inclusive:!0,input:s,inst:e,continue:!t.abort})}}),bu=U("$ZodCheckLengthEquals",(e,t)=>{var r;Me.init(e,t),(r=e._zod.def).when??(r.when=n=>{const s=n.value;return!gi(s)&&s.length!==void 0}),e._zod.onattach.push(n=>{const s=n._zod.bag;s.minimum=t.length,s.maximum=t.length,s.length=t.length}),e._zod.check=n=>{const s=n.value,a=s.length;if(a===t.length)return;const u=vi(s),d=a>t.length;n.issues.push({origin:u,...d?{code:"too_big",maximum:t.length}:{code:"too_small",minimum:t.length},inclusive:!0,exact:!0,input:n.value,inst:e,continue:!t.abort})}}),dn=U("$ZodCheckStringFormat",(e,t)=>{var r,n;Me.init(e,t),e._zod.onattach.push(s=>{const a=s._zod.bag;a.format=t.format,t.pattern&&(a.patterns??(a.patterns=new Set),a.patterns.add(t.pattern))}),t.pattern?(r=e._zod).check??(r.check=s=>{t.pattern.lastIndex=0,!t.pattern.test(s.value)&&s.issues.push({origin:"string",code:"invalid_format",format:t.format,input:s.value,...t.pattern?{pattern:t.pattern.toString()}:{},inst:e,continue:!t.abort})}):(n=e._zod).check??(n.check=()=>{})}),Eu=U("$ZodCheckRegex",(e,t)=>{dn.init(e,t),e._zod.check=r=>{t.pattern.lastIndex=0,!t.pattern.test(r.value)&&r.issues.push({origin:"string",code:"invalid_format",format:"regex",input:r.value,pattern:t.pattern.toString(),inst:e,continue:!t.abort})}}),$u=U("$ZodCheckLowerCase",(e,t)=>{t.pattern??(t.pattern=mu),dn.init(e,t)}),Su=U("$ZodCheckUpperCase",(e,t)=>{t.pattern??(t.pattern=gu),dn.init(e,t)}),ku=U("$ZodCheckIncludes",(e,t)=>{Me.init(e,t);const r=Ot(t.includes),n=new RegExp(typeof t.position=="number"?`^.{${t.position}}${r}`:r);t.pattern=n,e._zod.onattach.push(s=>{const a=s._zod.bag;a.patterns??(a.patterns=new Set),a.patterns.add(n)}),e._zod.check=s=>{s.value.includes(t.includes,t.position)||s.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:t.includes,input:s.value,inst:e,continue:!t.abort})}}),Tu=U("$ZodCheckStartsWith",(e,t)=>{Me.init(e,t);const r=new RegExp(`^${Ot(t.prefix)}.*`);t.pattern??(t.pattern=r),e._zod.onattach.push(n=>{const s=n._zod.bag;s.patterns??(s.patterns=new Set),s.patterns.add(r)}),e._zod.check=n=>{n.value.startsWith(t.prefix)||n.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:t.prefix,input:n.value,inst:e,continue:!t.abort})}}),Iu=U("$ZodCheckEndsWith",(e,t)=>{Me.init(e,t);const r=new RegExp(`.*${Ot(t.suffix)}$`);t.pattern??(t.pattern=r),e._zod.onattach.push(n=>{const s=n._zod.bag;s.patterns??(s.patterns=new Set),s.patterns.add(r)}),e._zod.check=n=>{n.value.endsWith(t.suffix)||n.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:t.suffix,input:n.value,inst:e,continue:!t.abort})}}),Ru=U("$ZodCheckOverwrite",(e,t)=>{Me.init(e,t),e._zod.check=r=>{r.value=t.tx(r.value)}});class Pu{constructor(t=[]){this.content=[],this.indent=0,this&&(this.args=t)}indented(t){this.indent+=1,t(this),this.indent-=1}write(t){if(typeof t=="function"){t(this,{execution:"sync"}),t(this,{execution:"async"});return}const n=t.split(`
`).filter(u=>u),s=Math.min(...n.map(u=>u.length-u.trimStart().length)),a=n.map(u=>u.slice(s)).map(u=>" ".repeat(this.indent*2)+u);for(const u of a)this.content.push(u)}compile(){const t=Function,r=this==null?void 0:this.args,s=[...((this==null?void 0:this.content)??[""]).map(a=>`  ${a}`)];return new t(...r,s.join(`
`))}}const Nu={major:4,minor:1,patch:13},me=U("$ZodType",(e,t)=>{var s;var r;e??(e={}),e._zod.def=t,e._zod.bag=e._zod.bag||{},e._zod.version=Nu;const n=[...e._zod.def.checks??[]];e._zod.traits.has("$ZodCheck")&&n.unshift(e);for(const a of n)for(const u of a._zod.onattach)u(e);if(n.length===0)(r=e._zod).deferred??(r.deferred=[]),(s=e._zod.deferred)==null||s.push(()=>{e._zod.run=e._zod.parse});else{const a=(d,p,_)=>{let v=St(d),b;for(const i of p){if(i._zod.def.when){if(!i._zod.def.when(d))continue}else if(v)continue;const o=d.issues.length,c=i._zod.check(d);if(c instanceof Promise&&(_==null?void 0:_.async)===!1)throw new Rt;if(b||c instanceof Promise)b=(b??Promise.resolve()).then(async()=>{await c,d.issues.length!==o&&(v||(v=St(d,o)))});else{if(d.issues.length===o)continue;v||(v=St(d,o))}}return b?b.then(()=>d):d},u=(d,p,_)=>{if(St(d))return d.aborted=!0,d;const v=a(p,n,_);if(v instanceof Promise){if(_.async===!1)throw new Rt;return v.then(b=>e._zod.parse(b,_))}return e._zod.parse(v,_)};e._zod.run=(d,p)=>{if(p.skipChecks)return e._zod.parse(d,p);if(p.direction==="backward"){const v=e._zod.parse({value:d.value,issues:[]},{...p,skipChecks:!0});return v instanceof Promise?v.then(b=>u(b,d,p)):u(v,d,p)}const _=e._zod.parse(d,p);if(_ instanceof Promise){if(p.async===!1)throw new Rt;return _.then(v=>a(v,n,p))}return a(_,n,p)}}e["~standard"]={validate:a=>{var u;try{const d=ea(e,a);return d.success?{value:d.data}:{issues:(u=d.error)==null?void 0:u.issues}}catch{return zc(e,a).then(p=>{var _;return p.success?{value:p.data}:{issues:(_=p.error)==null?void 0:_.issues}})}},vendor:"zod",version:1}}),bi=U("$ZodString",(e,t)=>{var r;me.init(e,t),e._zod.pattern=[...((r=e==null?void 0:e._zod.bag)==null?void 0:r.patterns)??[]].pop()??lu(e._zod.bag),e._zod.parse=(n,s)=>{if(t.coerce)try{n.value=String(n.value)}catch{}return typeof n.value=="string"||n.issues.push({expected:"string",code:"invalid_type",input:n.value,inst:e}),n}}),ve=U("$ZodStringFormat",(e,t)=>{dn.init(e,t),bi.init(e,t)}),Ou=U("$ZodGUID",(e,t)=>{t.pattern??(t.pattern=Yc),ve.init(e,t)}),Cu=U("$ZodUUID",(e,t)=>{if(t.version){const n={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[t.version];if(n===void 0)throw new Error(`Invalid UUID version: "${t.version}"`);t.pattern??(t.pattern=Xi(n))}else t.pattern??(t.pattern=Xi());ve.init(e,t)}),Au=U("$ZodEmail",(e,t)=>{t.pattern??(t.pattern=Qc),ve.init(e,t)}),Fu=U("$ZodURL",(e,t)=>{ve.init(e,t),e._zod.check=r=>{try{const n=r.value.trim(),s=new URL(n);t.hostname&&(t.hostname.lastIndex=0,t.hostname.test(s.hostname)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:t.hostname.source,input:r.value,inst:e,continue:!t.abort})),t.protocol&&(t.protocol.lastIndex=0,t.protocol.test(s.protocol.endsWith(":")?s.protocol.slice(0,-1):s.protocol)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:t.protocol.source,input:r.value,inst:e,continue:!t.abort})),t.normalize?r.value=s.href:r.value=n;return}catch{r.issues.push({code:"invalid_format",format:"url",input:r.value,inst:e,continue:!t.abort})}}}),zu=U("$ZodEmoji",(e,t)=>{t.pattern??(t.pattern=eu()),ve.init(e,t)}),Uu=U("$ZodNanoID",(e,t)=>{t.pattern??(t.pattern=Wc),ve.init(e,t)}),qu=U("$ZodCUID",(e,t)=>{t.pattern??(t.pattern=Vc),ve.init(e,t)}),ju=U("$ZodCUID2",(e,t)=>{t.pattern??(t.pattern=Hc),ve.init(e,t)}),Mu=U("$ZodULID",(e,t)=>{t.pattern??(t.pattern=Bc),ve.init(e,t)}),xu=U("$ZodXID",(e,t)=>{t.pattern??(t.pattern=Kc),ve.init(e,t)}),Lu=U("$ZodKSUID",(e,t)=>{t.pattern??(t.pattern=Gc),ve.init(e,t)}),Du=U("$ZodISODateTime",(e,t)=>{t.pattern??(t.pattern=uu(t)),ve.init(e,t)}),Zu=U("$ZodISODate",(e,t)=>{t.pattern??(t.pattern=au),ve.init(e,t)}),Vu=U("$ZodISOTime",(e,t)=>{t.pattern??(t.pattern=cu(t)),ve.init(e,t)}),Hu=U("$ZodISODuration",(e,t)=>{t.pattern??(t.pattern=Jc),ve.init(e,t)}),Bu=U("$ZodIPv4",(e,t)=>{t.pattern??(t.pattern=tu),ve.init(e,t),e._zod.bag.format="ipv4"}),Ku=U("$ZodIPv6",(e,t)=>{t.pattern??(t.pattern=ru),ve.init(e,t),e._zod.bag.format="ipv6",e._zod.check=r=>{try{new URL(`http://[${r.value}]`)}catch{r.issues.push({code:"invalid_format",format:"ipv6",input:r.value,inst:e,continue:!t.abort})}}}),Gu=U("$ZodCIDRv4",(e,t)=>{t.pattern??(t.pattern=nu),ve.init(e,t)}),Wu=U("$ZodCIDRv6",(e,t)=>{t.pattern??(t.pattern=iu),ve.init(e,t),e._zod.check=r=>{const n=r.value.split("/");try{if(n.length!==2)throw new Error;const[s,a]=n;if(!a)throw new Error;const u=Number(a);if(`${u}`!==a)throw new Error;if(u<0||u>128)throw new Error;new URL(`http://[${s}]`)}catch{r.issues.push({code:"invalid_format",format:"cidrv6",input:r.value,inst:e,continue:!t.abort})}}});function aa(e){if(e==="")return!0;if(e.length%4!==0)return!1;try{return atob(e),!0}catch{return!1}}const Ju=U("$ZodBase64",(e,t)=>{t.pattern??(t.pattern=ou),ve.init(e,t),e._zod.bag.contentEncoding="base64",e._zod.check=r=>{aa(r.value)||r.issues.push({code:"invalid_format",format:"base64",input:r.value,inst:e,continue:!t.abort})}});function Yu(e){if(!ta.test(e))return!1;const t=e.replace(/[-_]/g,n=>n==="-"?"+":"/"),r=t.padEnd(Math.ceil(t.length/4)*4,"=");return aa(r)}const Qu=U("$ZodBase64URL",(e,t)=>{t.pattern??(t.pattern=ta),ve.init(e,t),e._zod.bag.contentEncoding="base64url",e._zod.check=r=>{Yu(r.value)||r.issues.push({code:"invalid_format",format:"base64url",input:r.value,inst:e,continue:!t.abort})}}),Xu=U("$ZodE164",(e,t)=>{t.pattern??(t.pattern=su),ve.init(e,t)});function el(e,t=null){try{const r=e.split(".");if(r.length!==3)return!1;const[n]=r;if(!n)return!1;const s=JSON.parse(atob(n));return!("typ"in s&&(s==null?void 0:s.typ)!=="JWT"||!s.alg||t&&(!("alg"in s)||s.alg!==t))}catch{return!1}}const tl=U("$ZodJWT",(e,t)=>{ve.init(e,t),e._zod.check=r=>{el(r.value,t.alg)||r.issues.push({code:"invalid_format",format:"jwt",input:r.value,inst:e,continue:!t.abort})}}),ca=U("$ZodNumber",(e,t)=>{me.init(e,t),e._zod.pattern=e._zod.bag.pattern??hu,e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=Number(r.value)}catch{}const s=r.value;if(typeof s=="number"&&!Number.isNaN(s)&&Number.isFinite(s))return r;const a=typeof s=="number"?Number.isNaN(s)?"NaN":Number.isFinite(s)?void 0:"Infinity":void 0;return r.issues.push({expected:"number",code:"invalid_type",input:s,inst:e,...a?{received:a}:{}}),r}}),rl=U("$ZodNumberFormat",(e,t)=>{vu.init(e,t),ca.init(e,t)}),nl=U("$ZodBoolean",(e,t)=>{me.init(e,t),e._zod.pattern=fu,e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=!!r.value}catch{}const s=r.value;return typeof s=="boolean"||r.issues.push({expected:"boolean",code:"invalid_type",input:s,inst:e}),r}}),il=U("$ZodNull",(e,t)=>{me.init(e,t),e._zod.pattern=pu,e._zod.values=new Set([null]),e._zod.parse=(r,n)=>{const s=r.value;return s===null||r.issues.push({expected:"null",code:"invalid_type",input:s,inst:e}),r}}),ol=U("$ZodAny",(e,t)=>{me.init(e,t),e._zod.parse=r=>r}),sl=U("$ZodUnknown",(e,t)=>{me.init(e,t),e._zod.parse=r=>r}),al=U("$ZodNever",(e,t)=>{me.init(e,t),e._zod.parse=(r,n)=>(r.issues.push({expected:"never",code:"invalid_type",input:r.value,inst:e}),r)});function eo(e,t,r){e.issues.length&&t.issues.push(...kt(r,e.issues)),t.value[r]=e.value}const cl=U("$ZodArray",(e,t)=>{me.init(e,t),e._zod.parse=(r,n)=>{const s=r.value;if(!Array.isArray(s))return r.issues.push({expected:"array",code:"invalid_type",input:s,inst:e}),r;r.value=Array(s.length);const a=[];for(let u=0;u<s.length;u++){const d=s[u],p=t.element._zod.run({value:d,issues:[]},n);p instanceof Promise?a.push(p.then(_=>eo(_,r,u))):eo(p,r,u)}return a.length?Promise.all(a).then(()=>r):r}});function Jr(e,t,r,n){e.issues.length&&t.issues.push(...kt(r,e.issues)),e.value===void 0?r in n&&(t.value[r]=void 0):t.value[r]=e.value}function ua(e){var n,s,a,u;const t=Object.keys(e.shape);for(const d of t)if(!((u=(a=(s=(n=e.shape)==null?void 0:n[d])==null?void 0:s._zod)==null?void 0:a.traits)!=null&&u.has("$ZodType")))throw new Error(`Invalid element at key "${d}": expected a Zod schema`);const r=Sc(e.shape);return{...e,keys:t,keySet:new Set(t),numKeys:t.length,optionalKeys:new Set(r)}}function la(e,t,r,n,s,a){const u=[],d=s.keySet,p=s.catchall._zod,_=p.def.type;for(const v in t){if(d.has(v))continue;if(_==="never"){u.push(v);continue}const b=p.run({value:t[v],issues:[]},n);b instanceof Promise?e.push(b.then(i=>Jr(i,r,v,t))):Jr(b,r,v,t)}return u.length&&r.issues.push({code:"unrecognized_keys",keys:u,input:t,inst:a}),e.length?Promise.all(e).then(()=>r):r}const ul=U("$ZodObject",(e,t)=>{me.init(e,t);const r=Object.getOwnPropertyDescriptor(t,"shape");if(!(r!=null&&r.get)){const d=t.shape;Object.defineProperty(t,"shape",{get:()=>{const p={...d};return Object.defineProperty(t,"shape",{value:p}),p}})}const n=cn(()=>ua(t));fe(e._zod,"propValues",()=>{const d=t.shape,p={};for(const _ in d){const v=d[_]._zod;if(v.values){p[_]??(p[_]=new Set);for(const b of v.values)p[_].add(b)}}return p});const s=Ht,a=t.catchall;let u;e._zod.parse=(d,p)=>{u??(u=n.value);const _=d.value;if(!s(_))return d.issues.push({expected:"object",code:"invalid_type",input:_,inst:e}),d;d.value={};const v=[],b=u.shape;for(const i of u.keys){const c=b[i]._zod.run({value:_[i],issues:[]},p);c instanceof Promise?v.push(c.then(f=>Jr(f,d,i,_))):Jr(c,d,i,_)}return a?la(v,_,d,p,n.value,e):v.length?Promise.all(v).then(()=>d):d}}),ll=U("$ZodObjectJIT",(e,t)=>{ul.init(e,t);const r=e._zod.parse,n=cn(()=>ua(t)),s=i=>{const o=new Pu(["shape","payload","ctx"]),c=n.value,f=g=>{const w=Qi(g);return`shape[${w}]._zod.run({ value: input[${w}], issues: [] }, ctx)`};o.write("const input = payload.value;");const l=Object.create(null);let m=0;for(const g of c.keys)l[g]=`key_${m++}`;o.write("const newResult = {};");for(const g of c.keys){const w=l[g],y=Qi(g);o.write(`const ${w} = ${f(g)};`),o.write(`
        if (${w}.issues.length) {
          payload.issues = payload.issues.concat(${w}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${y}, ...iss.path] : [${y}]
          })));
        }
        
        
        if (${w}.value === undefined) {
          if (${y} in input) {
            newResult[${y}] = undefined;
          }
        } else {
          newResult[${y}] = ${w}.value;
        }
        
      `)}o.write("payload.value = newResult;"),o.write("return payload;");const h=o.compile();return(g,w)=>h(i,g,w)};let a;const u=Ht,d=!Gs.jitless,_=d&&Ec.value,v=t.catchall;let b;e._zod.parse=(i,o)=>{b??(b=n.value);const c=i.value;return u(c)?d&&_&&(o==null?void 0:o.async)===!1&&o.jitless!==!0?(a||(a=s(t.shape)),i=a(i,o),v?la([],c,i,o,b,e):i):r(i,o):(i.issues.push({expected:"object",code:"invalid_type",input:c,inst:e}),i)}});function to(e,t,r,n){for(const a of e)if(a.issues.length===0)return t.value=a.value,t;const s=e.filter(a=>!St(a));return s.length===1?(t.value=s[0].value,s[0]):(t.issues.push({code:"invalid_union",input:t.value,inst:r,errors:e.map(a=>a.issues.map(u=>st(u,n,ot())))}),t)}const da=U("$ZodUnion",(e,t)=>{me.init(e,t),fe(e._zod,"optin",()=>t.options.some(s=>s._zod.optin==="optional")?"optional":void 0),fe(e._zod,"optout",()=>t.options.some(s=>s._zod.optout==="optional")?"optional":void 0),fe(e._zod,"values",()=>{if(t.options.every(s=>s._zod.values))return new Set(t.options.flatMap(s=>Array.from(s._zod.values)))}),fe(e._zod,"pattern",()=>{if(t.options.every(s=>s._zod.pattern)){const s=t.options.map(a=>a._zod.pattern);return new RegExp(`^(${s.map(a=>_i(a.source)).join("|")})$`)}});const r=t.options.length===1,n=t.options[0]._zod.run;e._zod.parse=(s,a)=>{if(r)return n(s,a);let u=!1;const d=[];for(const p of t.options){const _=p._zod.run({value:s.value,issues:[]},a);if(_ instanceof Promise)d.push(_),u=!0;else{if(_.issues.length===0)return _;d.push(_)}}return u?Promise.all(d).then(p=>to(p,s,e,a)):to(d,s,e,a)}}),dl=U("$ZodDiscriminatedUnion",(e,t)=>{da.init(e,t);const r=e._zod.parse;fe(e._zod,"propValues",()=>{const s={};for(const a of t.options){const u=a._zod.propValues;if(!u||Object.keys(u).length===0)throw new Error(`Invalid discriminated union option at index "${t.options.indexOf(a)}"`);for(const[d,p]of Object.entries(u)){s[d]||(s[d]=new Set);for(const _ of p)s[d].add(_)}}return s});const n=cn(()=>{var u;const s=t.options,a=new Map;for(const d of s){const p=(u=d._zod.propValues)==null?void 0:u[t.discriminator];if(!p||p.size===0)throw new Error(`Invalid discriminated union option at index "${t.options.indexOf(d)}"`);for(const _ of p){if(a.has(_))throw new Error(`Duplicate discriminator value "${String(_)}"`);a.set(_,d)}}return a});e._zod.parse=(s,a)=>{const u=s.value;if(!Ht(u))return s.issues.push({code:"invalid_type",expected:"object",input:u,inst:e}),s;const d=n.value.get(u==null?void 0:u[t.discriminator]);return d?d._zod.run(s,a):t.unionFallback?r(s,a):(s.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",discriminator:t.discriminator,input:u,path:[t.discriminator],inst:e}),s)}}),hl=U("$ZodIntersection",(e,t)=>{me.init(e,t),e._zod.parse=(r,n)=>{const s=r.value,a=t.left._zod.run({value:s,issues:[]},n),u=t.right._zod.run({value:s,issues:[]},n);return a instanceof Promise||u instanceof Promise?Promise.all([a,u]).then(([p,_])=>ro(r,p,_)):ro(r,a,u)}});function Hn(e,t){if(e===t)return{valid:!0,data:e};if(e instanceof Date&&t instanceof Date&&+e==+t)return{valid:!0,data:e};if(Nt(e)&&Nt(t)){const r=Object.keys(t),n=Object.keys(e).filter(a=>r.indexOf(a)!==-1),s={...e,...t};for(const a of n){const u=Hn(e[a],t[a]);if(!u.valid)return{valid:!1,mergeErrorPath:[a,...u.mergeErrorPath]};s[a]=u.data}return{valid:!0,data:s}}if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return{valid:!1,mergeErrorPath:[]};const r=[];for(let n=0;n<e.length;n++){const s=e[n],a=t[n],u=Hn(s,a);if(!u.valid)return{valid:!1,mergeErrorPath:[n,...u.mergeErrorPath]};r.push(u.data)}return{valid:!0,data:r}}return{valid:!1,mergeErrorPath:[]}}function ro(e,t,r){if(t.issues.length&&e.issues.push(...t.issues),r.issues.length&&e.issues.push(...r.issues),St(e))return e;const n=Hn(t.value,r.value);if(!n.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(n.mergeErrorPath)}`);return e.value=n.data,e}const fl=U("$ZodRecord",(e,t)=>{me.init(e,t),e._zod.parse=(r,n)=>{const s=r.value;if(!Nt(s))return r.issues.push({expected:"record",code:"invalid_type",input:s,inst:e}),r;const a=[],u=t.keyType._zod.values;if(u){r.value={};const d=new Set;for(const _ of u)if(typeof _=="string"||typeof _=="number"||typeof _=="symbol"){d.add(typeof _=="number"?_.toString():_);const v=t.valueType._zod.run({value:s[_],issues:[]},n);v instanceof Promise?a.push(v.then(b=>{b.issues.length&&r.issues.push(...kt(_,b.issues)),r.value[_]=b.value})):(v.issues.length&&r.issues.push(...kt(_,v.issues)),r.value[_]=v.value)}let p;for(const _ in s)d.has(_)||(p=p??[],p.push(_));p&&p.length>0&&r.issues.push({code:"unrecognized_keys",input:s,inst:e,keys:p})}else{r.value={};for(const d of Reflect.ownKeys(s)){if(d==="__proto__")continue;const p=t.keyType._zod.run({value:d,issues:[]},n);if(p instanceof Promise)throw new Error("Async schemas not supported in object keys currently");if(p.issues.length){r.issues.push({code:"invalid_key",origin:"record",issues:p.issues.map(v=>st(v,n,ot())),input:d,path:[d],inst:e}),r.value[p.value]=p.value;continue}const _=t.valueType._zod.run({value:s[d],issues:[]},n);_ instanceof Promise?a.push(_.then(v=>{v.issues.length&&r.issues.push(...kt(d,v.issues)),r.value[p.value]=v.value})):(_.issues.length&&r.issues.push(...kt(d,_.issues)),r.value[p.value]=_.value)}}return a.length?Promise.all(a).then(()=>r):r}}),pl=U("$ZodEnum",(e,t)=>{me.init(e,t);const r=yc(t.entries),n=new Set(r);e._zod.values=n,e._zod.pattern=new RegExp(`^(${r.filter(s=>$c.has(typeof s)).map(s=>typeof s=="string"?Ot(s):s.toString()).join("|")})$`),e._zod.parse=(s,a)=>{const u=s.value;return n.has(u)||s.issues.push({code:"invalid_value",values:r,input:u,inst:e}),s}}),ml=U("$ZodLiteral",(e,t)=>{if(me.init(e,t),t.values.length===0)throw new Error("Cannot create literal schema with no valid values");const r=new Set(t.values);e._zod.values=r,e._zod.pattern=new RegExp(`^(${t.values.map(n=>typeof n=="string"?Ot(n):n?Ot(n.toString()):String(n)).join("|")})$`),e._zod.parse=(n,s)=>{const a=n.value;return r.has(a)||n.issues.push({code:"invalid_value",values:t.values,input:a,inst:e}),n}}),gl=U("$ZodTransform",(e,t)=>{me.init(e,t),e._zod.parse=(r,n)=>{if(n.direction==="backward")throw new Ks(e.constructor.name);const s=t.transform(r.value,r);if(n.async)return(s instanceof Promise?s:Promise.resolve(s)).then(u=>(r.value=u,r));if(s instanceof Promise)throw new Rt;return r.value=s,r}});function no(e,t){return e.issues.length&&t===void 0?{issues:[],value:void 0}:e}const _l=U("$ZodOptional",(e,t)=>{me.init(e,t),e._zod.optin="optional",e._zod.optout="optional",fe(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,void 0]):void 0),fe(e._zod,"pattern",()=>{const r=t.innerType._zod.pattern;return r?new RegExp(`^(${_i(r.source)})?$`):void 0}),e._zod.parse=(r,n)=>{if(t.innerType._zod.optin==="optional"){const s=t.innerType._zod.run(r,n);return s instanceof Promise?s.then(a=>no(a,r.value)):no(s,r.value)}return r.value===void 0?r:t.innerType._zod.run(r,n)}}),vl=U("$ZodNullable",(e,t)=>{me.init(e,t),fe(e._zod,"optin",()=>t.innerType._zod.optin),fe(e._zod,"optout",()=>t.innerType._zod.optout),fe(e._zod,"pattern",()=>{const r=t.innerType._zod.pattern;return r?new RegExp(`^(${_i(r.source)}|null)$`):void 0}),fe(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,null]):void 0),e._zod.parse=(r,n)=>r.value===null?r:t.innerType._zod.run(r,n)}),yl=U("$ZodDefault",(e,t)=>{me.init(e,t),e._zod.optin="optional",fe(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(r,n)=>{if(n.direction==="backward")return t.innerType._zod.run(r,n);if(r.value===void 0)return r.value=t.defaultValue,r;const s=t.innerType._zod.run(r,n);return s instanceof Promise?s.then(a=>io(a,t)):io(s,t)}});function io(e,t){return e.value===void 0&&(e.value=t.defaultValue),e}const wl=U("$ZodPrefault",(e,t)=>{me.init(e,t),e._zod.optin="optional",fe(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(r,n)=>(n.direction==="backward"||r.value===void 0&&(r.value=t.defaultValue),t.innerType._zod.run(r,n))}),bl=U("$ZodNonOptional",(e,t)=>{me.init(e,t),fe(e._zod,"values",()=>{const r=t.innerType._zod.values;return r?new Set([...r].filter(n=>n!==void 0)):void 0}),e._zod.parse=(r,n)=>{const s=t.innerType._zod.run(r,n);return s instanceof Promise?s.then(a=>oo(a,e)):oo(s,e)}});function oo(e,t){return!e.issues.length&&e.value===void 0&&e.issues.push({code:"invalid_type",expected:"nonoptional",input:e.value,inst:t}),e}const El=U("$ZodCatch",(e,t)=>{me.init(e,t),fe(e._zod,"optin",()=>t.innerType._zod.optin),fe(e._zod,"optout",()=>t.innerType._zod.optout),fe(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(r,n)=>{if(n.direction==="backward")return t.innerType._zod.run(r,n);const s=t.innerType._zod.run(r,n);return s instanceof Promise?s.then(a=>(r.value=a.value,a.issues.length&&(r.value=t.catchValue({...r,error:{issues:a.issues.map(u=>st(u,n,ot()))},input:r.value}),r.issues=[]),r)):(r.value=s.value,s.issues.length&&(r.value=t.catchValue({...r,error:{issues:s.issues.map(a=>st(a,n,ot()))},input:r.value}),r.issues=[]),r)}}),$l=U("$ZodPipe",(e,t)=>{me.init(e,t),fe(e._zod,"values",()=>t.in._zod.values),fe(e._zod,"optin",()=>t.in._zod.optin),fe(e._zod,"optout",()=>t.out._zod.optout),fe(e._zod,"propValues",()=>t.in._zod.propValues),e._zod.parse=(r,n)=>{if(n.direction==="backward"){const a=t.out._zod.run(r,n);return a instanceof Promise?a.then(u=>er(u,t.in,n)):er(a,t.in,n)}const s=t.in._zod.run(r,n);return s instanceof Promise?s.then(a=>er(a,t.out,n)):er(s,t.out,n)}});function er(e,t,r){return e.issues.length?(e.aborted=!0,e):t._zod.run({value:e.value,issues:e.issues},r)}const Sl=U("$ZodReadonly",(e,t)=>{me.init(e,t),fe(e._zod,"propValues",()=>t.innerType._zod.propValues),fe(e._zod,"values",()=>t.innerType._zod.values),fe(e._zod,"optin",()=>{var r,n;return(n=(r=t.innerType)==null?void 0:r._zod)==null?void 0:n.optin}),fe(e._zod,"optout",()=>{var r,n;return(n=(r=t.innerType)==null?void 0:r._zod)==null?void 0:n.optout}),e._zod.parse=(r,n)=>{if(n.direction==="backward")return t.innerType._zod.run(r,n);const s=t.innerType._zod.run(r,n);return s instanceof Promise?s.then(so):so(s)}});function so(e){return e.value=Object.freeze(e.value),e}const kl=U("$ZodCustom",(e,t)=>{Me.init(e,t),me.init(e,t),e._zod.parse=(r,n)=>r,e._zod.check=r=>{const n=r.value,s=t.fn(n);if(s instanceof Promise)return s.then(a=>ao(a,r,n,e));ao(s,r,n,e)}});function ao(e,t,r,n){if(!e){const s={code:"custom",input:r,inst:n,path:[...n._zod.def.path??[]],continue:!n._zod.def.abort};n._zod.def.params&&(s.params=n._zod.def.params),t.issues.push(Bt(s))}}var co;class Tl{constructor(){this._map=new WeakMap,this._idmap=new Map}add(t,...r){const n=r[0];if(this._map.set(t,n),n&&typeof n=="object"&&"id"in n){if(this._idmap.has(n.id))throw new Error(`ID ${n.id} already exists in the registry`);this._idmap.set(n.id,t)}return this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(t){const r=this._map.get(t);return r&&typeof r=="object"&&"id"in r&&this._idmap.delete(r.id),this._map.delete(t),this}get(t){const r=t._zod.parent;if(r){const n={...this.get(r)??{}};delete n.id;const s={...n,...this._map.get(t)};return Object.keys(s).length?s:void 0}return this._map.get(t)}has(t){return this._map.has(t)}}function Il(){return new Tl}(co=globalThis).__zod_globalRegistry??(co.__zod_globalRegistry=Il());const tr=globalThis.__zod_globalRegistry;function Rl(e,t){return new e({type:"string",...B(t)})}function Pl(e,t){return new e({type:"string",format:"email",check:"string_format",abort:!1,...B(t)})}function uo(e,t){return new e({type:"string",format:"guid",check:"string_format",abort:!1,...B(t)})}function Nl(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,...B(t)})}function Ol(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...B(t)})}function Cl(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...B(t)})}function Al(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...B(t)})}function ha(e,t){return new e({type:"string",format:"url",check:"string_format",abort:!1,...B(t)})}function Fl(e,t){return new e({type:"string",format:"emoji",check:"string_format",abort:!1,...B(t)})}function zl(e,t){return new e({type:"string",format:"nanoid",check:"string_format",abort:!1,...B(t)})}function Ul(e,t){return new e({type:"string",format:"cuid",check:"string_format",abort:!1,...B(t)})}function ql(e,t){return new e({type:"string",format:"cuid2",check:"string_format",abort:!1,...B(t)})}function jl(e,t){return new e({type:"string",format:"ulid",check:"string_format",abort:!1,...B(t)})}function Ml(e,t){return new e({type:"string",format:"xid",check:"string_format",abort:!1,...B(t)})}function xl(e,t){return new e({type:"string",format:"ksuid",check:"string_format",abort:!1,...B(t)})}function Ll(e,t){return new e({type:"string",format:"ipv4",check:"string_format",abort:!1,...B(t)})}function Dl(e,t){return new e({type:"string",format:"ipv6",check:"string_format",abort:!1,...B(t)})}function Zl(e,t){return new e({type:"string",format:"cidrv4",check:"string_format",abort:!1,...B(t)})}function Vl(e,t){return new e({type:"string",format:"cidrv6",check:"string_format",abort:!1,...B(t)})}function Hl(e,t){return new e({type:"string",format:"base64",check:"string_format",abort:!1,...B(t)})}function Bl(e,t){return new e({type:"string",format:"base64url",check:"string_format",abort:!1,...B(t)})}function Kl(e,t){return new e({type:"string",format:"e164",check:"string_format",abort:!1,...B(t)})}function Gl(e,t){return new e({type:"string",format:"jwt",check:"string_format",abort:!1,...B(t)})}function Wl(e,t){return new e({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...B(t)})}function Jl(e,t){return new e({type:"string",format:"date",check:"string_format",...B(t)})}function Yl(e,t){return new e({type:"string",format:"time",check:"string_format",precision:null,...B(t)})}function Ql(e,t){return new e({type:"string",format:"duration",check:"string_format",...B(t)})}function Xl(e,t){return new e({type:"number",checks:[],...B(t)})}function ed(e,t){return new e({type:"number",coerce:!0,checks:[],...B(t)})}function td(e,t){return new e({type:"number",check:"number_format",abort:!1,format:"safeint",...B(t)})}function rd(e,t){return new e({type:"boolean",...B(t)})}function nd(e,t){return new e({type:"null",...B(t)})}function id(e){return new e({type:"any"})}function od(e){return new e({type:"unknown"})}function sd(e,t){return new e({type:"never",...B(t)})}function lo(e,t){return new oa({check:"less_than",...B(t),value:e,inclusive:!1})}function Sn(e,t){return new oa({check:"less_than",...B(t),value:e,inclusive:!0})}function ho(e,t){return new sa({check:"greater_than",...B(t),value:e,inclusive:!1})}function kn(e,t){return new sa({check:"greater_than",...B(t),value:e,inclusive:!0})}function fo(e,t){return new _u({check:"multiple_of",...B(t),value:e})}function fa(e,t){return new yu({check:"max_length",...B(t),maximum:e})}function Yr(e,t){return new wu({check:"min_length",...B(t),minimum:e})}function pa(e,t){return new bu({check:"length_equals",...B(t),length:e})}function ad(e,t){return new Eu({check:"string_format",format:"regex",...B(t),pattern:e})}function cd(e){return new $u({check:"string_format",format:"lowercase",...B(e)})}function ud(e){return new Su({check:"string_format",format:"uppercase",...B(e)})}function ld(e,t){return new ku({check:"string_format",format:"includes",...B(t),includes:e})}function dd(e,t){return new Tu({check:"string_format",format:"starts_with",...B(t),prefix:e})}function hd(e,t){return new Iu({check:"string_format",format:"ends_with",...B(t),suffix:e})}function Ft(e){return new Ru({check:"overwrite",tx:e})}function fd(e){return Ft(t=>t.normalize(e))}function pd(){return Ft(e=>e.trim())}function md(){return Ft(e=>e.toLowerCase())}function gd(){return Ft(e=>e.toUpperCase())}function _d(){return Ft(e=>bc(e))}function vd(e,t,r){return new e({type:"array",element:t,...B(r)})}function yd(e,t,r){const n=B(r);return n.abort??(n.abort=!0),new e({type:"custom",check:"custom",fn:t,...n})}function wd(e,t,r){return new e({type:"custom",check:"custom",fn:t,...B(r)})}function bd(e){const t=Ed(r=>(r.addIssue=n=>{if(typeof n=="string")r.issues.push(Bt(n,r.value,t._zod.def));else{const s=n;s.fatal&&(s.continue=!1),s.code??(s.code="custom"),s.input??(s.input=r.value),s.inst??(s.inst=t),s.continue??(s.continue=!t._zod.def.abort),r.issues.push(Bt(s))}},e(r.value,r)));return t}function Ed(e,t){const r=new Me({check:"custom",...B(t)});return r._zod.check=e,r}function hn(e){return!!e._zod}function rt(e,t){return hn(e)?ea(e,t):e.safeParse(t)}function ma(e){var t,r;if(!e)return;let n;if(hn(e)?n=(r=(t=e._zod)===null||t===void 0?void 0:t.def)===null||r===void 0?void 0:r.shape:n=e.shape,!!n){if(typeof n=="function")try{return n()}catch{return}return n}}function $d(e){var t;if(hn(e)){const u=(t=e._zod)===null||t===void 0?void 0:t.def;if(u){if(u.value!==void 0)return u.value;if(Array.isArray(u.values)&&u.values.length>0)return u.values[0]}}const n=e._def;if(n){if(n.value!==void 0)return n.value;if(Array.isArray(n.values)&&n.values.length>0)return n.values[0]}const s=e.value;if(s!==void 0)return s}const Sd=U("ZodISODateTime",(e,t)=>{Du.init(e,t),be.init(e,t)});function kd(e){return Wl(Sd,e)}const Td=U("ZodISODate",(e,t)=>{Zu.init(e,t),be.init(e,t)});function Id(e){return Jl(Td,e)}const Rd=U("ZodISOTime",(e,t)=>{Vu.init(e,t),be.init(e,t)});function Pd(e){return Yl(Rd,e)}const Nd=U("ZodISODuration",(e,t)=>{Hu.init(e,t),be.init(e,t)});function Od(e){return Ql(Nd,e)}const Cd=(e,t)=>{Qs.init(e,t),e.name="ZodError",Object.defineProperties(e,{format:{value:r=>Fc(e,r)},flatten:{value:r=>Ac(e,r)},addIssue:{value:r=>{e.issues.push(r),e.message=JSON.stringify(e.issues,Vn,2)}},addIssues:{value:r=>{e.issues.push(...r),e.message=JSON.stringify(e.issues,Vn,2)}},isEmpty:{get(){return e.issues.length===0}}})},Ze=U("ZodError",Cd,{Parent:Error}),Ad=yi(Ze),Fd=wi(Ze),zd=un(Ze),Ud=ln(Ze),qd=Uc(Ze),jd=qc(Ze),Md=jc(Ze),xd=Mc(Ze),Ld=xc(Ze),Dd=Lc(Ze),Zd=Dc(Ze),Vd=Zc(Ze),ye=U("ZodType",(e,t)=>(me.init(e,t),e.def=t,e.type=t.type,Object.defineProperty(e,"_def",{value:t}),e.check=(...r)=>e.clone(gt(t,{checks:[...t.checks??[],...r.map(n=>typeof n=="function"?{_zod:{check:n,def:{check:"custom"},onattach:[]}}:n)]})),e.clone=(r,n)=>at(e,r,n),e.brand=()=>e,e.register=((r,n)=>(r.add(e,n),e)),e.parse=(r,n)=>Ad(e,r,n,{callee:e.parse}),e.safeParse=(r,n)=>zd(e,r,n),e.parseAsync=async(r,n)=>Fd(e,r,n,{callee:e.parseAsync}),e.safeParseAsync=async(r,n)=>Ud(e,r,n),e.spa=e.safeParseAsync,e.encode=(r,n)=>qd(e,r,n),e.decode=(r,n)=>jd(e,r,n),e.encodeAsync=async(r,n)=>Md(e,r,n),e.decodeAsync=async(r,n)=>xd(e,r,n),e.safeEncode=(r,n)=>Ld(e,r,n),e.safeDecode=(r,n)=>Dd(e,r,n),e.safeEncodeAsync=async(r,n)=>Zd(e,r,n),e.safeDecodeAsync=async(r,n)=>Vd(e,r,n),e.refine=(r,n)=>e.check(Fh(r,n)),e.superRefine=r=>e.check(zh(r)),e.overwrite=r=>e.check(Ft(r)),e.optional=()=>J(e),e.nullable=()=>go(e),e.nullish=()=>J(go(e)),e.nonoptional=r=>Ih(e,r),e.array=()=>H(e),e.or=r=>we([e,r]),e.and=r=>$i(e,r),e.transform=r=>Gn(e,Ea(r)),e.default=r=>Sh(e,r),e.prefault=r=>Th(e,r),e.catch=r=>Ph(e,r),e.pipe=r=>Gn(e,r),e.readonly=()=>Ch(e),e.describe=r=>{const n=e.clone();return tr.add(n,{description:r}),n},Object.defineProperty(e,"description",{get(){var r;return(r=tr.get(e))==null?void 0:r.description},configurable:!0}),e.meta=(...r)=>{if(r.length===0)return tr.get(e);const n=e.clone();return tr.add(n,r[0]),n},e.isOptional=()=>e.safeParse(void 0).success,e.isNullable=()=>e.safeParse(null).success,e)),ga=U("_ZodString",(e,t)=>{bi.init(e,t),ye.init(e,t);const r=e._zod.bag;e.format=r.format??null,e.minLength=r.minimum??null,e.maxLength=r.maximum??null,e.regex=(...n)=>e.check(ad(...n)),e.includes=(...n)=>e.check(ld(...n)),e.startsWith=(...n)=>e.check(dd(...n)),e.endsWith=(...n)=>e.check(hd(...n)),e.min=(...n)=>e.check(Yr(...n)),e.max=(...n)=>e.check(fa(...n)),e.length=(...n)=>e.check(pa(...n)),e.nonempty=(...n)=>e.check(Yr(1,...n)),e.lowercase=n=>e.check(cd(n)),e.uppercase=n=>e.check(ud(n)),e.trim=()=>e.check(pd()),e.normalize=(...n)=>e.check(fd(...n)),e.toLowerCase=()=>e.check(md()),e.toUpperCase=()=>e.check(gd()),e.slugify=()=>e.check(_d())}),Hd=U("ZodString",(e,t)=>{bi.init(e,t),ga.init(e,t),e.email=r=>e.check(Pl(Bd,r)),e.url=r=>e.check(ha(_a,r)),e.jwt=r=>e.check(Gl(ch,r)),e.emoji=r=>e.check(Fl(Gd,r)),e.guid=r=>e.check(uo(po,r)),e.uuid=r=>e.check(Nl(rr,r)),e.uuidv4=r=>e.check(Ol(rr,r)),e.uuidv6=r=>e.check(Cl(rr,r)),e.uuidv7=r=>e.check(Al(rr,r)),e.nanoid=r=>e.check(zl(Wd,r)),e.guid=r=>e.check(uo(po,r)),e.cuid=r=>e.check(Ul(Jd,r)),e.cuid2=r=>e.check(ql(Yd,r)),e.ulid=r=>e.check(jl(Qd,r)),e.base64=r=>e.check(Hl(oh,r)),e.base64url=r=>e.check(Bl(sh,r)),e.xid=r=>e.check(Ml(Xd,r)),e.ksuid=r=>e.check(xl(eh,r)),e.ipv4=r=>e.check(Ll(th,r)),e.ipv6=r=>e.check(Dl(rh,r)),e.cidrv4=r=>e.check(Zl(nh,r)),e.cidrv6=r=>e.check(Vl(ih,r)),e.e164=r=>e.check(Kl(ah,r)),e.datetime=r=>e.check(kd(r)),e.date=r=>e.check(Id(r)),e.time=r=>e.check(Pd(r)),e.duration=r=>e.check(Od(r))});function R(e){return Rl(Hd,e)}const be=U("ZodStringFormat",(e,t)=>{ve.init(e,t),ga.init(e,t)}),Bd=U("ZodEmail",(e,t)=>{Au.init(e,t),be.init(e,t)}),po=U("ZodGUID",(e,t)=>{Ou.init(e,t),be.init(e,t)}),rr=U("ZodUUID",(e,t)=>{Cu.init(e,t),be.init(e,t)}),_a=U("ZodURL",(e,t)=>{Fu.init(e,t),be.init(e,t)});function Kd(e){return ha(_a,e)}const Gd=U("ZodEmoji",(e,t)=>{zu.init(e,t),be.init(e,t)}),Wd=U("ZodNanoID",(e,t)=>{Uu.init(e,t),be.init(e,t)}),Jd=U("ZodCUID",(e,t)=>{qu.init(e,t),be.init(e,t)}),Yd=U("ZodCUID2",(e,t)=>{ju.init(e,t),be.init(e,t)}),Qd=U("ZodULID",(e,t)=>{Mu.init(e,t),be.init(e,t)}),Xd=U("ZodXID",(e,t)=>{xu.init(e,t),be.init(e,t)}),eh=U("ZodKSUID",(e,t)=>{Lu.init(e,t),be.init(e,t)}),th=U("ZodIPv4",(e,t)=>{Bu.init(e,t),be.init(e,t)}),rh=U("ZodIPv6",(e,t)=>{Ku.init(e,t),be.init(e,t)}),nh=U("ZodCIDRv4",(e,t)=>{Gu.init(e,t),be.init(e,t)}),ih=U("ZodCIDRv6",(e,t)=>{Wu.init(e,t),be.init(e,t)}),oh=U("ZodBase64",(e,t)=>{Ju.init(e,t),be.init(e,t)}),sh=U("ZodBase64URL",(e,t)=>{Qu.init(e,t),be.init(e,t)}),ah=U("ZodE164",(e,t)=>{Xu.init(e,t),be.init(e,t)}),ch=U("ZodJWT",(e,t)=>{tl.init(e,t),be.init(e,t)}),Ei=U("ZodNumber",(e,t)=>{ca.init(e,t),ye.init(e,t),e.gt=(n,s)=>e.check(ho(n,s)),e.gte=(n,s)=>e.check(kn(n,s)),e.min=(n,s)=>e.check(kn(n,s)),e.lt=(n,s)=>e.check(lo(n,s)),e.lte=(n,s)=>e.check(Sn(n,s)),e.max=(n,s)=>e.check(Sn(n,s)),e.int=n=>e.check(mo(n)),e.safe=n=>e.check(mo(n)),e.positive=n=>e.check(ho(0,n)),e.nonnegative=n=>e.check(kn(0,n)),e.negative=n=>e.check(lo(0,n)),e.nonpositive=n=>e.check(Sn(0,n)),e.multipleOf=(n,s)=>e.check(fo(n,s)),e.step=(n,s)=>e.check(fo(n,s)),e.finite=()=>e;const r=e._zod.bag;e.minValue=Math.max(r.minimum??Number.NEGATIVE_INFINITY,r.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,e.maxValue=Math.min(r.maximum??Number.POSITIVE_INFINITY,r.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,e.isInt=(r.format??"").includes("int")||Number.isSafeInteger(r.multipleOf??.5),e.isFinite=!0,e.format=r.format??null});function pe(e){return Xl(Ei,e)}const uh=U("ZodNumberFormat",(e,t)=>{rl.init(e,t),Ei.init(e,t)});function mo(e){return td(uh,e)}const lh=U("ZodBoolean",(e,t)=>{nl.init(e,t),ye.init(e,t)});function _e(e){return rd(lh,e)}const dh=U("ZodNull",(e,t)=>{il.init(e,t),ye.init(e,t)});function va(e){return nd(dh,e)}const hh=U("ZodAny",(e,t)=>{ol.init(e,t),ye.init(e,t)});function Bn(){return id(hh)}const fh=U("ZodUnknown",(e,t)=>{sl.init(e,t),ye.init(e,t)});function $e(){return od(fh)}const ph=U("ZodNever",(e,t)=>{al.init(e,t),ye.init(e,t)});function mh(e){return sd(ph,e)}const gh=U("ZodArray",(e,t)=>{cl.init(e,t),ye.init(e,t),e.element=t.element,e.min=(r,n)=>e.check(Yr(r,n)),e.nonempty=r=>e.check(Yr(1,r)),e.max=(r,n)=>e.check(fa(r,n)),e.length=(r,n)=>e.check(pa(r,n)),e.unwrap=()=>e.element});function H(e,t){return vd(gh,e,t)}const ya=U("ZodObject",(e,t)=>{ll.init(e,t),ye.init(e,t),fe(e,"shape",()=>t.shape),e.keyof=()=>Fe(Object.keys(e._zod.def.shape)),e.catchall=r=>e.clone({...e._zod.def,catchall:r}),e.passthrough=()=>e.clone({...e._zod.def,catchall:$e()}),e.loose=()=>e.clone({...e._zod.def,catchall:$e()}),e.strict=()=>e.clone({...e._zod.def,catchall:mh()}),e.strip=()=>e.clone({...e._zod.def,catchall:void 0}),e.extend=r=>Rc(e,r),e.safeExtend=r=>Pc(e,r),e.merge=r=>Nc(e,r),e.pick=r=>Tc(e,r),e.omit=r=>Ic(e,r),e.partial=(...r)=>Oc($a,e,r[0]),e.required=(...r)=>Cc(Sa,e,r[0])});function D(e,t){const r={type:"object",shape:e??{},...B(t)};return new ya(r)}function je(e,t){return new ya({type:"object",shape:e,catchall:$e(),...B(t)})}const wa=U("ZodUnion",(e,t)=>{da.init(e,t),ye.init(e,t),e.options=t.options});function we(e,t){return new wa({type:"union",options:e,...B(t)})}const _h=U("ZodDiscriminatedUnion",(e,t)=>{wa.init(e,t),dl.init(e,t)});function ba(e,t,r){return new _h({type:"union",options:t,discriminator:e,...B(r)})}const vh=U("ZodIntersection",(e,t)=>{hl.init(e,t),ye.init(e,t)});function $i(e,t){return new vh({type:"intersection",left:e,right:t})}const yh=U("ZodRecord",(e,t)=>{fl.init(e,t),ye.init(e,t),e.keyType=t.keyType,e.valueType=t.valueType});function Se(e,t,r){return new yh({type:"record",keyType:e,valueType:t,...B(r)})}const Kn=U("ZodEnum",(e,t)=>{pl.init(e,t),ye.init(e,t),e.enum=t.entries,e.options=Object.values(t.entries);const r=new Set(Object.keys(t.entries));e.extract=(n,s)=>{const a={};for(const u of n)if(r.has(u))a[u]=t.entries[u];else throw new Error(`Key ${u} not found in enum`);return new Kn({...t,checks:[],...B(s),entries:a})},e.exclude=(n,s)=>{const a={...t.entries};for(const u of n)if(r.has(u))delete a[u];else throw new Error(`Key ${u} not found in enum`);return new Kn({...t,checks:[],...B(s),entries:a})}});function Fe(e,t){const r=Array.isArray(e)?Object.fromEntries(e.map(n=>[n,n])):e;return new Kn({type:"enum",entries:r,...B(t)})}const wh=U("ZodLiteral",(e,t)=>{ml.init(e,t),ye.init(e,t),e.values=new Set(t.values),Object.defineProperty(e,"value",{get(){if(t.values.length>1)throw new Error("This schema contains multiple valid literal values. Use `.values` instead.");return t.values[0]}})});function G(e,t){return new wh({type:"literal",values:Array.isArray(e)?e:[e],...B(t)})}const bh=U("ZodTransform",(e,t)=>{gl.init(e,t),ye.init(e,t),e._zod.parse=(r,n)=>{if(n.direction==="backward")throw new Ks(e.constructor.name);r.addIssue=a=>{if(typeof a=="string")r.issues.push(Bt(a,r.value,t));else{const u=a;u.fatal&&(u.continue=!1),u.code??(u.code="custom"),u.input??(u.input=r.value),u.inst??(u.inst=e),r.issues.push(Bt(u))}};const s=t.transform(r.value,r);return s instanceof Promise?s.then(a=>(r.value=a,r)):(r.value=s,r)}});function Ea(e){return new bh({type:"transform",transform:e})}const $a=U("ZodOptional",(e,t)=>{_l.init(e,t),ye.init(e,t),e.unwrap=()=>e._zod.def.innerType});function J(e){return new $a({type:"optional",innerType:e})}const Eh=U("ZodNullable",(e,t)=>{vl.init(e,t),ye.init(e,t),e.unwrap=()=>e._zod.def.innerType});function go(e){return new Eh({type:"nullable",innerType:e})}const $h=U("ZodDefault",(e,t)=>{yl.init(e,t),ye.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeDefault=e.unwrap});function Sh(e,t){return new $h({type:"default",innerType:e,get defaultValue(){return typeof t=="function"?t():Js(t)}})}const kh=U("ZodPrefault",(e,t)=>{wl.init(e,t),ye.init(e,t),e.unwrap=()=>e._zod.def.innerType});function Th(e,t){return new kh({type:"prefault",innerType:e,get defaultValue(){return typeof t=="function"?t():Js(t)}})}const Sa=U("ZodNonOptional",(e,t)=>{bl.init(e,t),ye.init(e,t),e.unwrap=()=>e._zod.def.innerType});function Ih(e,t){return new Sa({type:"nonoptional",innerType:e,...B(t)})}const Rh=U("ZodCatch",(e,t)=>{El.init(e,t),ye.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeCatch=e.unwrap});function Ph(e,t){return new Rh({type:"catch",innerType:e,catchValue:typeof t=="function"?t:()=>t})}const Nh=U("ZodPipe",(e,t)=>{$l.init(e,t),ye.init(e,t),e.in=t.in,e.out=t.out});function Gn(e,t){return new Nh({type:"pipe",in:e,out:t})}const Oh=U("ZodReadonly",(e,t)=>{Sl.init(e,t),ye.init(e,t),e.unwrap=()=>e._zod.def.innerType});function Ch(e){return new Oh({type:"readonly",innerType:e})}const ka=U("ZodCustom",(e,t)=>{kl.init(e,t),ye.init(e,t)});function Ah(e,t){return yd(ka,e??(()=>!0),t)}function Fh(e,t={}){return wd(ka,e,t)}function zh(e){return bd(e)}function Ta(e,t){return Gn(Ea(e),t)}const Uh={custom:"custom"};function qh(e){return ed(Ei,e)}const fn="2025-11-25",jh=[fn,"2025-06-18","2025-03-26","2024-11-05","2024-10-07"],et="io.modelcontextprotocol/related-task",pn="2.0",We=Ah(e=>e!==null&&(typeof e=="object"||typeof e=="function")),Ia=we([R(),pe().int()]),Ra=R(),Mh=je({ttl:we([pe(),va()]).optional(),pollInterval:pe().optional()}),Si=je({taskId:R()}),xh=je({progressToken:Ia.optional(),[et]:Si.optional()}),xe=je({task:Mh.optional(),_meta:xh.optional()}),Oe=D({method:R(),params:xe.optional()}),_t=je({_meta:D({[et]:J(Si)}).passthrough().optional()}),Ve=D({method:R(),params:_t.optional()}),Ce=je({_meta:je({[et]:Si.optional()}).optional()}),mn=we([R(),pe().int()]),Pa=D({jsonrpc:G(pn),id:mn,...Oe.shape}).strict(),_o=e=>Pa.safeParse(e).success,Na=D({jsonrpc:G(pn),...Ve.shape}).strict(),Lh=e=>Na.safeParse(e).success,Oa=D({jsonrpc:G(pn),id:mn,result:Ce}).strict(),nr=e=>Oa.safeParse(e).success;var te;(function(e){e[e.ConnectionClosed=-32e3]="ConnectionClosed",e[e.RequestTimeout=-32001]="RequestTimeout",e[e.ParseError=-32700]="ParseError",e[e.InvalidRequest=-32600]="InvalidRequest",e[e.MethodNotFound=-32601]="MethodNotFound",e[e.InvalidParams=-32602]="InvalidParams",e[e.InternalError=-32603]="InternalError",e[e.UrlElicitationRequired=-32042]="UrlElicitationRequired"})(te||(te={}));const Ca=D({jsonrpc:G(pn),id:mn,error:D({code:pe().int(),message:R(),data:J($e())})}).strict(),Dh=e=>Ca.safeParse(e).success,Zh=we([Pa,Na,Oa,Ca]),Tt=Ce.strict(),Vh=_t.extend({requestId:mn,reason:R().optional()}),ki=Ve.extend({method:G("notifications/cancelled"),params:Vh}),Hh=D({src:R(),mimeType:R().optional(),sizes:H(R()).optional()}),Wt=D({icons:H(Hh).optional()}),Ct=D({name:R(),title:R().optional()}),Aa=Ct.extend({...Ct.shape,...Wt.shape,version:R(),websiteUrl:R().optional()}),Bh=$i(D({applyDefaults:_e().optional()}),Se(R(),$e())),Kh=Ta(e=>e&&typeof e=="object"&&!Array.isArray(e)&&Object.keys(e).length===0?{form:{}}:e,$i(D({form:Bh.optional(),url:We.optional()}),Se(R(),$e()).optional())),Gh=D({list:J(D({}).passthrough()),cancel:J(D({}).passthrough()),requests:J(D({sampling:J(D({createMessage:J(D({}).passthrough())}).passthrough()),elicitation:J(D({create:J(D({}).passthrough())}).passthrough())}).passthrough())}).passthrough(),Wh=D({list:J(D({}).passthrough()),cancel:J(D({}).passthrough()),requests:J(D({tools:J(D({call:J(D({}).passthrough())}).passthrough())}).passthrough())}).passthrough(),Jh=D({experimental:Se(R(),We).optional(),sampling:D({context:We.optional(),tools:We.optional()}).optional(),elicitation:Kh.optional(),roots:D({listChanged:_e().optional()}).optional(),tasks:J(Gh)}),Yh=xe.extend({protocolVersion:R(),capabilities:Jh,clientInfo:Aa}),Qh=Oe.extend({method:G("initialize"),params:Yh}),Xh=D({experimental:Se(R(),We).optional(),logging:We.optional(),completions:We.optional(),prompts:J(D({listChanged:J(_e())})),resources:D({subscribe:_e().optional(),listChanged:_e().optional()}).optional(),tools:D({listChanged:_e().optional()}).optional(),tasks:J(Wh)}).passthrough(),Fa=Ce.extend({protocolVersion:R(),capabilities:Xh,serverInfo:Aa,instructions:R().optional()}),ef=Ve.extend({method:G("notifications/initialized")}),Ti=Oe.extend({method:G("ping")}),tf=D({progress:pe(),total:J(pe()),message:J(R())}),rf=D({..._t.shape,...tf.shape,progressToken:Ia}),Ii=Ve.extend({method:G("notifications/progress"),params:rf}),nf=xe.extend({cursor:Ra.optional()}),Jt=Oe.extend({params:nf.optional()}),Yt=Ce.extend({nextCursor:J(Ra)}),Qt=D({taskId:R(),status:Fe(["working","input_required","completed","failed","cancelled"]),ttl:we([pe(),va()]),createdAt:R(),lastUpdatedAt:R(),pollInterval:J(pe()),statusMessage:J(R())}),Kt=Ce.extend({task:Qt}),of=_t.merge(Qt),Qr=Ve.extend({method:G("notifications/tasks/status"),params:of}),Ri=Oe.extend({method:G("tasks/get"),params:xe.extend({taskId:R()})}),Pi=Ce.merge(Qt),Ni=Oe.extend({method:G("tasks/result"),params:xe.extend({taskId:R()})}),Oi=Jt.extend({method:G("tasks/list")}),Ci=Yt.extend({tasks:H(Qt)}),sf=Oe.extend({method:G("tasks/cancel"),params:xe.extend({taskId:R()})}),af=Ce.merge(Qt),za=D({uri:R(),mimeType:J(R()),_meta:Se(R(),$e()).optional()}),Ua=za.extend({text:R()}),Ai=R().refine(e=>{try{return atob(e),!0}catch{return!1}},{message:"Invalid Base64 string"}),qa=za.extend({blob:Ai}),ja=D({...Ct.shape,...Wt.shape,uri:R(),description:J(R()),mimeType:J(R()),_meta:J(je({}))}),cf=D({...Ct.shape,...Wt.shape,uriTemplate:R(),description:J(R()),mimeType:J(R()),_meta:J(je({}))}),uf=Jt.extend({method:G("resources/list")}),Ma=Yt.extend({resources:H(ja)}),lf=Jt.extend({method:G("resources/templates/list")}),xa=Yt.extend({resourceTemplates:H(cf)}),Fi=xe.extend({uri:R()}),df=Fi,hf=Oe.extend({method:G("resources/read"),params:df}),La=Ce.extend({contents:H(we([Ua,qa]))}),ff=Ve.extend({method:G("notifications/resources/list_changed")}),pf=Fi,mf=Oe.extend({method:G("resources/subscribe"),params:pf}),gf=Fi,_f=Oe.extend({method:G("resources/unsubscribe"),params:gf}),vf=_t.extend({uri:R()}),yf=Ve.extend({method:G("notifications/resources/updated"),params:vf}),wf=D({name:R(),description:J(R()),required:J(_e())}),bf=D({...Ct.shape,...Wt.shape,description:J(R()),arguments:J(H(wf)),_meta:J(je({}))}),Ef=Jt.extend({method:G("prompts/list")}),Da=Yt.extend({prompts:H(bf)}),$f=xe.extend({name:R(),arguments:Se(R(),R()).optional()}),Sf=Oe.extend({method:G("prompts/get"),params:$f}),zi=D({type:G("text"),text:R(),_meta:Se(R(),$e()).optional()}),Ui=D({type:G("image"),data:Ai,mimeType:R(),_meta:Se(R(),$e()).optional()}),qi=D({type:G("audio"),data:Ai,mimeType:R(),_meta:Se(R(),$e()).optional()}),kf=D({type:G("tool_use"),name:R(),id:R(),input:D({}).passthrough(),_meta:J(D({}).passthrough())}).passthrough(),Tf=D({type:G("resource"),resource:we([Ua,qa]),_meta:Se(R(),$e()).optional()}),If=ja.extend({type:G("resource_link")}),ji=we([zi,Ui,qi,If,Tf]),Rf=D({role:Fe(["user","assistant"]),content:ji}),Za=Ce.extend({description:J(R()),messages:H(Rf)}),Pf=Ve.extend({method:G("notifications/prompts/list_changed")}),Nf=D({title:R().optional(),readOnlyHint:_e().optional(),destructiveHint:_e().optional(),idempotentHint:_e().optional(),openWorldHint:_e().optional()}),Of=D({taskSupport:Fe(["required","optional","forbidden"]).optional()}),Va=D({...Ct.shape,...Wt.shape,description:R().optional(),inputSchema:D({type:G("object"),properties:Se(R(),We).optional(),required:H(R()).optional()}).catchall($e()),outputSchema:D({type:G("object"),properties:Se(R(),We).optional(),required:H(R()).optional()}).catchall($e()).optional(),annotations:J(Nf),execution:J(Of),_meta:Se(R(),$e()).optional()}),Cf=Jt.extend({method:G("tools/list")}),Ha=Yt.extend({tools:H(Va)}),gn=Ce.extend({content:H(ji).default([]),structuredContent:Se(R(),$e()).optional(),isError:J(_e())});gn.or(Ce.extend({toolResult:$e()}));const Af=xe.extend({name:R(),arguments:J(Se(R(),$e()))}),Ff=Oe.extend({method:G("tools/call"),params:Af}),zf=Ve.extend({method:G("notifications/tools/list_changed")}),Ba=Fe(["debug","info","notice","warning","error","critical","alert","emergency"]),Uf=xe.extend({level:Ba}),qf=Oe.extend({method:G("logging/setLevel"),params:Uf}),jf=_t.extend({level:Ba,logger:R().optional(),data:$e()}),Mf=Ve.extend({method:G("notifications/message"),params:jf}),xf=D({name:R().optional()}),Lf=D({hints:J(H(xf)),costPriority:J(pe().min(0).max(1)),speedPriority:J(pe().min(0).max(1)),intelligencePriority:J(pe().min(0).max(1))}),Df=D({mode:J(Fe(["auto","required","none"]))}),Zf=D({type:G("tool_result"),toolUseId:R().describe("The unique identifier for the corresponding tool call."),content:H(ji).default([]),structuredContent:D({}).passthrough().optional(),isError:J(_e()),_meta:J(D({}).passthrough())}).passthrough(),Vf=ba("type",[zi,Ui,qi]),Xr=ba("type",[zi,Ui,qi,kf,Zf]),Hf=D({role:Fe(["user","assistant"]),content:we([Xr,H(Xr)]),_meta:J(D({}).passthrough())}).passthrough(),Bf=xe.extend({messages:H(Hf),modelPreferences:Lf.optional(),systemPrompt:R().optional(),includeContext:Fe(["none","thisServer","allServers"]).optional(),temperature:pe().optional(),maxTokens:pe().int(),stopSequences:H(R()).optional(),metadata:We.optional(),tools:J(H(Va)),toolChoice:J(Df)}),Ka=Oe.extend({method:G("sampling/createMessage"),params:Bf}),Ga=Ce.extend({model:R(),stopReason:J(Fe(["endTurn","stopSequence","maxTokens"]).or(R())),role:Fe(["user","assistant"]),content:Vf}),Kf=Ce.extend({model:R(),stopReason:J(Fe(["endTurn","stopSequence","maxTokens","toolUse"]).or(R())),role:Fe(["user","assistant"]),content:we([Xr,H(Xr)])}),Gf=D({type:G("boolean"),title:R().optional(),description:R().optional(),default:_e().optional()}),Wf=D({type:G("string"),title:R().optional(),description:R().optional(),minLength:pe().optional(),maxLength:pe().optional(),format:Fe(["email","uri","date","date-time"]).optional(),default:R().optional()}),Jf=D({type:Fe(["number","integer"]),title:R().optional(),description:R().optional(),minimum:pe().optional(),maximum:pe().optional(),default:pe().optional()}),Yf=D({type:G("string"),title:R().optional(),description:R().optional(),enum:H(R()),default:R().optional()}),Qf=D({type:G("string"),title:R().optional(),description:R().optional(),oneOf:H(D({const:R(),title:R()})),default:R().optional()}),Xf=D({type:G("string"),title:R().optional(),description:R().optional(),enum:H(R()),enumNames:H(R()).optional(),default:R().optional()}),ep=we([Yf,Qf]),tp=D({type:G("array"),title:R().optional(),description:R().optional(),minItems:pe().optional(),maxItems:pe().optional(),items:D({type:G("string"),enum:H(R())}),default:H(R()).optional()}),rp=D({type:G("array"),title:R().optional(),description:R().optional(),minItems:pe().optional(),maxItems:pe().optional(),items:D({anyOf:H(D({const:R(),title:R()}))}),default:H(R()).optional()}),np=we([tp,rp]),ip=we([Xf,ep,np]),op=we([ip,Gf,Wf,Jf]),sp=xe.extend({mode:G("form").optional(),message:R(),requestedSchema:D({type:G("object"),properties:Se(R(),op),required:H(R()).optional()})}),ap=xe.extend({mode:G("url"),message:R(),elicitationId:R(),url:R().url()}),cp=we([sp,ap]),Wa=Oe.extend({method:G("elicitation/create"),params:cp}),up=_t.extend({elicitationId:R()}),lp=Ve.extend({method:G("notifications/elicitation/complete"),params:up}),Ja=Ce.extend({action:Fe(["accept","decline","cancel"]),content:Ta(e=>e===null?void 0:e,Se(R(),we([R(),pe(),_e(),H(R())])).optional())}),dp=D({type:G("ref/resource"),uri:R()}),hp=D({type:G("ref/prompt"),name:R()}),fp=xe.extend({ref:we([hp,dp]),argument:D({name:R(),value:R()}),context:D({arguments:Se(R(),R()).optional()}).optional()}),pp=Oe.extend({method:G("completion/complete"),params:fp}),Ya=Ce.extend({completion:je({values:H(R()).max(100),total:J(pe().int()),hasMore:J(_e())})}),mp=D({uri:R().startsWith("file://"),name:R().optional(),_meta:Se(R(),$e()).optional()}),gp=Oe.extend({method:G("roots/list")}),_p=Ce.extend({roots:H(mp)}),vp=Ve.extend({method:G("notifications/roots/list_changed")});we([Ti,Qh,pp,qf,Sf,Ef,uf,lf,hf,mf,_f,Ff,Cf,Ri,Ni,Oi]);we([ki,Ii,ef,vp,Qr]);we([Tt,Ga,Kf,Ja,_p,Pi,Ci,Kt]);we([Ti,Ka,Wa,gp,Ri,Ni,Oi]);we([ki,Ii,Mf,yf,ff,zf,Pf,Qr,lp]);we([Tt,Fa,Ya,Za,Da,Ma,xa,La,gn,Ha,Pi,Ci,Kt]);class X extends Error{constructor(t,r,n){super(`MCP error ${t}: ${r}`),this.code=t,this.data=n,this.name="McpError"}static fromError(t,r,n){if(t===te.UrlElicitationRequired&&n){const s=n;if(s.elicitations)return new yp(s.elicitations,r)}return new X(t,r,n)}}class yp extends X{constructor(t,r=`URL elicitation${t.length>1?"s":""} required`){super(te.UrlElicitationRequired,r,{elicitations:t})}get elicitations(){var t,r;return(r=(t=this.data)===null||t===void 0?void 0:t.elicitations)!==null&&r!==void 0?r:[]}}function ut(e){return e==="completed"||e==="failed"||e==="cancelled"}new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function vo(e){const t=ma(e),r=t==null?void 0:t.method;if(!r)throw new Error("Schema is missing a method literal");const n=$d(r);if(typeof n!="string")throw new Error("Schema method literal must be a string");return n}function yo(e,t){const r=rt(e,t);if(!r.success)throw r.error;return r.data}const wp=6e4;class bp{constructor(t){this._options=t,this._requestMessageId=0,this._requestHandlers=new Map,this._requestHandlerAbortControllers=new Map,this._notificationHandlers=new Map,this._responseHandlers=new Map,this._progressHandlers=new Map,this._timeoutInfo=new Map,this._pendingDebouncedNotifications=new Set,this._taskProgressTokens=new Map,this._requestResolvers=new Map,this.setNotificationHandler(ki,r=>{this._oncancel(r)}),this.setNotificationHandler(Ii,r=>{this._onprogress(r)}),this.setRequestHandler(Ti,r=>({})),this._taskStore=t==null?void 0:t.taskStore,this._taskMessageQueue=t==null?void 0:t.taskMessageQueue,this._taskStore&&(this.setRequestHandler(Ri,async(r,n)=>{const s=await this._taskStore.getTask(r.params.taskId,n.sessionId);if(!s)throw new X(te.InvalidParams,"Failed to retrieve task: Task not found");return{...s}}),this.setRequestHandler(Ni,async(r,n)=>{const s=async()=>{var a;const u=r.params.taskId;if(this._taskMessageQueue){let p;for(;p=await this._taskMessageQueue.dequeue(u,n.sessionId);){if(p.type==="response"||p.type==="error"){const _=p.message,v=_.id,b=this._requestResolvers.get(v);if(b)if(this._requestResolvers.delete(v),p.type==="response")b(_);else{const i=_,o=new X(i.error.code,i.error.message,i.error.data);b(o)}else{const i=p.type==="response"?"Response":"Error";this._onerror(new Error(`${i} handler missing for request ${v}`))}continue}await((a=this._transport)===null||a===void 0?void 0:a.send(p.message,{relatedRequestId:n.requestId}))}}const d=await this._taskStore.getTask(u,n.sessionId);if(!d)throw new X(te.InvalidParams,`Task not found: ${u}`);if(!ut(d.status))return await this._waitForTaskUpdate(u,n.signal),await s();if(ut(d.status)){const p=await this._taskStore.getTaskResult(u,n.sessionId);return this._clearTaskQueue(u),{...p,_meta:{...p._meta,[et]:{taskId:u}}}}return await s()};return await s()}),this.setRequestHandler(Oi,async(r,n)=>{var s;try{const{tasks:a,nextCursor:u}=await this._taskStore.listTasks((s=r.params)===null||s===void 0?void 0:s.cursor,n.sessionId);return{tasks:a,nextCursor:u,_meta:{}}}catch(a){throw new X(te.InvalidParams,`Failed to list tasks: ${a instanceof Error?a.message:String(a)}`)}}),this.setRequestHandler(sf,async(r,n)=>{try{const s=await this._taskStore.getTask(r.params.taskId,n.sessionId);if(!s)throw new X(te.InvalidParams,`Task not found: ${r.params.taskId}`);if(ut(s.status))throw new X(te.InvalidParams,`Cannot cancel task in terminal status: ${s.status}`);await this._taskStore.updateTaskStatus(r.params.taskId,"cancelled","Client cancelled task execution.",n.sessionId),this._clearTaskQueue(r.params.taskId);const a=await this._taskStore.getTask(r.params.taskId,n.sessionId);if(!a)throw new X(te.InvalidParams,`Task not found after cancellation: ${r.params.taskId}`);return{_meta:{},...a}}catch(s){throw s instanceof X?s:new X(te.InvalidRequest,`Failed to cancel task: ${s instanceof Error?s.message:String(s)}`)}}))}async _oncancel(t){const r=this._requestHandlerAbortControllers.get(t.params.requestId);r==null||r.abort(t.params.reason)}_setupTimeout(t,r,n,s,a=!1){this._timeoutInfo.set(t,{timeoutId:setTimeout(s,r),startTime:Date.now(),timeout:r,maxTotalTimeout:n,resetTimeoutOnProgress:a,onTimeout:s})}_resetTimeout(t){const r=this._timeoutInfo.get(t);if(!r)return!1;const n=Date.now()-r.startTime;if(r.maxTotalTimeout&&n>=r.maxTotalTimeout)throw this._timeoutInfo.delete(t),X.fromError(te.RequestTimeout,"Maximum total timeout exceeded",{maxTotalTimeout:r.maxTotalTimeout,totalElapsed:n});return clearTimeout(r.timeoutId),r.timeoutId=setTimeout(r.onTimeout,r.timeout),!0}_cleanupTimeout(t){const r=this._timeoutInfo.get(t);r&&(clearTimeout(r.timeoutId),this._timeoutInfo.delete(t))}async connect(t){var r,n,s;this._transport=t;const a=(r=this.transport)===null||r===void 0?void 0:r.onclose;this._transport.onclose=()=>{a==null||a(),this._onclose()};const u=(n=this.transport)===null||n===void 0?void 0:n.onerror;this._transport.onerror=p=>{u==null||u(p),this._onerror(p)};const d=(s=this._transport)===null||s===void 0?void 0:s.onmessage;this._transport.onmessage=(p,_)=>{d==null||d(p,_),nr(p)||Dh(p)?this._onresponse(p):_o(p)?this._onrequest(p,_):Lh(p)?this._onnotification(p):this._onerror(new Error(`Unknown message type: ${JSON.stringify(p)}`))},await this._transport.start()}_onclose(){var t;const r=this._responseHandlers;this._responseHandlers=new Map,this._progressHandlers.clear(),this._taskProgressTokens.clear(),this._pendingDebouncedNotifications.clear();const n=X.fromError(te.ConnectionClosed,"Connection closed");this._transport=void 0,(t=this.onclose)===null||t===void 0||t.call(this);for(const s of r.values())s(n)}_onerror(t){var r;(r=this.onerror)===null||r===void 0||r.call(this,t)}_onnotification(t){var r;const n=(r=this._notificationHandlers.get(t.method))!==null&&r!==void 0?r:this.fallbackNotificationHandler;n!==void 0&&Promise.resolve().then(()=>n(t)).catch(s=>this._onerror(new Error(`Uncaught error in notification handler: ${s}`)))}_onrequest(t,r){var n,s,a,u,d,p;const _=(n=this._requestHandlers.get(t.method))!==null&&n!==void 0?n:this.fallbackRequestHandler,v=this._transport,b=(u=(a=(s=t.params)===null||s===void 0?void 0:s._meta)===null||a===void 0?void 0:a[et])===null||u===void 0?void 0:u.taskId;if(_===void 0){const l={jsonrpc:"2.0",id:t.id,error:{code:te.MethodNotFound,message:"Method not found"}};b&&this._taskMessageQueue?this._enqueueTaskMessage(b,{type:"error",message:l,timestamp:Date.now()},v==null?void 0:v.sessionId).catch(m=>this._onerror(new Error(`Failed to enqueue error response: ${m}`))):v==null||v.send(l).catch(m=>this._onerror(new Error(`Failed to send an error response: ${m}`)));return}const i=new AbortController;this._requestHandlerAbortControllers.set(t.id,i);const o=(d=t.params)===null||d===void 0?void 0:d.task,c=this._taskStore?this.requestTaskStore(t,v==null?void 0:v.sessionId):void 0,f={signal:i.signal,sessionId:v==null?void 0:v.sessionId,_meta:(p=t.params)===null||p===void 0?void 0:p._meta,sendNotification:async l=>{const m={relatedRequestId:t.id};b&&(m.relatedTask={taskId:b}),await this.notification(l,m)},sendRequest:async(l,m,h)=>{var g,w;const y={...h,relatedRequestId:t.id};b&&!y.relatedTask&&(y.relatedTask={taskId:b});const E=(w=(g=y.relatedTask)===null||g===void 0?void 0:g.taskId)!==null&&w!==void 0?w:b;return E&&c&&await c.updateTaskStatus(E,"input_required"),await this.request(l,m,y)},authInfo:r==null?void 0:r.authInfo,requestId:t.id,requestInfo:r==null?void 0:r.requestInfo,taskId:b,taskStore:c,taskRequestedTtl:o==null?void 0:o.ttl,closeSSEStream:r==null?void 0:r.closeSSEStream,closeStandaloneSSEStream:r==null?void 0:r.closeStandaloneSSEStream};Promise.resolve().then(()=>{o&&this.assertTaskHandlerCapability(t.method)}).then(()=>_(t,f)).then(async l=>{if(i.signal.aborted)return;const m={result:l,jsonrpc:"2.0",id:t.id};b&&this._taskMessageQueue?await this._enqueueTaskMessage(b,{type:"response",message:m,timestamp:Date.now()},v==null?void 0:v.sessionId):await(v==null?void 0:v.send(m))},async l=>{var m;if(i.signal.aborted)return;const h={jsonrpc:"2.0",id:t.id,error:{code:Number.isSafeInteger(l.code)?l.code:te.InternalError,message:(m=l.message)!==null&&m!==void 0?m:"Internal error",...l.data!==void 0&&{data:l.data}}};b&&this._taskMessageQueue?await this._enqueueTaskMessage(b,{type:"error",message:h,timestamp:Date.now()},v==null?void 0:v.sessionId):await(v==null?void 0:v.send(h))}).catch(l=>this._onerror(new Error(`Failed to send response: ${l}`))).finally(()=>{this._requestHandlerAbortControllers.delete(t.id)})}_onprogress(t){const{progressToken:r,...n}=t.params,s=Number(r),a=this._progressHandlers.get(s);if(!a){this._onerror(new Error(`Received a progress notification for an unknown token: ${JSON.stringify(t)}`));return}const u=this._responseHandlers.get(s),d=this._timeoutInfo.get(s);if(d&&u&&d.resetTimeoutOnProgress)try{this._resetTimeout(s)}catch(p){this._responseHandlers.delete(s),this._progressHandlers.delete(s),this._cleanupTimeout(s),u(p);return}a(n)}_onresponse(t){const r=Number(t.id),n=this._requestResolvers.get(r);if(n){if(this._requestResolvers.delete(r),nr(t))n(t);else{const u=new X(t.error.code,t.error.message,t.error.data);n(u)}return}const s=this._responseHandlers.get(r);if(s===void 0){this._onerror(new Error(`Received a response for an unknown message ID: ${JSON.stringify(t)}`));return}this._responseHandlers.delete(r),this._cleanupTimeout(r);let a=!1;if(nr(t)&&t.result&&typeof t.result=="object"){const u=t.result;if(u.task&&typeof u.task=="object"){const d=u.task;typeof d.taskId=="string"&&(a=!0,this._taskProgressTokens.set(d.taskId,r))}}if(a||this._progressHandlers.delete(r),nr(t))s(t);else{const u=X.fromError(t.error.code,t.error.message,t.error.data);s(u)}}get transport(){return this._transport}async close(){var t;await((t=this._transport)===null||t===void 0?void 0:t.close())}async*requestStream(t,r,n){var s,a,u,d;const{task:p}=n??{};if(!p){try{yield{type:"result",result:await this.request(t,r,n)}}catch(v){yield{type:"error",error:v instanceof X?v:new X(te.InternalError,String(v))}}return}let _;try{const v=await this.request(t,Kt,n);if(v.task)_=v.task.taskId,yield{type:"taskCreated",task:v.task};else throw new X(te.InternalError,"Task creation did not return a task");for(;;){const b=await this.getTask({taskId:_},n);if(yield{type:"taskStatus",task:b},ut(b.status)){b.status==="completed"?yield{type:"result",result:await this.getTaskResult({taskId:_},r,n)}:b.status==="failed"?yield{type:"error",error:new X(te.InternalError,`Task ${_} failed`)}:b.status==="cancelled"&&(yield{type:"error",error:new X(te.InternalError,`Task ${_} was cancelled`)});return}if(b.status==="input_required"){yield{type:"result",result:await this.getTaskResult({taskId:_},r,n)};return}const i=(u=(s=b.pollInterval)!==null&&s!==void 0?s:(a=this._options)===null||a===void 0?void 0:a.defaultTaskPollInterval)!==null&&u!==void 0?u:1e3;await new Promise(o=>setTimeout(o,i)),(d=n==null?void 0:n.signal)===null||d===void 0||d.throwIfAborted()}}catch(v){yield{type:"error",error:v instanceof X?v:new X(te.InternalError,String(v))}}}request(t,r,n){const{relatedRequestId:s,resumptionToken:a,onresumptiontoken:u,task:d,relatedTask:p}=n??{};return new Promise((_,v)=>{var b,i,o,c,f,l,m;const h=T=>{v(T)};if(!this._transport){h(new Error("Not connected"));return}if(((b=this._options)===null||b===void 0?void 0:b.enforceStrictCapabilities)===!0)try{this.assertCapabilityForMethod(t.method),d&&this.assertTaskCapability(t.method)}catch(T){h(T);return}(i=n==null?void 0:n.signal)===null||i===void 0||i.throwIfAborted();const g=this._requestMessageId++,w={...t,jsonrpc:"2.0",id:g};n!=null&&n.onprogress&&(this._progressHandlers.set(g,n.onprogress),w.params={...t.params,_meta:{...((o=t.params)===null||o===void 0?void 0:o._meta)||{},progressToken:g}}),d&&(w.params={...w.params,task:d}),p&&(w.params={...w.params,_meta:{...((c=w.params)===null||c===void 0?void 0:c._meta)||{},[et]:p}});const y=T=>{var P;this._responseHandlers.delete(g),this._progressHandlers.delete(g),this._cleanupTimeout(g),(P=this._transport)===null||P===void 0||P.send({jsonrpc:"2.0",method:"notifications/cancelled",params:{requestId:g,reason:String(T)}},{relatedRequestId:s,resumptionToken:a,onresumptiontoken:u}).catch(z=>this._onerror(new Error(`Failed to send cancellation: ${z}`)));const $=T instanceof X?T:new X(te.RequestTimeout,String(T));v($)};this._responseHandlers.set(g,T=>{var P;if(!(!((P=n==null?void 0:n.signal)===null||P===void 0)&&P.aborted)){if(T instanceof Error)return v(T);try{const $=rt(r,T.result);$.success?_($.data):v($.error)}catch($){v($)}}}),(f=n==null?void 0:n.signal)===null||f===void 0||f.addEventListener("abort",()=>{var T;y((T=n==null?void 0:n.signal)===null||T===void 0?void 0:T.reason)});const E=(l=n==null?void 0:n.timeout)!==null&&l!==void 0?l:wp,k=()=>y(X.fromError(te.RequestTimeout,"Request timed out",{timeout:E}));this._setupTimeout(g,E,n==null?void 0:n.maxTotalTimeout,k,(m=n==null?void 0:n.resetTimeoutOnProgress)!==null&&m!==void 0?m:!1);const C=p==null?void 0:p.taskId;if(C){const T=P=>{const $=this._responseHandlers.get(g);$?$(P):this._onerror(new Error(`Response handler missing for side-channeled request ${g}`))};this._requestResolvers.set(g,T),this._enqueueTaskMessage(C,{type:"request",message:w,timestamp:Date.now()}).catch(P=>{this._cleanupTimeout(g),v(P)})}else this._transport.send(w,{relatedRequestId:s,resumptionToken:a,onresumptiontoken:u}).catch(T=>{this._cleanupTimeout(g),v(T)})})}async getTask(t,r){return this.request({method:"tasks/get",params:t},Pi,r)}async getTaskResult(t,r,n){return this.request({method:"tasks/result",params:t},r,n)}async listTasks(t,r){return this.request({method:"tasks/list",params:t},Ci,r)}async cancelTask(t,r){return this.request({method:"tasks/cancel",params:t},af,r)}async notification(t,r){var n,s,a,u,d;if(!this._transport)throw new Error("Not connected");this.assertNotificationCapability(t.method);const p=(n=r==null?void 0:r.relatedTask)===null||n===void 0?void 0:n.taskId;if(p){const i={...t,jsonrpc:"2.0",params:{...t.params,_meta:{...((s=t.params)===null||s===void 0?void 0:s._meta)||{},[et]:r.relatedTask}}};await this._enqueueTaskMessage(p,{type:"notification",message:i,timestamp:Date.now()});return}if(((u=(a=this._options)===null||a===void 0?void 0:a.debouncedNotificationMethods)!==null&&u!==void 0?u:[]).includes(t.method)&&!t.params&&!(r!=null&&r.relatedRequestId)&&!(r!=null&&r.relatedTask)){if(this._pendingDebouncedNotifications.has(t.method))return;this._pendingDebouncedNotifications.add(t.method),Promise.resolve().then(()=>{var i,o;if(this._pendingDebouncedNotifications.delete(t.method),!this._transport)return;let c={...t,jsonrpc:"2.0"};r!=null&&r.relatedTask&&(c={...c,params:{...c.params,_meta:{...((i=c.params)===null||i===void 0?void 0:i._meta)||{},[et]:r.relatedTask}}}),(o=this._transport)===null||o===void 0||o.send(c,r).catch(f=>this._onerror(f))});return}let b={...t,jsonrpc:"2.0"};r!=null&&r.relatedTask&&(b={...b,params:{...b.params,_meta:{...((d=b.params)===null||d===void 0?void 0:d._meta)||{},[et]:r.relatedTask}}}),await this._transport.send(b,r)}setRequestHandler(t,r){const n=vo(t);this.assertRequestHandlerCapability(n),this._requestHandlers.set(n,(s,a)=>{const u=yo(t,s);return Promise.resolve(r(u,a))})}removeRequestHandler(t){this._requestHandlers.delete(t)}assertCanSetRequestHandler(t){if(this._requestHandlers.has(t))throw new Error(`A request handler for ${t} already exists, which would be overridden`)}setNotificationHandler(t,r){const n=vo(t);this._notificationHandlers.set(n,s=>{const a=yo(t,s);return Promise.resolve(r(a))})}removeNotificationHandler(t){this._notificationHandlers.delete(t)}_cleanupTaskProgressHandler(t){const r=this._taskProgressTokens.get(t);r!==void 0&&(this._progressHandlers.delete(r),this._taskProgressTokens.delete(t))}async _enqueueTaskMessage(t,r,n){var s;if(!this._taskStore||!this._taskMessageQueue)throw new Error("Cannot enqueue task message: taskStore and taskMessageQueue are not configured");const a=(s=this._options)===null||s===void 0?void 0:s.maxTaskQueueSize;await this._taskMessageQueue.enqueue(t,r,n,a)}async _clearTaskQueue(t,r){if(this._taskMessageQueue){const n=await this._taskMessageQueue.dequeueAll(t,r);for(const s of n)if(s.type==="request"&&_o(s.message)){const a=s.message.id,u=this._requestResolvers.get(a);u?(u(new X(te.InternalError,"Task cancelled or completed")),this._requestResolvers.delete(a)):this._onerror(new Error(`Resolver missing for request ${a} during task ${t} cleanup`))}}}async _waitForTaskUpdate(t,r){var n,s,a;let u=(s=(n=this._options)===null||n===void 0?void 0:n.defaultTaskPollInterval)!==null&&s!==void 0?s:1e3;try{const d=await((a=this._taskStore)===null||a===void 0?void 0:a.getTask(t));d!=null&&d.pollInterval&&(u=d.pollInterval)}catch{}return new Promise((d,p)=>{if(r.aborted){p(new X(te.InvalidRequest,"Request cancelled"));return}const _=setTimeout(d,u);r.addEventListener("abort",()=>{clearTimeout(_),p(new X(te.InvalidRequest,"Request cancelled"))},{once:!0})})}requestTaskStore(t,r){const n=this._taskStore;if(!n)throw new Error("No task store configured");return{createTask:async s=>{if(!t)throw new Error("No request provided");return await n.createTask(s,t.id,{method:t.method,params:t.params},r)},getTask:async s=>{const a=await n.getTask(s,r);if(!a)throw new X(te.InvalidParams,"Failed to retrieve task: Task not found");return a},storeTaskResult:async(s,a,u)=>{await n.storeTaskResult(s,a,u,r);const d=await n.getTask(s,r);if(d){const p=Qr.parse({method:"notifications/tasks/status",params:d});await this.notification(p),ut(d.status)&&this._cleanupTaskProgressHandler(s)}},getTaskResult:s=>n.getTaskResult(s,r),updateTaskStatus:async(s,a,u)=>{const d=await n.getTask(s,r);if(!d)throw new X(te.InvalidParams,`Task "${s}" not found - it may have been cleaned up`);if(ut(d.status))throw new X(te.InvalidParams,`Cannot update task "${s}" from terminal status "${d.status}" to "${a}". Terminal states (completed, failed, cancelled) cannot transition to other states.`);await n.updateTaskStatus(s,a,u,r);const p=await n.getTask(s,r);if(p){const _=Qr.parse({method:"notifications/tasks/status",params:p});await this.notification(_),ut(p.status)&&this._cleanupTaskProgressHandler(s)}},listTasks:s=>n.listTasks(s,r)}}}function wo(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)}function Ep(e,t){const r={...e};for(const n in t){const s=n,a=t[s];if(a===void 0)continue;const u=r[s];wo(u)&&wo(a)?r[s]={...u,...a}:r[s]=a}return r}var ir={exports:{}},Tn={},Je={},lt={},In={},Rn={},Pn={},bo;function en(){return bo||(bo=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.regexpCode=e.getEsmExportName=e.getProperty=e.safeStringify=e.stringify=e.strConcat=e.addCodeArg=e.str=e._=e.nil=e._Code=e.Name=e.IDENTIFIER=e._CodeOrName=void 0;class t{}e._CodeOrName=t,e.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class r extends t{constructor(h){if(super(),!e.IDENTIFIER.test(h))throw new Error("CodeGen: name must be a valid identifier");this.str=h}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}e.Name=r;class n extends t{constructor(h){super(),this._items=typeof h=="string"?[h]:h}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;const h=this._items[0];return h===""||h==='""'}get str(){var h;return(h=this._str)!==null&&h!==void 0?h:this._str=this._items.reduce((g,w)=>`${g}${w}`,"")}get names(){var h;return(h=this._names)!==null&&h!==void 0?h:this._names=this._items.reduce((g,w)=>(w instanceof r&&(g[w.str]=(g[w.str]||0)+1),g),{})}}e._Code=n,e.nil=new n("");function s(m,...h){const g=[m[0]];let w=0;for(;w<h.length;)d(g,h[w]),g.push(m[++w]);return new n(g)}e._=s;const a=new n("+");function u(m,...h){const g=[o(m[0])];let w=0;for(;w<h.length;)g.push(a),d(g,h[w]),g.push(a,o(m[++w]));return p(g),new n(g)}e.str=u;function d(m,h){h instanceof n?m.push(...h._items):h instanceof r?m.push(h):m.push(b(h))}e.addCodeArg=d;function p(m){let h=1;for(;h<m.length-1;){if(m[h]===a){const g=_(m[h-1],m[h+1]);if(g!==void 0){m.splice(h-1,3,g);continue}m[h++]="+"}h++}}function _(m,h){if(h==='""')return m;if(m==='""')return h;if(typeof m=="string")return h instanceof r||m[m.length-1]!=='"'?void 0:typeof h!="string"?`${m.slice(0,-1)}${h}"`:h[0]==='"'?m.slice(0,-1)+h.slice(1):void 0;if(typeof h=="string"&&h[0]==='"'&&!(m instanceof r))return`"${m}${h.slice(1)}`}function v(m,h){return h.emptyStr()?m:m.emptyStr()?h:u`${m}${h}`}e.strConcat=v;function b(m){return typeof m=="number"||typeof m=="boolean"||m===null?m:o(Array.isArray(m)?m.join(","):m)}function i(m){return new n(o(m))}e.stringify=i;function o(m){return JSON.stringify(m).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}e.safeStringify=o;function c(m){return typeof m=="string"&&e.IDENTIFIER.test(m)?new n(`.${m}`):s`[${m}]`}e.getProperty=c;function f(m){if(typeof m=="string"&&e.IDENTIFIER.test(m))return new n(`${m}`);throw new Error(`CodeGen: invalid export name: ${m}, use explicit $id name mapping`)}e.getEsmExportName=f;function l(m){return new n(m.toString())}e.regexpCode=l})(Pn)),Pn}var Nn={},Eo;function $o(){return Eo||(Eo=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ValueScope=e.ValueScopeName=e.Scope=e.varKinds=e.UsedValueState=void 0;const t=en();class r extends Error{constructor(_){super(`CodeGen: "code" for ${_} not defined`),this.value=_.value}}var n;(function(p){p[p.Started=0]="Started",p[p.Completed=1]="Completed"})(n||(e.UsedValueState=n={})),e.varKinds={const:new t.Name("const"),let:new t.Name("let"),var:new t.Name("var")};class s{constructor({prefixes:_,parent:v}={}){this._names={},this._prefixes=_,this._parent=v}toName(_){return _ instanceof t.Name?_:this.name(_)}name(_){return new t.Name(this._newName(_))}_newName(_){const v=this._names[_]||this._nameGroup(_);return`${_}${v.index++}`}_nameGroup(_){var v,b;if(!((b=(v=this._parent)===null||v===void 0?void 0:v._prefixes)===null||b===void 0)&&b.has(_)||this._prefixes&&!this._prefixes.has(_))throw new Error(`CodeGen: prefix "${_}" is not allowed in this scope`);return this._names[_]={prefix:_,index:0}}}e.Scope=s;class a extends t.Name{constructor(_,v){super(v),this.prefix=_}setValue(_,{property:v,itemIndex:b}){this.value=_,this.scopePath=(0,t._)`.${new t.Name(v)}[${b}]`}}e.ValueScopeName=a;const u=(0,t._)`\n`;class d extends s{constructor(_){super(_),this._values={},this._scope=_.scope,this.opts={..._,_n:_.lines?u:t.nil}}get(){return this._scope}name(_){return new a(_,this._newName(_))}value(_,v){var b;if(v.ref===void 0)throw new Error("CodeGen: ref must be passed in value");const i=this.toName(_),{prefix:o}=i,c=(b=v.key)!==null&&b!==void 0?b:v.ref;let f=this._values[o];if(f){const h=f.get(c);if(h)return h}else f=this._values[o]=new Map;f.set(c,i);const l=this._scope[o]||(this._scope[o]=[]),m=l.length;return l[m]=v.ref,i.setValue(v,{property:o,itemIndex:m}),i}getValue(_,v){const b=this._values[_];if(b)return b.get(v)}scopeRefs(_,v=this._values){return this._reduceValues(v,b=>{if(b.scopePath===void 0)throw new Error(`CodeGen: name "${b}" has no value`);return(0,t._)`${_}${b.scopePath}`})}scopeCode(_=this._values,v,b){return this._reduceValues(_,i=>{if(i.value===void 0)throw new Error(`CodeGen: name "${i}" has no value`);return i.value.code},v,b)}_reduceValues(_,v,b={},i){let o=t.nil;for(const c in _){const f=_[c];if(!f)continue;const l=b[c]=b[c]||new Map;f.forEach(m=>{if(l.has(m))return;l.set(m,n.Started);let h=v(m);if(h){const g=this.opts.es5?e.varKinds.var:e.varKinds.const;o=(0,t._)`${o}${g} ${m} = ${h};${this.opts._n}`}else if(h=i==null?void 0:i(m))o=(0,t._)`${o}${h}${this.opts._n}`;else throw new r(m);l.set(m,n.Completed)})}return o}}e.ValueScope=d})(Nn)),Nn}var So;function ne(){return So||(So=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.or=e.and=e.not=e.CodeGen=e.operators=e.varKinds=e.ValueScopeName=e.ValueScope=e.Scope=e.Name=e.regexpCode=e.stringify=e.getProperty=e.nil=e.strConcat=e.str=e._=void 0;const t=en(),r=$o();var n=en();Object.defineProperty(e,"_",{enumerable:!0,get:function(){return n._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return n.str}}),Object.defineProperty(e,"strConcat",{enumerable:!0,get:function(){return n.strConcat}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return n.nil}}),Object.defineProperty(e,"getProperty",{enumerable:!0,get:function(){return n.getProperty}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return n.stringify}}),Object.defineProperty(e,"regexpCode",{enumerable:!0,get:function(){return n.regexpCode}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return n.Name}});var s=$o();Object.defineProperty(e,"Scope",{enumerable:!0,get:function(){return s.Scope}}),Object.defineProperty(e,"ValueScope",{enumerable:!0,get:function(){return s.ValueScope}}),Object.defineProperty(e,"ValueScopeName",{enumerable:!0,get:function(){return s.ValueScopeName}}),Object.defineProperty(e,"varKinds",{enumerable:!0,get:function(){return s.varKinds}}),e.operators={GT:new t._Code(">"),GTE:new t._Code(">="),LT:new t._Code("<"),LTE:new t._Code("<="),EQ:new t._Code("==="),NEQ:new t._Code("!=="),NOT:new t._Code("!"),OR:new t._Code("||"),AND:new t._Code("&&"),ADD:new t._Code("+")};class a{optimizeNodes(){return this}optimizeNames(S,I){return this}}class u extends a{constructor(S,I,q){super(),this.varKind=S,this.name=I,this.rhs=q}render({es5:S,_n:I}){const q=S?r.varKinds.var:this.varKind,K=this.rhs===void 0?"":` = ${this.rhs}`;return`${q} ${this.name}${K};`+I}optimizeNames(S,I){if(S[this.name.str])return this.rhs&&(this.rhs=Z(this.rhs,S,I)),this}get names(){return this.rhs instanceof t._CodeOrName?this.rhs.names:{}}}class d extends a{constructor(S,I,q){super(),this.lhs=S,this.rhs=I,this.sideEffects=q}render({_n:S}){return`${this.lhs} = ${this.rhs};`+S}optimizeNames(S,I){if(!(this.lhs instanceof t.Name&&!S[this.lhs.str]&&!this.sideEffects))return this.rhs=Z(this.rhs,S,I),this}get names(){const S=this.lhs instanceof t.Name?{}:{...this.lhs.names};return L(S,this.rhs)}}class p extends d{constructor(S,I,q,K){super(S,q,K),this.op=I}render({_n:S}){return`${this.lhs} ${this.op}= ${this.rhs};`+S}}class _ extends a{constructor(S){super(),this.label=S,this.names={}}render({_n:S}){return`${this.label}:`+S}}class v extends a{constructor(S){super(),this.label=S,this.names={}}render({_n:S}){return`break${this.label?` ${this.label}`:""};`+S}}class b extends a{constructor(S){super(),this.error=S}render({_n:S}){return`throw ${this.error};`+S}get names(){return this.error.names}}class i extends a{constructor(S){super(),this.code=S}render({_n:S}){return`${this.code};`+S}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(S,I){return this.code=Z(this.code,S,I),this}get names(){return this.code instanceof t._CodeOrName?this.code.names:{}}}class o extends a{constructor(S=[]){super(),this.nodes=S}render(S){return this.nodes.reduce((I,q)=>I+q.render(S),"")}optimizeNodes(){const{nodes:S}=this;let I=S.length;for(;I--;){const q=S[I].optimizeNodes();Array.isArray(q)?S.splice(I,1,...q):q?S[I]=q:S.splice(I,1)}return S.length>0?this:void 0}optimizeNames(S,I){const{nodes:q}=this;let K=q.length;for(;K--;){const Y=q[K];Y.optimizeNames(S,I)||(Q(S,Y.names),q.splice(K,1))}return q.length>0?this:void 0}get names(){return this.nodes.reduce((S,I)=>z(S,I.names),{})}}class c extends o{render(S){return"{"+S._n+super.render(S)+"}"+S._n}}class f extends o{}class l extends c{}l.kind="else";class m extends c{constructor(S,I){super(I),this.condition=S}render(S){let I=`if(${this.condition})`+super.render(S);return this.else&&(I+="else "+this.else.render(S)),I}optimizeNodes(){super.optimizeNodes();const S=this.condition;if(S===!0)return this.nodes;let I=this.else;if(I){const q=I.optimizeNodes();I=this.else=Array.isArray(q)?new l(q):q}if(I)return S===!1?I instanceof m?I:I.nodes:this.nodes.length?this:new m(ae(S),I instanceof m?[I]:I.nodes);if(!(S===!1||!this.nodes.length))return this}optimizeNames(S,I){var q;if(this.else=(q=this.else)===null||q===void 0?void 0:q.optimizeNames(S,I),!!(super.optimizeNames(S,I)||this.else))return this.condition=Z(this.condition,S,I),this}get names(){const S=super.names;return L(S,this.condition),this.else&&z(S,this.else.names),S}}m.kind="if";class h extends c{}h.kind="for";class g extends h{constructor(S){super(),this.iteration=S}render(S){return`for(${this.iteration})`+super.render(S)}optimizeNames(S,I){if(super.optimizeNames(S,I))return this.iteration=Z(this.iteration,S,I),this}get names(){return z(super.names,this.iteration.names)}}class w extends h{constructor(S,I,q,K){super(),this.varKind=S,this.name=I,this.from=q,this.to=K}render(S){const I=S.es5?r.varKinds.var:this.varKind,{name:q,from:K,to:Y}=this;return`for(${I} ${q}=${K}; ${q}<${Y}; ${q}++)`+super.render(S)}get names(){const S=L(super.names,this.from);return L(S,this.to)}}class y extends h{constructor(S,I,q,K){super(),this.loop=S,this.varKind=I,this.name=q,this.iterable=K}render(S){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(S)}optimizeNames(S,I){if(super.optimizeNames(S,I))return this.iterable=Z(this.iterable,S,I),this}get names(){return z(super.names,this.iterable.names)}}class E extends c{constructor(S,I,q){super(),this.name=S,this.args=I,this.async=q}render(S){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(S)}}E.kind="func";class k extends o{render(S){return"return "+super.render(S)}}k.kind="return";class C extends c{render(S){let I="try"+super.render(S);return this.catch&&(I+=this.catch.render(S)),this.finally&&(I+=this.finally.render(S)),I}optimizeNodes(){var S,I;return super.optimizeNodes(),(S=this.catch)===null||S===void 0||S.optimizeNodes(),(I=this.finally)===null||I===void 0||I.optimizeNodes(),this}optimizeNames(S,I){var q,K;return super.optimizeNames(S,I),(q=this.catch)===null||q===void 0||q.optimizeNames(S,I),(K=this.finally)===null||K===void 0||K.optimizeNames(S,I),this}get names(){const S=super.names;return this.catch&&z(S,this.catch.names),this.finally&&z(S,this.finally.names),S}}class T extends c{constructor(S){super(),this.error=S}render(S){return`catch(${this.error})`+super.render(S)}}T.kind="catch";class P extends c{render(S){return"finally"+super.render(S)}}P.kind="finally";class ${constructor(S,I={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...I,_n:I.lines?`
`:""},this._extScope=S,this._scope=new r.Scope({parent:S}),this._nodes=[new f]}toString(){return this._root.render(this.opts)}name(S){return this._scope.name(S)}scopeName(S){return this._extScope.name(S)}scopeValue(S,I){const q=this._extScope.value(S,I);return(this._values[q.prefix]||(this._values[q.prefix]=new Set)).add(q),q}getScopeValue(S,I){return this._extScope.getValue(S,I)}scopeRefs(S){return this._extScope.scopeRefs(S,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(S,I,q,K){const Y=this._scope.toName(I);return q!==void 0&&K&&(this._constants[Y.str]=q),this._leafNode(new u(S,Y,q)),Y}const(S,I,q){return this._def(r.varKinds.const,S,I,q)}let(S,I,q){return this._def(r.varKinds.let,S,I,q)}var(S,I,q){return this._def(r.varKinds.var,S,I,q)}assign(S,I,q){return this._leafNode(new d(S,I,q))}add(S,I){return this._leafNode(new p(S,e.operators.ADD,I))}code(S){return typeof S=="function"?S():S!==t.nil&&this._leafNode(new i(S)),this}object(...S){const I=["{"];for(const[q,K]of S)I.length>1&&I.push(","),I.push(q),(q!==K||this.opts.es5)&&(I.push(":"),(0,t.addCodeArg)(I,K));return I.push("}"),new t._Code(I)}if(S,I,q){if(this._blockNode(new m(S)),I&&q)this.code(I).else().code(q).endIf();else if(I)this.code(I).endIf();else if(q)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(S){return this._elseNode(new m(S))}else(){return this._elseNode(new l)}endIf(){return this._endBlockNode(m,l)}_for(S,I){return this._blockNode(S),I&&this.code(I).endFor(),this}for(S,I){return this._for(new g(S),I)}forRange(S,I,q,K,Y=this.opts.es5?r.varKinds.var:r.varKinds.let){const ue=this._scope.toName(S);return this._for(new w(Y,ue,I,q),()=>K(ue))}forOf(S,I,q,K=r.varKinds.const){const Y=this._scope.toName(S);if(this.opts.es5){const ue=I instanceof t.Name?I:this.var("_arr",I);return this.forRange("_i",0,(0,t._)`${ue}.length`,se=>{this.var(Y,(0,t._)`${ue}[${se}]`),q(Y)})}return this._for(new y("of",K,Y,I),()=>q(Y))}forIn(S,I,q,K=this.opts.es5?r.varKinds.var:r.varKinds.const){if(this.opts.ownProperties)return this.forOf(S,(0,t._)`Object.keys(${I})`,q);const Y=this._scope.toName(S);return this._for(new y("in",K,Y,I),()=>q(Y))}endFor(){return this._endBlockNode(h)}label(S){return this._leafNode(new _(S))}break(S){return this._leafNode(new v(S))}return(S){const I=new k;if(this._blockNode(I),this.code(S),I.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(k)}try(S,I,q){if(!I&&!q)throw new Error('CodeGen: "try" without "catch" and "finally"');const K=new C;if(this._blockNode(K),this.code(S),I){const Y=this.name("e");this._currNode=K.catch=new T(Y),I(Y)}return q&&(this._currNode=K.finally=new P,this.code(q)),this._endBlockNode(T,P)}throw(S){return this._leafNode(new b(S))}block(S,I){return this._blockStarts.push(this._nodes.length),S&&this.code(S).endBlock(I),this}endBlock(S){const I=this._blockStarts.pop();if(I===void 0)throw new Error("CodeGen: not in self-balancing block");const q=this._nodes.length-I;if(q<0||S!==void 0&&q!==S)throw new Error(`CodeGen: wrong number of nodes: ${q} vs ${S} expected`);return this._nodes.length=I,this}func(S,I=t.nil,q,K){return this._blockNode(new E(S,I,q)),K&&this.code(K).endFunc(),this}endFunc(){return this._endBlockNode(E)}optimize(S=1){for(;S-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(S){return this._currNode.nodes.push(S),this}_blockNode(S){this._currNode.nodes.push(S),this._nodes.push(S)}_endBlockNode(S,I){const q=this._currNode;if(q instanceof S||I&&q instanceof I)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${I?`${S.kind}/${I.kind}`:S.kind}"`)}_elseNode(S){const I=this._currNode;if(!(I instanceof m))throw new Error('CodeGen: "else" without "if"');return this._currNode=I.else=S,this}get _root(){return this._nodes[0]}get _currNode(){const S=this._nodes;return S[S.length-1]}set _currNode(S){const I=this._nodes;I[I.length-1]=S}}e.CodeGen=$;function z(A,S){for(const I in S)A[I]=(A[I]||0)+(S[I]||0);return A}function L(A,S){return S instanceof t._CodeOrName?z(A,S.names):A}function Z(A,S,I){if(A instanceof t.Name)return q(A);if(!K(A))return A;return new t._Code(A._items.reduce((Y,ue)=>(ue instanceof t.Name&&(ue=q(ue)),ue instanceof t._Code?Y.push(...ue._items):Y.push(ue),Y),[]));function q(Y){const ue=I[Y.str];return ue===void 0||S[Y.str]!==1?Y:(delete S[Y.str],ue)}function K(Y){return Y instanceof t._Code&&Y._items.some(ue=>ue instanceof t.Name&&S[ue.str]===1&&I[ue.str]!==void 0)}}function Q(A,S){for(const I in S)A[I]=(A[I]||0)-(S[I]||0)}function ae(A){return typeof A=="boolean"||typeof A=="number"||A===null?!A:(0,t._)`!${j(A)}`}e.not=ae;const le=N(e.operators.AND);function ee(...A){return A.reduce(le)}e.and=ee;const he=N(e.operators.OR);function M(...A){return A.reduce(he)}e.or=M;function N(A){return(S,I)=>S===t.nil?I:I===t.nil?S:(0,t._)`${j(S)} ${A} ${j(I)}`}function j(A){return A instanceof t.Name?A:(0,t._)`(${A})`}})(Rn)),Rn}var re={},ko;function ce(){if(ko)return re;ko=1,Object.defineProperty(re,"__esModule",{value:!0}),re.checkStrictMode=re.getErrorPath=re.Type=re.useFunc=re.setEvaluated=re.evaluatedPropsToName=re.mergeEvaluated=re.eachItem=re.unescapeJsonPointer=re.escapeJsonPointer=re.escapeFragment=re.unescapeFragment=re.schemaRefOrVal=re.schemaHasRulesButRef=re.schemaHasRules=re.checkUnknownRules=re.alwaysValidSchema=re.toHash=void 0;const e=ne(),t=en();function r(y){const E={};for(const k of y)E[k]=!0;return E}re.toHash=r;function n(y,E){return typeof E=="boolean"?E:Object.keys(E).length===0?!0:(s(y,E),!a(E,y.self.RULES.all))}re.alwaysValidSchema=n;function s(y,E=y.schema){const{opts:k,self:C}=y;if(!k.strictSchema||typeof E=="boolean")return;const T=C.RULES.keywords;for(const P in E)T[P]||w(y,`unknown keyword: "${P}"`)}re.checkUnknownRules=s;function a(y,E){if(typeof y=="boolean")return!y;for(const k in y)if(E[k])return!0;return!1}re.schemaHasRules=a;function u(y,E){if(typeof y=="boolean")return!y;for(const k in y)if(k!=="$ref"&&E.all[k])return!0;return!1}re.schemaHasRulesButRef=u;function d({topSchemaRef:y,schemaPath:E},k,C,T){if(!T){if(typeof k=="number"||typeof k=="boolean")return k;if(typeof k=="string")return(0,e._)`${k}`}return(0,e._)`${y}${E}${(0,e.getProperty)(C)}`}re.schemaRefOrVal=d;function p(y){return b(decodeURIComponent(y))}re.unescapeFragment=p;function _(y){return encodeURIComponent(v(y))}re.escapeFragment=_;function v(y){return typeof y=="number"?`${y}`:y.replace(/~/g,"~0").replace(/\//g,"~1")}re.escapeJsonPointer=v;function b(y){return y.replace(/~1/g,"/").replace(/~0/g,"~")}re.unescapeJsonPointer=b;function i(y,E){if(Array.isArray(y))for(const k of y)E(k);else E(y)}re.eachItem=i;function o({mergeNames:y,mergeToName:E,mergeValues:k,resultToName:C}){return(T,P,$,z)=>{const L=$===void 0?P:$ instanceof e.Name?(P instanceof e.Name?y(T,P,$):E(T,P,$),$):P instanceof e.Name?(E(T,$,P),P):k(P,$);return z===e.Name&&!(L instanceof e.Name)?C(T,L):L}}re.mergeEvaluated={props:o({mergeNames:(y,E,k)=>y.if((0,e._)`${k} !== true && ${E} !== undefined`,()=>{y.if((0,e._)`${E} === true`,()=>y.assign(k,!0),()=>y.assign(k,(0,e._)`${k} || {}`).code((0,e._)`Object.assign(${k}, ${E})`))}),mergeToName:(y,E,k)=>y.if((0,e._)`${k} !== true`,()=>{E===!0?y.assign(k,!0):(y.assign(k,(0,e._)`${k} || {}`),f(y,k,E))}),mergeValues:(y,E)=>y===!0?!0:{...y,...E},resultToName:c}),items:o({mergeNames:(y,E,k)=>y.if((0,e._)`${k} !== true && ${E} !== undefined`,()=>y.assign(k,(0,e._)`${E} === true ? true : ${k} > ${E} ? ${k} : ${E}`)),mergeToName:(y,E,k)=>y.if((0,e._)`${k} !== true`,()=>y.assign(k,E===!0?!0:(0,e._)`${k} > ${E} ? ${k} : ${E}`)),mergeValues:(y,E)=>y===!0?!0:Math.max(y,E),resultToName:(y,E)=>y.var("items",E)})};function c(y,E){if(E===!0)return y.var("props",!0);const k=y.var("props",(0,e._)`{}`);return E!==void 0&&f(y,k,E),k}re.evaluatedPropsToName=c;function f(y,E,k){Object.keys(k).forEach(C=>y.assign((0,e._)`${E}${(0,e.getProperty)(C)}`,!0))}re.setEvaluated=f;const l={};function m(y,E){return y.scopeValue("func",{ref:E,code:l[E.code]||(l[E.code]=new t._Code(E.code))})}re.useFunc=m;var h;(function(y){y[y.Num=0]="Num",y[y.Str=1]="Str"})(h||(re.Type=h={}));function g(y,E,k){if(y instanceof e.Name){const C=E===h.Num;return k?C?(0,e._)`"[" + ${y} + "]"`:(0,e._)`"['" + ${y} + "']"`:C?(0,e._)`"/" + ${y}`:(0,e._)`"/" + ${y}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return k?(0,e.getProperty)(y).toString():"/"+v(y)}re.getErrorPath=g;function w(y,E,k=y.opts.strictSchema){if(k){if(E=`strict mode: ${E}`,k===!0)throw new Error(E);y.self.logger.warn(E)}}return re.checkStrictMode=w,re}var or={},To;function ct(){if(To)return or;To=1,Object.defineProperty(or,"__esModule",{value:!0});const e=ne(),t={data:new e.Name("data"),valCxt:new e.Name("valCxt"),instancePath:new e.Name("instancePath"),parentData:new e.Name("parentData"),parentDataProperty:new e.Name("parentDataProperty"),rootData:new e.Name("rootData"),dynamicAnchors:new e.Name("dynamicAnchors"),vErrors:new e.Name("vErrors"),errors:new e.Name("errors"),this:new e.Name("this"),self:new e.Name("self"),scope:new e.Name("scope"),json:new e.Name("json"),jsonPos:new e.Name("jsonPos"),jsonLen:new e.Name("jsonLen"),jsonPart:new e.Name("jsonPart")};return or.default=t,or}var Io;function _n(){return Io||(Io=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.extendErrors=e.resetErrorsCount=e.reportExtraError=e.reportError=e.keyword$DataError=e.keywordError=void 0;const t=ne(),r=ce(),n=ct();e.keywordError={message:({keyword:l})=>(0,t.str)`must pass "${l}" keyword validation`},e.keyword$DataError={message:({keyword:l,schemaType:m})=>m?(0,t.str)`"${l}" keyword must be ${m} ($data)`:(0,t.str)`"${l}" keyword is invalid ($data)`};function s(l,m=e.keywordError,h,g){const{it:w}=l,{gen:y,compositeRule:E,allErrors:k}=w,C=b(l,m,h);g??(E||k)?p(y,C):_(w,(0,t._)`[${C}]`)}e.reportError=s;function a(l,m=e.keywordError,h){const{it:g}=l,{gen:w,compositeRule:y,allErrors:E}=g,k=b(l,m,h);p(w,k),y||E||_(g,n.default.vErrors)}e.reportExtraError=a;function u(l,m){l.assign(n.default.errors,m),l.if((0,t._)`${n.default.vErrors} !== null`,()=>l.if(m,()=>l.assign((0,t._)`${n.default.vErrors}.length`,m),()=>l.assign(n.default.vErrors,null)))}e.resetErrorsCount=u;function d({gen:l,keyword:m,schemaValue:h,data:g,errsCount:w,it:y}){if(w===void 0)throw new Error("ajv implementation error");const E=l.name("err");l.forRange("i",w,n.default.errors,k=>{l.const(E,(0,t._)`${n.default.vErrors}[${k}]`),l.if((0,t._)`${E}.instancePath === undefined`,()=>l.assign((0,t._)`${E}.instancePath`,(0,t.strConcat)(n.default.instancePath,y.errorPath))),l.assign((0,t._)`${E}.schemaPath`,(0,t.str)`${y.errSchemaPath}/${m}`),y.opts.verbose&&(l.assign((0,t._)`${E}.schema`,h),l.assign((0,t._)`${E}.data`,g))})}e.extendErrors=d;function p(l,m){const h=l.const("err",m);l.if((0,t._)`${n.default.vErrors} === null`,()=>l.assign(n.default.vErrors,(0,t._)`[${h}]`),(0,t._)`${n.default.vErrors}.push(${h})`),l.code((0,t._)`${n.default.errors}++`)}function _(l,m){const{gen:h,validateName:g,schemaEnv:w}=l;w.$async?h.throw((0,t._)`new ${l.ValidationError}(${m})`):(h.assign((0,t._)`${g}.errors`,m),h.return(!1))}const v={keyword:new t.Name("keyword"),schemaPath:new t.Name("schemaPath"),params:new t.Name("params"),propertyName:new t.Name("propertyName"),message:new t.Name("message"),schema:new t.Name("schema"),parentSchema:new t.Name("parentSchema")};function b(l,m,h){const{createErrors:g}=l.it;return g===!1?(0,t._)`{}`:i(l,m,h)}function i(l,m,h={}){const{gen:g,it:w}=l,y=[o(w,h),c(l,h)];return f(l,m,y),g.object(...y)}function o({errorPath:l},{instancePath:m}){const h=m?(0,t.str)`${l}${(0,r.getErrorPath)(m,r.Type.Str)}`:l;return[n.default.instancePath,(0,t.strConcat)(n.default.instancePath,h)]}function c({keyword:l,it:{errSchemaPath:m}},{schemaPath:h,parentSchema:g}){let w=g?m:(0,t.str)`${m}/${l}`;return h&&(w=(0,t.str)`${w}${(0,r.getErrorPath)(h,r.Type.Str)}`),[v.schemaPath,w]}function f(l,{params:m,message:h},g){const{keyword:w,data:y,schemaValue:E,it:k}=l,{opts:C,propertyName:T,topSchemaRef:P,schemaPath:$}=k;g.push([v.keyword,w],[v.params,typeof m=="function"?m(l):m||(0,t._)`{}`]),C.messages&&g.push([v.message,typeof h=="function"?h(l):h]),C.verbose&&g.push([v.schema,E],[v.parentSchema,(0,t._)`${P}${$}`],[n.default.data,y]),T&&g.push([v.propertyName,T])}})(In)),In}var Ro;function $p(){if(Ro)return lt;Ro=1,Object.defineProperty(lt,"__esModule",{value:!0}),lt.boolOrEmptySchema=lt.topBoolOrEmptySchema=void 0;const e=_n(),t=ne(),r=ct(),n={message:"boolean schema is false"};function s(d){const{gen:p,schema:_,validateName:v}=d;_===!1?u(d,!1):typeof _=="object"&&_.$async===!0?p.return(r.default.data):(p.assign((0,t._)`${v}.errors`,null),p.return(!0))}lt.topBoolOrEmptySchema=s;function a(d,p){const{gen:_,schema:v}=d;v===!1?(_.var(p,!1),u(d)):_.var(p,!0)}lt.boolOrEmptySchema=a;function u(d,p){const{gen:_,data:v}=d,b={gen:_,keyword:"false schema",data:v,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:d};(0,e.reportError)(b,n,void 0,p)}return lt}var Re={},dt={},Po;function Qa(){if(Po)return dt;Po=1,Object.defineProperty(dt,"__esModule",{value:!0}),dt.getRules=dt.isJSONType=void 0;const e=["string","number","integer","boolean","null","object","array"],t=new Set(e);function r(s){return typeof s=="string"&&t.has(s)}dt.isJSONType=r;function n(){const s={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...s,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},s.number,s.string,s.array,s.object],post:{rules:[]},all:{},keywords:{}}}return dt.getRules=n,dt}var Ye={},No;function Xa(){if(No)return Ye;No=1,Object.defineProperty(Ye,"__esModule",{value:!0}),Ye.shouldUseRule=Ye.shouldUseGroup=Ye.schemaHasRulesForType=void 0;function e({schema:n,self:s},a){const u=s.RULES.types[a];return u&&u!==!0&&t(n,u)}Ye.schemaHasRulesForType=e;function t(n,s){return s.rules.some(a=>r(n,a))}Ye.shouldUseGroup=t;function r(n,s){var a;return n[s.keyword]!==void 0||((a=s.definition.implements)===null||a===void 0?void 0:a.some(u=>n[u]!==void 0))}return Ye.shouldUseRule=r,Ye}var Oo;function tn(){if(Oo)return Re;Oo=1,Object.defineProperty(Re,"__esModule",{value:!0}),Re.reportTypeError=Re.checkDataTypes=Re.checkDataType=Re.coerceAndCheckDataType=Re.getJSONTypes=Re.getSchemaTypes=Re.DataType=void 0;const e=Qa(),t=Xa(),r=_n(),n=ne(),s=ce();var a;(function(h){h[h.Correct=0]="Correct",h[h.Wrong=1]="Wrong"})(a||(Re.DataType=a={}));function u(h){const g=d(h.type);if(g.includes("null")){if(h.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!g.length&&h.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');h.nullable===!0&&g.push("null")}return g}Re.getSchemaTypes=u;function d(h){const g=Array.isArray(h)?h:h?[h]:[];if(g.every(e.isJSONType))return g;throw new Error("type must be JSONType or JSONType[]: "+g.join(","))}Re.getJSONTypes=d;function p(h,g){const{gen:w,data:y,opts:E}=h,k=v(g,E.coerceTypes),C=g.length>0&&!(k.length===0&&g.length===1&&(0,t.schemaHasRulesForType)(h,g[0]));if(C){const T=c(g,y,E.strictNumbers,a.Wrong);w.if(T,()=>{k.length?b(h,g,k):l(h)})}return C}Re.coerceAndCheckDataType=p;const _=new Set(["string","number","integer","boolean","null"]);function v(h,g){return g?h.filter(w=>_.has(w)||g==="array"&&w==="array"):[]}function b(h,g,w){const{gen:y,data:E,opts:k}=h,C=y.let("dataType",(0,n._)`typeof ${E}`),T=y.let("coerced",(0,n._)`undefined`);k.coerceTypes==="array"&&y.if((0,n._)`${C} == 'object' && Array.isArray(${E}) && ${E}.length == 1`,()=>y.assign(E,(0,n._)`${E}[0]`).assign(C,(0,n._)`typeof ${E}`).if(c(g,E,k.strictNumbers),()=>y.assign(T,E))),y.if((0,n._)`${T} !== undefined`);for(const $ of w)(_.has($)||$==="array"&&k.coerceTypes==="array")&&P($);y.else(),l(h),y.endIf(),y.if((0,n._)`${T} !== undefined`,()=>{y.assign(E,T),i(h,T)});function P($){switch($){case"string":y.elseIf((0,n._)`${C} == "number" || ${C} == "boolean"`).assign(T,(0,n._)`"" + ${E}`).elseIf((0,n._)`${E} === null`).assign(T,(0,n._)`""`);return;case"number":y.elseIf((0,n._)`${C} == "boolean" || ${E} === null
              || (${C} == "string" && ${E} && ${E} == +${E})`).assign(T,(0,n._)`+${E}`);return;case"integer":y.elseIf((0,n._)`${C} === "boolean" || ${E} === null
              || (${C} === "string" && ${E} && ${E} == +${E} && !(${E} % 1))`).assign(T,(0,n._)`+${E}`);return;case"boolean":y.elseIf((0,n._)`${E} === "false" || ${E} === 0 || ${E} === null`).assign(T,!1).elseIf((0,n._)`${E} === "true" || ${E} === 1`).assign(T,!0);return;case"null":y.elseIf((0,n._)`${E} === "" || ${E} === 0 || ${E} === false`),y.assign(T,null);return;case"array":y.elseIf((0,n._)`${C} === "string" || ${C} === "number"
              || ${C} === "boolean" || ${E} === null`).assign(T,(0,n._)`[${E}]`)}}}function i({gen:h,parentData:g,parentDataProperty:w},y){h.if((0,n._)`${g} !== undefined`,()=>h.assign((0,n._)`${g}[${w}]`,y))}function o(h,g,w,y=a.Correct){const E=y===a.Correct?n.operators.EQ:n.operators.NEQ;let k;switch(h){case"null":return(0,n._)`${g} ${E} null`;case"array":k=(0,n._)`Array.isArray(${g})`;break;case"object":k=(0,n._)`${g} && typeof ${g} == "object" && !Array.isArray(${g})`;break;case"integer":k=C((0,n._)`!(${g} % 1) && !isNaN(${g})`);break;case"number":k=C();break;default:return(0,n._)`typeof ${g} ${E} ${h}`}return y===a.Correct?k:(0,n.not)(k);function C(T=n.nil){return(0,n.and)((0,n._)`typeof ${g} == "number"`,T,w?(0,n._)`isFinite(${g})`:n.nil)}}Re.checkDataType=o;function c(h,g,w,y){if(h.length===1)return o(h[0],g,w,y);let E;const k=(0,s.toHash)(h);if(k.array&&k.object){const C=(0,n._)`typeof ${g} != "object"`;E=k.null?C:(0,n._)`!${g} || ${C}`,delete k.null,delete k.array,delete k.object}else E=n.nil;k.number&&delete k.integer;for(const C in k)E=(0,n.and)(E,o(C,g,w,y));return E}Re.checkDataTypes=c;const f={message:({schema:h})=>`must be ${h}`,params:({schema:h,schemaValue:g})=>typeof h=="string"?(0,n._)`{type: ${h}}`:(0,n._)`{type: ${g}}`};function l(h){const g=m(h);(0,r.reportError)(g,f)}Re.reportTypeError=l;function m(h){const{gen:g,data:w,schema:y}=h,E=(0,s.schemaRefOrVal)(h,y,"type");return{gen:g,keyword:"type",data:w,schema:y.type,schemaCode:E,schemaValue:E,parentSchema:y,params:{},it:h}}return Re}var Ut={},Co;function Sp(){if(Co)return Ut;Co=1,Object.defineProperty(Ut,"__esModule",{value:!0}),Ut.assignDefaults=void 0;const e=ne(),t=ce();function r(s,a){const{properties:u,items:d}=s.schema;if(a==="object"&&u)for(const p in u)n(s,p,u[p].default);else a==="array"&&Array.isArray(d)&&d.forEach((p,_)=>n(s,_,p.default))}Ut.assignDefaults=r;function n(s,a,u){const{gen:d,compositeRule:p,data:_,opts:v}=s;if(u===void 0)return;const b=(0,e._)`${_}${(0,e.getProperty)(a)}`;if(p){(0,t.checkStrictMode)(s,`default is ignored for: ${b}`);return}let i=(0,e._)`${b} === undefined`;v.useDefaults==="empty"&&(i=(0,e._)`${i} || ${b} === null || ${b} === ""`),d.if(i,(0,e._)`${b} = ${(0,e.stringify)(u)}`)}return Ut}var Be={},de={},Ao;function Ge(){if(Ao)return de;Ao=1,Object.defineProperty(de,"__esModule",{value:!0}),de.validateUnion=de.validateArray=de.usePattern=de.callValidateCode=de.schemaProperties=de.allSchemaProperties=de.noPropertyInData=de.propertyInData=de.isOwnProperty=de.hasPropFunc=de.reportMissingProp=de.checkMissingProp=de.checkReportMissingProp=void 0;const e=ne(),t=ce(),r=ct(),n=ce();function s(h,g){const{gen:w,data:y,it:E}=h;w.if(v(w,y,g,E.opts.ownProperties),()=>{h.setParams({missingProperty:(0,e._)`${g}`},!0),h.error()})}de.checkReportMissingProp=s;function a({gen:h,data:g,it:{opts:w}},y,E){return(0,e.or)(...y.map(k=>(0,e.and)(v(h,g,k,w.ownProperties),(0,e._)`${E} = ${k}`)))}de.checkMissingProp=a;function u(h,g){h.setParams({missingProperty:g},!0),h.error()}de.reportMissingProp=u;function d(h){return h.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,e._)`Object.prototype.hasOwnProperty`})}de.hasPropFunc=d;function p(h,g,w){return(0,e._)`${d(h)}.call(${g}, ${w})`}de.isOwnProperty=p;function _(h,g,w,y){const E=(0,e._)`${g}${(0,e.getProperty)(w)} !== undefined`;return y?(0,e._)`${E} && ${p(h,g,w)}`:E}de.propertyInData=_;function v(h,g,w,y){const E=(0,e._)`${g}${(0,e.getProperty)(w)} === undefined`;return y?(0,e.or)(E,(0,e.not)(p(h,g,w))):E}de.noPropertyInData=v;function b(h){return h?Object.keys(h).filter(g=>g!=="__proto__"):[]}de.allSchemaProperties=b;function i(h,g){return b(g).filter(w=>!(0,t.alwaysValidSchema)(h,g[w]))}de.schemaProperties=i;function o({schemaCode:h,data:g,it:{gen:w,topSchemaRef:y,schemaPath:E,errorPath:k},it:C},T,P,$){const z=$?(0,e._)`${h}, ${g}, ${y}${E}`:g,L=[[r.default.instancePath,(0,e.strConcat)(r.default.instancePath,k)],[r.default.parentData,C.parentData],[r.default.parentDataProperty,C.parentDataProperty],[r.default.rootData,r.default.rootData]];C.opts.dynamicRef&&L.push([r.default.dynamicAnchors,r.default.dynamicAnchors]);const Z=(0,e._)`${z}, ${w.object(...L)}`;return P!==e.nil?(0,e._)`${T}.call(${P}, ${Z})`:(0,e._)`${T}(${Z})`}de.callValidateCode=o;const c=(0,e._)`new RegExp`;function f({gen:h,it:{opts:g}},w){const y=g.unicodeRegExp?"u":"",{regExp:E}=g.code,k=E(w,y);return h.scopeValue("pattern",{key:k.toString(),ref:k,code:(0,e._)`${E.code==="new RegExp"?c:(0,n.useFunc)(h,E)}(${w}, ${y})`})}de.usePattern=f;function l(h){const{gen:g,data:w,keyword:y,it:E}=h,k=g.name("valid");if(E.allErrors){const T=g.let("valid",!0);return C(()=>g.assign(T,!1)),T}return g.var(k,!0),C(()=>g.break()),k;function C(T){const P=g.const("len",(0,e._)`${w}.length`);g.forRange("i",0,P,$=>{h.subschema({keyword:y,dataProp:$,dataPropType:t.Type.Num},k),g.if((0,e.not)(k),T)})}}de.validateArray=l;function m(h){const{gen:g,schema:w,keyword:y,it:E}=h;if(!Array.isArray(w))throw new Error("ajv implementation error");if(w.some(P=>(0,t.alwaysValidSchema)(E,P))&&!E.opts.unevaluated)return;const C=g.let("valid",!1),T=g.name("_valid");g.block(()=>w.forEach((P,$)=>{const z=h.subschema({keyword:y,schemaProp:$,compositeRule:!0},T);g.assign(C,(0,e._)`${C} || ${T}`),h.mergeValidEvaluated(z,T)||g.if((0,e.not)(C))})),h.result(C,()=>h.reset(),()=>h.error(!0))}return de.validateUnion=m,de}var Fo;function kp(){if(Fo)return Be;Fo=1,Object.defineProperty(Be,"__esModule",{value:!0}),Be.validateKeywordUsage=Be.validSchemaType=Be.funcKeywordCode=Be.macroKeywordCode=void 0;const e=ne(),t=ct(),r=Ge(),n=_n();function s(i,o){const{gen:c,keyword:f,schema:l,parentSchema:m,it:h}=i,g=o.macro.call(h.self,l,m,h),w=_(c,f,g);h.opts.validateSchema!==!1&&h.self.validateSchema(g,!0);const y=c.name("valid");i.subschema({schema:g,schemaPath:e.nil,errSchemaPath:`${h.errSchemaPath}/${f}`,topSchemaRef:w,compositeRule:!0},y),i.pass(y,()=>i.error(!0))}Be.macroKeywordCode=s;function a(i,o){var c;const{gen:f,keyword:l,schema:m,parentSchema:h,$data:g,it:w}=i;p(w,o);const y=!g&&o.compile?o.compile.call(w.self,m,h,w):o.validate,E=_(f,l,y),k=f.let("valid");i.block$data(k,C),i.ok((c=o.valid)!==null&&c!==void 0?c:k);function C(){if(o.errors===!1)$(),o.modifying&&u(i),z(()=>i.error());else{const L=o.async?T():P();o.modifying&&u(i),z(()=>d(i,L))}}function T(){const L=f.let("ruleErrs",null);return f.try(()=>$((0,e._)`await `),Z=>f.assign(k,!1).if((0,e._)`${Z} instanceof ${w.ValidationError}`,()=>f.assign(L,(0,e._)`${Z}.errors`),()=>f.throw(Z))),L}function P(){const L=(0,e._)`${E}.errors`;return f.assign(L,null),$(e.nil),L}function $(L=o.async?(0,e._)`await `:e.nil){const Z=w.opts.passContext?t.default.this:t.default.self,Q=!("compile"in o&&!g||o.schema===!1);f.assign(k,(0,e._)`${L}${(0,r.callValidateCode)(i,E,Z,Q)}`,o.modifying)}function z(L){var Z;f.if((0,e.not)((Z=o.valid)!==null&&Z!==void 0?Z:k),L)}}Be.funcKeywordCode=a;function u(i){const{gen:o,data:c,it:f}=i;o.if(f.parentData,()=>o.assign(c,(0,e._)`${f.parentData}[${f.parentDataProperty}]`))}function d(i,o){const{gen:c}=i;c.if((0,e._)`Array.isArray(${o})`,()=>{c.assign(t.default.vErrors,(0,e._)`${t.default.vErrors} === null ? ${o} : ${t.default.vErrors}.concat(${o})`).assign(t.default.errors,(0,e._)`${t.default.vErrors}.length`),(0,n.extendErrors)(i)},()=>i.error())}function p({schemaEnv:i},o){if(o.async&&!i.$async)throw new Error("async keyword in sync schema")}function _(i,o,c){if(c===void 0)throw new Error(`keyword "${o}" failed to compile`);return i.scopeValue("keyword",typeof c=="function"?{ref:c}:{ref:c,code:(0,e.stringify)(c)})}function v(i,o,c=!1){return!o.length||o.some(f=>f==="array"?Array.isArray(i):f==="object"?i&&typeof i=="object"&&!Array.isArray(i):typeof i==f||c&&typeof i>"u")}Be.validSchemaType=v;function b({schema:i,opts:o,self:c,errSchemaPath:f},l,m){if(Array.isArray(l.keyword)?!l.keyword.includes(m):l.keyword!==m)throw new Error("ajv implementation error");const h=l.dependencies;if(h!=null&&h.some(g=>!Object.prototype.hasOwnProperty.call(i,g)))throw new Error(`parent schema must have dependencies of ${m}: ${h.join(",")}`);if(l.validateSchema&&!l.validateSchema(i[m])){const w=`keyword "${m}" value is invalid at path "${f}": `+c.errorsText(l.validateSchema.errors);if(o.validateSchema==="log")c.logger.error(w);else throw new Error(w)}}return Be.validateKeywordUsage=b,Be}var Qe={},zo;function Tp(){if(zo)return Qe;zo=1,Object.defineProperty(Qe,"__esModule",{value:!0}),Qe.extendSubschemaMode=Qe.extendSubschemaData=Qe.getSubschema=void 0;const e=ne(),t=ce();function r(a,{keyword:u,schemaProp:d,schema:p,schemaPath:_,errSchemaPath:v,topSchemaRef:b}){if(u!==void 0&&p!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(u!==void 0){const i=a.schema[u];return d===void 0?{schema:i,schemaPath:(0,e._)`${a.schemaPath}${(0,e.getProperty)(u)}`,errSchemaPath:`${a.errSchemaPath}/${u}`}:{schema:i[d],schemaPath:(0,e._)`${a.schemaPath}${(0,e.getProperty)(u)}${(0,e.getProperty)(d)}`,errSchemaPath:`${a.errSchemaPath}/${u}/${(0,t.escapeFragment)(d)}`}}if(p!==void 0){if(_===void 0||v===void 0||b===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:p,schemaPath:_,topSchemaRef:b,errSchemaPath:v}}throw new Error('either "keyword" or "schema" must be passed')}Qe.getSubschema=r;function n(a,u,{dataProp:d,dataPropType:p,data:_,dataTypes:v,propertyName:b}){if(_!==void 0&&d!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');const{gen:i}=u;if(d!==void 0){const{errorPath:c,dataPathArr:f,opts:l}=u,m=i.let("data",(0,e._)`${u.data}${(0,e.getProperty)(d)}`,!0);o(m),a.errorPath=(0,e.str)`${c}${(0,t.getErrorPath)(d,p,l.jsPropertySyntax)}`,a.parentDataProperty=(0,e._)`${d}`,a.dataPathArr=[...f,a.parentDataProperty]}if(_!==void 0){const c=_ instanceof e.Name?_:i.let("data",_,!0);o(c),b!==void 0&&(a.propertyName=b)}v&&(a.dataTypes=v);function o(c){a.data=c,a.dataLevel=u.dataLevel+1,a.dataTypes=[],u.definedProperties=new Set,a.parentData=u.data,a.dataNames=[...u.dataNames,c]}}Qe.extendSubschemaData=n;function s(a,{jtdDiscriminator:u,jtdMetadata:d,compositeRule:p,createErrors:_,allErrors:v}){p!==void 0&&(a.compositeRule=p),_!==void 0&&(a.createErrors=_),v!==void 0&&(a.allErrors=v),a.jtdDiscriminator=u,a.jtdMetadata=d}return Qe.extendSubschemaMode=s,Qe}var Ae={},On,Uo;function ec(){return Uo||(Uo=1,On=function e(t,r){if(t===r)return!0;if(t&&r&&typeof t=="object"&&typeof r=="object"){if(t.constructor!==r.constructor)return!1;var n,s,a;if(Array.isArray(t)){if(n=t.length,n!=r.length)return!1;for(s=n;s--!==0;)if(!e(t[s],r[s]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if(a=Object.keys(t),n=a.length,n!==Object.keys(r).length)return!1;for(s=n;s--!==0;)if(!Object.prototype.hasOwnProperty.call(r,a[s]))return!1;for(s=n;s--!==0;){var u=a[s];if(!e(t[u],r[u]))return!1}return!0}return t!==t&&r!==r}),On}var Cn={exports:{}},qo;function Ip(){if(qo)return Cn.exports;qo=1;var e=Cn.exports=function(n,s,a){typeof s=="function"&&(a=s,s={}),a=s.cb||a;var u=typeof a=="function"?a:a.pre||function(){},d=a.post||function(){};t(s,u,d,n,"",n)};e.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0},e.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},e.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},e.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function t(n,s,a,u,d,p,_,v,b,i){if(u&&typeof u=="object"&&!Array.isArray(u)){s(u,d,p,_,v,b,i);for(var o in u){var c=u[o];if(Array.isArray(c)){if(o in e.arrayKeywords)for(var f=0;f<c.length;f++)t(n,s,a,c[f],d+"/"+o+"/"+f,p,d,o,u,f)}else if(o in e.propsKeywords){if(c&&typeof c=="object")for(var l in c)t(n,s,a,c[l],d+"/"+o+"/"+r(l),p,d,o,u,l)}else(o in e.keywords||n.allKeys&&!(o in e.skipKeywords))&&t(n,s,a,c,d+"/"+o,p,d,o,u)}a(u,d,p,_,v,b,i)}}function r(n){return n.replace(/~/g,"~0").replace(/\//g,"~1")}return Cn.exports}var jo;function vn(){if(jo)return Ae;jo=1,Object.defineProperty(Ae,"__esModule",{value:!0}),Ae.getSchemaRefs=Ae.resolveUrl=Ae.normalizeId=Ae._getFullPath=Ae.getFullPath=Ae.inlineRef=void 0;const e=ce(),t=ec(),r=Ip(),n=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function s(f,l=!0){return typeof f=="boolean"?!0:l===!0?!u(f):l?d(f)<=l:!1}Ae.inlineRef=s;const a=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function u(f){for(const l in f){if(a.has(l))return!0;const m=f[l];if(Array.isArray(m)&&m.some(u)||typeof m=="object"&&u(m))return!0}return!1}function d(f){let l=0;for(const m in f){if(m==="$ref")return 1/0;if(l++,!n.has(m)&&(typeof f[m]=="object"&&(0,e.eachItem)(f[m],h=>l+=d(h)),l===1/0))return 1/0}return l}function p(f,l="",m){m!==!1&&(l=b(l));const h=f.parse(l);return _(f,h)}Ae.getFullPath=p;function _(f,l){return f.serialize(l).split("#")[0]+"#"}Ae._getFullPath=_;const v=/#\/?$/;function b(f){return f?f.replace(v,""):""}Ae.normalizeId=b;function i(f,l,m){return m=b(m),f.resolve(l,m)}Ae.resolveUrl=i;const o=/^[a-z_][-a-z0-9._]*$/i;function c(f,l){if(typeof f=="boolean")return{};const{schemaId:m,uriResolver:h}=this.opts,g=b(f[m]||l),w={"":g},y=p(h,g,!1),E={},k=new Set;return r(f,{allKeys:!0},(P,$,z,L)=>{if(L===void 0)return;const Z=y+$;let Q=w[L];typeof P[m]=="string"&&(Q=ae.call(this,P[m])),le.call(this,P.$anchor),le.call(this,P.$dynamicAnchor),w[$]=Q;function ae(ee){const he=this.opts.uriResolver.resolve;if(ee=b(Q?he(Q,ee):ee),k.has(ee))throw T(ee);k.add(ee);let M=this.refs[ee];return typeof M=="string"&&(M=this.refs[M]),typeof M=="object"?C(P,M.schema,ee):ee!==b(Z)&&(ee[0]==="#"?(C(P,E[ee],ee),E[ee]=P):this.refs[ee]=Z),ee}function le(ee){if(typeof ee=="string"){if(!o.test(ee))throw new Error(`invalid anchor "${ee}"`);ae.call(this,`#${ee}`)}}}),E;function C(P,$,z){if($!==void 0&&!t(P,$))throw T(z)}function T(P){return new Error(`reference "${P}" resolves to more than one schema`)}}return Ae.getSchemaRefs=c,Ae}var Mo;function yn(){if(Mo)return Je;Mo=1,Object.defineProperty(Je,"__esModule",{value:!0}),Je.getData=Je.KeywordCxt=Je.validateFunctionCode=void 0;const e=$p(),t=tn(),r=Xa(),n=tn(),s=Sp(),a=kp(),u=Tp(),d=ne(),p=ct(),_=vn(),v=ce(),b=_n();function i(O){if(y(O)&&(k(O),w(O))){l(O);return}o(O,()=>(0,e.topBoolOrEmptySchema)(O))}Je.validateFunctionCode=i;function o({gen:O,validateName:F,schema:x,schemaEnv:V,opts:W},ie){W.code.es5?O.func(F,(0,d._)`${p.default.data}, ${p.default.valCxt}`,V.$async,()=>{O.code((0,d._)`"use strict"; ${h(x,W)}`),f(O,W),O.code(ie)}):O.func(F,(0,d._)`${p.default.data}, ${c(W)}`,V.$async,()=>O.code(h(x,W)).code(ie))}function c(O){return(0,d._)`{${p.default.instancePath}="", ${p.default.parentData}, ${p.default.parentDataProperty}, ${p.default.rootData}=${p.default.data}${O.dynamicRef?(0,d._)`, ${p.default.dynamicAnchors}={}`:d.nil}}={}`}function f(O,F){O.if(p.default.valCxt,()=>{O.var(p.default.instancePath,(0,d._)`${p.default.valCxt}.${p.default.instancePath}`),O.var(p.default.parentData,(0,d._)`${p.default.valCxt}.${p.default.parentData}`),O.var(p.default.parentDataProperty,(0,d._)`${p.default.valCxt}.${p.default.parentDataProperty}`),O.var(p.default.rootData,(0,d._)`${p.default.valCxt}.${p.default.rootData}`),F.dynamicRef&&O.var(p.default.dynamicAnchors,(0,d._)`${p.default.valCxt}.${p.default.dynamicAnchors}`)},()=>{O.var(p.default.instancePath,(0,d._)`""`),O.var(p.default.parentData,(0,d._)`undefined`),O.var(p.default.parentDataProperty,(0,d._)`undefined`),O.var(p.default.rootData,p.default.data),F.dynamicRef&&O.var(p.default.dynamicAnchors,(0,d._)`{}`)})}function l(O){const{schema:F,opts:x,gen:V}=O;o(O,()=>{x.$comment&&F.$comment&&L(O),P(O),V.let(p.default.vErrors,null),V.let(p.default.errors,0),x.unevaluated&&m(O),C(O),Z(O)})}function m(O){const{gen:F,validateName:x}=O;O.evaluated=F.const("evaluated",(0,d._)`${x}.evaluated`),F.if((0,d._)`${O.evaluated}.dynamicProps`,()=>F.assign((0,d._)`${O.evaluated}.props`,(0,d._)`undefined`)),F.if((0,d._)`${O.evaluated}.dynamicItems`,()=>F.assign((0,d._)`${O.evaluated}.items`,(0,d._)`undefined`))}function h(O,F){const x=typeof O=="object"&&O[F.schemaId];return x&&(F.code.source||F.code.process)?(0,d._)`/*# sourceURL=${x} */`:d.nil}function g(O,F){if(y(O)&&(k(O),w(O))){E(O,F);return}(0,e.boolOrEmptySchema)(O,F)}function w({schema:O,self:F}){if(typeof O=="boolean")return!O;for(const x in O)if(F.RULES.all[x])return!0;return!1}function y(O){return typeof O.schema!="boolean"}function E(O,F){const{schema:x,gen:V,opts:W}=O;W.$comment&&x.$comment&&L(O),$(O),z(O);const ie=V.const("_errs",p.default.errors);C(O,ie),V.var(F,(0,d._)`${ie} === ${p.default.errors}`)}function k(O){(0,v.checkUnknownRules)(O),T(O)}function C(O,F){if(O.opts.jtd)return ae(O,[],!1,F);const x=(0,t.getSchemaTypes)(O.schema),V=(0,t.coerceAndCheckDataType)(O,x);ae(O,x,!V,F)}function T(O){const{schema:F,errSchemaPath:x,opts:V,self:W}=O;F.$ref&&V.ignoreKeywordsWithRef&&(0,v.schemaHasRulesButRef)(F,W.RULES)&&W.logger.warn(`$ref: keywords ignored in schema at path "${x}"`)}function P(O){const{schema:F,opts:x}=O;F.default!==void 0&&x.useDefaults&&x.strictSchema&&(0,v.checkStrictMode)(O,"default is ignored in the schema root")}function $(O){const F=O.schema[O.opts.schemaId];F&&(O.baseId=(0,_.resolveUrl)(O.opts.uriResolver,O.baseId,F))}function z(O){if(O.schema.$async&&!O.schemaEnv.$async)throw new Error("async schema in sync schema")}function L({gen:O,schemaEnv:F,schema:x,errSchemaPath:V,opts:W}){const ie=x.$comment;if(W.$comment===!0)O.code((0,d._)`${p.default.self}.logger.log(${ie})`);else if(typeof W.$comment=="function"){const Te=(0,d.str)`${V}/$comment`,He=O.scopeValue("root",{ref:F.root});O.code((0,d._)`${p.default.self}.opts.$comment(${ie}, ${Te}, ${He}.schema)`)}}function Z(O){const{gen:F,schemaEnv:x,validateName:V,ValidationError:W,opts:ie}=O;x.$async?F.if((0,d._)`${p.default.errors} === 0`,()=>F.return(p.default.data),()=>F.throw((0,d._)`new ${W}(${p.default.vErrors})`)):(F.assign((0,d._)`${V}.errors`,p.default.vErrors),ie.unevaluated&&Q(O),F.return((0,d._)`${p.default.errors} === 0`))}function Q({gen:O,evaluated:F,props:x,items:V}){x instanceof d.Name&&O.assign((0,d._)`${F}.props`,x),V instanceof d.Name&&O.assign((0,d._)`${F}.items`,V)}function ae(O,F,x,V){const{gen:W,schema:ie,data:Te,allErrors:He,opts:ze,self:Ue}=O,{RULES:Ie}=Ue;if(ie.$ref&&(ze.ignoreKeywordsWithRef||!(0,v.schemaHasRulesButRef)(ie,Ie))){W.block(()=>K(O,"$ref",Ie.all.$ref.definition));return}ze.jtd||ee(O,F),W.block(()=>{for(const De of Ie.rules)vt(De);vt(Ie.post)});function vt(De){(0,r.shouldUseGroup)(ie,De)&&(De.type?(W.if((0,n.checkDataType)(De.type,Te,ze.strictNumbers)),le(O,De),F.length===1&&F[0]===De.type&&x&&(W.else(),(0,n.reportTypeError)(O)),W.endIf()):le(O,De),He||W.if((0,d._)`${p.default.errors} === ${V||0}`))}}function le(O,F){const{gen:x,schema:V,opts:{useDefaults:W}}=O;W&&(0,s.assignDefaults)(O,F.type),x.block(()=>{for(const ie of F.rules)(0,r.shouldUseRule)(V,ie)&&K(O,ie.keyword,ie.definition,F.type)})}function ee(O,F){O.schemaEnv.meta||!O.opts.strictTypes||(he(O,F),O.opts.allowUnionTypes||M(O,F),N(O,O.dataTypes))}function he(O,F){if(F.length){if(!O.dataTypes.length){O.dataTypes=F;return}F.forEach(x=>{A(O.dataTypes,x)||I(O,`type "${x}" not allowed by context "${O.dataTypes.join(",")}"`)}),S(O,F)}}function M(O,F){F.length>1&&!(F.length===2&&F.includes("null"))&&I(O,"use allowUnionTypes to allow union type keyword")}function N(O,F){const x=O.self.RULES.all;for(const V in x){const W=x[V];if(typeof W=="object"&&(0,r.shouldUseRule)(O.schema,W)){const{type:ie}=W.definition;ie.length&&!ie.some(Te=>j(F,Te))&&I(O,`missing type "${ie.join(",")}" for keyword "${V}"`)}}}function j(O,F){return O.includes(F)||F==="number"&&O.includes("integer")}function A(O,F){return O.includes(F)||F==="integer"&&O.includes("number")}function S(O,F){const x=[];for(const V of O.dataTypes)A(F,V)?x.push(V):F.includes("integer")&&V==="number"&&x.push("integer");O.dataTypes=x}function I(O,F){const x=O.schemaEnv.baseId+O.errSchemaPath;F+=` at "${x}" (strictTypes)`,(0,v.checkStrictMode)(O,F,O.opts.strictTypes)}class q{constructor(F,x,V){if((0,a.validateKeywordUsage)(F,x,V),this.gen=F.gen,this.allErrors=F.allErrors,this.keyword=V,this.data=F.data,this.schema=F.schema[V],this.$data=x.$data&&F.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,v.schemaRefOrVal)(F,this.schema,V,this.$data),this.schemaType=x.schemaType,this.parentSchema=F.schema,this.params={},this.it=F,this.def=x,this.$data)this.schemaCode=F.gen.const("vSchema",se(this.$data,F));else if(this.schemaCode=this.schemaValue,!(0,a.validSchemaType)(this.schema,x.schemaType,x.allowUndefined))throw new Error(`${V} value must be ${JSON.stringify(x.schemaType)}`);("code"in x?x.trackErrors:x.errors!==!1)&&(this.errsCount=F.gen.const("_errs",p.default.errors))}result(F,x,V){this.failResult((0,d.not)(F),x,V)}failResult(F,x,V){this.gen.if(F),V?V():this.error(),x?(this.gen.else(),x(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(F,x){this.failResult((0,d.not)(F),void 0,x)}fail(F){if(F===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(F),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(F){if(!this.$data)return this.fail(F);const{schemaCode:x}=this;this.fail((0,d._)`${x} !== undefined && (${(0,d.or)(this.invalid$data(),F)})`)}error(F,x,V){if(x){this.setParams(x),this._error(F,V),this.setParams({});return}this._error(F,V)}_error(F,x){(F?b.reportExtraError:b.reportError)(this,this.def.error,x)}$dataError(){(0,b.reportError)(this,this.def.$dataError||b.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,b.resetErrorsCount)(this.gen,this.errsCount)}ok(F){this.allErrors||this.gen.if(F)}setParams(F,x){x?Object.assign(this.params,F):this.params=F}block$data(F,x,V=d.nil){this.gen.block(()=>{this.check$data(F,V),x()})}check$data(F=d.nil,x=d.nil){if(!this.$data)return;const{gen:V,schemaCode:W,schemaType:ie,def:Te}=this;V.if((0,d.or)((0,d._)`${W} === undefined`,x)),F!==d.nil&&V.assign(F,!0),(ie.length||Te.validateSchema)&&(V.elseIf(this.invalid$data()),this.$dataError(),F!==d.nil&&V.assign(F,!1)),V.else()}invalid$data(){const{gen:F,schemaCode:x,schemaType:V,def:W,it:ie}=this;return(0,d.or)(Te(),He());function Te(){if(V.length){if(!(x instanceof d.Name))throw new Error("ajv implementation error");const ze=Array.isArray(V)?V:[V];return(0,d._)`${(0,n.checkDataTypes)(ze,x,ie.opts.strictNumbers,n.DataType.Wrong)}`}return d.nil}function He(){if(W.validateSchema){const ze=F.scopeValue("validate$data",{ref:W.validateSchema});return(0,d._)`!${ze}(${x})`}return d.nil}}subschema(F,x){const V=(0,u.getSubschema)(this.it,F);(0,u.extendSubschemaData)(V,this.it,F),(0,u.extendSubschemaMode)(V,F);const W={...this.it,...V,items:void 0,props:void 0};return g(W,x),W}mergeEvaluated(F,x){const{it:V,gen:W}=this;V.opts.unevaluated&&(V.props!==!0&&F.props!==void 0&&(V.props=v.mergeEvaluated.props(W,F.props,V.props,x)),V.items!==!0&&F.items!==void 0&&(V.items=v.mergeEvaluated.items(W,F.items,V.items,x)))}mergeValidEvaluated(F,x){const{it:V,gen:W}=this;if(V.opts.unevaluated&&(V.props!==!0||V.items!==!0))return W.if(x,()=>this.mergeEvaluated(F,d.Name)),!0}}Je.KeywordCxt=q;function K(O,F,x,V){const W=new q(O,x,F);"code"in x?x.code(W,V):W.$data&&x.validate?(0,a.funcKeywordCode)(W,x):"macro"in x?(0,a.macroKeywordCode)(W,x):(x.compile||x.validate)&&(0,a.funcKeywordCode)(W,x)}const Y=/^\/(?:[^~]|~0|~1)*$/,ue=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function se(O,{dataLevel:F,dataNames:x,dataPathArr:V}){let W,ie;if(O==="")return p.default.rootData;if(O[0]==="/"){if(!Y.test(O))throw new Error(`Invalid JSON-pointer: ${O}`);W=O,ie=p.default.rootData}else{const Ue=ue.exec(O);if(!Ue)throw new Error(`Invalid JSON-pointer: ${O}`);const Ie=+Ue[1];if(W=Ue[2],W==="#"){if(Ie>=F)throw new Error(ze("property/index",Ie));return V[F-Ie]}if(Ie>F)throw new Error(ze("data",Ie));if(ie=x[F-Ie],!W)return ie}let Te=ie;const He=W.split("/");for(const Ue of He)Ue&&(ie=(0,d._)`${ie}${(0,d.getProperty)((0,v.unescapeJsonPointer)(Ue))}`,Te=(0,d._)`${Te} && ${ie}`);return Te;function ze(Ue,Ie){return`Cannot access ${Ue} ${Ie} levels up, current level is ${F}`}}return Je.getData=se,Je}var sr={},xo;function Mi(){if(xo)return sr;xo=1,Object.defineProperty(sr,"__esModule",{value:!0});class e extends Error{constructor(r){super("validation failed"),this.errors=r,this.ajv=this.validation=!0}}return sr.default=e,sr}var ar={},Lo;function wn(){if(Lo)return ar;Lo=1,Object.defineProperty(ar,"__esModule",{value:!0});const e=vn();class t extends Error{constructor(n,s,a,u){super(u||`can't resolve reference ${a} from id ${s}`),this.missingRef=(0,e.resolveUrl)(n,s,a),this.missingSchema=(0,e.normalizeId)((0,e.getFullPath)(n,this.missingRef))}}return ar.default=t,ar}var Le={},Do;function xi(){if(Do)return Le;Do=1,Object.defineProperty(Le,"__esModule",{value:!0}),Le.resolveSchema=Le.getCompilingSchema=Le.resolveRef=Le.compileSchema=Le.SchemaEnv=void 0;const e=ne(),t=Mi(),r=ct(),n=vn(),s=ce(),a=yn();class u{constructor(m){var h;this.refs={},this.dynamicAnchors={};let g;typeof m.schema=="object"&&(g=m.schema),this.schema=m.schema,this.schemaId=m.schemaId,this.root=m.root||this,this.baseId=(h=m.baseId)!==null&&h!==void 0?h:(0,n.normalizeId)(g==null?void 0:g[m.schemaId||"$id"]),this.schemaPath=m.schemaPath,this.localRefs=m.localRefs,this.meta=m.meta,this.$async=g==null?void 0:g.$async,this.refs={}}}Le.SchemaEnv=u;function d(l){const m=v.call(this,l);if(m)return m;const h=(0,n.getFullPath)(this.opts.uriResolver,l.root.baseId),{es5:g,lines:w}=this.opts.code,{ownProperties:y}=this.opts,E=new e.CodeGen(this.scope,{es5:g,lines:w,ownProperties:y});let k;l.$async&&(k=E.scopeValue("Error",{ref:t.default,code:(0,e._)`require("ajv/dist/runtime/validation_error").default`}));const C=E.scopeName("validate");l.validateName=C;const T={gen:E,allErrors:this.opts.allErrors,data:r.default.data,parentData:r.default.parentData,parentDataProperty:r.default.parentDataProperty,dataNames:[r.default.data],dataPathArr:[e.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:E.scopeValue("schema",this.opts.code.source===!0?{ref:l.schema,code:(0,e.stringify)(l.schema)}:{ref:l.schema}),validateName:C,ValidationError:k,schema:l.schema,schemaEnv:l,rootId:h,baseId:l.baseId||h,schemaPath:e.nil,errSchemaPath:l.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,e._)`""`,opts:this.opts,self:this};let P;try{this._compilations.add(l),(0,a.validateFunctionCode)(T),E.optimize(this.opts.code.optimize);const $=E.toString();P=`${E.scopeRefs(r.default.scope)}return ${$}`,this.opts.code.process&&(P=this.opts.code.process(P,l));const L=new Function(`${r.default.self}`,`${r.default.scope}`,P)(this,this.scope.get());if(this.scope.value(C,{ref:L}),L.errors=null,L.schema=l.schema,L.schemaEnv=l,l.$async&&(L.$async=!0),this.opts.code.source===!0&&(L.source={validateName:C,validateCode:$,scopeValues:E._values}),this.opts.unevaluated){const{props:Z,items:Q}=T;L.evaluated={props:Z instanceof e.Name?void 0:Z,items:Q instanceof e.Name?void 0:Q,dynamicProps:Z instanceof e.Name,dynamicItems:Q instanceof e.Name},L.source&&(L.source.evaluated=(0,e.stringify)(L.evaluated))}return l.validate=L,l}catch($){throw delete l.validate,delete l.validateName,P&&this.logger.error("Error compiling schema, function code:",P),$}finally{this._compilations.delete(l)}}Le.compileSchema=d;function p(l,m,h){var g;h=(0,n.resolveUrl)(this.opts.uriResolver,m,h);const w=l.refs[h];if(w)return w;let y=i.call(this,l,h);if(y===void 0){const E=(g=l.localRefs)===null||g===void 0?void 0:g[h],{schemaId:k}=this.opts;E&&(y=new u({schema:E,schemaId:k,root:l,baseId:m}))}if(y!==void 0)return l.refs[h]=_.call(this,y)}Le.resolveRef=p;function _(l){return(0,n.inlineRef)(l.schema,this.opts.inlineRefs)?l.schema:l.validate?l:d.call(this,l)}function v(l){for(const m of this._compilations)if(b(m,l))return m}Le.getCompilingSchema=v;function b(l,m){return l.schema===m.schema&&l.root===m.root&&l.baseId===m.baseId}function i(l,m){let h;for(;typeof(h=this.refs[m])=="string";)m=h;return h||this.schemas[m]||o.call(this,l,m)}function o(l,m){const h=this.opts.uriResolver.parse(m),g=(0,n._getFullPath)(this.opts.uriResolver,h);let w=(0,n.getFullPath)(this.opts.uriResolver,l.baseId,void 0);if(Object.keys(l.schema).length>0&&g===w)return f.call(this,h,l);const y=(0,n.normalizeId)(g),E=this.refs[y]||this.schemas[y];if(typeof E=="string"){const k=o.call(this,l,E);return typeof(k==null?void 0:k.schema)!="object"?void 0:f.call(this,h,k)}if(typeof(E==null?void 0:E.schema)=="object"){if(E.validate||d.call(this,E),y===(0,n.normalizeId)(m)){const{schema:k}=E,{schemaId:C}=this.opts,T=k[C];return T&&(w=(0,n.resolveUrl)(this.opts.uriResolver,w,T)),new u({schema:k,schemaId:C,root:l,baseId:w})}return f.call(this,h,E)}}Le.resolveSchema=o;const c=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function f(l,{baseId:m,schema:h,root:g}){var w;if(((w=l.fragment)===null||w===void 0?void 0:w[0])!=="/")return;for(const k of l.fragment.slice(1).split("/")){if(typeof h=="boolean")return;const C=h[(0,s.unescapeFragment)(k)];if(C===void 0)return;h=C;const T=typeof h=="object"&&h[this.opts.schemaId];!c.has(k)&&T&&(m=(0,n.resolveUrl)(this.opts.uriResolver,m,T))}let y;if(typeof h!="boolean"&&h.$ref&&!(0,s.schemaHasRulesButRef)(h,this.RULES)){const k=(0,n.resolveUrl)(this.opts.uriResolver,m,h.$ref);y=o.call(this,g,k)}const{schemaId:E}=this.opts;if(y=y||new u({schema:h,schemaId:E,root:g,baseId:m}),y.schema!==y.root.schema)return y}return Le}const Rp="https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",Pp="Meta-schema for $data reference (JSON AnySchema extension proposal)",Np="object",Op=["$data"],Cp={$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},Ap=!1,Fp={$id:Rp,description:Pp,type:Np,required:Op,properties:Cp,additionalProperties:Ap};var cr={},qt={exports:{}},An,Zo;function tc(){if(Zo)return An;Zo=1;const e=RegExp.prototype.test.bind(/^[\da-f]{8}-[\da-f]{4}-[\da-f]{4}-[\da-f]{4}-[\da-f]{12}$/iu),t=RegExp.prototype.test.bind(/^(?:(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)$/u);function r(i){let o="",c=0,f=0;for(f=0;f<i.length;f++)if(c=i[f].charCodeAt(0),c!==48){if(!(c>=48&&c<=57||c>=65&&c<=70||c>=97&&c<=102))return"";o+=i[f];break}for(f+=1;f<i.length;f++){if(c=i[f].charCodeAt(0),!(c>=48&&c<=57||c>=65&&c<=70||c>=97&&c<=102))return"";o+=i[f]}return o}const n=RegExp.prototype.test.bind(/[^!"$&'()*+,\-.;=_`a-z{}~]/u);function s(i){return i.length=0,!0}function a(i,o,c){if(i.length){const f=r(i);if(f!=="")o.push(f);else return c.error=!0,!1;i.length=0}return!0}function u(i){let o=0;const c={error:!1,address:"",zone:""},f=[],l=[];let m=!1,h=!1,g=a;for(let w=0;w<i.length;w++){const y=i[w];if(!(y==="["||y==="]"))if(y===":"){if(m===!0&&(h=!0),!g(l,f,c))break;if(++o>7){c.error=!0;break}w>0&&i[w-1]===":"&&(m=!0),f.push(":");continue}else if(y==="%"){if(!g(l,f,c))break;g=s}else{l.push(y);continue}}return l.length&&(g===s?c.zone=l.join(""):h?f.push(l.join("")):f.push(r(l))),c.address=f.join(""),c}function d(i){if(p(i,":")<2)return{host:i,isIPV6:!1};const o=u(i);if(o.error)return{host:i,isIPV6:!1};{let c=o.address,f=o.address;return o.zone&&(c+="%"+o.zone,f+="%25"+o.zone),{host:c,isIPV6:!0,escapedHost:f}}}function p(i,o){let c=0;for(let f=0;f<i.length;f++)i[f]===o&&c++;return c}function _(i){let o=i;const c=[];let f=-1,l=0;for(;l=o.length;){if(l===1){if(o===".")break;if(o==="/"){c.push("/");break}else{c.push(o);break}}else if(l===2){if(o[0]==="."){if(o[1]===".")break;if(o[1]==="/"){o=o.slice(2);continue}}else if(o[0]==="/"&&(o[1]==="."||o[1]==="/")){c.push("/");break}}else if(l===3&&o==="/.."){c.length!==0&&c.pop(),c.push("/");break}if(o[0]==="."){if(o[1]==="."){if(o[2]==="/"){o=o.slice(3);continue}}else if(o[1]==="/"){o=o.slice(2);continue}}else if(o[0]==="/"&&o[1]==="."){if(o[2]==="/"){o=o.slice(2);continue}else if(o[2]==="."&&o[3]==="/"){o=o.slice(3),c.length!==0&&c.pop();continue}}if((f=o.indexOf("/",1))===-1){c.push(o);break}else c.push(o.slice(0,f)),o=o.slice(f)}return c.join("")}function v(i,o){const c=o!==!0?escape:unescape;return i.scheme!==void 0&&(i.scheme=c(i.scheme)),i.userinfo!==void 0&&(i.userinfo=c(i.userinfo)),i.host!==void 0&&(i.host=c(i.host)),i.path!==void 0&&(i.path=c(i.path)),i.query!==void 0&&(i.query=c(i.query)),i.fragment!==void 0&&(i.fragment=c(i.fragment)),i}function b(i){const o=[];if(i.userinfo!==void 0&&(o.push(i.userinfo),o.push("@")),i.host!==void 0){let c=unescape(i.host);if(!t(c)){const f=d(c);f.isIPV6===!0?c=`[${f.escapedHost}]`:c=i.host}o.push(c)}return(typeof i.port=="number"||typeof i.port=="string")&&(o.push(":"),o.push(String(i.port))),o.length?o.join(""):void 0}return An={nonSimpleDomain:n,recomposeAuthority:b,normalizeComponentEncoding:v,removeDotSegments:_,isIPv4:t,isUUID:e,normalizeIPv6:d,stringArrayToHexStripped:r},An}var Fn,Vo;function zp(){if(Vo)return Fn;Vo=1;const{isUUID:e}=tc(),t=/([\da-z][\d\-a-z]{0,31}):((?:[\w!$'()*+,\-.:;=@]|%[\da-f]{2})+)/iu,r=["http","https","ws","wss","urn","urn:uuid"];function n(y){return r.indexOf(y)!==-1}function s(y){return y.secure===!0?!0:y.secure===!1?!1:y.scheme?y.scheme.length===3&&(y.scheme[0]==="w"||y.scheme[0]==="W")&&(y.scheme[1]==="s"||y.scheme[1]==="S")&&(y.scheme[2]==="s"||y.scheme[2]==="S"):!1}function a(y){return y.host||(y.error=y.error||"HTTP URIs must have a host."),y}function u(y){const E=String(y.scheme).toLowerCase()==="https";return(y.port===(E?443:80)||y.port==="")&&(y.port=void 0),y.path||(y.path="/"),y}function d(y){return y.secure=s(y),y.resourceName=(y.path||"/")+(y.query?"?"+y.query:""),y.path=void 0,y.query=void 0,y}function p(y){if((y.port===(s(y)?443:80)||y.port==="")&&(y.port=void 0),typeof y.secure=="boolean"&&(y.scheme=y.secure?"wss":"ws",y.secure=void 0),y.resourceName){const[E,k]=y.resourceName.split("?");y.path=E&&E!=="/"?E:void 0,y.query=k,y.resourceName=void 0}return y.fragment=void 0,y}function _(y,E){if(!y.path)return y.error="URN can not be parsed",y;const k=y.path.match(t);if(k){const C=E.scheme||y.scheme||"urn";y.nid=k[1].toLowerCase(),y.nss=k[2];const T=`${C}:${E.nid||y.nid}`,P=w(T);y.path=void 0,P&&(y=P.parse(y,E))}else y.error=y.error||"URN can not be parsed.";return y}function v(y,E){if(y.nid===void 0)throw new Error("URN without nid cannot be serialized");const k=E.scheme||y.scheme||"urn",C=y.nid.toLowerCase(),T=`${k}:${E.nid||C}`,P=w(T);P&&(y=P.serialize(y,E));const $=y,z=y.nss;return $.path=`${C||E.nid}:${z}`,E.skipEscape=!0,$}function b(y,E){const k=y;return k.uuid=k.nss,k.nss=void 0,!E.tolerant&&(!k.uuid||!e(k.uuid))&&(k.error=k.error||"UUID is not valid."),k}function i(y){const E=y;return E.nss=(y.uuid||"").toLowerCase(),E}const o={scheme:"http",domainHost:!0,parse:a,serialize:u},c={scheme:"https",domainHost:o.domainHost,parse:a,serialize:u},f={scheme:"ws",domainHost:!0,parse:d,serialize:p},l={scheme:"wss",domainHost:f.domainHost,parse:f.parse,serialize:f.serialize},g={http:o,https:c,ws:f,wss:l,urn:{scheme:"urn",parse:_,serialize:v,skipNormalize:!0},"urn:uuid":{scheme:"urn:uuid",parse:b,serialize:i,skipNormalize:!0}};Object.setPrototypeOf(g,null);function w(y){return y&&(g[y]||g[y.toLowerCase()])||void 0}return Fn={wsIsSecure:s,SCHEMES:g,isValidSchemeName:n,getSchemeHandler:w},Fn}var Ho;function Up(){if(Ho)return qt.exports;Ho=1;const{normalizeIPv6:e,removeDotSegments:t,recomposeAuthority:r,normalizeComponentEncoding:n,isIPv4:s,nonSimpleDomain:a}=tc(),{SCHEMES:u,getSchemeHandler:d}=zp();function p(l,m){return typeof l=="string"?l=i(c(l,m),m):typeof l=="object"&&(l=c(i(l,m),m)),l}function _(l,m,h){const g=h?Object.assign({scheme:"null"},h):{scheme:"null"},w=v(c(l,g),c(m,g),g,!0);return g.skipEscape=!0,i(w,g)}function v(l,m,h,g){const w={};return g||(l=c(i(l,h),h),m=c(i(m,h),h)),h=h||{},!h.tolerant&&m.scheme?(w.scheme=m.scheme,w.userinfo=m.userinfo,w.host=m.host,w.port=m.port,w.path=t(m.path||""),w.query=m.query):(m.userinfo!==void 0||m.host!==void 0||m.port!==void 0?(w.userinfo=m.userinfo,w.host=m.host,w.port=m.port,w.path=t(m.path||""),w.query=m.query):(m.path?(m.path[0]==="/"?w.path=t(m.path):((l.userinfo!==void 0||l.host!==void 0||l.port!==void 0)&&!l.path?w.path="/"+m.path:l.path?w.path=l.path.slice(0,l.path.lastIndexOf("/")+1)+m.path:w.path=m.path,w.path=t(w.path)),w.query=m.query):(w.path=l.path,m.query!==void 0?w.query=m.query:w.query=l.query),w.userinfo=l.userinfo,w.host=l.host,w.port=l.port),w.scheme=l.scheme),w.fragment=m.fragment,w}function b(l,m,h){return typeof l=="string"?(l=unescape(l),l=i(n(c(l,h),!0),{...h,skipEscape:!0})):typeof l=="object"&&(l=i(n(l,!0),{...h,skipEscape:!0})),typeof m=="string"?(m=unescape(m),m=i(n(c(m,h),!0),{...h,skipEscape:!0})):typeof m=="object"&&(m=i(n(m,!0),{...h,skipEscape:!0})),l.toLowerCase()===m.toLowerCase()}function i(l,m){const h={host:l.host,scheme:l.scheme,userinfo:l.userinfo,port:l.port,path:l.path,query:l.query,nid:l.nid,nss:l.nss,uuid:l.uuid,fragment:l.fragment,reference:l.reference,resourceName:l.resourceName,secure:l.secure,error:""},g=Object.assign({},m),w=[],y=d(g.scheme||h.scheme);y&&y.serialize&&y.serialize(h,g),h.path!==void 0&&(g.skipEscape?h.path=unescape(h.path):(h.path=escape(h.path),h.scheme!==void 0&&(h.path=h.path.split("%3A").join(":")))),g.reference!=="suffix"&&h.scheme&&w.push(h.scheme,":");const E=r(h);if(E!==void 0&&(g.reference!=="suffix"&&w.push("//"),w.push(E),h.path&&h.path[0]!=="/"&&w.push("/")),h.path!==void 0){let k=h.path;!g.absolutePath&&(!y||!y.absolutePath)&&(k=t(k)),E===void 0&&k[0]==="/"&&k[1]==="/"&&(k="/%2F"+k.slice(2)),w.push(k)}return h.query!==void 0&&w.push("?",h.query),h.fragment!==void 0&&w.push("#",h.fragment),w.join("")}const o=/^(?:([^#/:?]+):)?(?:\/\/((?:([^#/?@]*)@)?(\[[^#/?\]]+\]|[^#/:?]*)(?::(\d*))?))?([^#?]*)(?:\?([^#]*))?(?:#((?:.|[\n\r])*))?/u;function c(l,m){const h=Object.assign({},m),g={scheme:void 0,userinfo:void 0,host:"",port:void 0,path:"",query:void 0,fragment:void 0};let w=!1;h.reference==="suffix"&&(h.scheme?l=h.scheme+":"+l:l="//"+l);const y=l.match(o);if(y){if(g.scheme=y[1],g.userinfo=y[3],g.host=y[4],g.port=parseInt(y[5],10),g.path=y[6]||"",g.query=y[7],g.fragment=y[8],isNaN(g.port)&&(g.port=y[5]),g.host)if(s(g.host)===!1){const C=e(g.host);g.host=C.host.toLowerCase(),w=C.isIPV6}else w=!0;g.scheme===void 0&&g.userinfo===void 0&&g.host===void 0&&g.port===void 0&&g.query===void 0&&!g.path?g.reference="same-document":g.scheme===void 0?g.reference="relative":g.fragment===void 0?g.reference="absolute":g.reference="uri",h.reference&&h.reference!=="suffix"&&h.reference!==g.reference&&(g.error=g.error||"URI is not a "+h.reference+" reference.");const E=d(h.scheme||g.scheme);if(!h.unicodeSupport&&(!E||!E.unicodeSupport)&&g.host&&(h.domainHost||E&&E.domainHost)&&w===!1&&a(g.host))try{g.host=URL.domainToASCII(g.host.toLowerCase())}catch(k){g.error=g.error||"Host's domain name can not be converted to ASCII: "+k}(!E||E&&!E.skipNormalize)&&(l.indexOf("%")!==-1&&(g.scheme!==void 0&&(g.scheme=unescape(g.scheme)),g.host!==void 0&&(g.host=unescape(g.host))),g.path&&(g.path=escape(unescape(g.path))),g.fragment&&(g.fragment=encodeURI(decodeURIComponent(g.fragment)))),E&&E.parse&&E.parse(g,h)}else g.error=g.error||"URI can not be parsed.";return g}const f={SCHEMES:u,normalize:p,resolve:_,resolveComponent:v,equal:b,serialize:i,parse:c};return qt.exports=f,qt.exports.default=f,qt.exports.fastUri=f,qt.exports}var Bo;function qp(){if(Bo)return cr;Bo=1,Object.defineProperty(cr,"__esModule",{value:!0});const e=Up();return e.code='require("ajv/dist/runtime/uri").default',cr.default=e,cr}var Ko;function jp(){return Ko||(Ko=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.CodeGen=e.Name=e.nil=e.stringify=e.str=e._=e.KeywordCxt=void 0;var t=yn();Object.defineProperty(e,"KeywordCxt",{enumerable:!0,get:function(){return t.KeywordCxt}});var r=ne();Object.defineProperty(e,"_",{enumerable:!0,get:function(){return r._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return r.str}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return r.stringify}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return r.nil}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return r.Name}}),Object.defineProperty(e,"CodeGen",{enumerable:!0,get:function(){return r.CodeGen}});const n=Mi(),s=wn(),a=Qa(),u=xi(),d=ne(),p=vn(),_=tn(),v=ce(),b=Fp,i=qp(),o=(M,N)=>new RegExp(M,N);o.code="new RegExp";const c=["removeAdditional","useDefaults","coerceTypes"],f=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),l={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},m={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},h=200;function g(M){var N,j,A,S,I,q,K,Y,ue,se,O,F,x,V,W,ie,Te,He,ze,Ue,Ie,vt,De,bn,En;const zt=M.strict,$n=(N=M.code)===null||N===void 0?void 0:N.optimize,Hi=$n===!0||$n===void 0?1:$n||0,Bi=(A=(j=M.code)===null||j===void 0?void 0:j.regExp)!==null&&A!==void 0?A:o,lc=(S=M.uriResolver)!==null&&S!==void 0?S:i.default;return{strictSchema:(q=(I=M.strictSchema)!==null&&I!==void 0?I:zt)!==null&&q!==void 0?q:!0,strictNumbers:(Y=(K=M.strictNumbers)!==null&&K!==void 0?K:zt)!==null&&Y!==void 0?Y:!0,strictTypes:(se=(ue=M.strictTypes)!==null&&ue!==void 0?ue:zt)!==null&&se!==void 0?se:"log",strictTuples:(F=(O=M.strictTuples)!==null&&O!==void 0?O:zt)!==null&&F!==void 0?F:"log",strictRequired:(V=(x=M.strictRequired)!==null&&x!==void 0?x:zt)!==null&&V!==void 0?V:!1,code:M.code?{...M.code,optimize:Hi,regExp:Bi}:{optimize:Hi,regExp:Bi},loopRequired:(W=M.loopRequired)!==null&&W!==void 0?W:h,loopEnum:(ie=M.loopEnum)!==null&&ie!==void 0?ie:h,meta:(Te=M.meta)!==null&&Te!==void 0?Te:!0,messages:(He=M.messages)!==null&&He!==void 0?He:!0,inlineRefs:(ze=M.inlineRefs)!==null&&ze!==void 0?ze:!0,schemaId:(Ue=M.schemaId)!==null&&Ue!==void 0?Ue:"$id",addUsedSchema:(Ie=M.addUsedSchema)!==null&&Ie!==void 0?Ie:!0,validateSchema:(vt=M.validateSchema)!==null&&vt!==void 0?vt:!0,validateFormats:(De=M.validateFormats)!==null&&De!==void 0?De:!0,unicodeRegExp:(bn=M.unicodeRegExp)!==null&&bn!==void 0?bn:!0,int32range:(En=M.int32range)!==null&&En!==void 0?En:!0,uriResolver:lc}}class w{constructor(N={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,N=this.opts={...N,...g(N)};const{es5:j,lines:A}=this.opts.code;this.scope=new d.ValueScope({scope:{},prefixes:f,es5:j,lines:A}),this.logger=z(N.logger);const S=N.validateFormats;N.validateFormats=!1,this.RULES=(0,a.getRules)(),y.call(this,l,N,"NOT SUPPORTED"),y.call(this,m,N,"DEPRECATED","warn"),this._metaOpts=P.call(this),N.formats&&C.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),N.keywords&&T.call(this,N.keywords),typeof N.meta=="object"&&this.addMetaSchema(N.meta),k.call(this),N.validateFormats=S}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:N,meta:j,schemaId:A}=this.opts;let S=b;A==="id"&&(S={...b},S.id=S.$id,delete S.$id),j&&N&&this.addMetaSchema(S,S[A],!1)}defaultMeta(){const{meta:N,schemaId:j}=this.opts;return this.opts.defaultMeta=typeof N=="object"?N[j]||N:void 0}validate(N,j){let A;if(typeof N=="string"){if(A=this.getSchema(N),!A)throw new Error(`no schema with key or ref "${N}"`)}else A=this.compile(N);const S=A(j);return"$async"in A||(this.errors=A.errors),S}compile(N,j){const A=this._addSchema(N,j);return A.validate||this._compileSchemaEnv(A)}compileAsync(N,j){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");const{loadSchema:A}=this.opts;return S.call(this,N,j);async function S(se,O){await I.call(this,se.$schema);const F=this._addSchema(se,O);return F.validate||q.call(this,F)}async function I(se){se&&!this.getSchema(se)&&await S.call(this,{$ref:se},!0)}async function q(se){try{return this._compileSchemaEnv(se)}catch(O){if(!(O instanceof s.default))throw O;return K.call(this,O),await Y.call(this,O.missingSchema),q.call(this,se)}}function K({missingSchema:se,missingRef:O}){if(this.refs[se])throw new Error(`AnySchema ${se} is loaded but ${O} cannot be resolved`)}async function Y(se){const O=await ue.call(this,se);this.refs[se]||await I.call(this,O.$schema),this.refs[se]||this.addSchema(O,se,j)}async function ue(se){const O=this._loading[se];if(O)return O;try{return await(this._loading[se]=A(se))}finally{delete this._loading[se]}}}addSchema(N,j,A,S=this.opts.validateSchema){if(Array.isArray(N)){for(const q of N)this.addSchema(q,void 0,A,S);return this}let I;if(typeof N=="object"){const{schemaId:q}=this.opts;if(I=N[q],I!==void 0&&typeof I!="string")throw new Error(`schema ${q} must be string`)}return j=(0,p.normalizeId)(j||I),this._checkUnique(j),this.schemas[j]=this._addSchema(N,A,j,S,!0),this}addMetaSchema(N,j,A=this.opts.validateSchema){return this.addSchema(N,j,!0,A),this}validateSchema(N,j){if(typeof N=="boolean")return!0;let A;if(A=N.$schema,A!==void 0&&typeof A!="string")throw new Error("$schema must be a string");if(A=A||this.opts.defaultMeta||this.defaultMeta(),!A)return this.logger.warn("meta-schema not available"),this.errors=null,!0;const S=this.validate(A,N);if(!S&&j){const I="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(I);else throw new Error(I)}return S}getSchema(N){let j;for(;typeof(j=E.call(this,N))=="string";)N=j;if(j===void 0){const{schemaId:A}=this.opts,S=new u.SchemaEnv({schema:{},schemaId:A});if(j=u.resolveSchema.call(this,S,N),!j)return;this.refs[N]=j}return j.validate||this._compileSchemaEnv(j)}removeSchema(N){if(N instanceof RegExp)return this._removeAllSchemas(this.schemas,N),this._removeAllSchemas(this.refs,N),this;switch(typeof N){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{const j=E.call(this,N);return typeof j=="object"&&this._cache.delete(j.schema),delete this.schemas[N],delete this.refs[N],this}case"object":{const j=N;this._cache.delete(j);let A=N[this.opts.schemaId];return A&&(A=(0,p.normalizeId)(A),delete this.schemas[A],delete this.refs[A]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(N){for(const j of N)this.addKeyword(j);return this}addKeyword(N,j){let A;if(typeof N=="string")A=N,typeof j=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),j.keyword=A);else if(typeof N=="object"&&j===void 0){if(j=N,A=j.keyword,Array.isArray(A)&&!A.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(Z.call(this,A,j),!j)return(0,v.eachItem)(A,I=>Q.call(this,I)),this;le.call(this,j);const S={...j,type:(0,_.getJSONTypes)(j.type),schemaType:(0,_.getJSONTypes)(j.schemaType)};return(0,v.eachItem)(A,S.type.length===0?I=>Q.call(this,I,S):I=>S.type.forEach(q=>Q.call(this,I,S,q))),this}getKeyword(N){const j=this.RULES.all[N];return typeof j=="object"?j.definition:!!j}removeKeyword(N){const{RULES:j}=this;delete j.keywords[N],delete j.all[N];for(const A of j.rules){const S=A.rules.findIndex(I=>I.keyword===N);S>=0&&A.rules.splice(S,1)}return this}addFormat(N,j){return typeof j=="string"&&(j=new RegExp(j)),this.formats[N]=j,this}errorsText(N=this.errors,{separator:j=", ",dataVar:A="data"}={}){return!N||N.length===0?"No errors":N.map(S=>`${A}${S.instancePath} ${S.message}`).reduce((S,I)=>S+j+I)}$dataMetaSchema(N,j){const A=this.RULES.all;N=JSON.parse(JSON.stringify(N));for(const S of j){const I=S.split("/").slice(1);let q=N;for(const K of I)q=q[K];for(const K in A){const Y=A[K];if(typeof Y!="object")continue;const{$data:ue}=Y.definition,se=q[K];ue&&se&&(q[K]=he(se))}}return N}_removeAllSchemas(N,j){for(const A in N){const S=N[A];(!j||j.test(A))&&(typeof S=="string"?delete N[A]:S&&!S.meta&&(this._cache.delete(S.schema),delete N[A]))}}_addSchema(N,j,A,S=this.opts.validateSchema,I=this.opts.addUsedSchema){let q;const{schemaId:K}=this.opts;if(typeof N=="object")q=N[K];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof N!="boolean")throw new Error("schema must be object or boolean")}let Y=this._cache.get(N);if(Y!==void 0)return Y;A=(0,p.normalizeId)(q||A);const ue=p.getSchemaRefs.call(this,N,A);return Y=new u.SchemaEnv({schema:N,schemaId:K,meta:j,baseId:A,localRefs:ue}),this._cache.set(Y.schema,Y),I&&!A.startsWith("#")&&(A&&this._checkUnique(A),this.refs[A]=Y),S&&this.validateSchema(N,!0),Y}_checkUnique(N){if(this.schemas[N]||this.refs[N])throw new Error(`schema with key or id "${N}" already exists`)}_compileSchemaEnv(N){if(N.meta?this._compileMetaSchema(N):u.compileSchema.call(this,N),!N.validate)throw new Error("ajv implementation error");return N.validate}_compileMetaSchema(N){const j=this.opts;this.opts=this._metaOpts;try{u.compileSchema.call(this,N)}finally{this.opts=j}}}w.ValidationError=n.default,w.MissingRefError=s.default,e.default=w;function y(M,N,j,A="error"){for(const S in M){const I=S;I in N&&this.logger[A](`${j}: option ${S}. ${M[I]}`)}}function E(M){return M=(0,p.normalizeId)(M),this.schemas[M]||this.refs[M]}function k(){const M=this.opts.schemas;if(M)if(Array.isArray(M))this.addSchema(M);else for(const N in M)this.addSchema(M[N],N)}function C(){for(const M in this.opts.formats){const N=this.opts.formats[M];N&&this.addFormat(M,N)}}function T(M){if(Array.isArray(M)){this.addVocabulary(M);return}this.logger.warn("keywords option as map is deprecated, pass array");for(const N in M){const j=M[N];j.keyword||(j.keyword=N),this.addKeyword(j)}}function P(){const M={...this.opts};for(const N of c)delete M[N];return M}const $={log(){},warn(){},error(){}};function z(M){if(M===!1)return $;if(M===void 0)return console;if(M.log&&M.warn&&M.error)return M;throw new Error("logger must implement log, warn and error methods")}const L=/^[a-z_$][a-z0-9_$:-]*$/i;function Z(M,N){const{RULES:j}=this;if((0,v.eachItem)(M,A=>{if(j.keywords[A])throw new Error(`Keyword ${A} is already defined`);if(!L.test(A))throw new Error(`Keyword ${A} has invalid name`)}),!!N&&N.$data&&!("code"in N||"validate"in N))throw new Error('$data keyword must have "code" or "validate" function')}function Q(M,N,j){var A;const S=N==null?void 0:N.post;if(j&&S)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:I}=this;let q=S?I.post:I.rules.find(({type:Y})=>Y===j);if(q||(q={type:j,rules:[]},I.rules.push(q)),I.keywords[M]=!0,!N)return;const K={keyword:M,definition:{...N,type:(0,_.getJSONTypes)(N.type),schemaType:(0,_.getJSONTypes)(N.schemaType)}};N.before?ae.call(this,q,K,N.before):q.rules.push(K),I.all[M]=K,(A=N.implements)===null||A===void 0||A.forEach(Y=>this.addKeyword(Y))}function ae(M,N,j){const A=M.rules.findIndex(S=>S.keyword===j);A>=0?M.rules.splice(A,0,N):(M.rules.push(N),this.logger.warn(`rule ${j} is not defined`))}function le(M){let{metaSchema:N}=M;N!==void 0&&(M.$data&&this.opts.$data&&(N=he(N)),M.validateSchema=this.compile(N,!0))}const ee={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function he(M){return{anyOf:[M,ee]}}})(Tn)),Tn}var ur={},lr={},dr={},Go;function Mp(){if(Go)return dr;Go=1,Object.defineProperty(dr,"__esModule",{value:!0});const e={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};return dr.default=e,dr}var tt={},Wo;function xp(){if(Wo)return tt;Wo=1,Object.defineProperty(tt,"__esModule",{value:!0}),tt.callRef=tt.getValidate=void 0;const e=wn(),t=Ge(),r=ne(),n=ct(),s=xi(),a=ce(),u={keyword:"$ref",schemaType:"string",code(_){const{gen:v,schema:b,it:i}=_,{baseId:o,schemaEnv:c,validateName:f,opts:l,self:m}=i,{root:h}=c;if((b==="#"||b==="#/")&&o===h.baseId)return w();const g=s.resolveRef.call(m,h,o,b);if(g===void 0)throw new e.default(i.opts.uriResolver,o,b);if(g instanceof s.SchemaEnv)return y(g);return E(g);function w(){if(c===h)return p(_,f,c,c.$async);const k=v.scopeValue("root",{ref:h});return p(_,(0,r._)`${k}.validate`,h,h.$async)}function y(k){const C=d(_,k);p(_,C,k,k.$async)}function E(k){const C=v.scopeValue("schema",l.code.source===!0?{ref:k,code:(0,r.stringify)(k)}:{ref:k}),T=v.name("valid"),P=_.subschema({schema:k,dataTypes:[],schemaPath:r.nil,topSchemaRef:C,errSchemaPath:b},T);_.mergeEvaluated(P),_.ok(T)}}};function d(_,v){const{gen:b}=_;return v.validate?b.scopeValue("validate",{ref:v.validate}):(0,r._)`${b.scopeValue("wrapper",{ref:v})}.validate`}tt.getValidate=d;function p(_,v,b,i){const{gen:o,it:c}=_,{allErrors:f,schemaEnv:l,opts:m}=c,h=m.passContext?n.default.this:r.nil;i?g():w();function g(){if(!l.$async)throw new Error("async schema referenced by sync schema");const k=o.let("valid");o.try(()=>{o.code((0,r._)`await ${(0,t.callValidateCode)(_,v,h)}`),E(v),f||o.assign(k,!0)},C=>{o.if((0,r._)`!(${C} instanceof ${c.ValidationError})`,()=>o.throw(C)),y(C),f||o.assign(k,!1)}),_.ok(k)}function w(){_.result((0,t.callValidateCode)(_,v,h),()=>E(v),()=>y(v))}function y(k){const C=(0,r._)`${k}.errors`;o.assign(n.default.vErrors,(0,r._)`${n.default.vErrors} === null ? ${C} : ${n.default.vErrors}.concat(${C})`),o.assign(n.default.errors,(0,r._)`${n.default.vErrors}.length`)}function E(k){var C;if(!c.opts.unevaluated)return;const T=(C=b==null?void 0:b.validate)===null||C===void 0?void 0:C.evaluated;if(c.props!==!0)if(T&&!T.dynamicProps)T.props!==void 0&&(c.props=a.mergeEvaluated.props(o,T.props,c.props));else{const P=o.var("props",(0,r._)`${k}.evaluated.props`);c.props=a.mergeEvaluated.props(o,P,c.props,r.Name)}if(c.items!==!0)if(T&&!T.dynamicItems)T.items!==void 0&&(c.items=a.mergeEvaluated.items(o,T.items,c.items));else{const P=o.var("items",(0,r._)`${k}.evaluated.items`);c.items=a.mergeEvaluated.items(o,P,c.items,r.Name)}}}return tt.callRef=p,tt.default=u,tt}var Jo;function Lp(){if(Jo)return lr;Jo=1,Object.defineProperty(lr,"__esModule",{value:!0});const e=Mp(),t=xp(),r=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",e.default,t.default];return lr.default=r,lr}var hr={},fr={},Yo;function Dp(){if(Yo)return fr;Yo=1,Object.defineProperty(fr,"__esModule",{value:!0});const e=ne(),t=e.operators,r={maximum:{okStr:"<=",ok:t.LTE,fail:t.GT},minimum:{okStr:">=",ok:t.GTE,fail:t.LT},exclusiveMaximum:{okStr:"<",ok:t.LT,fail:t.GTE},exclusiveMinimum:{okStr:">",ok:t.GT,fail:t.LTE}},n={message:({keyword:a,schemaCode:u})=>(0,e.str)`must be ${r[a].okStr} ${u}`,params:({keyword:a,schemaCode:u})=>(0,e._)`{comparison: ${r[a].okStr}, limit: ${u}}`},s={keyword:Object.keys(r),type:"number",schemaType:"number",$data:!0,error:n,code(a){const{keyword:u,data:d,schemaCode:p}=a;a.fail$data((0,e._)`${d} ${r[u].fail} ${p} || isNaN(${d})`)}};return fr.default=s,fr}var pr={},Qo;function Zp(){if(Qo)return pr;Qo=1,Object.defineProperty(pr,"__esModule",{value:!0});const e=ne(),r={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:{message:({schemaCode:n})=>(0,e.str)`must be multiple of ${n}`,params:({schemaCode:n})=>(0,e._)`{multipleOf: ${n}}`},code(n){const{gen:s,data:a,schemaCode:u,it:d}=n,p=d.opts.multipleOfPrecision,_=s.let("res"),v=p?(0,e._)`Math.abs(Math.round(${_}) - ${_}) > 1e-${p}`:(0,e._)`${_} !== parseInt(${_})`;n.fail$data((0,e._)`(${u} === 0 || (${_} = ${a}/${u}, ${v}))`)}};return pr.default=r,pr}var mr={},gr={},Xo;function Vp(){if(Xo)return gr;Xo=1,Object.defineProperty(gr,"__esModule",{value:!0});function e(t){const r=t.length;let n=0,s=0,a;for(;s<r;)n++,a=t.charCodeAt(s++),a>=55296&&a<=56319&&s<r&&(a=t.charCodeAt(s),(a&64512)===56320&&s++);return n}return gr.default=e,e.code='require("ajv/dist/runtime/ucs2length").default',gr}var es;function Hp(){if(es)return mr;es=1,Object.defineProperty(mr,"__esModule",{value:!0});const e=ne(),t=ce(),r=Vp(),s={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:{message({keyword:a,schemaCode:u}){const d=a==="maxLength"?"more":"fewer";return(0,e.str)`must NOT have ${d} than ${u} characters`},params:({schemaCode:a})=>(0,e._)`{limit: ${a}}`},code(a){const{keyword:u,data:d,schemaCode:p,it:_}=a,v=u==="maxLength"?e.operators.GT:e.operators.LT,b=_.opts.unicode===!1?(0,e._)`${d}.length`:(0,e._)`${(0,t.useFunc)(a.gen,r.default)}(${d})`;a.fail$data((0,e._)`${b} ${v} ${p}`)}};return mr.default=s,mr}var _r={},ts;function Bp(){if(ts)return _r;ts=1,Object.defineProperty(_r,"__esModule",{value:!0});const e=Ge(),t=ne(),n={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:{message:({schemaCode:s})=>(0,t.str)`must match pattern "${s}"`,params:({schemaCode:s})=>(0,t._)`{pattern: ${s}}`},code(s){const{data:a,$data:u,schema:d,schemaCode:p,it:_}=s,v=_.opts.unicodeRegExp?"u":"",b=u?(0,t._)`(new RegExp(${p}, ${v}))`:(0,e.usePattern)(s,d);s.fail$data((0,t._)`!${b}.test(${a})`)}};return _r.default=n,_r}var vr={},rs;function Kp(){if(rs)return vr;rs=1,Object.defineProperty(vr,"__esModule",{value:!0});const e=ne(),r={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:{message({keyword:n,schemaCode:s}){const a=n==="maxProperties"?"more":"fewer";return(0,e.str)`must NOT have ${a} than ${s} properties`},params:({schemaCode:n})=>(0,e._)`{limit: ${n}}`},code(n){const{keyword:s,data:a,schemaCode:u}=n,d=s==="maxProperties"?e.operators.GT:e.operators.LT;n.fail$data((0,e._)`Object.keys(${a}).length ${d} ${u}`)}};return vr.default=r,vr}var yr={},ns;function Gp(){if(ns)return yr;ns=1,Object.defineProperty(yr,"__esModule",{value:!0});const e=Ge(),t=ne(),r=ce(),s={keyword:"required",type:"object",schemaType:"array",$data:!0,error:{message:({params:{missingProperty:a}})=>(0,t.str)`must have required property '${a}'`,params:({params:{missingProperty:a}})=>(0,t._)`{missingProperty: ${a}}`},code(a){const{gen:u,schema:d,schemaCode:p,data:_,$data:v,it:b}=a,{opts:i}=b;if(!v&&d.length===0)return;const o=d.length>=i.loopRequired;if(b.allErrors?c():f(),i.strictRequired){const h=a.parentSchema.properties,{definedProperties:g}=a.it;for(const w of d)if((h==null?void 0:h[w])===void 0&&!g.has(w)){const y=b.schemaEnv.baseId+b.errSchemaPath,E=`required property "${w}" is not defined at "${y}" (strictRequired)`;(0,r.checkStrictMode)(b,E,b.opts.strictRequired)}}function c(){if(o||v)a.block$data(t.nil,l);else for(const h of d)(0,e.checkReportMissingProp)(a,h)}function f(){const h=u.let("missing");if(o||v){const g=u.let("valid",!0);a.block$data(g,()=>m(h,g)),a.ok(g)}else u.if((0,e.checkMissingProp)(a,d,h)),(0,e.reportMissingProp)(a,h),u.else()}function l(){u.forOf("prop",p,h=>{a.setParams({missingProperty:h}),u.if((0,e.noPropertyInData)(u,_,h,i.ownProperties),()=>a.error())})}function m(h,g){a.setParams({missingProperty:h}),u.forOf(h,p,()=>{u.assign(g,(0,e.propertyInData)(u,_,h,i.ownProperties)),u.if((0,t.not)(g),()=>{a.error(),u.break()})},t.nil)}}};return yr.default=s,yr}var wr={},is;function Wp(){if(is)return wr;is=1,Object.defineProperty(wr,"__esModule",{value:!0});const e=ne(),r={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:{message({keyword:n,schemaCode:s}){const a=n==="maxItems"?"more":"fewer";return(0,e.str)`must NOT have ${a} than ${s} items`},params:({schemaCode:n})=>(0,e._)`{limit: ${n}}`},code(n){const{keyword:s,data:a,schemaCode:u}=n,d=s==="maxItems"?e.operators.GT:e.operators.LT;n.fail$data((0,e._)`${a}.length ${d} ${u}`)}};return wr.default=r,wr}var br={},Er={},os;function Li(){if(os)return Er;os=1,Object.defineProperty(Er,"__esModule",{value:!0});const e=ec();return e.code='require("ajv/dist/runtime/equal").default',Er.default=e,Er}var ss;function Jp(){if(ss)return br;ss=1,Object.defineProperty(br,"__esModule",{value:!0});const e=tn(),t=ne(),r=ce(),n=Li(),a={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:{message:({params:{i:u,j:d}})=>(0,t.str)`must NOT have duplicate items (items ## ${d} and ${u} are identical)`,params:({params:{i:u,j:d}})=>(0,t._)`{i: ${u}, j: ${d}}`},code(u){const{gen:d,data:p,$data:_,schema:v,parentSchema:b,schemaCode:i,it:o}=u;if(!_&&!v)return;const c=d.let("valid"),f=b.items?(0,e.getSchemaTypes)(b.items):[];u.block$data(c,l,(0,t._)`${i} === false`),u.ok(c);function l(){const w=d.let("i",(0,t._)`${p}.length`),y=d.let("j");u.setParams({i:w,j:y}),d.assign(c,!0),d.if((0,t._)`${w} > 1`,()=>(m()?h:g)(w,y))}function m(){return f.length>0&&!f.some(w=>w==="object"||w==="array")}function h(w,y){const E=d.name("item"),k=(0,e.checkDataTypes)(f,E,o.opts.strictNumbers,e.DataType.Wrong),C=d.const("indices",(0,t._)`{}`);d.for((0,t._)`;${w}--;`,()=>{d.let(E,(0,t._)`${p}[${w}]`),d.if(k,(0,t._)`continue`),f.length>1&&d.if((0,t._)`typeof ${E} == "string"`,(0,t._)`${E} += "_"`),d.if((0,t._)`typeof ${C}[${E}] == "number"`,()=>{d.assign(y,(0,t._)`${C}[${E}]`),u.error(),d.assign(c,!1).break()}).code((0,t._)`${C}[${E}] = ${w}`)})}function g(w,y){const E=(0,r.useFunc)(d,n.default),k=d.name("outer");d.label(k).for((0,t._)`;${w}--;`,()=>d.for((0,t._)`${y} = ${w}; ${y}--;`,()=>d.if((0,t._)`${E}(${p}[${w}], ${p}[${y}])`,()=>{u.error(),d.assign(c,!1).break(k)})))}}};return br.default=a,br}var $r={},as;function Yp(){if(as)return $r;as=1,Object.defineProperty($r,"__esModule",{value:!0});const e=ne(),t=ce(),r=Li(),s={keyword:"const",$data:!0,error:{message:"must be equal to constant",params:({schemaCode:a})=>(0,e._)`{allowedValue: ${a}}`},code(a){const{gen:u,data:d,$data:p,schemaCode:_,schema:v}=a;p||v&&typeof v=="object"?a.fail$data((0,e._)`!${(0,t.useFunc)(u,r.default)}(${d}, ${_})`):a.fail((0,e._)`${v} !== ${d}`)}};return $r.default=s,$r}var Sr={},cs;function Qp(){if(cs)return Sr;cs=1,Object.defineProperty(Sr,"__esModule",{value:!0});const e=ne(),t=ce(),r=Li(),s={keyword:"enum",schemaType:"array",$data:!0,error:{message:"must be equal to one of the allowed values",params:({schemaCode:a})=>(0,e._)`{allowedValues: ${a}}`},code(a){const{gen:u,data:d,$data:p,schema:_,schemaCode:v,it:b}=a;if(!p&&_.length===0)throw new Error("enum must have non-empty array");const i=_.length>=b.opts.loopEnum;let o;const c=()=>o??(o=(0,t.useFunc)(u,r.default));let f;if(i||p)f=u.let("valid"),a.block$data(f,l);else{if(!Array.isArray(_))throw new Error("ajv implementation error");const h=u.const("vSchema",v);f=(0,e.or)(..._.map((g,w)=>m(h,w)))}a.pass(f);function l(){u.assign(f,!1),u.forOf("v",v,h=>u.if((0,e._)`${c()}(${d}, ${h})`,()=>u.assign(f,!0).break()))}function m(h,g){const w=_[g];return typeof w=="object"&&w!==null?(0,e._)`${c()}(${d}, ${h}[${g}])`:(0,e._)`${d} === ${w}`}}};return Sr.default=s,Sr}var us;function Xp(){if(us)return hr;us=1,Object.defineProperty(hr,"__esModule",{value:!0});const e=Dp(),t=Zp(),r=Hp(),n=Bp(),s=Kp(),a=Gp(),u=Wp(),d=Jp(),p=Yp(),_=Qp(),v=[e.default,t.default,r.default,n.default,s.default,a.default,u.default,d.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},p.default,_.default];return hr.default=v,hr}var kr={},yt={},ls;function rc(){if(ls)return yt;ls=1,Object.defineProperty(yt,"__esModule",{value:!0}),yt.validateAdditionalItems=void 0;const e=ne(),t=ce(),n={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:{message:({params:{len:a}})=>(0,e.str)`must NOT have more than ${a} items`,params:({params:{len:a}})=>(0,e._)`{limit: ${a}}`},code(a){const{parentSchema:u,it:d}=a,{items:p}=u;if(!Array.isArray(p)){(0,t.checkStrictMode)(d,'"additionalItems" is ignored when "items" is not an array of schemas');return}s(a,p)}};function s(a,u){const{gen:d,schema:p,data:_,keyword:v,it:b}=a;b.items=!0;const i=d.const("len",(0,e._)`${_}.length`);if(p===!1)a.setParams({len:u.length}),a.pass((0,e._)`${i} <= ${u.length}`);else if(typeof p=="object"&&!(0,t.alwaysValidSchema)(b,p)){const c=d.var("valid",(0,e._)`${i} <= ${u.length}`);d.if((0,e.not)(c),()=>o(c)),a.ok(c)}function o(c){d.forRange("i",u.length,i,f=>{a.subschema({keyword:v,dataProp:f,dataPropType:t.Type.Num},c),b.allErrors||d.if((0,e.not)(c),()=>d.break())})}}return yt.validateAdditionalItems=s,yt.default=n,yt}var Tr={},wt={},ds;function nc(){if(ds)return wt;ds=1,Object.defineProperty(wt,"__esModule",{value:!0}),wt.validateTuple=void 0;const e=ne(),t=ce(),r=Ge(),n={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(a){const{schema:u,it:d}=a;if(Array.isArray(u))return s(a,"additionalItems",u);d.items=!0,!(0,t.alwaysValidSchema)(d,u)&&a.ok((0,r.validateArray)(a))}};function s(a,u,d=a.schema){const{gen:p,parentSchema:_,data:v,keyword:b,it:i}=a;f(_),i.opts.unevaluated&&d.length&&i.items!==!0&&(i.items=t.mergeEvaluated.items(p,d.length,i.items));const o=p.name("valid"),c=p.const("len",(0,e._)`${v}.length`);d.forEach((l,m)=>{(0,t.alwaysValidSchema)(i,l)||(p.if((0,e._)`${c} > ${m}`,()=>a.subschema({keyword:b,schemaProp:m,dataProp:m},o)),a.ok(o))});function f(l){const{opts:m,errSchemaPath:h}=i,g=d.length,w=g===l.minItems&&(g===l.maxItems||l[u]===!1);if(m.strictTuples&&!w){const y=`"${b}" is ${g}-tuple, but minItems or maxItems/${u} are not specified or different at path "${h}"`;(0,t.checkStrictMode)(i,y,m.strictTuples)}}}return wt.validateTuple=s,wt.default=n,wt}var hs;function em(){if(hs)return Tr;hs=1,Object.defineProperty(Tr,"__esModule",{value:!0});const e=nc(),t={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:r=>(0,e.validateTuple)(r,"items")};return Tr.default=t,Tr}var Ir={},fs;function tm(){if(fs)return Ir;fs=1,Object.defineProperty(Ir,"__esModule",{value:!0});const e=ne(),t=ce(),r=Ge(),n=rc(),a={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:{message:({params:{len:u}})=>(0,e.str)`must NOT have more than ${u} items`,params:({params:{len:u}})=>(0,e._)`{limit: ${u}}`},code(u){const{schema:d,parentSchema:p,it:_}=u,{prefixItems:v}=p;_.items=!0,!(0,t.alwaysValidSchema)(_,d)&&(v?(0,n.validateAdditionalItems)(u,v):u.ok((0,r.validateArray)(u)))}};return Ir.default=a,Ir}var Rr={},ps;function rm(){if(ps)return Rr;ps=1,Object.defineProperty(Rr,"__esModule",{value:!0});const e=ne(),t=ce(),n={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:{message:({params:{min:s,max:a}})=>a===void 0?(0,e.str)`must contain at least ${s} valid item(s)`:(0,e.str)`must contain at least ${s} and no more than ${a} valid item(s)`,params:({params:{min:s,max:a}})=>a===void 0?(0,e._)`{minContains: ${s}}`:(0,e._)`{minContains: ${s}, maxContains: ${a}}`},code(s){const{gen:a,schema:u,parentSchema:d,data:p,it:_}=s;let v,b;const{minContains:i,maxContains:o}=d;_.opts.next?(v=i===void 0?1:i,b=o):v=1;const c=a.const("len",(0,e._)`${p}.length`);if(s.setParams({min:v,max:b}),b===void 0&&v===0){(0,t.checkStrictMode)(_,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(b!==void 0&&v>b){(0,t.checkStrictMode)(_,'"minContains" > "maxContains" is always invalid'),s.fail();return}if((0,t.alwaysValidSchema)(_,u)){let g=(0,e._)`${c} >= ${v}`;b!==void 0&&(g=(0,e._)`${g} && ${c} <= ${b}`),s.pass(g);return}_.items=!0;const f=a.name("valid");b===void 0&&v===1?m(f,()=>a.if(f,()=>a.break())):v===0?(a.let(f,!0),b!==void 0&&a.if((0,e._)`${p}.length > 0`,l)):(a.let(f,!1),l()),s.result(f,()=>s.reset());function l(){const g=a.name("_valid"),w=a.let("count",0);m(g,()=>a.if(g,()=>h(w)))}function m(g,w){a.forRange("i",0,c,y=>{s.subschema({keyword:"contains",dataProp:y,dataPropType:t.Type.Num,compositeRule:!0},g),w()})}function h(g){a.code((0,e._)`${g}++`),b===void 0?a.if((0,e._)`${g} >= ${v}`,()=>a.assign(f,!0).break()):(a.if((0,e._)`${g} > ${b}`,()=>a.assign(f,!1).break()),v===1?a.assign(f,!0):a.if((0,e._)`${g} >= ${v}`,()=>a.assign(f,!0)))}}};return Rr.default=n,Rr}var zn={},ms;function nm(){return ms||(ms=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.validateSchemaDeps=e.validatePropertyDeps=e.error=void 0;const t=ne(),r=ce(),n=Ge();e.error={message:({params:{property:p,depsCount:_,deps:v}})=>{const b=_===1?"property":"properties";return(0,t.str)`must have ${b} ${v} when property ${p} is present`},params:({params:{property:p,depsCount:_,deps:v,missingProperty:b}})=>(0,t._)`{property: ${p},
    missingProperty: ${b},
    depsCount: ${_},
    deps: ${v}}`};const s={keyword:"dependencies",type:"object",schemaType:"object",error:e.error,code(p){const[_,v]=a(p);u(p,_),d(p,v)}};function a({schema:p}){const _={},v={};for(const b in p){if(b==="__proto__")continue;const i=Array.isArray(p[b])?_:v;i[b]=p[b]}return[_,v]}function u(p,_=p.schema){const{gen:v,data:b,it:i}=p;if(Object.keys(_).length===0)return;const o=v.let("missing");for(const c in _){const f=_[c];if(f.length===0)continue;const l=(0,n.propertyInData)(v,b,c,i.opts.ownProperties);p.setParams({property:c,depsCount:f.length,deps:f.join(", ")}),i.allErrors?v.if(l,()=>{for(const m of f)(0,n.checkReportMissingProp)(p,m)}):(v.if((0,t._)`${l} && (${(0,n.checkMissingProp)(p,f,o)})`),(0,n.reportMissingProp)(p,o),v.else())}}e.validatePropertyDeps=u;function d(p,_=p.schema){const{gen:v,data:b,keyword:i,it:o}=p,c=v.name("valid");for(const f in _)(0,r.alwaysValidSchema)(o,_[f])||(v.if((0,n.propertyInData)(v,b,f,o.opts.ownProperties),()=>{const l=p.subschema({keyword:i,schemaProp:f},c);p.mergeValidEvaluated(l,c)},()=>v.var(c,!0)),p.ok(c))}e.validateSchemaDeps=d,e.default=s})(zn)),zn}var Pr={},gs;function im(){if(gs)return Pr;gs=1,Object.defineProperty(Pr,"__esModule",{value:!0});const e=ne(),t=ce(),n={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:{message:"property name must be valid",params:({params:s})=>(0,e._)`{propertyName: ${s.propertyName}}`},code(s){const{gen:a,schema:u,data:d,it:p}=s;if((0,t.alwaysValidSchema)(p,u))return;const _=a.name("valid");a.forIn("key",d,v=>{s.setParams({propertyName:v}),s.subschema({keyword:"propertyNames",data:v,dataTypes:["string"],propertyName:v,compositeRule:!0},_),a.if((0,e.not)(_),()=>{s.error(!0),p.allErrors||a.break()})}),s.ok(_)}};return Pr.default=n,Pr}var Nr={},_s;function ic(){if(_s)return Nr;_s=1,Object.defineProperty(Nr,"__esModule",{value:!0});const e=Ge(),t=ne(),r=ct(),n=ce(),a={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:{message:"must NOT have additional properties",params:({params:u})=>(0,t._)`{additionalProperty: ${u.additionalProperty}}`},code(u){const{gen:d,schema:p,parentSchema:_,data:v,errsCount:b,it:i}=u;if(!b)throw new Error("ajv implementation error");const{allErrors:o,opts:c}=i;if(i.props=!0,c.removeAdditional!=="all"&&(0,n.alwaysValidSchema)(i,p))return;const f=(0,e.allSchemaProperties)(_.properties),l=(0,e.allSchemaProperties)(_.patternProperties);m(),u.ok((0,t._)`${b} === ${r.default.errors}`);function m(){d.forIn("key",v,E=>{!f.length&&!l.length?w(E):d.if(h(E),()=>w(E))})}function h(E){let k;if(f.length>8){const C=(0,n.schemaRefOrVal)(i,_.properties,"properties");k=(0,e.isOwnProperty)(d,C,E)}else f.length?k=(0,t.or)(...f.map(C=>(0,t._)`${E} === ${C}`)):k=t.nil;return l.length&&(k=(0,t.or)(k,...l.map(C=>(0,t._)`${(0,e.usePattern)(u,C)}.test(${E})`))),(0,t.not)(k)}function g(E){d.code((0,t._)`delete ${v}[${E}]`)}function w(E){if(c.removeAdditional==="all"||c.removeAdditional&&p===!1){g(E);return}if(p===!1){u.setParams({additionalProperty:E}),u.error(),o||d.break();return}if(typeof p=="object"&&!(0,n.alwaysValidSchema)(i,p)){const k=d.name("valid");c.removeAdditional==="failing"?(y(E,k,!1),d.if((0,t.not)(k),()=>{u.reset(),g(E)})):(y(E,k),o||d.if((0,t.not)(k),()=>d.break()))}}function y(E,k,C){const T={keyword:"additionalProperties",dataProp:E,dataPropType:n.Type.Str};C===!1&&Object.assign(T,{compositeRule:!0,createErrors:!1,allErrors:!1}),u.subschema(T,k)}}};return Nr.default=a,Nr}var Or={},vs;function om(){if(vs)return Or;vs=1,Object.defineProperty(Or,"__esModule",{value:!0});const e=yn(),t=Ge(),r=ce(),n=ic(),s={keyword:"properties",type:"object",schemaType:"object",code(a){const{gen:u,schema:d,parentSchema:p,data:_,it:v}=a;v.opts.removeAdditional==="all"&&p.additionalProperties===void 0&&n.default.code(new e.KeywordCxt(v,n.default,"additionalProperties"));const b=(0,t.allSchemaProperties)(d);for(const l of b)v.definedProperties.add(l);v.opts.unevaluated&&b.length&&v.props!==!0&&(v.props=r.mergeEvaluated.props(u,(0,r.toHash)(b),v.props));const i=b.filter(l=>!(0,r.alwaysValidSchema)(v,d[l]));if(i.length===0)return;const o=u.name("valid");for(const l of i)c(l)?f(l):(u.if((0,t.propertyInData)(u,_,l,v.opts.ownProperties)),f(l),v.allErrors||u.else().var(o,!0),u.endIf()),a.it.definedProperties.add(l),a.ok(o);function c(l){return v.opts.useDefaults&&!v.compositeRule&&d[l].default!==void 0}function f(l){a.subschema({keyword:"properties",schemaProp:l,dataProp:l},o)}}};return Or.default=s,Or}var Cr={},ys;function sm(){if(ys)return Cr;ys=1,Object.defineProperty(Cr,"__esModule",{value:!0});const e=Ge(),t=ne(),r=ce(),n=ce(),s={keyword:"patternProperties",type:"object",schemaType:"object",code(a){const{gen:u,schema:d,data:p,parentSchema:_,it:v}=a,{opts:b}=v,i=(0,e.allSchemaProperties)(d),o=i.filter(w=>(0,r.alwaysValidSchema)(v,d[w]));if(i.length===0||o.length===i.length&&(!v.opts.unevaluated||v.props===!0))return;const c=b.strictSchema&&!b.allowMatchingProperties&&_.properties,f=u.name("valid");v.props!==!0&&!(v.props instanceof t.Name)&&(v.props=(0,n.evaluatedPropsToName)(u,v.props));const{props:l}=v;m();function m(){for(const w of i)c&&h(w),v.allErrors?g(w):(u.var(f,!0),g(w),u.if(f))}function h(w){for(const y in c)new RegExp(w).test(y)&&(0,r.checkStrictMode)(v,`property ${y} matches pattern ${w} (use allowMatchingProperties)`)}function g(w){u.forIn("key",p,y=>{u.if((0,t._)`${(0,e.usePattern)(a,w)}.test(${y})`,()=>{const E=o.includes(w);E||a.subschema({keyword:"patternProperties",schemaProp:w,dataProp:y,dataPropType:n.Type.Str},f),v.opts.unevaluated&&l!==!0?u.assign((0,t._)`${l}[${y}]`,!0):!E&&!v.allErrors&&u.if((0,t.not)(f),()=>u.break())})})}}};return Cr.default=s,Cr}var Ar={},ws;function am(){if(ws)return Ar;ws=1,Object.defineProperty(Ar,"__esModule",{value:!0});const e=ce(),t={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(r){const{gen:n,schema:s,it:a}=r;if((0,e.alwaysValidSchema)(a,s)){r.fail();return}const u=n.name("valid");r.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},u),r.failResult(u,()=>r.reset(),()=>r.error())},error:{message:"must NOT be valid"}};return Ar.default=t,Ar}var Fr={},bs;function cm(){if(bs)return Fr;bs=1,Object.defineProperty(Fr,"__esModule",{value:!0});const t={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:Ge().validateUnion,error:{message:"must match a schema in anyOf"}};return Fr.default=t,Fr}var zr={},Es;function um(){if(Es)return zr;Es=1,Object.defineProperty(zr,"__esModule",{value:!0});const e=ne(),t=ce(),n={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:{message:"must match exactly one schema in oneOf",params:({params:s})=>(0,e._)`{passingSchemas: ${s.passing}}`},code(s){const{gen:a,schema:u,parentSchema:d,it:p}=s;if(!Array.isArray(u))throw new Error("ajv implementation error");if(p.opts.discriminator&&d.discriminator)return;const _=u,v=a.let("valid",!1),b=a.let("passing",null),i=a.name("_valid");s.setParams({passing:b}),a.block(o),s.result(v,()=>s.reset(),()=>s.error(!0));function o(){_.forEach((c,f)=>{let l;(0,t.alwaysValidSchema)(p,c)?a.var(i,!0):l=s.subschema({keyword:"oneOf",schemaProp:f,compositeRule:!0},i),f>0&&a.if((0,e._)`${i} && ${v}`).assign(v,!1).assign(b,(0,e._)`[${b}, ${f}]`).else(),a.if(i,()=>{a.assign(v,!0),a.assign(b,f),l&&s.mergeEvaluated(l,e.Name)})})}}};return zr.default=n,zr}var Ur={},$s;function lm(){if($s)return Ur;$s=1,Object.defineProperty(Ur,"__esModule",{value:!0});const e=ce(),t={keyword:"allOf",schemaType:"array",code(r){const{gen:n,schema:s,it:a}=r;if(!Array.isArray(s))throw new Error("ajv implementation error");const u=n.name("valid");s.forEach((d,p)=>{if((0,e.alwaysValidSchema)(a,d))return;const _=r.subschema({keyword:"allOf",schemaProp:p},u);r.ok(u),r.mergeEvaluated(_)})}};return Ur.default=t,Ur}var qr={},Ss;function dm(){if(Ss)return qr;Ss=1,Object.defineProperty(qr,"__esModule",{value:!0});const e=ne(),t=ce(),n={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:{message:({params:a})=>(0,e.str)`must match "${a.ifClause}" schema`,params:({params:a})=>(0,e._)`{failingKeyword: ${a.ifClause}}`},code(a){const{gen:u,parentSchema:d,it:p}=a;d.then===void 0&&d.else===void 0&&(0,t.checkStrictMode)(p,'"if" without "then" and "else" is ignored');const _=s(p,"then"),v=s(p,"else");if(!_&&!v)return;const b=u.let("valid",!0),i=u.name("_valid");if(o(),a.reset(),_&&v){const f=u.let("ifClause");a.setParams({ifClause:f}),u.if(i,c("then",f),c("else",f))}else _?u.if(i,c("then")):u.if((0,e.not)(i),c("else"));a.pass(b,()=>a.error(!0));function o(){const f=a.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},i);a.mergeEvaluated(f)}function c(f,l){return()=>{const m=a.subschema({keyword:f},i);u.assign(b,i),a.mergeValidEvaluated(m,b),l?u.assign(l,(0,e._)`${f}`):a.setParams({ifClause:f})}}}};function s(a,u){const d=a.schema[u];return d!==void 0&&!(0,t.alwaysValidSchema)(a,d)}return qr.default=n,qr}var jr={},ks;function hm(){if(ks)return jr;ks=1,Object.defineProperty(jr,"__esModule",{value:!0});const e=ce(),t={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:r,parentSchema:n,it:s}){n.if===void 0&&(0,e.checkStrictMode)(s,`"${r}" without "if" is ignored`)}};return jr.default=t,jr}var Ts;function fm(){if(Ts)return kr;Ts=1,Object.defineProperty(kr,"__esModule",{value:!0});const e=rc(),t=em(),r=nc(),n=tm(),s=rm(),a=nm(),u=im(),d=ic(),p=om(),_=sm(),v=am(),b=cm(),i=um(),o=lm(),c=dm(),f=hm();function l(m=!1){const h=[v.default,b.default,i.default,o.default,c.default,f.default,u.default,d.default,a.default,p.default,_.default];return m?h.push(t.default,n.default):h.push(e.default,r.default),h.push(s.default),h}return kr.default=l,kr}var Mr={},xr={},Is;function pm(){if(Is)return xr;Is=1,Object.defineProperty(xr,"__esModule",{value:!0});const e=ne(),r={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:{message:({schemaCode:n})=>(0,e.str)`must match format "${n}"`,params:({schemaCode:n})=>(0,e._)`{format: ${n}}`},code(n,s){const{gen:a,data:u,$data:d,schema:p,schemaCode:_,it:v}=n,{opts:b,errSchemaPath:i,schemaEnv:o,self:c}=v;if(!b.validateFormats)return;d?f():l();function f(){const m=a.scopeValue("formats",{ref:c.formats,code:b.code.formats}),h=a.const("fDef",(0,e._)`${m}[${_}]`),g=a.let("fType"),w=a.let("format");a.if((0,e._)`typeof ${h} == "object" && !(${h} instanceof RegExp)`,()=>a.assign(g,(0,e._)`${h}.type || "string"`).assign(w,(0,e._)`${h}.validate`),()=>a.assign(g,(0,e._)`"string"`).assign(w,h)),n.fail$data((0,e.or)(y(),E()));function y(){return b.strictSchema===!1?e.nil:(0,e._)`${_} && !${w}`}function E(){const k=o.$async?(0,e._)`(${h}.async ? await ${w}(${u}) : ${w}(${u}))`:(0,e._)`${w}(${u})`,C=(0,e._)`(typeof ${w} == "function" ? ${k} : ${w}.test(${u}))`;return(0,e._)`${w} && ${w} !== true && ${g} === ${s} && !${C}`}}function l(){const m=c.formats[p];if(!m){y();return}if(m===!0)return;const[h,g,w]=E(m);h===s&&n.pass(k());function y(){if(b.strictSchema===!1){c.logger.warn(C());return}throw new Error(C());function C(){return`unknown format "${p}" ignored in schema at path "${i}"`}}function E(C){const T=C instanceof RegExp?(0,e.regexpCode)(C):b.code.formats?(0,e._)`${b.code.formats}${(0,e.getProperty)(p)}`:void 0,P=a.scopeValue("formats",{key:p,ref:C,code:T});return typeof C=="object"&&!(C instanceof RegExp)?[C.type||"string",C.validate,(0,e._)`${P}.validate`]:["string",C,P]}function k(){if(typeof m=="object"&&!(m instanceof RegExp)&&m.async){if(!o.$async)throw new Error("async format in sync schema");return(0,e._)`await ${w}(${u})`}return typeof g=="function"?(0,e._)`${w}(${u})`:(0,e._)`${w}.test(${u})`}}}};return xr.default=r,xr}var Rs;function mm(){if(Rs)return Mr;Rs=1,Object.defineProperty(Mr,"__esModule",{value:!0});const t=[pm().default];return Mr.default=t,Mr}var ht={},Ps;function gm(){return Ps||(Ps=1,Object.defineProperty(ht,"__esModule",{value:!0}),ht.contentVocabulary=ht.metadataVocabulary=void 0,ht.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"],ht.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]),ht}var Ns;function _m(){if(Ns)return ur;Ns=1,Object.defineProperty(ur,"__esModule",{value:!0});const e=Lp(),t=Xp(),r=fm(),n=mm(),s=gm(),a=[e.default,t.default,(0,r.default)(),n.default,s.metadataVocabulary,s.contentVocabulary];return ur.default=a,ur}var Lr={},jt={},Os;function vm(){if(Os)return jt;Os=1,Object.defineProperty(jt,"__esModule",{value:!0}),jt.DiscrError=void 0;var e;return(function(t){t.Tag="tag",t.Mapping="mapping"})(e||(jt.DiscrError=e={})),jt}var Cs;function ym(){if(Cs)return Lr;Cs=1,Object.defineProperty(Lr,"__esModule",{value:!0});const e=ne(),t=vm(),r=xi(),n=wn(),s=ce(),u={keyword:"discriminator",type:"object",schemaType:"object",error:{message:({params:{discrError:d,tagName:p}})=>d===t.DiscrError.Tag?`tag "${p}" must be string`:`value of tag "${p}" must be in oneOf`,params:({params:{discrError:d,tag:p,tagName:_}})=>(0,e._)`{error: ${d}, tag: ${_}, tagValue: ${p}}`},code(d){const{gen:p,data:_,schema:v,parentSchema:b,it:i}=d,{oneOf:o}=b;if(!i.opts.discriminator)throw new Error("discriminator: requires discriminator option");const c=v.propertyName;if(typeof c!="string")throw new Error("discriminator: requires propertyName");if(v.mapping)throw new Error("discriminator: mapping is not supported");if(!o)throw new Error("discriminator: requires oneOf keyword");const f=p.let("valid",!1),l=p.const("tag",(0,e._)`${_}${(0,e.getProperty)(c)}`);p.if((0,e._)`typeof ${l} == "string"`,()=>m(),()=>d.error(!1,{discrError:t.DiscrError.Tag,tag:l,tagName:c})),d.ok(f);function m(){const w=g();p.if(!1);for(const y in w)p.elseIf((0,e._)`${l} === ${y}`),p.assign(f,h(w[y]));p.else(),d.error(!1,{discrError:t.DiscrError.Mapping,tag:l,tagName:c}),p.endIf()}function h(w){const y=p.name("valid"),E=d.subschema({keyword:"oneOf",schemaProp:w},y);return d.mergeEvaluated(E,e.Name),y}function g(){var w;const y={},E=C(b);let k=!0;for(let $=0;$<o.length;$++){let z=o[$];if(z!=null&&z.$ref&&!(0,s.schemaHasRulesButRef)(z,i.self.RULES)){const Z=z.$ref;if(z=r.resolveRef.call(i.self,i.schemaEnv.root,i.baseId,Z),z instanceof r.SchemaEnv&&(z=z.schema),z===void 0)throw new n.default(i.opts.uriResolver,i.baseId,Z)}const L=(w=z==null?void 0:z.properties)===null||w===void 0?void 0:w[c];if(typeof L!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${c}"`);k=k&&(E||C(z)),T(L,$)}if(!k)throw new Error(`discriminator: "${c}" must be required`);return y;function C({required:$}){return Array.isArray($)&&$.includes(c)}function T($,z){if($.const)P($.const,z);else if($.enum)for(const L of $.enum)P(L,z);else throw new Error(`discriminator: "properties/${c}" must have "const" or "enum"`)}function P($,z){if(typeof $!="string"||$ in y)throw new Error(`discriminator: "${c}" values must be unique strings`);y[$]=z}}}};return Lr.default=u,Lr}const wm="http://json-schema.org/draft-07/schema#",bm="http://json-schema.org/draft-07/schema#",Em="Core schema meta-schema",$m={schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},Sm=["object","boolean"],km={$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},Tm={$schema:wm,$id:bm,title:Em,definitions:$m,type:Sm,properties:km,default:!0};var As;function oc(){return As||(As=1,(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MissingRefError=t.ValidationError=t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=t.Ajv=void 0;const r=jp(),n=_m(),s=ym(),a=Tm,u=["/properties"],d="http://json-schema.org/draft-07/schema";class p extends r.default{_addVocabularies(){super._addVocabularies(),n.default.forEach(c=>this.addVocabulary(c)),this.opts.discriminator&&this.addKeyword(s.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;const c=this.opts.$data?this.$dataMetaSchema(a,u):a;this.addMetaSchema(c,d,!1),this.refs["http://json-schema.org/schema"]=d}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(d)?d:void 0)}}t.Ajv=p,e.exports=t=p,e.exports.Ajv=p,Object.defineProperty(t,"__esModule",{value:!0}),t.default=p;var _=yn();Object.defineProperty(t,"KeywordCxt",{enumerable:!0,get:function(){return _.KeywordCxt}});var v=ne();Object.defineProperty(t,"_",{enumerable:!0,get:function(){return v._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return v.str}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return v.stringify}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return v.nil}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return v.Name}}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:function(){return v.CodeGen}});var b=Mi();Object.defineProperty(t,"ValidationError",{enumerable:!0,get:function(){return b.default}});var i=wn();Object.defineProperty(t,"MissingRefError",{enumerable:!0,get:function(){return i.default}})})(ir,ir.exports)),ir.exports}var Im=oc(),Dr={exports:{}},Un={},Fs;function Rm(){return Fs||(Fs=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.formatNames=e.fastFormats=e.fullFormats=void 0;function t($,z){return{validate:$,compare:z}}e.fullFormats={date:t(a,u),time:t(p(!0),_),"date-time":t(i(!0),o),"iso-time":t(p(),v),"iso-date-time":t(i(),c),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:m,"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:P,uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:g,int32:{type:"number",validate:E},int64:{type:"number",validate:k},float:{type:"number",validate:C},double:{type:"number",validate:C},password:!0,binary:!0},e.fastFormats={...e.fullFormats,date:t(/^\d\d\d\d-[0-1]\d-[0-3]\d$/,u),time:t(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,_),"date-time":t(/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,o),"iso-time":t(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,v),"iso-date-time":t(/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,c),uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i},e.formatNames=Object.keys(e.fullFormats);function r($){return $%4===0&&($%100!==0||$%400===0)}const n=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,s=[0,31,28,31,30,31,30,31,31,30,31,30,31];function a($){const z=n.exec($);if(!z)return!1;const L=+z[1],Z=+z[2],Q=+z[3];return Z>=1&&Z<=12&&Q>=1&&Q<=(Z===2&&r(L)?29:s[Z])}function u($,z){if($&&z)return $>z?1:$<z?-1:0}const d=/^(\d\d):(\d\d):(\d\d(?:\.\d+)?)(z|([+-])(\d\d)(?::?(\d\d))?)?$/i;function p($){return function(L){const Z=d.exec(L);if(!Z)return!1;const Q=+Z[1],ae=+Z[2],le=+Z[3],ee=Z[4],he=Z[5]==="-"?-1:1,M=+(Z[6]||0),N=+(Z[7]||0);if(M>23||N>59||$&&!ee)return!1;if(Q<=23&&ae<=59&&le<60)return!0;const j=ae-N*he,A=Q-M*he-(j<0?1:0);return(A===23||A===-1)&&(j===59||j===-1)&&le<61}}function _($,z){if(!($&&z))return;const L=new Date("2020-01-01T"+$).valueOf(),Z=new Date("2020-01-01T"+z).valueOf();if(L&&Z)return L-Z}function v($,z){if(!($&&z))return;const L=d.exec($),Z=d.exec(z);if(L&&Z)return $=L[1]+L[2]+L[3],z=Z[1]+Z[2]+Z[3],$>z?1:$<z?-1:0}const b=/t|\s/i;function i($){const z=p($);return function(Z){const Q=Z.split(b);return Q.length===2&&a(Q[0])&&z(Q[1])}}function o($,z){if(!($&&z))return;const L=new Date($).valueOf(),Z=new Date(z).valueOf();if(L&&Z)return L-Z}function c($,z){if(!($&&z))return;const[L,Z]=$.split(b),[Q,ae]=z.split(b),le=u(L,Q);if(le!==void 0)return le||_(Z,ae)}const f=/\/|:/,l=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;function m($){return f.test($)&&l.test($)}const h=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm;function g($){return h.lastIndex=0,h.test($)}const w=-2147483648,y=2**31-1;function E($){return Number.isInteger($)&&$<=y&&$>=w}function k($){return Number.isInteger($)}function C(){return!0}const T=/[^\\]\\Z/;function P($){if(T.test($))return!1;try{return new RegExp($),!0}catch{return!1}}})(Un)),Un}var qn={},zs;function Pm(){return zs||(zs=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.formatLimitDefinition=void 0;const t=oc(),r=ne(),n=r.operators,s={formatMaximum:{okStr:"<=",ok:n.LTE,fail:n.GT},formatMinimum:{okStr:">=",ok:n.GTE,fail:n.LT},formatExclusiveMaximum:{okStr:"<",ok:n.LT,fail:n.GTE},formatExclusiveMinimum:{okStr:">",ok:n.GT,fail:n.LTE}},a={message:({keyword:d,schemaCode:p})=>(0,r.str)`should be ${s[d].okStr} ${p}`,params:({keyword:d,schemaCode:p})=>(0,r._)`{comparison: ${s[d].okStr}, limit: ${p}}`};e.formatLimitDefinition={keyword:Object.keys(s),type:"string",schemaType:"string",$data:!0,error:a,code(d){const{gen:p,data:_,schemaCode:v,keyword:b,it:i}=d,{opts:o,self:c}=i;if(!o.validateFormats)return;const f=new t.KeywordCxt(i,c.RULES.all.format.definition,"format");f.$data?l():m();function l(){const g=p.scopeValue("formats",{ref:c.formats,code:o.code.formats}),w=p.const("fmt",(0,r._)`${g}[${f.schemaCode}]`);d.fail$data((0,r.or)((0,r._)`typeof ${w} != "object"`,(0,r._)`${w} instanceof RegExp`,(0,r._)`typeof ${w}.compare != "function"`,h(w)))}function m(){const g=f.schema,w=c.formats[g];if(!w||w===!0)return;if(typeof w!="object"||w instanceof RegExp||typeof w.compare!="function")throw new Error(`"${b}": format "${g}" does not define "compare" function`);const y=p.scopeValue("formats",{key:g,ref:w,code:o.code.formats?(0,r._)`${o.code.formats}${(0,r.getProperty)(g)}`:void 0});d.fail$data(h(y))}function h(g){return(0,r._)`${g}.compare(${_}, ${v}) ${s[b].fail} 0`}},dependencies:["format"]};const u=d=>(d.addKeyword(e.formatLimitDefinition),d);e.default=u})(qn)),qn}var Us;function Nm(){return Us||(Us=1,(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const r=Rm(),n=Pm(),s=ne(),a=new s.Name("fullFormats"),u=new s.Name("fastFormats"),d=(_,v={keywords:!0})=>{if(Array.isArray(v))return p(_,v,r.fullFormats,a),_;const[b,i]=v.mode==="fast"?[r.fastFormats,u]:[r.fullFormats,a],o=v.formats||r.formatNames;return p(_,o,b,i),v.keywords&&(0,n.default)(_),_};d.get=(_,v="full")=>{const i=(v==="fast"?r.fastFormats:r.fullFormats)[_];if(!i)throw new Error(`Unknown format "${_}"`);return i};function p(_,v,b,i){var o,c;(o=(c=_.opts.code).formats)!==null&&o!==void 0||(c.formats=(0,s._)`require("ajv-formats/dist/formats").${i}`);for(const f of v)_.addFormat(f,b[f])}e.exports=t=d,Object.defineProperty(t,"__esModule",{value:!0}),t.default=d})(Dr,Dr.exports)),Dr.exports}var Om=Nm();const Cm=Hs(Om);function Am(){const e=new Im.Ajv({strict:!1,validateFormats:!0,validateSchema:!1,allErrors:!0});return Cm(e),e}class Fm{constructor(t){this._ajv=t??Am()}getValidator(t){var r;const n="$id"in t&&typeof t.$id=="string"?(r=this._ajv.getSchema(t.$id))!==null&&r!==void 0?r:this._ajv.compile(t):this._ajv.compile(t);return s=>n(s)?{valid:!0,data:s,errorMessage:void 0}:{valid:!1,data:void 0,errorMessage:this._ajv.errorsText(n.errors)}}}class zm{constructor(t){this._client=t}async*callToolStream(t,r=gn,n){var s;const a=this._client,u={...n,task:(s=n==null?void 0:n.task)!==null&&s!==void 0?s:a.isToolTask(t.name)?{}:void 0},d=a.requestStream({method:"tools/call",params:t},r,u),p=a.getToolOutputValidator(t.name);for await(const _ of d){if(_.type==="result"&&p){const v=_.result;if(!v.structuredContent&&!v.isError){yield{type:"error",error:new X(te.InvalidRequest,`Tool ${t.name} has an output schema but did not return structured content`)};return}if(v.structuredContent)try{const b=p(v.structuredContent);if(!b.valid){yield{type:"error",error:new X(te.InvalidParams,`Structured content does not match the tool's output schema: ${b.errorMessage}`)};return}}catch(b){if(b instanceof X){yield{type:"error",error:b};return}yield{type:"error",error:new X(te.InvalidParams,`Failed to validate structured content: ${b instanceof Error?b.message:String(b)}`)};return}}yield _}}async getTask(t,r){return this._client.getTask({taskId:t},r)}async getTaskResult(t,r,n){return this._client.getTaskResult({taskId:t},r,n)}async listTasks(t,r){return this._client.listTasks(t?{cursor:t}:void 0,r)}async cancelTask(t,r){return this._client.cancelTask({taskId:t},r)}requestStream(t,r,n){return this._client.requestStream(t,r,n)}}function Um(e,t,r){var n;if(!e)throw new Error(`${r} does not support task creation (required for ${t})`);switch(t){case"tools/call":if(!(!((n=e.tools)===null||n===void 0)&&n.call))throw new Error(`${r} does not support task creation for tools/call (required for ${t})`);break}}function qm(e,t,r){var n,s;if(!e)throw new Error(`${r} does not support task creation (required for ${t})`);switch(t){case"sampling/createMessage":if(!(!((n=e.sampling)===null||n===void 0)&&n.createMessage))throw new Error(`${r} does not support task creation for sampling/createMessage (required for ${t})`);break;case"elicitation/create":if(!(!((s=e.elicitation)===null||s===void 0)&&s.create))throw new Error(`${r} does not support task creation for elicitation/create (required for ${t})`);break}}function Br(e,t){if(!(!e||t===null||typeof t!="object")){if(e.type==="object"&&e.properties&&typeof e.properties=="object"){const r=t,n=e.properties;for(const s of Object.keys(n)){const a=n[s];r[s]===void 0&&Object.prototype.hasOwnProperty.call(a,"default")&&(r[s]=a.default),r[s]!==void 0&&Br(a,r[s])}}if(Array.isArray(e.anyOf))for(const r of e.anyOf)Br(r,t);if(Array.isArray(e.oneOf))for(const r of e.oneOf)Br(r,t)}}function jm(e){if(!e)return{supportsFormMode:!1,supportsUrlMode:!1};const t=e.form!==void 0,r=e.url!==void 0;return{supportsFormMode:t||!t&&!r,supportsUrlMode:r}}class Mm extends bp{constructor(t,r){var n,s;super(r),this._clientInfo=t,this._cachedToolOutputValidators=new Map,this._cachedKnownTaskTools=new Set,this._cachedRequiredTaskTools=new Set,this._capabilities=(n=r==null?void 0:r.capabilities)!==null&&n!==void 0?n:{},this._jsonSchemaValidator=(s=r==null?void 0:r.jsonSchemaValidator)!==null&&s!==void 0?s:new Fm}get experimental(){return this._experimental||(this._experimental={tasks:new zm(this)}),this._experimental}registerCapabilities(t){if(this.transport)throw new Error("Cannot register capabilities after connecting to transport");this._capabilities=Ep(this._capabilities,t)}setRequestHandler(t,r){var n,s,a;const u=ma(t),d=u==null?void 0:u.method;if(!d)throw new Error("Schema is missing a method literal");let p;if(hn(d)){const v=d,b=(n=v._zod)===null||n===void 0?void 0:n.def;p=(s=b==null?void 0:b.value)!==null&&s!==void 0?s:v.value}else{const v=d,b=v._def;p=(a=b==null?void 0:b.value)!==null&&a!==void 0?a:v.value}if(typeof p!="string")throw new Error("Schema method literal must be a string");const _=p;if(_==="elicitation/create"){const v=async(b,i)=>{var o,c,f;const l=rt(Wa,b);if(!l.success){const T=l.error instanceof Error?l.error.message:String(l.error);throw new X(te.InvalidParams,`Invalid elicitation request: ${T}`)}const{params:m}=l.data,h=(o=m.mode)!==null&&o!==void 0?o:"form",{supportsFormMode:g,supportsUrlMode:w}=jm(this._capabilities.elicitation);if(h==="form"&&!g)throw new X(te.InvalidParams,"Client does not support form-mode elicitation requests");if(h==="url"&&!w)throw new X(te.InvalidParams,"Client does not support URL-mode elicitation requests");const y=await Promise.resolve(r(b,i));if(m.task){const T=rt(Kt,y);if(!T.success){const P=T.error instanceof Error?T.error.message:String(T.error);throw new X(te.InvalidParams,`Invalid task creation result: ${P}`)}return T.data}const E=rt(Ja,y);if(!E.success){const T=E.error instanceof Error?E.error.message:String(E.error);throw new X(te.InvalidParams,`Invalid elicitation result: ${T}`)}const k=E.data,C=h==="form"?m.requestedSchema:void 0;if(h==="form"&&k.action==="accept"&&k.content&&C&&!((f=(c=this._capabilities.elicitation)===null||c===void 0?void 0:c.form)===null||f===void 0)&&f.applyDefaults)try{Br(C,k.content)}catch{}return k};return super.setRequestHandler(t,v)}if(_==="sampling/createMessage"){const v=async(b,i)=>{const o=rt(Ka,b);if(!o.success){const m=o.error instanceof Error?o.error.message:String(o.error);throw new X(te.InvalidParams,`Invalid sampling request: ${m}`)}const{params:c}=o.data,f=await Promise.resolve(r(b,i));if(c.task){const m=rt(Kt,f);if(!m.success){const h=m.error instanceof Error?m.error.message:String(m.error);throw new X(te.InvalidParams,`Invalid task creation result: ${h}`)}return m.data}const l=rt(Ga,f);if(!l.success){const m=l.error instanceof Error?l.error.message:String(l.error);throw new X(te.InvalidParams,`Invalid sampling result: ${m}`)}return l.data};return super.setRequestHandler(t,v)}return super.setRequestHandler(t,r)}assertCapability(t,r){var n;if(!(!((n=this._serverCapabilities)===null||n===void 0)&&n[t]))throw new Error(`Server does not support ${t} (required for ${r})`)}async connect(t,r){if(await super.connect(t),t.sessionId===void 0)try{const n=await this.request({method:"initialize",params:{protocolVersion:fn,capabilities:this._capabilities,clientInfo:this._clientInfo}},Fa,r);if(n===void 0)throw new Error(`Server sent invalid initialize result: ${n}`);if(!jh.includes(n.protocolVersion))throw new Error(`Server's protocol version is not supported: ${n.protocolVersion}`);this._serverCapabilities=n.capabilities,this._serverVersion=n.serverInfo,t.setProtocolVersion&&t.setProtocolVersion(n.protocolVersion),this._instructions=n.instructions,await this.notification({method:"notifications/initialized"})}catch(n){throw this.close(),n}}getServerCapabilities(){return this._serverCapabilities}getServerVersion(){return this._serverVersion}getInstructions(){return this._instructions}assertCapabilityForMethod(t){var r,n,s,a,u;switch(t){case"logging/setLevel":if(!(!((r=this._serverCapabilities)===null||r===void 0)&&r.logging))throw new Error(`Server does not support logging (required for ${t})`);break;case"prompts/get":case"prompts/list":if(!(!((n=this._serverCapabilities)===null||n===void 0)&&n.prompts))throw new Error(`Server does not support prompts (required for ${t})`);break;case"resources/list":case"resources/templates/list":case"resources/read":case"resources/subscribe":case"resources/unsubscribe":if(!(!((s=this._serverCapabilities)===null||s===void 0)&&s.resources))throw new Error(`Server does not support resources (required for ${t})`);if(t==="resources/subscribe"&&!this._serverCapabilities.resources.subscribe)throw new Error(`Server does not support resource subscriptions (required for ${t})`);break;case"tools/call":case"tools/list":if(!(!((a=this._serverCapabilities)===null||a===void 0)&&a.tools))throw new Error(`Server does not support tools (required for ${t})`);break;case"completion/complete":if(!(!((u=this._serverCapabilities)===null||u===void 0)&&u.completions))throw new Error(`Server does not support completions (required for ${t})`);break}}assertNotificationCapability(t){var r;switch(t){case"notifications/roots/list_changed":if(!(!((r=this._capabilities.roots)===null||r===void 0)&&r.listChanged))throw new Error(`Client does not support roots list changed notifications (required for ${t})`);break}}assertRequestHandlerCapability(t){if(this._capabilities)switch(t){case"sampling/createMessage":if(!this._capabilities.sampling)throw new Error(`Client does not support sampling capability (required for ${t})`);break;case"elicitation/create":if(!this._capabilities.elicitation)throw new Error(`Client does not support elicitation capability (required for ${t})`);break;case"roots/list":if(!this._capabilities.roots)throw new Error(`Client does not support roots capability (required for ${t})`);break;case"tasks/get":case"tasks/list":case"tasks/result":case"tasks/cancel":if(!this._capabilities.tasks)throw new Error(`Client does not support tasks capability (required for ${t})`);break}}assertTaskCapability(t){var r,n;Um((n=(r=this._serverCapabilities)===null||r===void 0?void 0:r.tasks)===null||n===void 0?void 0:n.requests,t,"Server")}assertTaskHandlerCapability(t){var r;this._capabilities&&qm((r=this._capabilities.tasks)===null||r===void 0?void 0:r.requests,t,"Client")}async ping(t){return this.request({method:"ping"},Tt,t)}async complete(t,r){return this.request({method:"completion/complete",params:t},Ya,r)}async setLoggingLevel(t,r){return this.request({method:"logging/setLevel",params:{level:t}},Tt,r)}async getPrompt(t,r){return this.request({method:"prompts/get",params:t},Za,r)}async listPrompts(t,r){return this.request({method:"prompts/list",params:t},Da,r)}async listResources(t,r){return this.request({method:"resources/list",params:t},Ma,r)}async listResourceTemplates(t,r){return this.request({method:"resources/templates/list",params:t},xa,r)}async readResource(t,r){return this.request({method:"resources/read",params:t},La,r)}async subscribeResource(t,r){return this.request({method:"resources/subscribe",params:t},Tt,r)}async unsubscribeResource(t,r){return this.request({method:"resources/unsubscribe",params:t},Tt,r)}async callTool(t,r=gn,n){if(this.isToolTaskRequired(t.name))throw new X(te.InvalidRequest,`Tool "${t.name}" requires task-based execution. Use client.experimental.tasks.callToolStream() instead.`);const s=await this.request({method:"tools/call",params:t},r,n),a=this.getToolOutputValidator(t.name);if(a){if(!s.structuredContent&&!s.isError)throw new X(te.InvalidRequest,`Tool ${t.name} has an output schema but did not return structured content`);if(s.structuredContent)try{const u=a(s.structuredContent);if(!u.valid)throw new X(te.InvalidParams,`Structured content does not match the tool's output schema: ${u.errorMessage}`)}catch(u){throw u instanceof X?u:new X(te.InvalidParams,`Failed to validate structured content: ${u instanceof Error?u.message:String(u)}`)}}return s}isToolTask(t){var r,n,s,a;return!((a=(s=(n=(r=this._serverCapabilities)===null||r===void 0?void 0:r.tasks)===null||n===void 0?void 0:n.requests)===null||s===void 0?void 0:s.tools)===null||a===void 0)&&a.call?this._cachedKnownTaskTools.has(t):!1}isToolTaskRequired(t){return this._cachedRequiredTaskTools.has(t)}cacheToolMetadata(t){var r;this._cachedToolOutputValidators.clear(),this._cachedKnownTaskTools.clear(),this._cachedRequiredTaskTools.clear();for(const n of t){if(n.outputSchema){const a=this._jsonSchemaValidator.getValidator(n.outputSchema);this._cachedToolOutputValidators.set(n.name,a)}const s=(r=n.execution)===null||r===void 0?void 0:r.taskSupport;(s==="required"||s==="optional")&&this._cachedKnownTaskTools.add(n.name),s==="required"&&this._cachedRequiredTaskTools.add(n.name)}}getToolOutputValidator(t){return this._cachedToolOutputValidators.get(t)}async listTools(t,r){const n=await this.request({method:"tools/list",params:t},Ha,r);return this.cacheToolMetadata(n.tools),n}async sendRootsListChanged(){return this.notification({method:"notifications/roots/list_changed"})}}class qs extends Error{constructor(t,r){super(t),this.name="ParseError",this.type=r.type,this.field=r.field,this.value=r.value,this.line=r.line}}function jn(e){}function xm(e){if(typeof e=="function")throw new TypeError("`callbacks` must be an object, got a function instead. Did you mean `{onEvent: fn}`?");const{onEvent:t=jn,onError:r=jn,onRetry:n=jn,onComment:s}=e;let a="",u=!0,d,p="",_="";function v(f){const l=u?f.replace(/^\xEF\xBB\xBF/,""):f,[m,h]=Lm(`${a}${l}`);for(const g of m)b(g);a=h,u=!1}function b(f){if(f===""){o();return}if(f.startsWith(":")){s&&s(f.slice(f.startsWith(": ")?2:1));return}const l=f.indexOf(":");if(l!==-1){const m=f.slice(0,l),h=f[l+1]===" "?2:1,g=f.slice(l+h);i(m,g,f);return}i(f,"",f)}function i(f,l,m){switch(f){case"event":_=l;break;case"data":p=`${p}${l}
`;break;case"id":d=l.includes("\0")?void 0:l;break;case"retry":/^\d+$/.test(l)?n(parseInt(l,10)):r(new qs(`Invalid \`retry\` value: "${l}"`,{type:"invalid-retry",value:l,line:m}));break;default:r(new qs(`Unknown field "${f.length>20?`${f.slice(0,20)}`:f}"`,{type:"unknown-field",field:f,value:l,line:m}));break}}function o(){p.length>0&&t({id:d,event:_||void 0,data:p.endsWith(`
`)?p.slice(0,-1):p}),d=void 0,p="",_=""}function c(f={}){a&&f.consume&&b(a),u=!0,d=void 0,p="",_="",a=""}return{feed:v,reset:c}}function Lm(e){const t=[];let r="",n=0;for(;n<e.length;){const s=e.indexOf("\r",n),a=e.indexOf(`
`,n);let u=-1;if(s!==-1&&a!==-1?u=Math.min(s,a):s!==-1?s===e.length-1?u=-1:u=s:a!==-1&&(u=a),u===-1){r=e.slice(n);break}else{const d=e.slice(n,u);t.push(d),n=u+1,e[n-1]==="\r"&&e[n]===`
`&&n++}}return[t,r]}class js extends Event{constructor(t,r){var n,s;super(t),this.code=(n=r==null?void 0:r.code)!=null?n:void 0,this.message=(s=r==null?void 0:r.message)!=null?s:void 0}[Symbol.for("nodejs.util.inspect.custom")](t,r,n){return n(Ms(this),r)}[Symbol.for("Deno.customInspect")](t,r){return t(Ms(this),r)}}function Dm(e){const t=globalThis.DOMException;return typeof t=="function"?new t(e,"SyntaxError"):new SyntaxError(e)}function Wn(e){return e instanceof Error?"errors"in e&&Array.isArray(e.errors)?e.errors.map(Wn).join(", "):"cause"in e&&e.cause instanceof Error?`${e}: ${Wn(e.cause)}`:e.message:`${e}`}function Ms(e){return{type:e.type,message:e.message,code:e.code,defaultPrevented:e.defaultPrevented,cancelable:e.cancelable,timeStamp:e.timeStamp}}var sc=e=>{throw TypeError(e)},Di=(e,t,r)=>t.has(e)||sc("Cannot "+r),oe=(e,t,r)=>(Di(e,t,"read from private field"),r?r.call(e):t.get(e)),Ee=(e,t,r)=>t.has(e)?sc("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),ge=(e,t,r,n)=>(Di(e,t,"write to private field"),t.set(e,r),r),Xe=(e,t,r)=>(Di(e,t,"access private method"),r),qe,ft,bt,Kr,rn,Zt,It,Vt,nt,Et,Pt,$t,Lt,Ke,Jn,Yn,Qn,xs,Xn,ei,Dt,ti,ri;class Gr extends EventTarget{constructor(t,r){var n,s;super(),Ee(this,Ke),this.CONNECTING=0,this.OPEN=1,this.CLOSED=2,Ee(this,qe),Ee(this,ft),Ee(this,bt),Ee(this,Kr),Ee(this,rn),Ee(this,Zt),Ee(this,It),Ee(this,Vt,null),Ee(this,nt),Ee(this,Et),Ee(this,Pt,null),Ee(this,$t,null),Ee(this,Lt,null),Ee(this,Yn,async a=>{var u;oe(this,Et).reset();const{body:d,redirected:p,status:_,headers:v}=a;if(_===204){Xe(this,Ke,Dt).call(this,"Server sent HTTP 204, not reconnecting",204),this.close();return}if(p?ge(this,bt,new URL(a.url)):ge(this,bt,void 0),_!==200){Xe(this,Ke,Dt).call(this,`Non-200 status code (${_})`,_);return}if(!(v.get("content-type")||"").startsWith("text/event-stream")){Xe(this,Ke,Dt).call(this,'Invalid content type, expected "text/event-stream"',_);return}if(oe(this,qe)===this.CLOSED)return;ge(this,qe,this.OPEN);const b=new Event("open");if((u=oe(this,Lt))==null||u.call(this,b),this.dispatchEvent(b),typeof d!="object"||!d||!("getReader"in d)){Xe(this,Ke,Dt).call(this,"Invalid response body, expected a web ReadableStream",_),this.close();return}const i=new TextDecoder,o=d.getReader();let c=!0;do{const{done:f,value:l}=await o.read();l&&oe(this,Et).feed(i.decode(l,{stream:!f})),f&&(c=!1,oe(this,Et).reset(),Xe(this,Ke,ti).call(this))}while(c)}),Ee(this,Qn,a=>{ge(this,nt,void 0),!(a.name==="AbortError"||a.type==="aborted")&&Xe(this,Ke,ti).call(this,Wn(a))}),Ee(this,Xn,a=>{typeof a.id=="string"&&ge(this,Vt,a.id);const u=new MessageEvent(a.event||"message",{data:a.data,origin:oe(this,bt)?oe(this,bt).origin:oe(this,ft).origin,lastEventId:a.id||""});oe(this,$t)&&(!a.event||a.event==="message")&&oe(this,$t).call(this,u),this.dispatchEvent(u)}),Ee(this,ei,a=>{ge(this,Zt,a)}),Ee(this,ri,()=>{ge(this,It,void 0),oe(this,qe)===this.CONNECTING&&Xe(this,Ke,Jn).call(this)});try{if(t instanceof URL)ge(this,ft,t);else if(typeof t=="string")ge(this,ft,new URL(t,Zm()));else throw new Error("Invalid URL")}catch{throw Dm("An invalid or illegal string was specified")}ge(this,Et,xm({onEvent:oe(this,Xn),onRetry:oe(this,ei)})),ge(this,qe,this.CONNECTING),ge(this,Zt,3e3),ge(this,rn,(n=r==null?void 0:r.fetch)!=null?n:globalThis.fetch),ge(this,Kr,(s=r==null?void 0:r.withCredentials)!=null?s:!1),Xe(this,Ke,Jn).call(this)}get readyState(){return oe(this,qe)}get url(){return oe(this,ft).href}get withCredentials(){return oe(this,Kr)}get onerror(){return oe(this,Pt)}set onerror(t){ge(this,Pt,t)}get onmessage(){return oe(this,$t)}set onmessage(t){ge(this,$t,t)}get onopen(){return oe(this,Lt)}set onopen(t){ge(this,Lt,t)}addEventListener(t,r,n){const s=r;super.addEventListener(t,s,n)}removeEventListener(t,r,n){const s=r;super.removeEventListener(t,s,n)}close(){oe(this,It)&&clearTimeout(oe(this,It)),oe(this,qe)!==this.CLOSED&&(oe(this,nt)&&oe(this,nt).abort(),ge(this,qe,this.CLOSED),ge(this,nt,void 0))}}qe=new WeakMap,ft=new WeakMap,bt=new WeakMap,Kr=new WeakMap,rn=new WeakMap,Zt=new WeakMap,It=new WeakMap,Vt=new WeakMap,nt=new WeakMap,Et=new WeakMap,Pt=new WeakMap,$t=new WeakMap,Lt=new WeakMap,Ke=new WeakSet,Jn=function(){ge(this,qe,this.CONNECTING),ge(this,nt,new AbortController),oe(this,rn)(oe(this,ft),Xe(this,Ke,xs).call(this)).then(oe(this,Yn)).catch(oe(this,Qn))},Yn=new WeakMap,Qn=new WeakMap,xs=function(){var e;const t={mode:"cors",redirect:"follow",headers:{Accept:"text/event-stream",...oe(this,Vt)?{"Last-Event-ID":oe(this,Vt)}:void 0},cache:"no-store",signal:(e=oe(this,nt))==null?void 0:e.signal};return"window"in globalThis&&(t.credentials=this.withCredentials?"include":"same-origin"),t},Xn=new WeakMap,ei=new WeakMap,Dt=function(e,t){var r;oe(this,qe)!==this.CLOSED&&ge(this,qe,this.CLOSED);const n=new js("error",{code:t,message:e});(r=oe(this,Pt))==null||r.call(this,n),this.dispatchEvent(n)},ti=function(e,t){var r;if(oe(this,qe)===this.CLOSED)return;ge(this,qe,this.CONNECTING);const n=new js("error",{code:t,message:e});(r=oe(this,Pt))==null||r.call(this,n),this.dispatchEvent(n),ge(this,It,setTimeout(oe(this,ri),oe(this,Zt)))},ri=new WeakMap,Gr.CONNECTING=0,Gr.OPEN=1,Gr.CLOSED=2;function Zm(){const e="document"in globalThis?globalThis.document:void 0;return e&&typeof e=="object"&&"baseURI"in e&&typeof e.baseURI=="string"?e.baseURI:void 0}function ni(e){return e?e instanceof Headers?Object.fromEntries(e.entries()):Array.isArray(e)?Object.fromEntries(e):{...e}:{}}function Vm(e=fetch,t){return t?async(r,n)=>{const s={...t,...n,headers:n!=null&&n.headers?{...ni(t.headers),...ni(n.headers)}:t.headers};return e(r,s)}:e}let Zi;Zi=globalThis.crypto;async function Hm(e){return(await Zi).getRandomValues(new Uint8Array(e))}async function Bm(e){const t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-._~",r=Math.pow(2,8)-Math.pow(2,8)%t.length;let n="";for(;n.length<e;){const s=await Hm(e-n.length);for(const a of s)a<r&&(n+=t[a%t.length])}return n}async function Km(e){return await Bm(e)}async function Gm(e){const t=await(await Zi).subtle.digest("SHA-256",new TextEncoder().encode(e));return btoa(String.fromCharCode(...new Uint8Array(t))).replace(/\//g,"_").replace(/\+/g,"-").replace(/=/g,"")}async function Wm(e){if(e||(e=43),e<43||e>128)throw`Expected a length between 43 and 128. Received ${e}.`;const t=await Km(e),r=await Gm(t);return{code_verifier:t,code_challenge:r}}const Ne=Kd().superRefine((e,t)=>{if(!URL.canParse(e))return t.addIssue({code:Uh.custom,message:"URL must be parseable",fatal:!0}),vc}).refine(e=>{const t=new URL(e);return t.protocol!=="javascript:"&&t.protocol!=="data:"&&t.protocol!=="vbscript:"},{message:"URL cannot use javascript:, data:, or vbscript: scheme"}),Jm=je({resource:R().url(),authorization_servers:H(Ne).optional(),jwks_uri:R().url().optional(),scopes_supported:H(R()).optional(),bearer_methods_supported:H(R()).optional(),resource_signing_alg_values_supported:H(R()).optional(),resource_name:R().optional(),resource_documentation:R().optional(),resource_policy_uri:R().url().optional(),resource_tos_uri:R().url().optional(),tls_client_certificate_bound_access_tokens:_e().optional(),authorization_details_types_supported:H(R()).optional(),dpop_signing_alg_values_supported:H(R()).optional(),dpop_bound_access_tokens_required:_e().optional()}),ac=je({issuer:R(),authorization_endpoint:Ne,token_endpoint:Ne,registration_endpoint:Ne.optional(),scopes_supported:H(R()).optional(),response_types_supported:H(R()),response_modes_supported:H(R()).optional(),grant_types_supported:H(R()).optional(),token_endpoint_auth_methods_supported:H(R()).optional(),token_endpoint_auth_signing_alg_values_supported:H(R()).optional(),service_documentation:Ne.optional(),revocation_endpoint:Ne.optional(),revocation_endpoint_auth_methods_supported:H(R()).optional(),revocation_endpoint_auth_signing_alg_values_supported:H(R()).optional(),introspection_endpoint:R().optional(),introspection_endpoint_auth_methods_supported:H(R()).optional(),introspection_endpoint_auth_signing_alg_values_supported:H(R()).optional(),code_challenge_methods_supported:H(R()).optional(),client_id_metadata_document_supported:_e().optional()}),Ym=je({issuer:R(),authorization_endpoint:Ne,token_endpoint:Ne,userinfo_endpoint:Ne.optional(),jwks_uri:Ne,registration_endpoint:Ne.optional(),scopes_supported:H(R()).optional(),response_types_supported:H(R()),response_modes_supported:H(R()).optional(),grant_types_supported:H(R()).optional(),acr_values_supported:H(R()).optional(),subject_types_supported:H(R()),id_token_signing_alg_values_supported:H(R()),id_token_encryption_alg_values_supported:H(R()).optional(),id_token_encryption_enc_values_supported:H(R()).optional(),userinfo_signing_alg_values_supported:H(R()).optional(),userinfo_encryption_alg_values_supported:H(R()).optional(),userinfo_encryption_enc_values_supported:H(R()).optional(),request_object_signing_alg_values_supported:H(R()).optional(),request_object_encryption_alg_values_supported:H(R()).optional(),request_object_encryption_enc_values_supported:H(R()).optional(),token_endpoint_auth_methods_supported:H(R()).optional(),token_endpoint_auth_signing_alg_values_supported:H(R()).optional(),display_values_supported:H(R()).optional(),claim_types_supported:H(R()).optional(),claims_supported:H(R()).optional(),service_documentation:R().optional(),claims_locales_supported:H(R()).optional(),ui_locales_supported:H(R()).optional(),claims_parameter_supported:_e().optional(),request_parameter_supported:_e().optional(),request_uri_parameter_supported:_e().optional(),require_request_uri_registration:_e().optional(),op_policy_uri:Ne.optional(),op_tos_uri:Ne.optional(),client_id_metadata_document_supported:_e().optional()}),Qm=D({...Ym.shape,...ac.pick({code_challenge_methods_supported:!0}).shape}),Xm=D({access_token:R(),id_token:R().optional(),token_type:R(),expires_in:qh().optional(),scope:R().optional(),refresh_token:R().optional()}).strip(),e0=D({error:R(),error_description:R().optional(),error_uri:R().optional()}),Ls=Ne.optional().or(G("").transform(()=>{})),t0=D({redirect_uris:H(Ne),token_endpoint_auth_method:R().optional(),grant_types:H(R()).optional(),response_types:H(R()).optional(),client_name:R().optional(),client_uri:Ne.optional(),logo_uri:Ls,scope:R().optional(),contacts:H(R()).optional(),tos_uri:Ls,policy_uri:R().optional(),jwks_uri:Ne.optional(),jwks:Bn().optional(),software_id:R().optional(),software_version:R().optional(),software_statement:R().optional()}).strip(),r0=D({client_id:R(),client_secret:R().optional(),client_id_issued_at:pe().optional(),client_secret_expires_at:pe().optional()}).strip(),n0=t0.merge(r0);D({error:R(),error_description:R().optional()}).strip();D({token:R(),token_type_hint:R().optional()}).strip();function i0(e){const t=typeof e=="string"?new URL(e):new URL(e.href);return t.hash="",t}function o0({requestedResource:e,configuredResource:t}){const r=typeof e=="string"?new URL(e):new URL(e.href),n=typeof t=="string"?new URL(t):new URL(t.href);if(r.origin!==n.origin||r.pathname.length<n.pathname.length)return!1;const s=r.pathname.endsWith("/")?r.pathname:r.pathname+"/",a=n.pathname.endsWith("/")?n.pathname:n.pathname+"/";return s.startsWith(a)}class ke extends Error{constructor(t,r){super(t),this.errorUri=r,this.name=this.constructor.name}toResponseObject(){const t={error:this.errorCode,error_description:this.message};return this.errorUri&&(t.error_uri=this.errorUri),t}get errorCode(){return this.constructor.errorCode}}class ii extends ke{}ii.errorCode="invalid_request";class nn extends ke{}nn.errorCode="invalid_client";class on extends ke{}on.errorCode="invalid_grant";class sn extends ke{}sn.errorCode="unauthorized_client";class oi extends ke{}oi.errorCode="unsupported_grant_type";class si extends ke{}si.errorCode="invalid_scope";class ai extends ke{}ai.errorCode="access_denied";class At extends ke{}At.errorCode="server_error";class ci extends ke{}ci.errorCode="temporarily_unavailable";class ui extends ke{}ui.errorCode="unsupported_response_type";class li extends ke{}li.errorCode="unsupported_token_type";class di extends ke{}di.errorCode="invalid_token";class hi extends ke{}hi.errorCode="method_not_allowed";class fi extends ke{}fi.errorCode="too_many_requests";class an extends ke{}an.errorCode="invalid_client_metadata";class pi extends ke{}pi.errorCode="insufficient_scope";class mi extends ke{}mi.errorCode="invalid_target";const s0={[ii.errorCode]:ii,[nn.errorCode]:nn,[on.errorCode]:on,[sn.errorCode]:sn,[oi.errorCode]:oi,[si.errorCode]:si,[ai.errorCode]:ai,[At.errorCode]:At,[ci.errorCode]:ci,[ui.errorCode]:ui,[li.errorCode]:li,[di.errorCode]:di,[hi.errorCode]:hi,[fi.errorCode]:fi,[an.errorCode]:an,[pi.errorCode]:pi,[mi.errorCode]:mi};class Mt extends Error{constructor(t){super(t??"Unauthorized")}}function a0(e){return["client_secret_basic","client_secret_post","none"].includes(e)}const Mn="code",xn="S256";function c0(e,t){const r=e.client_secret!==void 0;return t.length===0?r?"client_secret_post":"none":"token_endpoint_auth_method"in e&&e.token_endpoint_auth_method&&a0(e.token_endpoint_auth_method)&&t.includes(e.token_endpoint_auth_method)?e.token_endpoint_auth_method:r&&t.includes("client_secret_basic")?"client_secret_basic":r&&t.includes("client_secret_post")?"client_secret_post":t.includes("none")?"none":r?"client_secret_post":"none"}function u0(e,t,r,n){const{client_id:s,client_secret:a}=t;switch(e){case"client_secret_basic":l0(s,a,r);return;case"client_secret_post":d0(s,a,n);return;case"none":h0(s,n);return;default:throw new Error(`Unsupported client authentication method: ${e}`)}}function l0(e,t,r){if(!t)throw new Error("client_secret_basic authentication requires a client_secret");const n=btoa(`${e}:${t}`);r.set("Authorization",`Basic ${n}`)}function d0(e,t,r){r.set("client_id",e),t&&r.set("client_secret",t)}function h0(e,t){t.set("client_id",e)}async function cc(e){const t=e instanceof Response?e.status:void 0,r=e instanceof Response?await e.text():e;try{const n=e0.parse(JSON.parse(r)),{error:s,error_description:a,error_uri:u}=n,d=s0[s]||At;return new d(a||"",u)}catch(n){const s=`${t?`HTTP ${t}: `:""}Invalid OAuth error response: ${n}. Raw body: ${r}`;return new At(s)}}async function Ln(e,t){var r,n;try{return await Dn(e,t)}catch(s){if(s instanceof nn||s instanceof sn)return await((r=e.invalidateCredentials)===null||r===void 0?void 0:r.call(e,"all")),await Dn(e,t);if(s instanceof on)return await((n=e.invalidateCredentials)===null||n===void 0?void 0:n.call(e,"tokens")),await Dn(e,t);throw s}}async function Dn(e,{serverUrl:t,authorizationCode:r,scope:n,resourceMetadataUrl:s,fetchFn:a}){var u,d;let p,_;try{p=await m0(t,{resourceMetadataUrl:s},a),p.authorization_servers&&p.authorization_servers.length>0&&(_=p.authorization_servers[0])}catch{}_||(_=new URL("/",t));const v=await p0(t,e,p),b=await w0(_,{fetchFn:a});let i=await Promise.resolve(e.clientInformation());if(!i){if(r!==void 0)throw new Error("Existing OAuth client information is required when exchanging an authorization code");const h=(b==null?void 0:b.client_id_metadata_document_supported)===!0,g=e.clientMetadataUrl;if(g&&!f0(g))throw new an(`clientMetadataUrl must be a valid HTTPS URL with a non-root pathname, got: ${g}`);if(h&&g)i={client_id:g},await((u=e.saveClientInformation)===null||u===void 0?void 0:u.call(e,i));else{if(!e.saveClientInformation)throw new Error("OAuth client information must be saveable for dynamic registration");const y=await k0(_,{metadata:b,clientMetadata:e.clientMetadata,fetchFn:a});await e.saveClientInformation(y),i=y}}const o=!e.redirectUrl;if(r!==void 0||o){const h=await S0(e,_,{metadata:b,resource:v,authorizationCode:r,fetchFn:a});return await e.saveTokens(h),"AUTHORIZED"}const c=await e.tokens();if(c!=null&&c.refresh_token)try{const h=await $0(_,{metadata:b,clientInformation:i,refreshToken:c.refresh_token,resource:v,addClientAuthentication:e.addClientAuthentication,fetchFn:a});return await e.saveTokens(h),"AUTHORIZED"}catch(h){if(!(!(h instanceof ke)||h instanceof At))throw h}const f=e.state?await e.state():void 0,{authorizationUrl:l,codeVerifier:m}=await b0(_,{metadata:b,clientInformation:i,state:f,redirectUrl:e.redirectUrl,scope:n||((d=p==null?void 0:p.scopes_supported)===null||d===void 0?void 0:d.join(" "))||e.clientMetadata.scope,resource:v});return await e.saveCodeVerifier(m),await e.redirectToAuthorization(l),"REDIRECT"}function f0(e){if(!e)return!1;try{const t=new URL(e);return t.protocol==="https:"&&t.pathname!=="/"}catch{return!1}}async function p0(e,t,r){const n=i0(e);if(t.validateResourceURL)return await t.validateResourceURL(n,r==null?void 0:r.resource);if(r){if(!o0({requestedResource:n,configuredResource:r.resource}))throw new Error(`Protected resource ${r.resource} does not match expected ${n} (or origin)`);return new URL(r.resource)}}function Ds(e){const t=e.headers.get("WWW-Authenticate");if(!t)return{};const[r,n]=t.split(" ");if(r.toLowerCase()!=="bearer"||!n)return{};const s=Zn(e,"resource_metadata")||void 0;let a;if(s)try{a=new URL(s)}catch{}const u=Zn(e,"scope")||void 0,d=Zn(e,"error")||void 0;return{resourceMetadataUrl:a,scope:u,error:d}}function Zn(e,t){const r=e.headers.get("WWW-Authenticate");if(!r)return null;const n=new RegExp(`${t}=(?:"([^"]+)"|([^\\s,]+))`),s=r.match(n);return s?s[1]||s[2]:null}async function m0(e,t,r=fetch){var n,s;const a=await v0(e,"oauth-protected-resource",r,{protocolVersion:t==null?void 0:t.protocolVersion,metadataUrl:t==null?void 0:t.resourceMetadataUrl});if(!a||a.status===404)throw await((n=a==null?void 0:a.body)===null||n===void 0?void 0:n.cancel()),new Error("Resource server does not implement OAuth 2.0 Protected Resource Metadata.");if(!a.ok)throw await((s=a.body)===null||s===void 0?void 0:s.cancel()),new Error(`HTTP ${a.status} trying to load well-known OAuth protected resource metadata.`);return Jm.parse(await a.json())}async function Vi(e,t,r=fetch){try{return await r(e,{headers:t})}catch(n){if(n instanceof TypeError)return t?Vi(e,void 0,r):void 0;throw n}}function g0(e,t="",r={}){return t.endsWith("/")&&(t=t.slice(0,-1)),r.prependPathname?`${t}/.well-known/${e}`:`/.well-known/${e}${t}`}async function Zs(e,t,r=fetch){return await Vi(e,{"MCP-Protocol-Version":t},r)}function _0(e,t){return!e||e.status>=400&&e.status<500&&t!=="/"}async function v0(e,t,r,n){var s,a;const u=new URL(e),d=(s=n==null?void 0:n.protocolVersion)!==null&&s!==void 0?s:fn;let p;if(n!=null&&n.metadataUrl)p=new URL(n.metadataUrl);else{const v=g0(t,u.pathname);p=new URL(v,(a=n==null?void 0:n.metadataServerUrl)!==null&&a!==void 0?a:u),p.search=u.search}let _=await Zs(p,d,r);if(!(n!=null&&n.metadataUrl)&&_0(_,u.pathname)){const v=new URL(`/.well-known/${t}`,u);_=await Zs(v,d,r)}return _}function y0(e){const t=typeof e=="string"?new URL(e):e,r=t.pathname!=="/",n=[];if(!r)return n.push({url:new URL("/.well-known/oauth-authorization-server",t.origin),type:"oauth"}),n.push({url:new URL("/.well-known/openid-configuration",t.origin),type:"oidc"}),n;let s=t.pathname;return s.endsWith("/")&&(s=s.slice(0,-1)),n.push({url:new URL(`/.well-known/oauth-authorization-server${s}`,t.origin),type:"oauth"}),n.push({url:new URL(`/.well-known/openid-configuration${s}`,t.origin),type:"oidc"}),n.push({url:new URL(`${s}/.well-known/openid-configuration`,t.origin),type:"oidc"}),n}async function w0(e,{fetchFn:t=fetch,protocolVersion:r=fn}={}){var n;const s={"MCP-Protocol-Version":r,Accept:"application/json"},a=y0(e);for(const{url:u,type:d}of a){const p=await Vi(u,s,t);if(p){if(!p.ok){if(await((n=p.body)===null||n===void 0?void 0:n.cancel()),p.status>=400&&p.status<500)continue;throw new Error(`HTTP ${p.status} trying to load ${d==="oauth"?"OAuth":"OpenID provider"} metadata from ${u}`)}return d==="oauth"?ac.parse(await p.json()):Qm.parse(await p.json())}}}async function b0(e,{metadata:t,clientInformation:r,redirectUrl:n,scope:s,state:a,resource:u}){let d;if(t){if(d=new URL(t.authorization_endpoint),!t.response_types_supported.includes(Mn))throw new Error(`Incompatible auth server: does not support response type ${Mn}`);if(t.code_challenge_methods_supported&&!t.code_challenge_methods_supported.includes(xn))throw new Error(`Incompatible auth server: does not support code challenge method ${xn}`)}else d=new URL("/authorize",e);const p=await Wm(),_=p.code_verifier,v=p.code_challenge;return d.searchParams.set("response_type",Mn),d.searchParams.set("client_id",r.client_id),d.searchParams.set("code_challenge",v),d.searchParams.set("code_challenge_method",xn),d.searchParams.set("redirect_uri",String(n)),a&&d.searchParams.set("state",a),s&&d.searchParams.set("scope",s),s!=null&&s.includes("offline_access")&&d.searchParams.append("prompt","consent"),u&&d.searchParams.set("resource",u.href),{authorizationUrl:d,codeVerifier:_}}function E0(e,t,r){return new URLSearchParams({grant_type:"authorization_code",code:e,code_verifier:t,redirect_uri:String(r)})}async function uc(e,{metadata:t,tokenRequestParams:r,clientInformation:n,addClientAuthentication:s,resource:a,fetchFn:u}){var d;const p=t!=null&&t.token_endpoint?new URL(t.token_endpoint):new URL("/token",e),_=new Headers({"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"});if(a&&r.set("resource",a.href),s)await s(_,r,p,t);else if(n){const b=(d=t==null?void 0:t.token_endpoint_auth_methods_supported)!==null&&d!==void 0?d:[],i=c0(n,b);u0(i,n,_,r)}const v=await(u??fetch)(p,{method:"POST",headers:_,body:r});if(!v.ok)throw await cc(v);return Xm.parse(await v.json())}async function $0(e,{metadata:t,clientInformation:r,refreshToken:n,resource:s,addClientAuthentication:a,fetchFn:u}){const d=new URLSearchParams({grant_type:"refresh_token",refresh_token:n}),p=await uc(e,{metadata:t,tokenRequestParams:d,clientInformation:r,addClientAuthentication:a,resource:s,fetchFn:u});return{refresh_token:n,...p}}async function S0(e,t,{metadata:r,resource:n,authorizationCode:s,fetchFn:a}={}){const u=e.clientMetadata.scope;let d;if(e.prepareTokenRequest&&(d=await e.prepareTokenRequest(u)),!d){if(!s)throw new Error("Either provider.prepareTokenRequest() or authorizationCode is required");if(!e.redirectUrl)throw new Error("redirectUrl is required for authorization_code flow");const _=await e.codeVerifier();d=E0(s,_,e.redirectUrl)}const p=await e.clientInformation();return uc(t,{metadata:r,tokenRequestParams:d,clientInformation:p??void 0,addClientAuthentication:e.addClientAuthentication,resource:n,fetchFn:a})}async function k0(e,{metadata:t,clientMetadata:r,fetchFn:n}){let s;if(t){if(!t.registration_endpoint)throw new Error("Incompatible auth server: does not support dynamic client registration");s=new URL(t.registration_endpoint)}else s=new URL("/register",e);const a=await(n??fetch)(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!a.ok)throw await cc(a);return n0.parse(await a.json())}class T0 extends Error{constructor(t,r,n){super(`SSE error: ${r}`),this.code=t,this.event=n}}class I0{constructor(t,r){this._url=t,this._resourceMetadataUrl=void 0,this._scope=void 0,this._eventSourceInit=r==null?void 0:r.eventSourceInit,this._requestInit=r==null?void 0:r.requestInit,this._authProvider=r==null?void 0:r.authProvider,this._fetch=r==null?void 0:r.fetch,this._fetchWithInit=Vm(r==null?void 0:r.fetch,r==null?void 0:r.requestInit)}async _authThenStart(){var t;if(!this._authProvider)throw new Mt("No auth provider");let r;try{r=await Ln(this._authProvider,{serverUrl:this._url,resourceMetadataUrl:this._resourceMetadataUrl,scope:this._scope,fetchFn:this._fetchWithInit})}catch(n){throw(t=this.onerror)===null||t===void 0||t.call(this,n),n}if(r!=="AUTHORIZED")throw new Mt;return await this._startOrAuth()}async _commonHeaders(){var t;const r={};if(this._authProvider){const s=await this._authProvider.tokens();s&&(r.Authorization=`Bearer ${s.access_token}`)}this._protocolVersion&&(r["mcp-protocol-version"]=this._protocolVersion);const n=ni((t=this._requestInit)===null||t===void 0?void 0:t.headers);return new Headers({...r,...n})}_startOrAuth(){var t,r,n;const s=(n=(r=(t=this===null||this===void 0?void 0:this._eventSourceInit)===null||t===void 0?void 0:t.fetch)!==null&&r!==void 0?r:this._fetch)!==null&&n!==void 0?n:fetch;return new Promise((a,u)=>{this._eventSource=new Gr(this._url.href,{...this._eventSourceInit,fetch:async(d,p)=>{const _=await this._commonHeaders();_.set("Accept","text/event-stream");const v=await s(d,{...p,headers:_});if(v.status===401&&v.headers.has("www-authenticate")){const{resourceMetadataUrl:b,scope:i}=Ds(v);this._resourceMetadataUrl=b,this._scope=i}return v}}),this._abortController=new AbortController,this._eventSource.onerror=d=>{var p;if(d.code===401&&this._authProvider){this._authThenStart().then(a,u);return}const _=new T0(d.code,d.message,d);u(_),(p=this.onerror)===null||p===void 0||p.call(this,_)},this._eventSource.onopen=()=>{},this._eventSource.addEventListener("endpoint",d=>{var p;const _=d;try{if(this._endpoint=new URL(_.data,this._url),this._endpoint.origin!==this._url.origin)throw new Error(`Endpoint origin does not match connection origin: ${this._endpoint.origin}`)}catch(v){u(v),(p=this.onerror)===null||p===void 0||p.call(this,v),this.close();return}a()}),this._eventSource.onmessage=d=>{var p,_;const v=d;let b;try{b=Zh.parse(JSON.parse(v.data))}catch(i){(p=this.onerror)===null||p===void 0||p.call(this,i);return}(_=this.onmessage)===null||_===void 0||_.call(this,b)}})}async start(){if(this._eventSource)throw new Error("SSEClientTransport already started! If using Client class, note that connect() calls start() automatically.");return await this._startOrAuth()}async finishAuth(t){if(!this._authProvider)throw new Mt("No auth provider");if(await Ln(this._authProvider,{serverUrl:this._url,authorizationCode:t,resourceMetadataUrl:this._resourceMetadataUrl,scope:this._scope,fetchFn:this._fetchWithInit})!=="AUTHORIZED")throw new Mt("Failed to authorize")}async close(){var t,r,n;(t=this._abortController)===null||t===void 0||t.abort(),(r=this._eventSource)===null||r===void 0||r.close(),(n=this.onclose)===null||n===void 0||n.call(this)}async send(t){var r,n,s;if(!this._endpoint)throw new Error("Not connected");try{const a=await this._commonHeaders();a.set("content-type","application/json");const u={...this._requestInit,method:"POST",headers:a,body:JSON.stringify(t),signal:(r=this._abortController)===null||r===void 0?void 0:r.signal},d=await((n=this._fetch)!==null&&n!==void 0?n:fetch)(this._endpoint,u);if(!d.ok){const p=await d.text().catch(()=>null);if(d.status===401&&this._authProvider){const{resourceMetadataUrl:_,scope:v}=Ds(d);if(this._resourceMetadataUrl=_,this._scope=v,await Ln(this._authProvider,{serverUrl:this._url,resourceMetadataUrl:this._resourceMetadataUrl,scope:this._scope,fetchFn:this._fetchWithInit})!=="AUTHORIZED")throw new Mt;return this.send(t)}throw new Error(`Error POSTing to endpoint (HTTP ${d.status}): ${p}`)}}catch(a){throw(s=this.onerror)===null||s===void 0||s.call(this,a),a}}setProtocolVersion(t){this._protocolVersion=t}}let Zr;const R0=new Uint8Array(16);function P0(){if(!Zr&&(Zr=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Zr))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Zr(R0)}const Pe=[];for(let e=0;e<256;++e)Pe.push((e+256).toString(16).slice(1));function N0(e,t=0){return Pe[e[t+0]]+Pe[e[t+1]]+Pe[e[t+2]]+Pe[e[t+3]]+"-"+Pe[e[t+4]]+Pe[e[t+5]]+"-"+Pe[e[t+6]]+Pe[e[t+7]]+"-"+Pe[e[t+8]]+Pe[e[t+9]]+"-"+Pe[e[t+10]]+Pe[e[t+11]]+Pe[e[t+12]]+Pe[e[t+13]]+Pe[e[t+14]]+Pe[e[t+15]]}const O0=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Vs={randomUUID:O0};function C0(e,t,r){if(Vs.randomUUID&&!e)return Vs.randomUUID();e=e||{};const n=e.random||(e.rng||P0)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,N0(n)}var pt;(function(e){e[e.INIT=0]="INIT",e[e.READY=1]="READY",e[e.CONNECTED=2]="CONNECTED",e[e.DISCONNECTED=3]="DISCONNECTED",e[e.CONNECTING=4]="CONNECTING",e[e.ERROR=5]="ERROR"})(pt||(pt={}));const A0=async e=>{console.log("getToken",{apiKey:e,endpoint:Gt(e).GET_TOKEN});const t={"x-api-key":e,"Content-Type":"application/json"};try{typeof process<"u"&&await process.nextTick(()=>{});const r=await fetch(Gt(e).GET_TOKEN,{method:"GET",headers:t});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);return(await r.json()).token}catch(r){const n=`Problem getting token, check api key, err: ${r.message}`;throw new Error(n)}};class F0{constructor(t,r={name:"nstrumenta-client",version:"1.0.0"}){this.ws=null,this.resourceSubscriptions=new Map,this.reconnection={hasVerified:!1,attempts:0,timeout:null},this.clientId=null,this.connection={status:pt.INIT},this.addSubscription=async(n,s)=>{const{subscriptionId:a}=await this.callRPC("subscribe",{channel:n});console.log(`Nstrumenta client subscribe <${n}> subscriptionId:${a}`);const u=this.subscriptions.get(n)||new Map;return u.set(a,s),this.subscriptions.set(n,u),async()=>{var d;await this.callRPC("unsubscribe",{channel:n,subscriptionId:a}),(d=this.subscriptions.get(n))==null||d.delete(a)}},this.apiKey=t,this.clientInfo=r,this.listeners=new Map,this.subscriptions=new Map,this.datalogs=new Map,this.messageBuffer=[],this.endpoints=Gt(t||"http://localhost:5999"),this.addSubscription=this.addSubscription.bind(this),this.addListener=this.addListener.bind(this),this.connect=this.connect.bind(this),this.storage=new z0({apiKey:t??""})}async shutdown(){var t,r;this.listeners.clear(),this.subscriptions.clear(),this.datalogs.clear(),this.messageBuffer=[],this.reconnection.timeout&&(clearTimeout(this.reconnection.timeout),this.reconnection.timeout=null),(t=this.ws)==null||t.removeAllListeners(),(r=this.ws)==null||r.close()}rollOff(t){return t==0?0:Math.min(Math.pow(t,2)*1e3,1800*1e3)}send(t,r){this.bufferedSend(Wi(t,r))}sendBuffer(t,r){this.bufferedSend(gc(t,r))}bufferedSend(t){var r,n,s;((r=this.ws)==null?void 0:r.readyState)!==((n=this.ws)==null?void 0:n.OPEN)?(console.log("adding to messageBuffer, length:",this.messageBuffer.length),this.messageBuffer.push(t)):(s=this.ws)==null||s.send(t)}addListener(t,r){this.listeners.get(t)||this.listeners.set(t,[]);const n=this.listeners.get(t);n&&n.push(r)}addStringToDataLog(t,r){const n=this.datalogs.get(t);n?n.push(r):(console.log(`starting new log: ${t}`),this.datalogs.set(t,[r]))}async uploadData(t,r,n){var _;const s=r.size;let a;const u=await fetch(this.endpoints.GET_UPLOAD_URL,{method:"POST",headers:{"Content-Type":"application/json","x-api-key":(_=this.apiKey)==null?void 0:_.split(":")[0]},body:JSON.stringify({path:t,size:s,meta:n})});if(!u.ok)throw new Error(`HTTP error! status: ${u.status}`);const d=await u.json();a=d==null?void 0:d.uploadUrl;const p=await fetch(a,{method:"PUT",headers:{"Content-Type":"application/octet-stream"},body:r});if(!p.ok)throw new Error(`HTTP error! status: ${p.status}`)}async ping(){return this.callRPC("ping",{sendTimestamp:Date.now()})}async startLog(t,r,n){this.send("_nstrumenta",{command:"startLog",name:t,channels:r,config:n})}async startRecording(t,r,n){return this.callRPC("startRecording",{name:t,channels:r,config:n})}async stopRecording(t){return this.callRPC("stopRecording",{name:t})}async finishLog(t){console.log("finish log"),this.send("_nstrumenta",{command:"finishLog",name:t})}async connectMcp(){if(!this.apiKey)throw new Error("apiKey required for MCP");const t=new I0(new URL(`${this.endpoints.MCP_SSE}?apiKey=${this.apiKey.split(":")[0]}`));this.mcp=new Mm(this.clientInfo,{capabilities:{}}),this.mcp.setNotificationHandler(D({method:G("notifications/resources/updated"),params:D({uri:R()})}),async r=>{const n=r.params.uri,s=this.resourceSubscriptions.get(n);s==null||s.forEach(a=>a(n))}),await this.mcp.connect(t)}async subscribeToMcpResource(t,r){this.mcp||await this.connectMcp();let n=this.resourceSubscriptions.get(t);n||(n=[],this.resourceSubscriptions.set(t,n),await this.mcp.request({method:"resources/subscribe",params:{uri:t}},Bn())),n.push(r)}async subscribeToAction(t,r,n){const s=`projects://${t}/actions/${r}`;await this.subscribeToMcpResource(s,async a=>{var p;const d=(p=(await this.mcp.request({method:"resources/read",params:{uri:s}},Bn())).contents)==null?void 0:p[0];d&&d.text&&n(JSON.parse(d.text))})}async callMcpTool(t,r){var u,d,p,_;if(!this.apiKey)throw new Error("apiKey not set");const n=await fetch(this.endpoints.MCP,{method:"POST",headers:{"Content-Type":"application/json","x-api-key":this.apiKey},body:JSON.stringify({jsonrpc:"2.0",method:"tools/call",params:{name:t,arguments:r},id:Date.now()})});if(!n.ok){const v=await n.text();throw new Error(`MCP request failed: ${n.status} ${v}`)}const s=await n.json();if(s.error)throw new Error(`MCP error: ${s.error.message||"Unknown error"}`);const a=s.result;if(a.isError)throw new Error(`Tool error: ${((d=(u=a.content)==null?void 0:u[0])==null?void 0:d.text)||"Unknown error"}`);return a.structuredContent?a.structuredContent:(_=(p=a.content)==null?void 0:p[0])!=null&&_.text?JSON.parse(a.content[0].text):a}async callRPC(t,r){console.log("callRPC",t,r);const n=C0(),s=`__rpc/${t}/${n}`,a=`${s}/request`,u=`${s}/response`;return new Promise(async d=>{var _;const p=this.subscriptions.get(u)||new Map;p.set(n,v=>{p==null||p.delete(n),d(v)}),this.subscriptions.set(u,p),(_=this.ws)==null||_.send(Wi(a,r))})}}class z0{constructor(t){var r;this.apiKey=t.apiKey,this.apiKeyHeader=(r=this.apiKey)==null?void 0:r.split(":")[0],this.endpoints=Gt(this.apiKey)}async getDownloadUrl(t){if(!this.apiKey)throw new Error("apiKey not set");const r=await fetch(this.endpoints.GET_PROJECT_DOWNLOAD_URL,{method:"POST",headers:{"x-api-key":this.apiKeyHeader,"content-type":"application/json"},body:JSON.stringify({path:t})});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);return console.log("REQ:",r),(await r.json()).url}async download(t){if(!this.apiKey)throw new Error("apiKey not set");const r=await fetch(this.endpoints.GET_PROJECT_DOWNLOAD_URL,{method:"POST",headers:{"x-api-key":this.apiKeyHeader,"content-type":"application/json"},body:JSON.stringify({path:t})});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const n=await r.json();console.log("REQ:",r);const s=await fetch(n.url,{method:"GET"});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);return await s.blob()}async query({field:t,comparison:r,compareValue:n}){if(!this.apiKey)throw new Error("apiKey not set");const s={field:t,comparison:r,compareValue:n},a={method:"POST",headers:{"x-api-key":this.apiKeyHeader,"Content-Type":"application/json"},body:JSON.stringify(s)};try{const u=await fetch(this.endpoints.QUERY_COLLECTION,a);if(!u.ok)throw new Error(`HTTP error! status: ${u.status}`);return await u.json()}catch(u){return console.log(`Something went wrong: ${u.message}`),[]}}async list(t){if(!this.apiKey)throw new Error("apiKey not set");const r=await fetch(this.endpoints.LIST_STORAGE_OBJECTS,{method:"POST",headers:{"x-api-key":this.apiKeyHeader,"Content-Type":"application/json"},body:JSON.stringify({type:t})});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);return await r.json()}async upload({filename:t,data:r,meta:n,overwrite:s}){const a=r.size||r.length;let u;const d={method:"POST",headers:{"x-api-key":this.apiKeyHeader,"Content-Type":"application/json"},body:JSON.stringify({name:t,size:a,metadata:n,overwrite:s})};let p=await fetch(this.endpoints.GET_UPLOAD_DATA_URL,d);if(!p.ok){console.warn(`HTTP error! status: ${p.status}`);return}const _=await p.json();if(u=_==null?void 0:_.uploadUrl,!u){console.warn(`no upload url returned, can't upload ${t}`),console.log(_);return}const v=_==null?void 0:_.remoteFilePath,b={method:"PUT",headers:{"Content-Type":"application/octet-stream"},body:r};console.log({remoteFilePath:v,uploadConfig:b});const i=await fetch(u,b);if(!i.ok){console.warn(`HTTP error! status: ${i.status}`);return}}}const Gt=(e,t)=>{const r=atob(e.split(":")[1]??"").trim();return{ADMIN_UTILS:`${r}/adminUtils`,CREATE_PROJECT:`${r}/createProject`,GET_MACHINES:`${r}/getMachines`,GET_CLOUD_RUN_SERVICES:`${r}/getCloudRunServices`,GET_UPLOAD_URL:`${r}/getUploadUrl`,GET_UPLOAD_DATA_URL:`${r}/getUploadDataUrl`,GET_PROJECT:`${r}/getProject`,REGISTER_AGENT:`${r}/registerAgent`,LIST_AGENTS:`${r}/listAgents`,SET_ACTION:`${r}/setAction`,GET_ACTION:`${r}/getAction`,SET_AGENT_ACTION:`${r}/setAgentAction`,GET_AGENT_ID_BY_TAG:`${r}/getAgentIdByTag`,CLEAN_AGENT_ACTIONS:`${r}/cleanAgentActions`,GET_DOWNLOAD_URL:`${r}/getDownloadUrl`,GET_PROJECT_DOWNLOAD_URL:`${r}/getProjectDownloadUrl`,GENERATE_DATA_ID:`${r}/generateDataId`,LIST_MODULES:`${r}/listModules`,GET_TOKEN:`${r}/getToken`,VERIFY_TOKEN:`${r}/verifyToken`,VERIFY_API_KEY:`${r}/verifyApiKey`,SET_STORAGE_OBJECT:`${r}/setStorageObject`,SET_DATA_METADATA:`${r}/setDataMetadata`,LIST_STORAGE_OBJECTS:`${r}/listStorageObjects`,GET_DATA_MOUNT:`${r}/getDataMount`,QUERY_COLLECTION:`${r}/queryCollection`,MCP:`${r}/`,MCP_SSE:`${r}/mcp/messages`}},U0="3.1.48";class q0 extends F0{constructor(){super(void 0,{name:"nstrumenta-browser",version:U0})}async connect(t){return new Promise(async(r,n)=>{const{wsUrl:s=void 0,apiKey:a=void 0,verify:u=!0}=t||{},{search:d}=window.location,p=new URLSearchParams(d).get("wsUrl"),_=s||p||window.location.origin.replace("http","ws"),v=new URLSearchParams(d).get("apiKey"),b=localStorage.getItem("apiKey"),i=a||v||b||prompt("Enter your nstrumenta apiKey");if(i&&localStorage.setItem("apiKey",i),this.reconnection.attempts>100)throw new Error("Too many reconnection attempts, stopping");if(!i)throw new Error('nstrumenta api key is missing, pass it as an argument to NstrumentaClient.connect({apiKey: "your key"}) for javascript clients in the browser, or set the NSTRUMENTA_API_KEY environment variable get a key from your nstrumenta project settings https://nstrumenta.com/projects/ *your projectId here* /settings');this.apiKey=i;let o="unverified";if(u)try{o=await A0(this.apiKey)}catch(c){console.error(c.message),n(c);return}this.ws=new WebSocket(_),this.ws.binaryType="arraybuffer",this.ws.addEventListener("open",async()=>{var c;console.log(`client websocket opened <${_}>`),(c=this.ws)==null||c.send(o),this.reconnection.attempts=0,this.connection.status=pt.CONNECTING}),this.ws.addEventListener("close",c=>{var f;this.connection.status=pt.DISCONNECTED,(f=this.listeners.get("close"))==null||f.forEach(l=>l()),console.log(`client websocket closed ${_} code:${c.code} wasClean:${c.wasClean}`),this.subscriptions.clear(),this.reconnection.hasVerified&&(this.reconnection.timeout=setTimeout(()=>{this.reconnection.timeout=null,console.log(`attempting to reconnect, attempts: ${this.reconnection.attempts}`),this.connect(t)},this.rollOff(this.reconnection.attempts)),this.reconnection.attempts+=1)}),this.ws.addEventListener("error",c=>{this.connection.status=pt.ERROR,n(`Error in websocket connection: ${c.message}`)}),this.ws.addEventListener("message",c=>{var g,w,y;const f=c.data;let l;try{l=_c(f)}catch(E){console.log(`Couldn't deserialize message ${JSON.stringify(E)}`);return}const{channel:m,contents:h}=l;if(m=="_nstrumenta"){const{verified:E,error:k,clientId:C}=h;k&&console.error(k),E&&(this.connection.status=pt.CONNECTED,this.reconnection.hasVerified=!0,(g=this.listeners.get("open"))==null||g.forEach(T=>T()),this.messageBuffer.forEach(T=>{var P;(P=this.ws)==null||P.send(T)}),this.messageBuffer=[],this.clientId=C,r(this.connection))}if(m=="__event"){const{event:E}=h;(w=this.listeners.get(E))==null||w.forEach(k=>k())}(y=this.subscriptions.get(m))==null||y.forEach(E=>{E(h)})})})}}const xt=new q0,j0=async()=>{if(document.readyState!=="complete")return;const e=document.getElementById("outputTextArea");xt.addListener("open",()=>{let d=!1;console.log("client open"),xt.addSubscription("__event",p=>{switch(p.event){case"health":const _=document.getElementById("health");_&&(_.innerText=new Date(Date.now()).toLocaleString());break}}),xt.addSubscription("_status",p=>{const{agentId:_}=p,v=document.getElementById("status");v&&(v.innerText=JSON.stringify(p)),_&&!d&&(d=!0,xt.addSubscription(`_${_}/stdout`,b=>{const i=new TextDecoder().decode(b);e.textContent+=`${i}
`}))})});const t=new URL(window.location.href).searchParams,r=t.get("wsUrl"),n=r||window.location.origin.replace("http","ws"),s=t.get("apiKey");s&&localStorage.setItem("apiKey",s);const a=localStorage.getItem("apiKey"),u=s||a;await xt.connect({apiKey:u||void 0,wsUrl:n})};document.addEventListener("readystatechange",j0);
