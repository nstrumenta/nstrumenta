const jn=(e,t)=>{const r=atob(e.split(":")[1]??"").trim();return{ADMIN_UTILS:`${r}/adminUtils`,CREATE_PROJECT:`${r}/createProject`,GET_MACHINES:`${r}/getMachines`,GET_CLOUD_RUN_SERVICES:`${r}/getCloudRunServices`,GET_UPLOAD_URL:`${r}/getUploadUrl`,GET_UPLOAD_DATA_URL:`${r}/getUploadDataUrl`,GET_PROJECT:`${r}/getProject`,REGISTER_AGENT:`${r}/registerAgent`,LIST_AGENTS:`${r}/listAgents`,SET_ACTION:`${r}/setAction`,GET_ACTION:`${r}/getAction`,SET_AGENT_ACTION:`${r}/setAgentAction`,GET_AGENT_ID_BY_TAG:`${r}/getAgentIdByTag`,CLEAN_AGENT_ACTIONS:`${r}/cleanAgentActions`,GET_DOWNLOAD_URL:`${r}/getDownloadUrl`,GET_PROJECT_DOWNLOAD_URL:`${r}/getProjectDownloadUrl`,GENERATE_DATA_ID:`${r}/generateDataId`,LIST_MODULES:`${r}/listModules`,GET_TOKEN:`${r}/getToken`,VERIFY_TOKEN:`${r}/verifyToken`,VERIFY_API_KEY:`${r}/verifyApiKey`,SET_STORAGE_OBJECT:`${r}/setStorageObject`,SET_DATA_METADATA:`${r}/setDataMetadata`,LIST_STORAGE_OBJECTS:`${r}/listStorageObjects`,GET_DATA_MOUNT:`${r}/getDataMount`,QUERY_COLLECTION:`${r}/queryCollection`,MCP:`${r}/`,MCP_SSE:`${r}/mcp/messages`}},Qa=Object.freeze({status:"aborted"});function N(e,t,r){function n(a,c){if(a._zod||Object.defineProperty(a,"_zod",{value:{def:c,constr:i,traits:new Set},enumerable:!1}),a._zod.traits.has(e))return;a._zod.traits.add(e),t(a,c);const u=i.prototype,l=Object.keys(u);for(let v=0;v<l.length;v++){const _=l[v];_ in a||(a[_]=u[_].bind(a))}}const o=(r==null?void 0:r.Parent)??Object;class s extends o{}Object.defineProperty(s,"name",{value:e});function i(a){var c;const u=r!=null&&r.Parent?new s:this;n(u,a),(c=u._zod).deferred??(c.deferred=[]);for(const l of u._zod.deferred)l();return u}return Object.defineProperty(i,"init",{value:n}),Object.defineProperty(i,Symbol.hasInstance,{value:a=>{var c,u;return r!=null&&r.Parent&&a instanceof r.Parent?!0:(u=(c=a==null?void 0:a._zod)==null?void 0:c.traits)==null?void 0:u.has(e)}}),Object.defineProperty(i,"name",{value:e}),i}class Et extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class zi extends Error{constructor(t){super(`Encountered unidirectional transform during encode: ${t}`),this.name="ZodEncodeError"}}const Ai={};function nt(e){return Ai}function Ya(e){const t=Object.values(e).filter(n=>typeof n=="number");return Object.entries(e).filter(([n,o])=>t.indexOf(+n)===-1).map(([n,o])=>o)}function Mn(e,t){return typeof t=="bigint"?t.toString():t}function Xr(e){return{get value(){{const t=e();return Object.defineProperty(this,"value",{value:t}),t}}}}function uo(e){return e==null}function lo(e){const t=e.startsWith("^")?1:0,r=e.endsWith("$")?e.length-1:e.length;return e.slice(t,r)}function Xa(e,t){const r=(e.toString().split(".")[1]||"").length,n=t.toString();let o=(n.split(".")[1]||"").length;if(o===0&&/\d?e-\d?/.test(n)){const c=n.match(/\d?e-(\d?)/);c!=null&&c[1]&&(o=Number.parseInt(c[1]))}const s=r>o?r:o,i=Number.parseInt(e.toFixed(s).replace(".","")),a=Number.parseInt(t.toFixed(s).replace(".",""));return i%a/10**s}const Zo=Symbol("evaluating");function le(e,t,r){let n;Object.defineProperty(e,t,{get(){if(n!==Zo)return n===void 0&&(n=Zo,n=r()),n},set(o){Object.defineProperty(e,t,{value:o})},configurable:!0})}function ft(e,t,r){Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!0,configurable:!0})}function ht(...e){const t={};for(const r of e){const n=Object.getOwnPropertyDescriptors(r);Object.assign(t,n)}return Object.defineProperties({},t)}function Vo(e){return JSON.stringify(e)}function ec(e){return e.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,"")}const qi="captureStackTrace"in Error?Error.captureStackTrace:(...e)=>{};function Vt(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}const tc=Xr(()=>{var e;if(typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)!=null&&e.includes("Cloudflare")))return!1;try{const t=Function;return new t(""),!0}catch{return!1}});function Pt(e){if(Vt(e)===!1)return!1;const t=e.constructor;if(t===void 0||typeof t!="function")return!0;const r=t.prototype;return!(Vt(r)===!1||Object.prototype.hasOwnProperty.call(r,"isPrototypeOf")===!1)}function ji(e){return Pt(e)?{...e}:Array.isArray(e)?[...e]:e}const rc=new Set(["string","number","symbol"]);function Rt(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function st(e,t,r){const n=new e._zod.constr(t??e._zod.def);return(!t||r!=null&&r.parent)&&(n._zod.parent=e),n}function K(e){const t=e;if(!t)return{};if(typeof t=="string")return{error:()=>t};if((t==null?void 0:t.message)!==void 0){if((t==null?void 0:t.error)!==void 0)throw new Error("Cannot specify both `message` and `error` params");t.error=t.message}return delete t.message,typeof t.error=="string"?{...t,error:()=>t.error}:t}function nc(e){return Object.keys(e).filter(t=>e[t]._zod.optin==="optional"&&e[t]._zod.optout==="optional")}const oc={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function sc(e,t){const r=e._zod.def,n=ht(e._zod.def,{get shape(){const o={};for(const s in t){if(!(s in r.shape))throw new Error(`Unrecognized key: "${s}"`);t[s]&&(o[s]=r.shape[s])}return ft(this,"shape",o),o},checks:[]});return st(e,n)}function ic(e,t){const r=e._zod.def,n=ht(e._zod.def,{get shape(){const o={...e._zod.def.shape};for(const s in t){if(!(s in r.shape))throw new Error(`Unrecognized key: "${s}"`);t[s]&&delete o[s]}return ft(this,"shape",o),o},checks:[]});return st(e,n)}function ac(e,t){if(!Pt(t))throw new Error("Invalid input to extend: expected a plain object");const r=e._zod.def.checks;if(r&&r.length>0)throw new Error("Object schemas containing refinements cannot be extended. Use `.safeExtend()` instead.");const o=ht(e._zod.def,{get shape(){const s={...e._zod.def.shape,...t};return ft(this,"shape",s),s},checks:[]});return st(e,o)}function cc(e,t){if(!Pt(t))throw new Error("Invalid input to safeExtend: expected a plain object");const r={...e._zod.def,get shape(){const n={...e._zod.def.shape,...t};return ft(this,"shape",n),n},checks:e._zod.def.checks};return st(e,r)}function uc(e,t){const r=ht(e._zod.def,{get shape(){const n={...e._zod.def.shape,...t._zod.def.shape};return ft(this,"shape",n),n},get catchall(){return t._zod.def.catchall},checks:[]});return st(e,r)}function lc(e,t,r){const n=ht(t._zod.def,{get shape(){const o=t._zod.def.shape,s={...o};if(r)for(const i in r){if(!(i in o))throw new Error(`Unrecognized key: "${i}"`);r[i]&&(s[i]=e?new e({type:"optional",innerType:o[i]}):o[i])}else for(const i in o)s[i]=e?new e({type:"optional",innerType:o[i]}):o[i];return ft(this,"shape",s),s},checks:[]});return st(t,n)}function dc(e,t,r){const n=ht(t._zod.def,{get shape(){const o=t._zod.def.shape,s={...o};if(r)for(const i in r){if(!(i in s))throw new Error(`Unrecognized key: "${i}"`);r[i]&&(s[i]=new e({type:"nonoptional",innerType:o[i]}))}else for(const i in o)s[i]=new e({type:"nonoptional",innerType:o[i]});return ft(this,"shape",s),s},checks:[]});return st(t,n)}function $t(e,t=0){var r;if(e.aborted===!0)return!0;for(let n=t;n<e.issues.length;n++)if(((r=e.issues[n])==null?void 0:r.continue)!==!0)return!0;return!1}function bt(e,t){return t.map(r=>{var n;return(n=r).path??(n.path=[]),r.path.unshift(e),r})}function Jt(e){return typeof e=="string"?e:e==null?void 0:e.message}function ot(e,t,r){var o,s,i,a,c,u;const n={...e,path:e.path??[]};if(!e.message){const l=Jt((i=(s=(o=e.inst)==null?void 0:o._zod.def)==null?void 0:s.error)==null?void 0:i.call(s,e))??Jt((a=t==null?void 0:t.error)==null?void 0:a.call(t,e))??Jt((c=r.customError)==null?void 0:c.call(r,e))??Jt((u=r.localeError)==null?void 0:u.call(r,e))??"Invalid input";n.message=l}return delete n.inst,delete n.continue,t!=null&&t.reportInput||delete n.input,n}function fo(e){return Array.isArray(e)?"array":typeof e=="string"?"string":"unknown"}function Ft(...e){const[t,r,n]=e;return typeof t=="string"?{message:t,code:"custom",input:r,inst:n}:{...t}}const Mi=(e,t)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:t,enumerable:!1}),e.message=JSON.stringify(t,Mn,2),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})},Ui=N("$ZodError",Mi),Di=N("$ZodError",Mi,{Parent:Error});function fc(e,t=r=>r.message){const r={},n=[];for(const o of e.issues)o.path.length>0?(r[o.path[0]]=r[o.path[0]]||[],r[o.path[0]].push(t(o))):n.push(t(o));return{formErrors:n,fieldErrors:r}}function hc(e,t=r=>r.message){const r={_errors:[]},n=o=>{for(const s of o.issues)if(s.code==="invalid_union"&&s.errors.length)s.errors.map(i=>n({issues:i}));else if(s.code==="invalid_key")n({issues:s.issues});else if(s.code==="invalid_element")n({issues:s.issues});else if(s.path.length===0)r._errors.push(t(s));else{let i=r,a=0;for(;a<s.path.length;){const c=s.path[a];a===s.path.length-1?(i[c]=i[c]||{_errors:[]},i[c]._errors.push(t(s))):i[c]=i[c]||{_errors:[]},i=i[c],a++}}};return n(e),r}const ho=e=>(t,r,n,o)=>{const s=n?Object.assign(n,{async:!1}):{async:!1},i=t._zod.run({value:r,issues:[]},s);if(i instanceof Promise)throw new Et;if(i.issues.length){const a=new((o==null?void 0:o.Err)??e)(i.issues.map(c=>ot(c,s,nt())));throw qi(a,o==null?void 0:o.callee),a}return i.value},po=e=>async(t,r,n,o)=>{const s=n?Object.assign(n,{async:!0}):{async:!0};let i=t._zod.run({value:r,issues:[]},s);if(i instanceof Promise&&(i=await i),i.issues.length){const a=new((o==null?void 0:o.Err)??e)(i.issues.map(c=>ot(c,s,nt())));throw qi(a,o==null?void 0:o.callee),a}return i.value},en=e=>(t,r,n)=>{const o=n?{...n,async:!1}:{async:!1},s=t._zod.run({value:r,issues:[]},o);if(s instanceof Promise)throw new Et;return s.issues.length?{success:!1,error:new(e??Ui)(s.issues.map(i=>ot(i,o,nt())))}:{success:!0,data:s.value}},Li=en(Di),tn=e=>async(t,r,n)=>{const o=n?Object.assign(n,{async:!0}):{async:!0};let s=t._zod.run({value:r,issues:[]},o);return s instanceof Promise&&(s=await s),s.issues.length?{success:!1,error:new e(s.issues.map(i=>ot(i,o,nt())))}:{success:!0,data:s.value}},pc=tn(Di),mc=e=>(t,r,n)=>{const o=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return ho(e)(t,r,o)},_c=e=>(t,r,n)=>ho(e)(t,r,n),vc=e=>async(t,r,n)=>{const o=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return po(e)(t,r,o)},gc=e=>async(t,r,n)=>po(e)(t,r,n),yc=e=>(t,r,n)=>{const o=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return en(e)(t,r,o)},wc=e=>(t,r,n)=>en(e)(t,r,n),$c=e=>async(t,r,n)=>{const o=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return tn(e)(t,r,o)},bc=e=>async(t,r,n)=>tn(e)(t,r,n),kc=/^[cC][^\s-]{8,}$/,Sc=/^[0-9a-z]+$/,Ec=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,Tc=/^[0-9a-vA-V]{20}$/,Pc=/^[A-Za-z0-9]{27}$/,Rc=/^[a-zA-Z0-9_-]{21}$/,Ic=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,Oc=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,Fo=e=>e?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${e}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,Cc=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,Nc="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function zc(){return new RegExp(Nc,"u")}const Ac=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,qc=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,jc=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,Mc=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Uc=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,Zi=/^[A-Za-z0-9_-]*$/,Dc=/^\+(?:[0-9]){6,14}[0-9]$/,Vi="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",Lc=new RegExp(`^${Vi}$`);function Fi(e){const t="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof e.precision=="number"?e.precision===-1?`${t}`:e.precision===0?`${t}:[0-5]\\d`:`${t}:[0-5]\\d\\.\\d{${e.precision}}`:`${t}(?::[0-5]\\d(?:\\.\\d+)?)?`}function Zc(e){return new RegExp(`^${Fi(e)}$`)}function Vc(e){const t=Fi({precision:e.precision}),r=["Z"];e.local&&r.push(""),e.offset&&r.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");const n=`${t}(?:${r.join("|")})`;return new RegExp(`^${Vi}T(?:${n})$`)}const Fc=e=>{const t=e?`[\\s\\S]{${(e==null?void 0:e.minimum)??0},${(e==null?void 0:e.maximum)??""}}`:"[\\s\\S]*";return new RegExp(`^${t}$`)},xc=/^-?\d+$/,Hc=/^-?\d+(?:\.\d+)?/,Kc=/^(?:true|false)$/i,Wc=/^null$/i,Gc=/^[^A-Z]*$/,Jc=/^[^a-z]*$/,Me=N("$ZodCheck",(e,t)=>{var r;e._zod??(e._zod={}),e._zod.def=t,(r=e._zod).onattach??(r.onattach=[])}),xi={number:"number",bigint:"bigint",object:"date"},Hi=N("$ZodCheckLessThan",(e,t)=>{Me.init(e,t);const r=xi[typeof t.value];e._zod.onattach.push(n=>{const o=n._zod.bag,s=(t.inclusive?o.maximum:o.exclusiveMaximum)??Number.POSITIVE_INFINITY;t.value<s&&(t.inclusive?o.maximum=t.value:o.exclusiveMaximum=t.value)}),e._zod.check=n=>{(t.inclusive?n.value<=t.value:n.value<t.value)||n.issues.push({origin:r,code:"too_big",maximum:t.value,input:n.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),Ki=N("$ZodCheckGreaterThan",(e,t)=>{Me.init(e,t);const r=xi[typeof t.value];e._zod.onattach.push(n=>{const o=n._zod.bag,s=(t.inclusive?o.minimum:o.exclusiveMinimum)??Number.NEGATIVE_INFINITY;t.value>s&&(t.inclusive?o.minimum=t.value:o.exclusiveMinimum=t.value)}),e._zod.check=n=>{(t.inclusive?n.value>=t.value:n.value>t.value)||n.issues.push({origin:r,code:"too_small",minimum:t.value,input:n.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),Bc=N("$ZodCheckMultipleOf",(e,t)=>{Me.init(e,t),e._zod.onattach.push(r=>{var n;(n=r._zod.bag).multipleOf??(n.multipleOf=t.value)}),e._zod.check=r=>{if(typeof r.value!=typeof t.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof r.value=="bigint"?r.value%t.value===BigInt(0):Xa(r.value,t.value)===0)||r.issues.push({origin:typeof r.value,code:"not_multiple_of",divisor:t.value,input:r.value,inst:e,continue:!t.abort})}}),Qc=N("$ZodCheckNumberFormat",(e,t)=>{var i;Me.init(e,t),t.format=t.format||"float64";const r=(i=t.format)==null?void 0:i.includes("int"),n=r?"int":"number",[o,s]=oc[t.format];e._zod.onattach.push(a=>{const c=a._zod.bag;c.format=t.format,c.minimum=o,c.maximum=s,r&&(c.pattern=xc)}),e._zod.check=a=>{const c=a.value;if(r){if(!Number.isInteger(c)){a.issues.push({expected:n,format:t.format,code:"invalid_type",continue:!1,input:c,inst:e});return}if(!Number.isSafeInteger(c)){c>0?a.issues.push({input:c,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:n,continue:!t.abort}):a.issues.push({input:c,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:n,continue:!t.abort});return}}c<o&&a.issues.push({origin:"number",input:c,code:"too_small",minimum:o,inclusive:!0,inst:e,continue:!t.abort}),c>s&&a.issues.push({origin:"number",input:c,code:"too_big",maximum:s,inst:e})}}),Yc=N("$ZodCheckMaxLength",(e,t)=>{var r;Me.init(e,t),(r=e._zod.def).when??(r.when=n=>{const o=n.value;return!uo(o)&&o.length!==void 0}),e._zod.onattach.push(n=>{const o=n._zod.bag.maximum??Number.POSITIVE_INFINITY;t.maximum<o&&(n._zod.bag.maximum=t.maximum)}),e._zod.check=n=>{const o=n.value;if(o.length<=t.maximum)return;const i=fo(o);n.issues.push({origin:i,code:"too_big",maximum:t.maximum,inclusive:!0,input:o,inst:e,continue:!t.abort})}}),Xc=N("$ZodCheckMinLength",(e,t)=>{var r;Me.init(e,t),(r=e._zod.def).when??(r.when=n=>{const o=n.value;return!uo(o)&&o.length!==void 0}),e._zod.onattach.push(n=>{const o=n._zod.bag.minimum??Number.NEGATIVE_INFINITY;t.minimum>o&&(n._zod.bag.minimum=t.minimum)}),e._zod.check=n=>{const o=n.value;if(o.length>=t.minimum)return;const i=fo(o);n.issues.push({origin:i,code:"too_small",minimum:t.minimum,inclusive:!0,input:o,inst:e,continue:!t.abort})}}),eu=N("$ZodCheckLengthEquals",(e,t)=>{var r;Me.init(e,t),(r=e._zod.def).when??(r.when=n=>{const o=n.value;return!uo(o)&&o.length!==void 0}),e._zod.onattach.push(n=>{const o=n._zod.bag;o.minimum=t.length,o.maximum=t.length,o.length=t.length}),e._zod.check=n=>{const o=n.value,s=o.length;if(s===t.length)return;const i=fo(o),a=s>t.length;n.issues.push({origin:i,...a?{code:"too_big",maximum:t.length}:{code:"too_small",minimum:t.length},inclusive:!0,exact:!0,input:n.value,inst:e,continue:!t.abort})}}),rn=N("$ZodCheckStringFormat",(e,t)=>{var r,n;Me.init(e,t),e._zod.onattach.push(o=>{const s=o._zod.bag;s.format=t.format,t.pattern&&(s.patterns??(s.patterns=new Set),s.patterns.add(t.pattern))}),t.pattern?(r=e._zod).check??(r.check=o=>{t.pattern.lastIndex=0,!t.pattern.test(o.value)&&o.issues.push({origin:"string",code:"invalid_format",format:t.format,input:o.value,...t.pattern?{pattern:t.pattern.toString()}:{},inst:e,continue:!t.abort})}):(n=e._zod).check??(n.check=()=>{})}),tu=N("$ZodCheckRegex",(e,t)=>{rn.init(e,t),e._zod.check=r=>{t.pattern.lastIndex=0,!t.pattern.test(r.value)&&r.issues.push({origin:"string",code:"invalid_format",format:"regex",input:r.value,pattern:t.pattern.toString(),inst:e,continue:!t.abort})}}),ru=N("$ZodCheckLowerCase",(e,t)=>{t.pattern??(t.pattern=Gc),rn.init(e,t)}),nu=N("$ZodCheckUpperCase",(e,t)=>{t.pattern??(t.pattern=Jc),rn.init(e,t)}),ou=N("$ZodCheckIncludes",(e,t)=>{Me.init(e,t);const r=Rt(t.includes),n=new RegExp(typeof t.position=="number"?`^.{${t.position}}${r}`:r);t.pattern=n,e._zod.onattach.push(o=>{const s=o._zod.bag;s.patterns??(s.patterns=new Set),s.patterns.add(n)}),e._zod.check=o=>{o.value.includes(t.includes,t.position)||o.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:t.includes,input:o.value,inst:e,continue:!t.abort})}}),su=N("$ZodCheckStartsWith",(e,t)=>{Me.init(e,t);const r=new RegExp(`^${Rt(t.prefix)}.*`);t.pattern??(t.pattern=r),e._zod.onattach.push(n=>{const o=n._zod.bag;o.patterns??(o.patterns=new Set),o.patterns.add(r)}),e._zod.check=n=>{n.value.startsWith(t.prefix)||n.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:t.prefix,input:n.value,inst:e,continue:!t.abort})}}),iu=N("$ZodCheckEndsWith",(e,t)=>{Me.init(e,t);const r=new RegExp(`.*${Rt(t.suffix)}$`);t.pattern??(t.pattern=r),e._zod.onattach.push(n=>{const o=n._zod.bag;o.patterns??(o.patterns=new Set),o.patterns.add(r)}),e._zod.check=n=>{n.value.endsWith(t.suffix)||n.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:t.suffix,input:n.value,inst:e,continue:!t.abort})}}),au=N("$ZodCheckOverwrite",(e,t)=>{Me.init(e,t),e._zod.check=r=>{r.value=t.tx(r.value)}});class cu{constructor(t=[]){this.content=[],this.indent=0,this&&(this.args=t)}indented(t){this.indent+=1,t(this),this.indent-=1}write(t){if(typeof t=="function"){t(this,{execution:"sync"}),t(this,{execution:"async"});return}const n=t.split(`
`).filter(i=>i),o=Math.min(...n.map(i=>i.length-i.trimStart().length)),s=n.map(i=>i.slice(o)).map(i=>" ".repeat(this.indent*2)+i);for(const i of s)this.content.push(i)}compile(){const t=Function,r=this==null?void 0:this.args,o=[...((this==null?void 0:this.content)??[""]).map(s=>`  ${s}`)];return new t(...r,o.join(`
`))}}const uu={major:4,minor:1,patch:13},fe=N("$ZodType",(e,t)=>{var o;var r;e??(e={}),e._zod.def=t,e._zod.bag=e._zod.bag||{},e._zod.version=uu;const n=[...e._zod.def.checks??[]];e._zod.traits.has("$ZodCheck")&&n.unshift(e);for(const s of n)for(const i of s._zod.onattach)i(e);if(n.length===0)(r=e._zod).deferred??(r.deferred=[]),(o=e._zod.deferred)==null||o.push(()=>{e._zod.run=e._zod.parse});else{const s=(a,c,u)=>{let l=$t(a),v;for(const _ of c){if(_._zod.def.when){if(!_._zod.def.when(a))continue}else if(l)continue;const g=a.issues.length,y=_._zod.check(a);if(y instanceof Promise&&(u==null?void 0:u.async)===!1)throw new Et;if(v||y instanceof Promise)v=(v??Promise.resolve()).then(async()=>{await y,a.issues.length!==g&&(l||(l=$t(a,g)))});else{if(a.issues.length===g)continue;l||(l=$t(a,g))}}return v?v.then(()=>a):a},i=(a,c,u)=>{if($t(a))return a.aborted=!0,a;const l=s(c,n,u);if(l instanceof Promise){if(u.async===!1)throw new Et;return l.then(v=>e._zod.parse(v,u))}return e._zod.parse(l,u)};e._zod.run=(a,c)=>{if(c.skipChecks)return e._zod.parse(a,c);if(c.direction==="backward"){const l=e._zod.parse({value:a.value,issues:[]},{...c,skipChecks:!0});return l instanceof Promise?l.then(v=>i(v,a,c)):i(l,a,c)}const u=e._zod.parse(a,c);if(u instanceof Promise){if(c.async===!1)throw new Et;return u.then(l=>s(l,n,c))}return s(u,n,c)}}e["~standard"]={validate:s=>{var i;try{const a=Li(e,s);return a.success?{value:a.data}:{issues:(i=a.error)==null?void 0:i.issues}}catch{return pc(e,s).then(c=>{var u;return c.success?{value:c.data}:{issues:(u=c.error)==null?void 0:u.issues}})}},vendor:"zod",version:1}}),mo=N("$ZodString",(e,t)=>{var r;fe.init(e,t),e._zod.pattern=[...((r=e==null?void 0:e._zod.bag)==null?void 0:r.patterns)??[]].pop()??Fc(e._zod.bag),e._zod.parse=(n,o)=>{if(t.coerce)try{n.value=String(n.value)}catch{}return typeof n.value=="string"||n.issues.push({expected:"string",code:"invalid_type",input:n.value,inst:e}),n}}),me=N("$ZodStringFormat",(e,t)=>{rn.init(e,t),mo.init(e,t)}),lu=N("$ZodGUID",(e,t)=>{t.pattern??(t.pattern=Oc),me.init(e,t)}),du=N("$ZodUUID",(e,t)=>{if(t.version){const n={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[t.version];if(n===void 0)throw new Error(`Invalid UUID version: "${t.version}"`);t.pattern??(t.pattern=Fo(n))}else t.pattern??(t.pattern=Fo());me.init(e,t)}),fu=N("$ZodEmail",(e,t)=>{t.pattern??(t.pattern=Cc),me.init(e,t)}),hu=N("$ZodURL",(e,t)=>{me.init(e,t),e._zod.check=r=>{try{const n=r.value.trim(),o=new URL(n);t.hostname&&(t.hostname.lastIndex=0,t.hostname.test(o.hostname)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:t.hostname.source,input:r.value,inst:e,continue:!t.abort})),t.protocol&&(t.protocol.lastIndex=0,t.protocol.test(o.protocol.endsWith(":")?o.protocol.slice(0,-1):o.protocol)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:t.protocol.source,input:r.value,inst:e,continue:!t.abort})),t.normalize?r.value=o.href:r.value=n;return}catch{r.issues.push({code:"invalid_format",format:"url",input:r.value,inst:e,continue:!t.abort})}}}),pu=N("$ZodEmoji",(e,t)=>{t.pattern??(t.pattern=zc()),me.init(e,t)}),mu=N("$ZodNanoID",(e,t)=>{t.pattern??(t.pattern=Rc),me.init(e,t)}),_u=N("$ZodCUID",(e,t)=>{t.pattern??(t.pattern=kc),me.init(e,t)}),vu=N("$ZodCUID2",(e,t)=>{t.pattern??(t.pattern=Sc),me.init(e,t)}),gu=N("$ZodULID",(e,t)=>{t.pattern??(t.pattern=Ec),me.init(e,t)}),yu=N("$ZodXID",(e,t)=>{t.pattern??(t.pattern=Tc),me.init(e,t)}),wu=N("$ZodKSUID",(e,t)=>{t.pattern??(t.pattern=Pc),me.init(e,t)}),$u=N("$ZodISODateTime",(e,t)=>{t.pattern??(t.pattern=Vc(t)),me.init(e,t)}),bu=N("$ZodISODate",(e,t)=>{t.pattern??(t.pattern=Lc),me.init(e,t)}),ku=N("$ZodISOTime",(e,t)=>{t.pattern??(t.pattern=Zc(t)),me.init(e,t)}),Su=N("$ZodISODuration",(e,t)=>{t.pattern??(t.pattern=Ic),me.init(e,t)}),Eu=N("$ZodIPv4",(e,t)=>{t.pattern??(t.pattern=Ac),me.init(e,t),e._zod.bag.format="ipv4"}),Tu=N("$ZodIPv6",(e,t)=>{t.pattern??(t.pattern=qc),me.init(e,t),e._zod.bag.format="ipv6",e._zod.check=r=>{try{new URL(`http://[${r.value}]`)}catch{r.issues.push({code:"invalid_format",format:"ipv6",input:r.value,inst:e,continue:!t.abort})}}}),Pu=N("$ZodCIDRv4",(e,t)=>{t.pattern??(t.pattern=jc),me.init(e,t)}),Ru=N("$ZodCIDRv6",(e,t)=>{t.pattern??(t.pattern=Mc),me.init(e,t),e._zod.check=r=>{const n=r.value.split("/");try{if(n.length!==2)throw new Error;const[o,s]=n;if(!s)throw new Error;const i=Number(s);if(`${i}`!==s)throw new Error;if(i<0||i>128)throw new Error;new URL(`http://[${o}]`)}catch{r.issues.push({code:"invalid_format",format:"cidrv6",input:r.value,inst:e,continue:!t.abort})}}});function Wi(e){if(e==="")return!0;if(e.length%4!==0)return!1;try{return atob(e),!0}catch{return!1}}const Iu=N("$ZodBase64",(e,t)=>{t.pattern??(t.pattern=Uc),me.init(e,t),e._zod.bag.contentEncoding="base64",e._zod.check=r=>{Wi(r.value)||r.issues.push({code:"invalid_format",format:"base64",input:r.value,inst:e,continue:!t.abort})}});function Ou(e){if(!Zi.test(e))return!1;const t=e.replace(/[-_]/g,n=>n==="-"?"+":"/"),r=t.padEnd(Math.ceil(t.length/4)*4,"=");return Wi(r)}const Cu=N("$ZodBase64URL",(e,t)=>{t.pattern??(t.pattern=Zi),me.init(e,t),e._zod.bag.contentEncoding="base64url",e._zod.check=r=>{Ou(r.value)||r.issues.push({code:"invalid_format",format:"base64url",input:r.value,inst:e,continue:!t.abort})}}),Nu=N("$ZodE164",(e,t)=>{t.pattern??(t.pattern=Dc),me.init(e,t)});function zu(e,t=null){try{const r=e.split(".");if(r.length!==3)return!1;const[n]=r;if(!n)return!1;const o=JSON.parse(atob(n));return!("typ"in o&&(o==null?void 0:o.typ)!=="JWT"||!o.alg||t&&(!("alg"in o)||o.alg!==t))}catch{return!1}}const Au=N("$ZodJWT",(e,t)=>{me.init(e,t),e._zod.check=r=>{zu(r.value,t.alg)||r.issues.push({code:"invalid_format",format:"jwt",input:r.value,inst:e,continue:!t.abort})}}),Gi=N("$ZodNumber",(e,t)=>{fe.init(e,t),e._zod.pattern=e._zod.bag.pattern??Hc,e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=Number(r.value)}catch{}const o=r.value;if(typeof o=="number"&&!Number.isNaN(o)&&Number.isFinite(o))return r;const s=typeof o=="number"?Number.isNaN(o)?"NaN":Number.isFinite(o)?void 0:"Infinity":void 0;return r.issues.push({expected:"number",code:"invalid_type",input:o,inst:e,...s?{received:s}:{}}),r}}),qu=N("$ZodNumberFormat",(e,t)=>{Qc.init(e,t),Gi.init(e,t)}),ju=N("$ZodBoolean",(e,t)=>{fe.init(e,t),e._zod.pattern=Kc,e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=!!r.value}catch{}const o=r.value;return typeof o=="boolean"||r.issues.push({expected:"boolean",code:"invalid_type",input:o,inst:e}),r}}),Mu=N("$ZodNull",(e,t)=>{fe.init(e,t),e._zod.pattern=Wc,e._zod.values=new Set([null]),e._zod.parse=(r,n)=>{const o=r.value;return o===null||r.issues.push({expected:"null",code:"invalid_type",input:o,inst:e}),r}}),Uu=N("$ZodAny",(e,t)=>{fe.init(e,t),e._zod.parse=r=>r}),Du=N("$ZodUnknown",(e,t)=>{fe.init(e,t),e._zod.parse=r=>r}),Lu=N("$ZodNever",(e,t)=>{fe.init(e,t),e._zod.parse=(r,n)=>(r.issues.push({expected:"never",code:"invalid_type",input:r.value,inst:e}),r)});function xo(e,t,r){e.issues.length&&t.issues.push(...bt(r,e.issues)),t.value[r]=e.value}const Zu=N("$ZodArray",(e,t)=>{fe.init(e,t),e._zod.parse=(r,n)=>{const o=r.value;if(!Array.isArray(o))return r.issues.push({expected:"array",code:"invalid_type",input:o,inst:e}),r;r.value=Array(o.length);const s=[];for(let i=0;i<o.length;i++){const a=o[i],c=t.element._zod.run({value:a,issues:[]},n);c instanceof Promise?s.push(c.then(u=>xo(u,r,i))):xo(c,r,i)}return s.length?Promise.all(s).then(()=>r):r}});function Vr(e,t,r,n){e.issues.length&&t.issues.push(...bt(r,e.issues)),e.value===void 0?r in n&&(t.value[r]=void 0):t.value[r]=e.value}function Ji(e){var n,o,s,i;const t=Object.keys(e.shape);for(const a of t)if(!((i=(s=(o=(n=e.shape)==null?void 0:n[a])==null?void 0:o._zod)==null?void 0:s.traits)!=null&&i.has("$ZodType")))throw new Error(`Invalid element at key "${a}": expected a Zod schema`);const r=nc(e.shape);return{...e,keys:t,keySet:new Set(t),numKeys:t.length,optionalKeys:new Set(r)}}function Bi(e,t,r,n,o,s){const i=[],a=o.keySet,c=o.catchall._zod,u=c.def.type;for(const l in t){if(a.has(l))continue;if(u==="never"){i.push(l);continue}const v=c.run({value:t[l],issues:[]},n);v instanceof Promise?e.push(v.then(_=>Vr(_,r,l,t))):Vr(v,r,l,t)}return i.length&&r.issues.push({code:"unrecognized_keys",keys:i,input:t,inst:s}),e.length?Promise.all(e).then(()=>r):r}const Vu=N("$ZodObject",(e,t)=>{fe.init(e,t);const r=Object.getOwnPropertyDescriptor(t,"shape");if(!(r!=null&&r.get)){const a=t.shape;Object.defineProperty(t,"shape",{get:()=>{const c={...a};return Object.defineProperty(t,"shape",{value:c}),c}})}const n=Xr(()=>Ji(t));le(e._zod,"propValues",()=>{const a=t.shape,c={};for(const u in a){const l=a[u]._zod;if(l.values){c[u]??(c[u]=new Set);for(const v of l.values)c[u].add(v)}}return c});const o=Vt,s=t.catchall;let i;e._zod.parse=(a,c)=>{i??(i=n.value);const u=a.value;if(!o(u))return a.issues.push({expected:"object",code:"invalid_type",input:u,inst:e}),a;a.value={};const l=[],v=i.shape;for(const _ of i.keys){const y=v[_]._zod.run({value:u[_],issues:[]},c);y instanceof Promise?l.push(y.then(k=>Vr(k,a,_,u))):Vr(y,a,_,u)}return s?Bi(l,u,a,c,n.value,e):l.length?Promise.all(l).then(()=>a):a}}),Fu=N("$ZodObjectJIT",(e,t)=>{Vu.init(e,t);const r=e._zod.parse,n=Xr(()=>Ji(t)),o=_=>{const g=new cu(["shape","payload","ctx"]),y=n.value,k=h=>{const $=Vo(h);return`shape[${$}]._zod.run({ value: input[${$}], issues: [] }, ctx)`};g.write("const input = payload.value;");const f=Object.create(null);let m=0;for(const h of y.keys)f[h]=`key_${m++}`;g.write("const newResult = {};");for(const h of y.keys){const $=f[h],p=Vo(h);g.write(`const ${$} = ${k(h)};`),g.write(`
        if (${$}.issues.length) {
          payload.issues = payload.issues.concat(${$}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${p}, ...iss.path] : [${p}]
          })));
        }
        
        
        if (${$}.value === undefined) {
          if (${p} in input) {
            newResult[${p}] = undefined;
          }
        } else {
          newResult[${p}] = ${$}.value;
        }
        
      `)}g.write("payload.value = newResult;"),g.write("return payload;");const d=g.compile();return(h,$)=>d(_,h,$)};let s;const i=Vt,a=!Ai.jitless,u=a&&tc.value,l=t.catchall;let v;e._zod.parse=(_,g)=>{v??(v=n.value);const y=_.value;return i(y)?a&&u&&(g==null?void 0:g.async)===!1&&g.jitless!==!0?(s||(s=o(t.shape)),_=s(_,g),l?Bi([],y,_,g,v,e):_):r(_,g):(_.issues.push({expected:"object",code:"invalid_type",input:y,inst:e}),_)}});function Ho(e,t,r,n){for(const s of e)if(s.issues.length===0)return t.value=s.value,t;const o=e.filter(s=>!$t(s));return o.length===1?(t.value=o[0].value,o[0]):(t.issues.push({code:"invalid_union",input:t.value,inst:r,errors:e.map(s=>s.issues.map(i=>ot(i,n,nt())))}),t)}const Qi=N("$ZodUnion",(e,t)=>{fe.init(e,t),le(e._zod,"optin",()=>t.options.some(o=>o._zod.optin==="optional")?"optional":void 0),le(e._zod,"optout",()=>t.options.some(o=>o._zod.optout==="optional")?"optional":void 0),le(e._zod,"values",()=>{if(t.options.every(o=>o._zod.values))return new Set(t.options.flatMap(o=>Array.from(o._zod.values)))}),le(e._zod,"pattern",()=>{if(t.options.every(o=>o._zod.pattern)){const o=t.options.map(s=>s._zod.pattern);return new RegExp(`^(${o.map(s=>lo(s.source)).join("|")})$`)}});const r=t.options.length===1,n=t.options[0]._zod.run;e._zod.parse=(o,s)=>{if(r)return n(o,s);let i=!1;const a=[];for(const c of t.options){const u=c._zod.run({value:o.value,issues:[]},s);if(u instanceof Promise)a.push(u),i=!0;else{if(u.issues.length===0)return u;a.push(u)}}return i?Promise.all(a).then(c=>Ho(c,o,e,s)):Ho(a,o,e,s)}}),xu=N("$ZodDiscriminatedUnion",(e,t)=>{Qi.init(e,t);const r=e._zod.parse;le(e._zod,"propValues",()=>{const o={};for(const s of t.options){const i=s._zod.propValues;if(!i||Object.keys(i).length===0)throw new Error(`Invalid discriminated union option at index "${t.options.indexOf(s)}"`);for(const[a,c]of Object.entries(i)){o[a]||(o[a]=new Set);for(const u of c)o[a].add(u)}}return o});const n=Xr(()=>{var i;const o=t.options,s=new Map;for(const a of o){const c=(i=a._zod.propValues)==null?void 0:i[t.discriminator];if(!c||c.size===0)throw new Error(`Invalid discriminated union option at index "${t.options.indexOf(a)}"`);for(const u of c){if(s.has(u))throw new Error(`Duplicate discriminator value "${String(u)}"`);s.set(u,a)}}return s});e._zod.parse=(o,s)=>{const i=o.value;if(!Vt(i))return o.issues.push({code:"invalid_type",expected:"object",input:i,inst:e}),o;const a=n.value.get(i==null?void 0:i[t.discriminator]);return a?a._zod.run(o,s):t.unionFallback?r(o,s):(o.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",discriminator:t.discriminator,input:i,path:[t.discriminator],inst:e}),o)}}),Hu=N("$ZodIntersection",(e,t)=>{fe.init(e,t),e._zod.parse=(r,n)=>{const o=r.value,s=t.left._zod.run({value:o,issues:[]},n),i=t.right._zod.run({value:o,issues:[]},n);return s instanceof Promise||i instanceof Promise?Promise.all([s,i]).then(([c,u])=>Ko(r,c,u)):Ko(r,s,i)}});function Un(e,t){if(e===t)return{valid:!0,data:e};if(e instanceof Date&&t instanceof Date&&+e==+t)return{valid:!0,data:e};if(Pt(e)&&Pt(t)){const r=Object.keys(t),n=Object.keys(e).filter(s=>r.indexOf(s)!==-1),o={...e,...t};for(const s of n){const i=Un(e[s],t[s]);if(!i.valid)return{valid:!1,mergeErrorPath:[s,...i.mergeErrorPath]};o[s]=i.data}return{valid:!0,data:o}}if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return{valid:!1,mergeErrorPath:[]};const r=[];for(let n=0;n<e.length;n++){const o=e[n],s=t[n],i=Un(o,s);if(!i.valid)return{valid:!1,mergeErrorPath:[n,...i.mergeErrorPath]};r.push(i.data)}return{valid:!0,data:r}}return{valid:!1,mergeErrorPath:[]}}function Ko(e,t,r){if(t.issues.length&&e.issues.push(...t.issues),r.issues.length&&e.issues.push(...r.issues),$t(e))return e;const n=Un(t.value,r.value);if(!n.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(n.mergeErrorPath)}`);return e.value=n.data,e}const Ku=N("$ZodRecord",(e,t)=>{fe.init(e,t),e._zod.parse=(r,n)=>{const o=r.value;if(!Pt(o))return r.issues.push({expected:"record",code:"invalid_type",input:o,inst:e}),r;const s=[],i=t.keyType._zod.values;if(i){r.value={};const a=new Set;for(const u of i)if(typeof u=="string"||typeof u=="number"||typeof u=="symbol"){a.add(typeof u=="number"?u.toString():u);const l=t.valueType._zod.run({value:o[u],issues:[]},n);l instanceof Promise?s.push(l.then(v=>{v.issues.length&&r.issues.push(...bt(u,v.issues)),r.value[u]=v.value})):(l.issues.length&&r.issues.push(...bt(u,l.issues)),r.value[u]=l.value)}let c;for(const u in o)a.has(u)||(c=c??[],c.push(u));c&&c.length>0&&r.issues.push({code:"unrecognized_keys",input:o,inst:e,keys:c})}else{r.value={};for(const a of Reflect.ownKeys(o)){if(a==="__proto__")continue;const c=t.keyType._zod.run({value:a,issues:[]},n);if(c instanceof Promise)throw new Error("Async schemas not supported in object keys currently");if(c.issues.length){r.issues.push({code:"invalid_key",origin:"record",issues:c.issues.map(l=>ot(l,n,nt())),input:a,path:[a],inst:e}),r.value[c.value]=c.value;continue}const u=t.valueType._zod.run({value:o[a],issues:[]},n);u instanceof Promise?s.push(u.then(l=>{l.issues.length&&r.issues.push(...bt(a,l.issues)),r.value[c.value]=l.value})):(u.issues.length&&r.issues.push(...bt(a,u.issues)),r.value[c.value]=u.value)}}return s.length?Promise.all(s).then(()=>r):r}}),Wu=N("$ZodEnum",(e,t)=>{fe.init(e,t);const r=Ya(t.entries),n=new Set(r);e._zod.values=n,e._zod.pattern=new RegExp(`^(${r.filter(o=>rc.has(typeof o)).map(o=>typeof o=="string"?Rt(o):o.toString()).join("|")})$`),e._zod.parse=(o,s)=>{const i=o.value;return n.has(i)||o.issues.push({code:"invalid_value",values:r,input:i,inst:e}),o}}),Gu=N("$ZodLiteral",(e,t)=>{if(fe.init(e,t),t.values.length===0)throw new Error("Cannot create literal schema with no valid values");const r=new Set(t.values);e._zod.values=r,e._zod.pattern=new RegExp(`^(${t.values.map(n=>typeof n=="string"?Rt(n):n?Rt(n.toString()):String(n)).join("|")})$`),e._zod.parse=(n,o)=>{const s=n.value;return r.has(s)||n.issues.push({code:"invalid_value",values:t.values,input:s,inst:e}),n}}),Ju=N("$ZodTransform",(e,t)=>{fe.init(e,t),e._zod.parse=(r,n)=>{if(n.direction==="backward")throw new zi(e.constructor.name);const o=t.transform(r.value,r);if(n.async)return(o instanceof Promise?o:Promise.resolve(o)).then(i=>(r.value=i,r));if(o instanceof Promise)throw new Et;return r.value=o,r}});function Wo(e,t){return e.issues.length&&t===void 0?{issues:[],value:void 0}:e}const Bu=N("$ZodOptional",(e,t)=>{fe.init(e,t),e._zod.optin="optional",e._zod.optout="optional",le(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,void 0]):void 0),le(e._zod,"pattern",()=>{const r=t.innerType._zod.pattern;return r?new RegExp(`^(${lo(r.source)})?$`):void 0}),e._zod.parse=(r,n)=>{if(t.innerType._zod.optin==="optional"){const o=t.innerType._zod.run(r,n);return o instanceof Promise?o.then(s=>Wo(s,r.value)):Wo(o,r.value)}return r.value===void 0?r:t.innerType._zod.run(r,n)}}),Qu=N("$ZodNullable",(e,t)=>{fe.init(e,t),le(e._zod,"optin",()=>t.innerType._zod.optin),le(e._zod,"optout",()=>t.innerType._zod.optout),le(e._zod,"pattern",()=>{const r=t.innerType._zod.pattern;return r?new RegExp(`^(${lo(r.source)}|null)$`):void 0}),le(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,null]):void 0),e._zod.parse=(r,n)=>r.value===null?r:t.innerType._zod.run(r,n)}),Yu=N("$ZodDefault",(e,t)=>{fe.init(e,t),e._zod.optin="optional",le(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(r,n)=>{if(n.direction==="backward")return t.innerType._zod.run(r,n);if(r.value===void 0)return r.value=t.defaultValue,r;const o=t.innerType._zod.run(r,n);return o instanceof Promise?o.then(s=>Go(s,t)):Go(o,t)}});function Go(e,t){return e.value===void 0&&(e.value=t.defaultValue),e}const Xu=N("$ZodPrefault",(e,t)=>{fe.init(e,t),e._zod.optin="optional",le(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(r,n)=>(n.direction==="backward"||r.value===void 0&&(r.value=t.defaultValue),t.innerType._zod.run(r,n))}),el=N("$ZodNonOptional",(e,t)=>{fe.init(e,t),le(e._zod,"values",()=>{const r=t.innerType._zod.values;return r?new Set([...r].filter(n=>n!==void 0)):void 0}),e._zod.parse=(r,n)=>{const o=t.innerType._zod.run(r,n);return o instanceof Promise?o.then(s=>Jo(s,e)):Jo(o,e)}});function Jo(e,t){return!e.issues.length&&e.value===void 0&&e.issues.push({code:"invalid_type",expected:"nonoptional",input:e.value,inst:t}),e}const tl=N("$ZodCatch",(e,t)=>{fe.init(e,t),le(e._zod,"optin",()=>t.innerType._zod.optin),le(e._zod,"optout",()=>t.innerType._zod.optout),le(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(r,n)=>{if(n.direction==="backward")return t.innerType._zod.run(r,n);const o=t.innerType._zod.run(r,n);return o instanceof Promise?o.then(s=>(r.value=s.value,s.issues.length&&(r.value=t.catchValue({...r,error:{issues:s.issues.map(i=>ot(i,n,nt()))},input:r.value}),r.issues=[]),r)):(r.value=o.value,o.issues.length&&(r.value=t.catchValue({...r,error:{issues:o.issues.map(s=>ot(s,n,nt()))},input:r.value}),r.issues=[]),r)}}),rl=N("$ZodPipe",(e,t)=>{fe.init(e,t),le(e._zod,"values",()=>t.in._zod.values),le(e._zod,"optin",()=>t.in._zod.optin),le(e._zod,"optout",()=>t.out._zod.optout),le(e._zod,"propValues",()=>t.in._zod.propValues),e._zod.parse=(r,n)=>{if(n.direction==="backward"){const s=t.out._zod.run(r,n);return s instanceof Promise?s.then(i=>Bt(i,t.in,n)):Bt(s,t.in,n)}const o=t.in._zod.run(r,n);return o instanceof Promise?o.then(s=>Bt(s,t.out,n)):Bt(o,t.out,n)}});function Bt(e,t,r){return e.issues.length?(e.aborted=!0,e):t._zod.run({value:e.value,issues:e.issues},r)}const nl=N("$ZodReadonly",(e,t)=>{fe.init(e,t),le(e._zod,"propValues",()=>t.innerType._zod.propValues),le(e._zod,"values",()=>t.innerType._zod.values),le(e._zod,"optin",()=>{var r,n;return(n=(r=t.innerType)==null?void 0:r._zod)==null?void 0:n.optin}),le(e._zod,"optout",()=>{var r,n;return(n=(r=t.innerType)==null?void 0:r._zod)==null?void 0:n.optout}),e._zod.parse=(r,n)=>{if(n.direction==="backward")return t.innerType._zod.run(r,n);const o=t.innerType._zod.run(r,n);return o instanceof Promise?o.then(Bo):Bo(o)}});function Bo(e){return e.value=Object.freeze(e.value),e}const ol=N("$ZodCustom",(e,t)=>{Me.init(e,t),fe.init(e,t),e._zod.parse=(r,n)=>r,e._zod.check=r=>{const n=r.value,o=t.fn(n);if(o instanceof Promise)return o.then(s=>Qo(s,r,n,e));Qo(o,r,n,e)}});function Qo(e,t,r,n){if(!e){const o={code:"custom",input:r,inst:n,path:[...n._zod.def.path??[]],continue:!n._zod.def.abort};n._zod.def.params&&(o.params=n._zod.def.params),t.issues.push(Ft(o))}}var Yo;class sl{constructor(){this._map=new WeakMap,this._idmap=new Map}add(t,...r){const n=r[0];if(this._map.set(t,n),n&&typeof n=="object"&&"id"in n){if(this._idmap.has(n.id))throw new Error(`ID ${n.id} already exists in the registry`);this._idmap.set(n.id,t)}return this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(t){const r=this._map.get(t);return r&&typeof r=="object"&&"id"in r&&this._idmap.delete(r.id),this._map.delete(t),this}get(t){const r=t._zod.parent;if(r){const n={...this.get(r)??{}};delete n.id;const o={...n,...this._map.get(t)};return Object.keys(o).length?o:void 0}return this._map.get(t)}has(t){return this._map.has(t)}}function il(){return new sl}(Yo=globalThis).__zod_globalRegistry??(Yo.__zod_globalRegistry=il());const Qt=globalThis.__zod_globalRegistry;function al(e,t){return new e({type:"string",...K(t)})}function cl(e,t){return new e({type:"string",format:"email",check:"string_format",abort:!1,...K(t)})}function Xo(e,t){return new e({type:"string",format:"guid",check:"string_format",abort:!1,...K(t)})}function ul(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,...K(t)})}function ll(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...K(t)})}function dl(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...K(t)})}function fl(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...K(t)})}function Yi(e,t){return new e({type:"string",format:"url",check:"string_format",abort:!1,...K(t)})}function hl(e,t){return new e({type:"string",format:"emoji",check:"string_format",abort:!1,...K(t)})}function pl(e,t){return new e({type:"string",format:"nanoid",check:"string_format",abort:!1,...K(t)})}function ml(e,t){return new e({type:"string",format:"cuid",check:"string_format",abort:!1,...K(t)})}function _l(e,t){return new e({type:"string",format:"cuid2",check:"string_format",abort:!1,...K(t)})}function vl(e,t){return new e({type:"string",format:"ulid",check:"string_format",abort:!1,...K(t)})}function gl(e,t){return new e({type:"string",format:"xid",check:"string_format",abort:!1,...K(t)})}function yl(e,t){return new e({type:"string",format:"ksuid",check:"string_format",abort:!1,...K(t)})}function wl(e,t){return new e({type:"string",format:"ipv4",check:"string_format",abort:!1,...K(t)})}function $l(e,t){return new e({type:"string",format:"ipv6",check:"string_format",abort:!1,...K(t)})}function bl(e,t){return new e({type:"string",format:"cidrv4",check:"string_format",abort:!1,...K(t)})}function kl(e,t){return new e({type:"string",format:"cidrv6",check:"string_format",abort:!1,...K(t)})}function Sl(e,t){return new e({type:"string",format:"base64",check:"string_format",abort:!1,...K(t)})}function El(e,t){return new e({type:"string",format:"base64url",check:"string_format",abort:!1,...K(t)})}function Tl(e,t){return new e({type:"string",format:"e164",check:"string_format",abort:!1,...K(t)})}function Pl(e,t){return new e({type:"string",format:"jwt",check:"string_format",abort:!1,...K(t)})}function Rl(e,t){return new e({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...K(t)})}function Il(e,t){return new e({type:"string",format:"date",check:"string_format",...K(t)})}function Ol(e,t){return new e({type:"string",format:"time",check:"string_format",precision:null,...K(t)})}function Cl(e,t){return new e({type:"string",format:"duration",check:"string_format",...K(t)})}function Nl(e,t){return new e({type:"number",checks:[],...K(t)})}function zl(e,t){return new e({type:"number",coerce:!0,checks:[],...K(t)})}function Al(e,t){return new e({type:"number",check:"number_format",abort:!1,format:"safeint",...K(t)})}function ql(e,t){return new e({type:"boolean",...K(t)})}function jl(e,t){return new e({type:"null",...K(t)})}function Ml(e){return new e({type:"any"})}function Ul(e){return new e({type:"unknown"})}function Dl(e,t){return new e({type:"never",...K(t)})}function es(e,t){return new Hi({check:"less_than",...K(t),value:e,inclusive:!1})}function _n(e,t){return new Hi({check:"less_than",...K(t),value:e,inclusive:!0})}function ts(e,t){return new Ki({check:"greater_than",...K(t),value:e,inclusive:!1})}function vn(e,t){return new Ki({check:"greater_than",...K(t),value:e,inclusive:!0})}function rs(e,t){return new Bc({check:"multiple_of",...K(t),value:e})}function Xi(e,t){return new Yc({check:"max_length",...K(t),maximum:e})}function Fr(e,t){return new Xc({check:"min_length",...K(t),minimum:e})}function ea(e,t){return new eu({check:"length_equals",...K(t),length:e})}function Ll(e,t){return new tu({check:"string_format",format:"regex",...K(t),pattern:e})}function Zl(e){return new ru({check:"string_format",format:"lowercase",...K(e)})}function Vl(e){return new nu({check:"string_format",format:"uppercase",...K(e)})}function Fl(e,t){return new ou({check:"string_format",format:"includes",...K(t),includes:e})}function xl(e,t){return new su({check:"string_format",format:"starts_with",...K(t),prefix:e})}function Hl(e,t){return new iu({check:"string_format",format:"ends_with",...K(t),suffix:e})}function Ct(e){return new au({check:"overwrite",tx:e})}function Kl(e){return Ct(t=>t.normalize(e))}function Wl(){return Ct(e=>e.trim())}function Gl(){return Ct(e=>e.toLowerCase())}function Jl(){return Ct(e=>e.toUpperCase())}function Bl(){return Ct(e=>ec(e))}function Ql(e,t,r){return new e({type:"array",element:t,...K(r)})}function Yl(e,t,r){const n=K(r);return n.abort??(n.abort=!0),new e({type:"custom",check:"custom",fn:t,...n})}function Xl(e,t,r){return new e({type:"custom",check:"custom",fn:t,...K(r)})}function ed(e){const t=td(r=>(r.addIssue=n=>{if(typeof n=="string")r.issues.push(Ft(n,r.value,t._zod.def));else{const o=n;o.fatal&&(o.continue=!1),o.code??(o.code="custom"),o.input??(o.input=r.value),o.inst??(o.inst=t),o.continue??(o.continue=!t._zod.def.abort),r.issues.push(Ft(o))}},e(r.value,r)));return t}function td(e,t){const r=new Me({check:"custom",...K(t)});return r._zod.check=e,r}function nn(e){return!!e._zod}function tt(e,t){return nn(e)?Li(e,t):e.safeParse(t)}function ta(e){var t,r;if(!e)return;let n;if(nn(e)?n=(r=(t=e._zod)===null||t===void 0?void 0:t.def)===null||r===void 0?void 0:r.shape:n=e.shape,!!n){if(typeof n=="function")try{return n()}catch{return}return n}}function rd(e){var t;if(nn(e)){const i=(t=e._zod)===null||t===void 0?void 0:t.def;if(i){if(i.value!==void 0)return i.value;if(Array.isArray(i.values)&&i.values.length>0)return i.values[0]}}const n=e._def;if(n){if(n.value!==void 0)return n.value;if(Array.isArray(n.values)&&n.values.length>0)return n.values[0]}const o=e.value;if(o!==void 0)return o}const nd=N("ZodISODateTime",(e,t)=>{$u.init(e,t),ge.init(e,t)});function od(e){return Rl(nd,e)}const sd=N("ZodISODate",(e,t)=>{bu.init(e,t),ge.init(e,t)});function id(e){return Il(sd,e)}const ad=N("ZodISOTime",(e,t)=>{ku.init(e,t),ge.init(e,t)});function cd(e){return Ol(ad,e)}const ud=N("ZodISODuration",(e,t)=>{Su.init(e,t),ge.init(e,t)});function ld(e){return Cl(ud,e)}const dd=(e,t)=>{Ui.init(e,t),e.name="ZodError",Object.defineProperties(e,{format:{value:r=>hc(e,r)},flatten:{value:r=>fc(e,r)},addIssue:{value:r=>{e.issues.push(r),e.message=JSON.stringify(e.issues,Mn,2)}},addIssues:{value:r=>{e.issues.push(...r),e.message=JSON.stringify(e.issues,Mn,2)}},isEmpty:{get(){return e.issues.length===0}}})},Ze=N("ZodError",dd,{Parent:Error}),fd=ho(Ze),hd=po(Ze),pd=en(Ze),md=tn(Ze),_d=mc(Ze),vd=_c(Ze),gd=vc(Ze),yd=gc(Ze),wd=yc(Ze),$d=wc(Ze),bd=$c(Ze),kd=bc(Ze),_e=N("ZodType",(e,t)=>(fe.init(e,t),e.def=t,e.type=t.type,Object.defineProperty(e,"_def",{value:t}),e.check=(...r)=>e.clone(ht(t,{checks:[...t.checks??[],...r.map(n=>typeof n=="function"?{_zod:{check:n,def:{check:"custom"},onattach:[]}}:n)]})),e.clone=(r,n)=>st(e,r,n),e.brand=()=>e,e.register=((r,n)=>(r.add(e,n),e)),e.parse=(r,n)=>fd(e,r,n,{callee:e.parse}),e.safeParse=(r,n)=>pd(e,r,n),e.parseAsync=async(r,n)=>hd(e,r,n,{callee:e.parseAsync}),e.safeParseAsync=async(r,n)=>md(e,r,n),e.spa=e.safeParseAsync,e.encode=(r,n)=>_d(e,r,n),e.decode=(r,n)=>vd(e,r,n),e.encodeAsync=async(r,n)=>gd(e,r,n),e.decodeAsync=async(r,n)=>yd(e,r,n),e.safeEncode=(r,n)=>wd(e,r,n),e.safeDecode=(r,n)=>$d(e,r,n),e.safeEncodeAsync=async(r,n)=>bd(e,r,n),e.safeDecodeAsync=async(r,n)=>kd(e,r,n),e.refine=(r,n)=>e.check(pf(r,n)),e.superRefine=r=>e.check(mf(r)),e.overwrite=r=>e.check(Ct(r)),e.optional=()=>B(e),e.nullable=()=>ss(e),e.nullish=()=>B(ss(e)),e.nonoptional=r=>af(e,r),e.array=()=>F(e),e.or=r=>ve([e,r]),e.and=r=>vo(e,r),e.transform=r=>Zn(e,ca(r)),e.default=r=>nf(e,r),e.prefault=r=>sf(e,r),e.catch=r=>uf(e,r),e.pipe=r=>Zn(e,r),e.readonly=()=>ff(e),e.describe=r=>{const n=e.clone();return Qt.add(n,{description:r}),n},Object.defineProperty(e,"description",{get(){var r;return(r=Qt.get(e))==null?void 0:r.description},configurable:!0}),e.meta=(...r)=>{if(r.length===0)return Qt.get(e);const n=e.clone();return Qt.add(n,r[0]),n},e.isOptional=()=>e.safeParse(void 0).success,e.isNullable=()=>e.safeParse(null).success,e)),ra=N("_ZodString",(e,t)=>{mo.init(e,t),_e.init(e,t);const r=e._zod.bag;e.format=r.format??null,e.minLength=r.minimum??null,e.maxLength=r.maximum??null,e.regex=(...n)=>e.check(Ll(...n)),e.includes=(...n)=>e.check(Fl(...n)),e.startsWith=(...n)=>e.check(xl(...n)),e.endsWith=(...n)=>e.check(Hl(...n)),e.min=(...n)=>e.check(Fr(...n)),e.max=(...n)=>e.check(Xi(...n)),e.length=(...n)=>e.check(ea(...n)),e.nonempty=(...n)=>e.check(Fr(1,...n)),e.lowercase=n=>e.check(Zl(n)),e.uppercase=n=>e.check(Vl(n)),e.trim=()=>e.check(Wl()),e.normalize=(...n)=>e.check(Kl(...n)),e.toLowerCase=()=>e.check(Gl()),e.toUpperCase=()=>e.check(Jl()),e.slugify=()=>e.check(Bl())}),Sd=N("ZodString",(e,t)=>{mo.init(e,t),ra.init(e,t),e.email=r=>e.check(cl(Ed,r)),e.url=r=>e.check(Yi(na,r)),e.jwt=r=>e.check(Pl(Zd,r)),e.emoji=r=>e.check(hl(Pd,r)),e.guid=r=>e.check(Xo(ns,r)),e.uuid=r=>e.check(ul(Yt,r)),e.uuidv4=r=>e.check(ll(Yt,r)),e.uuidv6=r=>e.check(dl(Yt,r)),e.uuidv7=r=>e.check(fl(Yt,r)),e.nanoid=r=>e.check(pl(Rd,r)),e.guid=r=>e.check(Xo(ns,r)),e.cuid=r=>e.check(ml(Id,r)),e.cuid2=r=>e.check(_l(Od,r)),e.ulid=r=>e.check(vl(Cd,r)),e.base64=r=>e.check(Sl(Ud,r)),e.base64url=r=>e.check(El(Dd,r)),e.xid=r=>e.check(gl(Nd,r)),e.ksuid=r=>e.check(yl(zd,r)),e.ipv4=r=>e.check(wl(Ad,r)),e.ipv6=r=>e.check($l(qd,r)),e.cidrv4=r=>e.check(bl(jd,r)),e.cidrv6=r=>e.check(kl(Md,r)),e.e164=r=>e.check(Tl(Ld,r)),e.datetime=r=>e.check(od(r)),e.date=r=>e.check(id(r)),e.time=r=>e.check(cd(r)),e.duration=r=>e.check(ld(r))});function T(e){return al(Sd,e)}const ge=N("ZodStringFormat",(e,t)=>{me.init(e,t),ra.init(e,t)}),Ed=N("ZodEmail",(e,t)=>{fu.init(e,t),ge.init(e,t)}),ns=N("ZodGUID",(e,t)=>{lu.init(e,t),ge.init(e,t)}),Yt=N("ZodUUID",(e,t)=>{du.init(e,t),ge.init(e,t)}),na=N("ZodURL",(e,t)=>{hu.init(e,t),ge.init(e,t)});function Td(e){return Yi(na,e)}const Pd=N("ZodEmoji",(e,t)=>{pu.init(e,t),ge.init(e,t)}),Rd=N("ZodNanoID",(e,t)=>{mu.init(e,t),ge.init(e,t)}),Id=N("ZodCUID",(e,t)=>{_u.init(e,t),ge.init(e,t)}),Od=N("ZodCUID2",(e,t)=>{vu.init(e,t),ge.init(e,t)}),Cd=N("ZodULID",(e,t)=>{gu.init(e,t),ge.init(e,t)}),Nd=N("ZodXID",(e,t)=>{yu.init(e,t),ge.init(e,t)}),zd=N("ZodKSUID",(e,t)=>{wu.init(e,t),ge.init(e,t)}),Ad=N("ZodIPv4",(e,t)=>{Eu.init(e,t),ge.init(e,t)}),qd=N("ZodIPv6",(e,t)=>{Tu.init(e,t),ge.init(e,t)}),jd=N("ZodCIDRv4",(e,t)=>{Pu.init(e,t),ge.init(e,t)}),Md=N("ZodCIDRv6",(e,t)=>{Ru.init(e,t),ge.init(e,t)}),Ud=N("ZodBase64",(e,t)=>{Iu.init(e,t),ge.init(e,t)}),Dd=N("ZodBase64URL",(e,t)=>{Cu.init(e,t),ge.init(e,t)}),Ld=N("ZodE164",(e,t)=>{Nu.init(e,t),ge.init(e,t)}),Zd=N("ZodJWT",(e,t)=>{Au.init(e,t),ge.init(e,t)}),_o=N("ZodNumber",(e,t)=>{Gi.init(e,t),_e.init(e,t),e.gt=(n,o)=>e.check(ts(n,o)),e.gte=(n,o)=>e.check(vn(n,o)),e.min=(n,o)=>e.check(vn(n,o)),e.lt=(n,o)=>e.check(es(n,o)),e.lte=(n,o)=>e.check(_n(n,o)),e.max=(n,o)=>e.check(_n(n,o)),e.int=n=>e.check(os(n)),e.safe=n=>e.check(os(n)),e.positive=n=>e.check(ts(0,n)),e.nonnegative=n=>e.check(vn(0,n)),e.negative=n=>e.check(es(0,n)),e.nonpositive=n=>e.check(_n(0,n)),e.multipleOf=(n,o)=>e.check(rs(n,o)),e.step=(n,o)=>e.check(rs(n,o)),e.finite=()=>e;const r=e._zod.bag;e.minValue=Math.max(r.minimum??Number.NEGATIVE_INFINITY,r.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,e.maxValue=Math.min(r.maximum??Number.POSITIVE_INFINITY,r.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,e.isInt=(r.format??"").includes("int")||Number.isSafeInteger(r.multipleOf??.5),e.isFinite=!0,e.format=r.format??null});function de(e){return Nl(_o,e)}const Vd=N("ZodNumberFormat",(e,t)=>{qu.init(e,t),_o.init(e,t)});function os(e){return Al(Vd,e)}const Fd=N("ZodBoolean",(e,t)=>{ju.init(e,t),_e.init(e,t)});function pe(e){return ql(Fd,e)}const xd=N("ZodNull",(e,t)=>{Mu.init(e,t),_e.init(e,t)});function oa(e){return jl(xd,e)}const Hd=N("ZodAny",(e,t)=>{Uu.init(e,t),_e.init(e,t)});function Dn(){return Ml(Hd)}const Kd=N("ZodUnknown",(e,t)=>{Du.init(e,t),_e.init(e,t)});function we(){return Ul(Kd)}const Wd=N("ZodNever",(e,t)=>{Lu.init(e,t),_e.init(e,t)});function Gd(e){return Dl(Wd,e)}const Jd=N("ZodArray",(e,t)=>{Zu.init(e,t),_e.init(e,t),e.element=t.element,e.min=(r,n)=>e.check(Fr(r,n)),e.nonempty=r=>e.check(Fr(1,r)),e.max=(r,n)=>e.check(Xi(r,n)),e.length=(r,n)=>e.check(ea(r,n)),e.unwrap=()=>e.element});function F(e,t){return Ql(Jd,e,t)}const sa=N("ZodObject",(e,t)=>{Fu.init(e,t),_e.init(e,t),le(e,"shape",()=>t.shape),e.keyof=()=>Ne(Object.keys(e._zod.def.shape)),e.catchall=r=>e.clone({...e._zod.def,catchall:r}),e.passthrough=()=>e.clone({...e._zod.def,catchall:we()}),e.loose=()=>e.clone({...e._zod.def,catchall:we()}),e.strict=()=>e.clone({...e._zod.def,catchall:Gd()}),e.strip=()=>e.clone({...e._zod.def,catchall:void 0}),e.extend=r=>ac(e,r),e.safeExtend=r=>cc(e,r),e.merge=r=>uc(e,r),e.pick=r=>sc(e,r),e.omit=r=>ic(e,r),e.partial=(...r)=>lc(ua,e,r[0]),e.required=(...r)=>dc(la,e,r[0])});function U(e,t){const r={type:"object",shape:e??{},...K(t)};return new sa(r)}function je(e,t){return new sa({type:"object",shape:e,catchall:we(),...K(t)})}const ia=N("ZodUnion",(e,t)=>{Qi.init(e,t),_e.init(e,t),e.options=t.options});function ve(e,t){return new ia({type:"union",options:e,...K(t)})}const Bd=N("ZodDiscriminatedUnion",(e,t)=>{ia.init(e,t),xu.init(e,t)});function aa(e,t,r){return new Bd({type:"union",options:t,discriminator:e,...K(r)})}const Qd=N("ZodIntersection",(e,t)=>{Hu.init(e,t),_e.init(e,t)});function vo(e,t){return new Qd({type:"intersection",left:e,right:t})}const Yd=N("ZodRecord",(e,t)=>{Ku.init(e,t),_e.init(e,t),e.keyType=t.keyType,e.valueType=t.valueType});function $e(e,t,r){return new Yd({type:"record",keyType:e,valueType:t,...K(r)})}const Ln=N("ZodEnum",(e,t)=>{Wu.init(e,t),_e.init(e,t),e.enum=t.entries,e.options=Object.values(t.entries);const r=new Set(Object.keys(t.entries));e.extract=(n,o)=>{const s={};for(const i of n)if(r.has(i))s[i]=t.entries[i];else throw new Error(`Key ${i} not found in enum`);return new Ln({...t,checks:[],...K(o),entries:s})},e.exclude=(n,o)=>{const s={...t.entries};for(const i of n)if(r.has(i))delete s[i];else throw new Error(`Key ${i} not found in enum`);return new Ln({...t,checks:[],...K(o),entries:s})}});function Ne(e,t){const r=Array.isArray(e)?Object.fromEntries(e.map(n=>[n,n])):e;return new Ln({type:"enum",entries:r,...K(t)})}const Xd=N("ZodLiteral",(e,t)=>{Gu.init(e,t),_e.init(e,t),e.values=new Set(t.values),Object.defineProperty(e,"value",{get(){if(t.values.length>1)throw new Error("This schema contains multiple valid literal values. Use `.values` instead.");return t.values[0]}})});function G(e,t){return new Xd({type:"literal",values:Array.isArray(e)?e:[e],...K(t)})}const ef=N("ZodTransform",(e,t)=>{Ju.init(e,t),_e.init(e,t),e._zod.parse=(r,n)=>{if(n.direction==="backward")throw new zi(e.constructor.name);r.addIssue=s=>{if(typeof s=="string")r.issues.push(Ft(s,r.value,t));else{const i=s;i.fatal&&(i.continue=!1),i.code??(i.code="custom"),i.input??(i.input=r.value),i.inst??(i.inst=e),r.issues.push(Ft(i))}};const o=t.transform(r.value,r);return o instanceof Promise?o.then(s=>(r.value=s,r)):(r.value=o,r)}});function ca(e){return new ef({type:"transform",transform:e})}const ua=N("ZodOptional",(e,t)=>{Bu.init(e,t),_e.init(e,t),e.unwrap=()=>e._zod.def.innerType});function B(e){return new ua({type:"optional",innerType:e})}const tf=N("ZodNullable",(e,t)=>{Qu.init(e,t),_e.init(e,t),e.unwrap=()=>e._zod.def.innerType});function ss(e){return new tf({type:"nullable",innerType:e})}const rf=N("ZodDefault",(e,t)=>{Yu.init(e,t),_e.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeDefault=e.unwrap});function nf(e,t){return new rf({type:"default",innerType:e,get defaultValue(){return typeof t=="function"?t():ji(t)}})}const of=N("ZodPrefault",(e,t)=>{Xu.init(e,t),_e.init(e,t),e.unwrap=()=>e._zod.def.innerType});function sf(e,t){return new of({type:"prefault",innerType:e,get defaultValue(){return typeof t=="function"?t():ji(t)}})}const la=N("ZodNonOptional",(e,t)=>{el.init(e,t),_e.init(e,t),e.unwrap=()=>e._zod.def.innerType});function af(e,t){return new la({type:"nonoptional",innerType:e,...K(t)})}const cf=N("ZodCatch",(e,t)=>{tl.init(e,t),_e.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeCatch=e.unwrap});function uf(e,t){return new cf({type:"catch",innerType:e,catchValue:typeof t=="function"?t:()=>t})}const lf=N("ZodPipe",(e,t)=>{rl.init(e,t),_e.init(e,t),e.in=t.in,e.out=t.out});function Zn(e,t){return new lf({type:"pipe",in:e,out:t})}const df=N("ZodReadonly",(e,t)=>{nl.init(e,t),_e.init(e,t),e.unwrap=()=>e._zod.def.innerType});function ff(e){return new df({type:"readonly",innerType:e})}const da=N("ZodCustom",(e,t)=>{ol.init(e,t),_e.init(e,t)});function hf(e,t){return Yl(da,e??(()=>!0),t)}function pf(e,t={}){return Xl(da,e,t)}function mf(e){return ed(e)}function fa(e,t){return Zn(ca(e),t)}const _f={custom:"custom"};function vf(e){return zl(_o,e)}const on="2025-11-25",gf=[on,"2025-06-18","2025-03-26","2024-11-05","2024-10-07"],Xe="io.modelcontextprotocol/related-task",sn="2.0",Ge=hf(e=>e!==null&&(typeof e=="object"||typeof e=="function")),ha=ve([T(),de().int()]),pa=T(),yf=je({ttl:ve([de(),oa()]).optional(),pollInterval:de().optional()}),go=je({taskId:T()}),wf=je({progressToken:ha.optional(),[Xe]:go.optional()}),Ue=je({task:yf.optional(),_meta:wf.optional()}),Pe=U({method:T(),params:Ue.optional()}),pt=je({_meta:U({[Xe]:B(go)}).passthrough().optional()}),Ve=U({method:T(),params:pt.optional()}),Re=je({_meta:je({[Xe]:go.optional()}).optional()}),an=ve([T(),de().int()]),ma=U({jsonrpc:G(sn),id:an,...Pe.shape}).strict(),is=e=>ma.safeParse(e).success,_a=U({jsonrpc:G(sn),...Ve.shape}).strict(),$f=e=>_a.safeParse(e).success,va=U({jsonrpc:G(sn),id:an,result:Re}).strict(),Xt=e=>va.safeParse(e).success;var X;(function(e){e[e.ConnectionClosed=-32e3]="ConnectionClosed",e[e.RequestTimeout=-32001]="RequestTimeout",e[e.ParseError=-32700]="ParseError",e[e.InvalidRequest=-32600]="InvalidRequest",e[e.MethodNotFound=-32601]="MethodNotFound",e[e.InvalidParams=-32602]="InvalidParams",e[e.InternalError=-32603]="InternalError",e[e.UrlElicitationRequired=-32042]="UrlElicitationRequired"})(X||(X={}));const ga=U({jsonrpc:G(sn),id:an,error:U({code:de().int(),message:T(),data:B(we())})}).strict(),bf=e=>ga.safeParse(e).success,kf=ve([ma,_a,va,ga]),kt=Re.strict(),Sf=pt.extend({requestId:an,reason:T().optional()}),yo=Ve.extend({method:G("notifications/cancelled"),params:Sf}),Ef=U({src:T(),mimeType:T().optional(),sizes:F(T()).optional()}),Ht=U({icons:F(Ef).optional()}),It=U({name:T(),title:T().optional()}),ya=It.extend({...It.shape,...Ht.shape,version:T(),websiteUrl:T().optional()}),Tf=vo(U({applyDefaults:pe().optional()}),$e(T(),we())),Pf=fa(e=>e&&typeof e=="object"&&!Array.isArray(e)&&Object.keys(e).length===0?{form:{}}:e,vo(U({form:Tf.optional(),url:Ge.optional()}),$e(T(),we()).optional())),Rf=U({list:B(U({}).passthrough()),cancel:B(U({}).passthrough()),requests:B(U({sampling:B(U({createMessage:B(U({}).passthrough())}).passthrough()),elicitation:B(U({create:B(U({}).passthrough())}).passthrough())}).passthrough())}).passthrough(),If=U({list:B(U({}).passthrough()),cancel:B(U({}).passthrough()),requests:B(U({tools:B(U({call:B(U({}).passthrough())}).passthrough())}).passthrough())}).passthrough(),Of=U({experimental:$e(T(),Ge).optional(),sampling:U({context:Ge.optional(),tools:Ge.optional()}).optional(),elicitation:Pf.optional(),roots:U({listChanged:pe().optional()}).optional(),tasks:B(Rf)}),Cf=Ue.extend({protocolVersion:T(),capabilities:Of,clientInfo:ya}),Nf=Pe.extend({method:G("initialize"),params:Cf}),zf=U({experimental:$e(T(),Ge).optional(),logging:Ge.optional(),completions:Ge.optional(),prompts:B(U({listChanged:B(pe())})),resources:U({subscribe:pe().optional(),listChanged:pe().optional()}).optional(),tools:U({listChanged:pe().optional()}).optional(),tasks:B(If)}).passthrough(),wa=Re.extend({protocolVersion:T(),capabilities:zf,serverInfo:ya,instructions:T().optional()}),Af=Ve.extend({method:G("notifications/initialized")}),wo=Pe.extend({method:G("ping")}),qf=U({progress:de(),total:B(de()),message:B(T())}),jf=U({...pt.shape,...qf.shape,progressToken:ha}),$o=Ve.extend({method:G("notifications/progress"),params:jf}),Mf=Ue.extend({cursor:pa.optional()}),Kt=Pe.extend({params:Mf.optional()}),Wt=Re.extend({nextCursor:B(pa)}),Gt=U({taskId:T(),status:Ne(["working","input_required","completed","failed","cancelled"]),ttl:ve([de(),oa()]),createdAt:T(),lastUpdatedAt:T(),pollInterval:B(de()),statusMessage:B(T())}),xt=Re.extend({task:Gt}),Uf=pt.merge(Gt),xr=Ve.extend({method:G("notifications/tasks/status"),params:Uf}),bo=Pe.extend({method:G("tasks/get"),params:Ue.extend({taskId:T()})}),ko=Re.merge(Gt),So=Pe.extend({method:G("tasks/result"),params:Ue.extend({taskId:T()})}),Eo=Kt.extend({method:G("tasks/list")}),To=Wt.extend({tasks:F(Gt)}),Df=Pe.extend({method:G("tasks/cancel"),params:Ue.extend({taskId:T()})}),Lf=Re.merge(Gt),$a=U({uri:T(),mimeType:B(T()),_meta:$e(T(),we()).optional()}),ba=$a.extend({text:T()}),Po=T().refine(e=>{try{return atob(e),!0}catch{return!1}},{message:"Invalid Base64 string"}),ka=$a.extend({blob:Po}),Sa=U({...It.shape,...Ht.shape,uri:T(),description:B(T()),mimeType:B(T()),_meta:B(je({}))}),Zf=U({...It.shape,...Ht.shape,uriTemplate:T(),description:B(T()),mimeType:B(T()),_meta:B(je({}))}),Vf=Kt.extend({method:G("resources/list")}),Ea=Wt.extend({resources:F(Sa)}),Ff=Kt.extend({method:G("resources/templates/list")}),Ta=Wt.extend({resourceTemplates:F(Zf)}),Ro=Ue.extend({uri:T()}),xf=Ro,Hf=Pe.extend({method:G("resources/read"),params:xf}),Pa=Re.extend({contents:F(ve([ba,ka]))}),Kf=Ve.extend({method:G("notifications/resources/list_changed")}),Wf=Ro,Gf=Pe.extend({method:G("resources/subscribe"),params:Wf}),Jf=Ro,Bf=Pe.extend({method:G("resources/unsubscribe"),params:Jf}),Qf=pt.extend({uri:T()}),Yf=Ve.extend({method:G("notifications/resources/updated"),params:Qf}),Xf=U({name:T(),description:B(T()),required:B(pe())}),eh=U({...It.shape,...Ht.shape,description:B(T()),arguments:B(F(Xf)),_meta:B(je({}))}),th=Kt.extend({method:G("prompts/list")}),Ra=Wt.extend({prompts:F(eh)}),rh=Ue.extend({name:T(),arguments:$e(T(),T()).optional()}),nh=Pe.extend({method:G("prompts/get"),params:rh}),Io=U({type:G("text"),text:T(),_meta:$e(T(),we()).optional()}),Oo=U({type:G("image"),data:Po,mimeType:T(),_meta:$e(T(),we()).optional()}),Co=U({type:G("audio"),data:Po,mimeType:T(),_meta:$e(T(),we()).optional()}),oh=U({type:G("tool_use"),name:T(),id:T(),input:U({}).passthrough(),_meta:B(U({}).passthrough())}).passthrough(),sh=U({type:G("resource"),resource:ve([ba,ka]),_meta:$e(T(),we()).optional()}),ih=Sa.extend({type:G("resource_link")}),No=ve([Io,Oo,Co,ih,sh]),ah=U({role:Ne(["user","assistant"]),content:No}),Ia=Re.extend({description:B(T()),messages:F(ah)}),ch=Ve.extend({method:G("notifications/prompts/list_changed")}),uh=U({title:T().optional(),readOnlyHint:pe().optional(),destructiveHint:pe().optional(),idempotentHint:pe().optional(),openWorldHint:pe().optional()}),lh=U({taskSupport:Ne(["required","optional","forbidden"]).optional()}),Oa=U({...It.shape,...Ht.shape,description:T().optional(),inputSchema:U({type:G("object"),properties:$e(T(),Ge).optional(),required:F(T()).optional()}).catchall(we()),outputSchema:U({type:G("object"),properties:$e(T(),Ge).optional(),required:F(T()).optional()}).catchall(we()).optional(),annotations:B(uh),execution:B(lh),_meta:$e(T(),we()).optional()}),dh=Kt.extend({method:G("tools/list")}),Ca=Wt.extend({tools:F(Oa)}),cn=Re.extend({content:F(No).default([]),structuredContent:$e(T(),we()).optional(),isError:B(pe())});cn.or(Re.extend({toolResult:we()}));const fh=Ue.extend({name:T(),arguments:B($e(T(),we()))}),hh=Pe.extend({method:G("tools/call"),params:fh}),ph=Ve.extend({method:G("notifications/tools/list_changed")}),Na=Ne(["debug","info","notice","warning","error","critical","alert","emergency"]),mh=Ue.extend({level:Na}),_h=Pe.extend({method:G("logging/setLevel"),params:mh}),vh=pt.extend({level:Na,logger:T().optional(),data:we()}),gh=Ve.extend({method:G("notifications/message"),params:vh}),yh=U({name:T().optional()}),wh=U({hints:B(F(yh)),costPriority:B(de().min(0).max(1)),speedPriority:B(de().min(0).max(1)),intelligencePriority:B(de().min(0).max(1))}),$h=U({mode:B(Ne(["auto","required","none"]))}),bh=U({type:G("tool_result"),toolUseId:T().describe("The unique identifier for the corresponding tool call."),content:F(No).default([]),structuredContent:U({}).passthrough().optional(),isError:B(pe()),_meta:B(U({}).passthrough())}).passthrough(),kh=aa("type",[Io,Oo,Co]),Hr=aa("type",[Io,Oo,Co,oh,bh]),Sh=U({role:Ne(["user","assistant"]),content:ve([Hr,F(Hr)]),_meta:B(U({}).passthrough())}).passthrough(),Eh=Ue.extend({messages:F(Sh),modelPreferences:wh.optional(),systemPrompt:T().optional(),includeContext:Ne(["none","thisServer","allServers"]).optional(),temperature:de().optional(),maxTokens:de().int(),stopSequences:F(T()).optional(),metadata:Ge.optional(),tools:B(F(Oa)),toolChoice:B($h)}),za=Pe.extend({method:G("sampling/createMessage"),params:Eh}),Aa=Re.extend({model:T(),stopReason:B(Ne(["endTurn","stopSequence","maxTokens"]).or(T())),role:Ne(["user","assistant"]),content:kh}),Th=Re.extend({model:T(),stopReason:B(Ne(["endTurn","stopSequence","maxTokens","toolUse"]).or(T())),role:Ne(["user","assistant"]),content:ve([Hr,F(Hr)])}),Ph=U({type:G("boolean"),title:T().optional(),description:T().optional(),default:pe().optional()}),Rh=U({type:G("string"),title:T().optional(),description:T().optional(),minLength:de().optional(),maxLength:de().optional(),format:Ne(["email","uri","date","date-time"]).optional(),default:T().optional()}),Ih=U({type:Ne(["number","integer"]),title:T().optional(),description:T().optional(),minimum:de().optional(),maximum:de().optional(),default:de().optional()}),Oh=U({type:G("string"),title:T().optional(),description:T().optional(),enum:F(T()),default:T().optional()}),Ch=U({type:G("string"),title:T().optional(),description:T().optional(),oneOf:F(U({const:T(),title:T()})),default:T().optional()}),Nh=U({type:G("string"),title:T().optional(),description:T().optional(),enum:F(T()),enumNames:F(T()).optional(),default:T().optional()}),zh=ve([Oh,Ch]),Ah=U({type:G("array"),title:T().optional(),description:T().optional(),minItems:de().optional(),maxItems:de().optional(),items:U({type:G("string"),enum:F(T())}),default:F(T()).optional()}),qh=U({type:G("array"),title:T().optional(),description:T().optional(),minItems:de().optional(),maxItems:de().optional(),items:U({anyOf:F(U({const:T(),title:T()}))}),default:F(T()).optional()}),jh=ve([Ah,qh]),Mh=ve([Nh,zh,jh]),Uh=ve([Mh,Ph,Rh,Ih]),Dh=Ue.extend({mode:G("form").optional(),message:T(),requestedSchema:U({type:G("object"),properties:$e(T(),Uh),required:F(T()).optional()})}),Lh=Ue.extend({mode:G("url"),message:T(),elicitationId:T(),url:T().url()}),Zh=ve([Dh,Lh]),qa=Pe.extend({method:G("elicitation/create"),params:Zh}),Vh=pt.extend({elicitationId:T()}),Fh=Ve.extend({method:G("notifications/elicitation/complete"),params:Vh}),ja=Re.extend({action:Ne(["accept","decline","cancel"]),content:fa(e=>e===null?void 0:e,$e(T(),ve([T(),de(),pe(),F(T())])).optional())}),xh=U({type:G("ref/resource"),uri:T()}),Hh=U({type:G("ref/prompt"),name:T()}),Kh=Ue.extend({ref:ve([Hh,xh]),argument:U({name:T(),value:T()}),context:U({arguments:$e(T(),T()).optional()}).optional()}),Wh=Pe.extend({method:G("completion/complete"),params:Kh}),Ma=Re.extend({completion:je({values:F(T()).max(100),total:B(de().int()),hasMore:B(pe())})}),Gh=U({uri:T().startsWith("file://"),name:T().optional(),_meta:$e(T(),we()).optional()}),Jh=Pe.extend({method:G("roots/list")}),Bh=Re.extend({roots:F(Gh)}),Qh=Ve.extend({method:G("notifications/roots/list_changed")});ve([wo,Nf,Wh,_h,nh,th,Vf,Ff,Hf,Gf,Bf,hh,dh,bo,So,Eo]);ve([yo,$o,Af,Qh,xr]);ve([kt,Aa,Th,ja,Bh,ko,To,xt]);ve([wo,za,qa,Jh,bo,So,Eo]);ve([yo,$o,gh,Yf,Kf,ph,ch,xr,Fh]);ve([kt,wa,Ma,Ia,Ra,Ea,Ta,Pa,cn,Ca,ko,To,xt]);class Y extends Error{constructor(t,r,n){super(`MCP error ${t}: ${r}`),this.code=t,this.data=n,this.name="McpError"}static fromError(t,r,n){if(t===X.UrlElicitationRequired&&n){const o=n;if(o.elicitations)return new Yh(o.elicitations,r)}return new Y(t,r,n)}}class Yh extends Y{constructor(t,r=`URL elicitation${t.length>1?"s":""} required`){super(X.UrlElicitationRequired,r,{elicitations:t})}get elicitations(){var t,r;return(r=(t=this.data)===null||t===void 0?void 0:t.elicitations)!==null&&r!==void 0?r:[]}}function at(e){return e==="completed"||e==="failed"||e==="cancelled"}new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function as(e){const t=ta(e),r=t==null?void 0:t.method;if(!r)throw new Error("Schema is missing a method literal");const n=rd(r);if(typeof n!="string")throw new Error("Schema method literal must be a string");return n}function cs(e,t){const r=tt(e,t);if(!r.success)throw r.error;return r.data}const Xh=6e4;class ep{constructor(t){this._options=t,this._requestMessageId=0,this._requestHandlers=new Map,this._requestHandlerAbortControllers=new Map,this._notificationHandlers=new Map,this._responseHandlers=new Map,this._progressHandlers=new Map,this._timeoutInfo=new Map,this._pendingDebouncedNotifications=new Set,this._taskProgressTokens=new Map,this._requestResolvers=new Map,this.setNotificationHandler(yo,r=>{this._oncancel(r)}),this.setNotificationHandler($o,r=>{this._onprogress(r)}),this.setRequestHandler(wo,r=>({})),this._taskStore=t==null?void 0:t.taskStore,this._taskMessageQueue=t==null?void 0:t.taskMessageQueue,this._taskStore&&(this.setRequestHandler(bo,async(r,n)=>{const o=await this._taskStore.getTask(r.params.taskId,n.sessionId);if(!o)throw new Y(X.InvalidParams,"Failed to retrieve task: Task not found");return{...o}}),this.setRequestHandler(So,async(r,n)=>{const o=async()=>{var s;const i=r.params.taskId;if(this._taskMessageQueue){let c;for(;c=await this._taskMessageQueue.dequeue(i,n.sessionId);){if(c.type==="response"||c.type==="error"){const u=c.message,l=u.id,v=this._requestResolvers.get(l);if(v)if(this._requestResolvers.delete(l),c.type==="response")v(u);else{const _=u,g=new Y(_.error.code,_.error.message,_.error.data);v(g)}else{const _=c.type==="response"?"Response":"Error";this._onerror(new Error(`${_} handler missing for request ${l}`))}continue}await((s=this._transport)===null||s===void 0?void 0:s.send(c.message,{relatedRequestId:n.requestId}))}}const a=await this._taskStore.getTask(i,n.sessionId);if(!a)throw new Y(X.InvalidParams,`Task not found: ${i}`);if(!at(a.status))return await this._waitForTaskUpdate(i,n.signal),await o();if(at(a.status)){const c=await this._taskStore.getTaskResult(i,n.sessionId);return this._clearTaskQueue(i),{...c,_meta:{...c._meta,[Xe]:{taskId:i}}}}return await o()};return await o()}),this.setRequestHandler(Eo,async(r,n)=>{var o;try{const{tasks:s,nextCursor:i}=await this._taskStore.listTasks((o=r.params)===null||o===void 0?void 0:o.cursor,n.sessionId);return{tasks:s,nextCursor:i,_meta:{}}}catch(s){throw new Y(X.InvalidParams,`Failed to list tasks: ${s instanceof Error?s.message:String(s)}`)}}),this.setRequestHandler(Df,async(r,n)=>{try{const o=await this._taskStore.getTask(r.params.taskId,n.sessionId);if(!o)throw new Y(X.InvalidParams,`Task not found: ${r.params.taskId}`);if(at(o.status))throw new Y(X.InvalidParams,`Cannot cancel task in terminal status: ${o.status}`);await this._taskStore.updateTaskStatus(r.params.taskId,"cancelled","Client cancelled task execution.",n.sessionId),this._clearTaskQueue(r.params.taskId);const s=await this._taskStore.getTask(r.params.taskId,n.sessionId);if(!s)throw new Y(X.InvalidParams,`Task not found after cancellation: ${r.params.taskId}`);return{_meta:{},...s}}catch(o){throw o instanceof Y?o:new Y(X.InvalidRequest,`Failed to cancel task: ${o instanceof Error?o.message:String(o)}`)}}))}async _oncancel(t){const r=this._requestHandlerAbortControllers.get(t.params.requestId);r==null||r.abort(t.params.reason)}_setupTimeout(t,r,n,o,s=!1){this._timeoutInfo.set(t,{timeoutId:setTimeout(o,r),startTime:Date.now(),timeout:r,maxTotalTimeout:n,resetTimeoutOnProgress:s,onTimeout:o})}_resetTimeout(t){const r=this._timeoutInfo.get(t);if(!r)return!1;const n=Date.now()-r.startTime;if(r.maxTotalTimeout&&n>=r.maxTotalTimeout)throw this._timeoutInfo.delete(t),Y.fromError(X.RequestTimeout,"Maximum total timeout exceeded",{maxTotalTimeout:r.maxTotalTimeout,totalElapsed:n});return clearTimeout(r.timeoutId),r.timeoutId=setTimeout(r.onTimeout,r.timeout),!0}_cleanupTimeout(t){const r=this._timeoutInfo.get(t);r&&(clearTimeout(r.timeoutId),this._timeoutInfo.delete(t))}async connect(t){var r,n,o;this._transport=t;const s=(r=this.transport)===null||r===void 0?void 0:r.onclose;this._transport.onclose=()=>{s==null||s(),this._onclose()};const i=(n=this.transport)===null||n===void 0?void 0:n.onerror;this._transport.onerror=c=>{i==null||i(c),this._onerror(c)};const a=(o=this._transport)===null||o===void 0?void 0:o.onmessage;this._transport.onmessage=(c,u)=>{a==null||a(c,u),Xt(c)||bf(c)?this._onresponse(c):is(c)?this._onrequest(c,u):$f(c)?this._onnotification(c):this._onerror(new Error(`Unknown message type: ${JSON.stringify(c)}`))},await this._transport.start()}_onclose(){var t;const r=this._responseHandlers;this._responseHandlers=new Map,this._progressHandlers.clear(),this._taskProgressTokens.clear(),this._pendingDebouncedNotifications.clear();const n=Y.fromError(X.ConnectionClosed,"Connection closed");this._transport=void 0,(t=this.onclose)===null||t===void 0||t.call(this);for(const o of r.values())o(n)}_onerror(t){var r;(r=this.onerror)===null||r===void 0||r.call(this,t)}_onnotification(t){var r;const n=(r=this._notificationHandlers.get(t.method))!==null&&r!==void 0?r:this.fallbackNotificationHandler;n!==void 0&&Promise.resolve().then(()=>n(t)).catch(o=>this._onerror(new Error(`Uncaught error in notification handler: ${o}`)))}_onrequest(t,r){var n,o,s,i,a,c;const u=(n=this._requestHandlers.get(t.method))!==null&&n!==void 0?n:this.fallbackRequestHandler,l=this._transport,v=(i=(s=(o=t.params)===null||o===void 0?void 0:o._meta)===null||s===void 0?void 0:s[Xe])===null||i===void 0?void 0:i.taskId;if(u===void 0){const f={jsonrpc:"2.0",id:t.id,error:{code:X.MethodNotFound,message:"Method not found"}};v&&this._taskMessageQueue?this._enqueueTaskMessage(v,{type:"error",message:f,timestamp:Date.now()},l==null?void 0:l.sessionId).catch(m=>this._onerror(new Error(`Failed to enqueue error response: ${m}`))):l==null||l.send(f).catch(m=>this._onerror(new Error(`Failed to send an error response: ${m}`)));return}const _=new AbortController;this._requestHandlerAbortControllers.set(t.id,_);const g=(a=t.params)===null||a===void 0?void 0:a.task,y=this._taskStore?this.requestTaskStore(t,l==null?void 0:l.sessionId):void 0,k={signal:_.signal,sessionId:l==null?void 0:l.sessionId,_meta:(c=t.params)===null||c===void 0?void 0:c._meta,sendNotification:async f=>{const m={relatedRequestId:t.id};v&&(m.relatedTask={taskId:v}),await this.notification(f,m)},sendRequest:async(f,m,d)=>{var h,$;const p={...d,relatedRequestId:t.id};v&&!p.relatedTask&&(p.relatedTask={taskId:v});const b=($=(h=p.relatedTask)===null||h===void 0?void 0:h.taskId)!==null&&$!==void 0?$:v;return b&&y&&await y.updateTaskStatus(b,"input_required"),await this.request(f,m,p)},authInfo:r==null?void 0:r.authInfo,requestId:t.id,requestInfo:r==null?void 0:r.requestInfo,taskId:v,taskStore:y,taskRequestedTtl:g==null?void 0:g.ttl,closeSSEStream:r==null?void 0:r.closeSSEStream,closeStandaloneSSEStream:r==null?void 0:r.closeStandaloneSSEStream};Promise.resolve().then(()=>{g&&this.assertTaskHandlerCapability(t.method)}).then(()=>u(t,k)).then(async f=>{if(_.signal.aborted)return;const m={result:f,jsonrpc:"2.0",id:t.id};v&&this._taskMessageQueue?await this._enqueueTaskMessage(v,{type:"response",message:m,timestamp:Date.now()},l==null?void 0:l.sessionId):await(l==null?void 0:l.send(m))},async f=>{var m;if(_.signal.aborted)return;const d={jsonrpc:"2.0",id:t.id,error:{code:Number.isSafeInteger(f.code)?f.code:X.InternalError,message:(m=f.message)!==null&&m!==void 0?m:"Internal error",...f.data!==void 0&&{data:f.data}}};v&&this._taskMessageQueue?await this._enqueueTaskMessage(v,{type:"error",message:d,timestamp:Date.now()},l==null?void 0:l.sessionId):await(l==null?void 0:l.send(d))}).catch(f=>this._onerror(new Error(`Failed to send response: ${f}`))).finally(()=>{this._requestHandlerAbortControllers.delete(t.id)})}_onprogress(t){const{progressToken:r,...n}=t.params,o=Number(r),s=this._progressHandlers.get(o);if(!s){this._onerror(new Error(`Received a progress notification for an unknown token: ${JSON.stringify(t)}`));return}const i=this._responseHandlers.get(o),a=this._timeoutInfo.get(o);if(a&&i&&a.resetTimeoutOnProgress)try{this._resetTimeout(o)}catch(c){this._responseHandlers.delete(o),this._progressHandlers.delete(o),this._cleanupTimeout(o),i(c);return}s(n)}_onresponse(t){const r=Number(t.id),n=this._requestResolvers.get(r);if(n){if(this._requestResolvers.delete(r),Xt(t))n(t);else{const i=new Y(t.error.code,t.error.message,t.error.data);n(i)}return}const o=this._responseHandlers.get(r);if(o===void 0){this._onerror(new Error(`Received a response for an unknown message ID: ${JSON.stringify(t)}`));return}this._responseHandlers.delete(r),this._cleanupTimeout(r);let s=!1;if(Xt(t)&&t.result&&typeof t.result=="object"){const i=t.result;if(i.task&&typeof i.task=="object"){const a=i.task;typeof a.taskId=="string"&&(s=!0,this._taskProgressTokens.set(a.taskId,r))}}if(s||this._progressHandlers.delete(r),Xt(t))o(t);else{const i=Y.fromError(t.error.code,t.error.message,t.error.data);o(i)}}get transport(){return this._transport}async close(){var t;await((t=this._transport)===null||t===void 0?void 0:t.close())}async*requestStream(t,r,n){var o,s,i,a;const{task:c}=n??{};if(!c){try{yield{type:"result",result:await this.request(t,r,n)}}catch(l){yield{type:"error",error:l instanceof Y?l:new Y(X.InternalError,String(l))}}return}let u;try{const l=await this.request(t,xt,n);if(l.task)u=l.task.taskId,yield{type:"taskCreated",task:l.task};else throw new Y(X.InternalError,"Task creation did not return a task");for(;;){const v=await this.getTask({taskId:u},n);if(yield{type:"taskStatus",task:v},at(v.status)){v.status==="completed"?yield{type:"result",result:await this.getTaskResult({taskId:u},r,n)}:v.status==="failed"?yield{type:"error",error:new Y(X.InternalError,`Task ${u} failed`)}:v.status==="cancelled"&&(yield{type:"error",error:new Y(X.InternalError,`Task ${u} was cancelled`)});return}if(v.status==="input_required"){yield{type:"result",result:await this.getTaskResult({taskId:u},r,n)};return}const _=(i=(o=v.pollInterval)!==null&&o!==void 0?o:(s=this._options)===null||s===void 0?void 0:s.defaultTaskPollInterval)!==null&&i!==void 0?i:1e3;await new Promise(g=>setTimeout(g,_)),(a=n==null?void 0:n.signal)===null||a===void 0||a.throwIfAborted()}}catch(l){yield{type:"error",error:l instanceof Y?l:new Y(X.InternalError,String(l))}}}request(t,r,n){const{relatedRequestId:o,resumptionToken:s,onresumptiontoken:i,task:a,relatedTask:c}=n??{};return new Promise((u,l)=>{var v,_,g,y,k,f,m;const d=z=>{l(z)};if(!this._transport){d(new Error("Not connected"));return}if(((v=this._options)===null||v===void 0?void 0:v.enforceStrictCapabilities)===!0)try{this.assertCapabilityForMethod(t.method),a&&this.assertTaskCapability(t.method)}catch(z){d(z);return}(_=n==null?void 0:n.signal)===null||_===void 0||_.throwIfAborted();const h=this._requestMessageId++,$={...t,jsonrpc:"2.0",id:h};n!=null&&n.onprogress&&(this._progressHandlers.set(h,n.onprogress),$.params={...t.params,_meta:{...((g=t.params)===null||g===void 0?void 0:g._meta)||{},progressToken:h}}),a&&($.params={...$.params,task:a}),c&&($.params={...$.params,_meta:{...((y=$.params)===null||y===void 0?void 0:y._meta)||{},[Xe]:c}});const p=z=>{var D;this._responseHandlers.delete(h),this._progressHandlers.delete(h),this._cleanupTimeout(h),(D=this._transport)===null||D===void 0||D.send({jsonrpc:"2.0",method:"notifications/cancelled",params:{requestId:h,reason:String(z)}},{relatedRequestId:o,resumptionToken:s,onresumptiontoken:i}).catch(V=>this._onerror(new Error(`Failed to send cancellation: ${V}`)));const q=z instanceof Y?z:new Y(X.RequestTimeout,String(z));l(q)};this._responseHandlers.set(h,z=>{var D;if(!(!((D=n==null?void 0:n.signal)===null||D===void 0)&&D.aborted)){if(z instanceof Error)return l(z);try{const q=tt(r,z.result);q.success?u(q.data):l(q.error)}catch(q){l(q)}}}),(k=n==null?void 0:n.signal)===null||k===void 0||k.addEventListener("abort",()=>{var z;p((z=n==null?void 0:n.signal)===null||z===void 0?void 0:z.reason)});const b=(f=n==null?void 0:n.timeout)!==null&&f!==void 0?f:Xh,S=()=>p(Y.fromError(X.RequestTimeout,"Request timed out",{timeout:b}));this._setupTimeout(h,b,n==null?void 0:n.maxTotalTimeout,S,(m=n==null?void 0:n.resetTimeoutOnProgress)!==null&&m!==void 0?m:!1);const C=c==null?void 0:c.taskId;if(C){const z=D=>{const q=this._responseHandlers.get(h);q?q(D):this._onerror(new Error(`Response handler missing for side-channeled request ${h}`))};this._requestResolvers.set(h,z),this._enqueueTaskMessage(C,{type:"request",message:$,timestamp:Date.now()}).catch(D=>{this._cleanupTimeout(h),l(D)})}else this._transport.send($,{relatedRequestId:o,resumptionToken:s,onresumptiontoken:i}).catch(z=>{this._cleanupTimeout(h),l(z)})})}async getTask(t,r){return this.request({method:"tasks/get",params:t},ko,r)}async getTaskResult(t,r,n){return this.request({method:"tasks/result",params:t},r,n)}async listTasks(t,r){return this.request({method:"tasks/list",params:t},To,r)}async cancelTask(t,r){return this.request({method:"tasks/cancel",params:t},Lf,r)}async notification(t,r){var n,o,s,i,a;if(!this._transport)throw new Error("Not connected");this.assertNotificationCapability(t.method);const c=(n=r==null?void 0:r.relatedTask)===null||n===void 0?void 0:n.taskId;if(c){const _={...t,jsonrpc:"2.0",params:{...t.params,_meta:{...((o=t.params)===null||o===void 0?void 0:o._meta)||{},[Xe]:r.relatedTask}}};await this._enqueueTaskMessage(c,{type:"notification",message:_,timestamp:Date.now()});return}if(((i=(s=this._options)===null||s===void 0?void 0:s.debouncedNotificationMethods)!==null&&i!==void 0?i:[]).includes(t.method)&&!t.params&&!(r!=null&&r.relatedRequestId)&&!(r!=null&&r.relatedTask)){if(this._pendingDebouncedNotifications.has(t.method))return;this._pendingDebouncedNotifications.add(t.method),Promise.resolve().then(()=>{var _,g;if(this._pendingDebouncedNotifications.delete(t.method),!this._transport)return;let y={...t,jsonrpc:"2.0"};r!=null&&r.relatedTask&&(y={...y,params:{...y.params,_meta:{...((_=y.params)===null||_===void 0?void 0:_._meta)||{},[Xe]:r.relatedTask}}}),(g=this._transport)===null||g===void 0||g.send(y,r).catch(k=>this._onerror(k))});return}let v={...t,jsonrpc:"2.0"};r!=null&&r.relatedTask&&(v={...v,params:{...v.params,_meta:{...((a=v.params)===null||a===void 0?void 0:a._meta)||{},[Xe]:r.relatedTask}}}),await this._transport.send(v,r)}setRequestHandler(t,r){const n=as(t);this.assertRequestHandlerCapability(n),this._requestHandlers.set(n,(o,s)=>{const i=cs(t,o);return Promise.resolve(r(i,s))})}removeRequestHandler(t){this._requestHandlers.delete(t)}assertCanSetRequestHandler(t){if(this._requestHandlers.has(t))throw new Error(`A request handler for ${t} already exists, which would be overridden`)}setNotificationHandler(t,r){const n=as(t);this._notificationHandlers.set(n,o=>{const s=cs(t,o);return Promise.resolve(r(s))})}removeNotificationHandler(t){this._notificationHandlers.delete(t)}_cleanupTaskProgressHandler(t){const r=this._taskProgressTokens.get(t);r!==void 0&&(this._progressHandlers.delete(r),this._taskProgressTokens.delete(t))}async _enqueueTaskMessage(t,r,n){var o;if(!this._taskStore||!this._taskMessageQueue)throw new Error("Cannot enqueue task message: taskStore and taskMessageQueue are not configured");const s=(o=this._options)===null||o===void 0?void 0:o.maxTaskQueueSize;await this._taskMessageQueue.enqueue(t,r,n,s)}async _clearTaskQueue(t,r){if(this._taskMessageQueue){const n=await this._taskMessageQueue.dequeueAll(t,r);for(const o of n)if(o.type==="request"&&is(o.message)){const s=o.message.id,i=this._requestResolvers.get(s);i?(i(new Y(X.InternalError,"Task cancelled or completed")),this._requestResolvers.delete(s)):this._onerror(new Error(`Resolver missing for request ${s} during task ${t} cleanup`))}}}async _waitForTaskUpdate(t,r){var n,o,s;let i=(o=(n=this._options)===null||n===void 0?void 0:n.defaultTaskPollInterval)!==null&&o!==void 0?o:1e3;try{const a=await((s=this._taskStore)===null||s===void 0?void 0:s.getTask(t));a!=null&&a.pollInterval&&(i=a.pollInterval)}catch{}return new Promise((a,c)=>{if(r.aborted){c(new Y(X.InvalidRequest,"Request cancelled"));return}const u=setTimeout(a,i);r.addEventListener("abort",()=>{clearTimeout(u),c(new Y(X.InvalidRequest,"Request cancelled"))},{once:!0})})}requestTaskStore(t,r){const n=this._taskStore;if(!n)throw new Error("No task store configured");return{createTask:async o=>{if(!t)throw new Error("No request provided");return await n.createTask(o,t.id,{method:t.method,params:t.params},r)},getTask:async o=>{const s=await n.getTask(o,r);if(!s)throw new Y(X.InvalidParams,"Failed to retrieve task: Task not found");return s},storeTaskResult:async(o,s,i)=>{await n.storeTaskResult(o,s,i,r);const a=await n.getTask(o,r);if(a){const c=xr.parse({method:"notifications/tasks/status",params:a});await this.notification(c),at(a.status)&&this._cleanupTaskProgressHandler(o)}},getTaskResult:o=>n.getTaskResult(o,r),updateTaskStatus:async(o,s,i)=>{const a=await n.getTask(o,r);if(!a)throw new Y(X.InvalidParams,`Task "${o}" not found - it may have been cleaned up`);if(at(a.status))throw new Y(X.InvalidParams,`Cannot update task "${o}" from terminal status "${a.status}" to "${s}". Terminal states (completed, failed, cancelled) cannot transition to other states.`);await n.updateTaskStatus(o,s,i,r);const c=await n.getTask(o,r);if(c){const u=xr.parse({method:"notifications/tasks/status",params:c});await this.notification(u),at(c.status)&&this._cleanupTaskProgressHandler(o)}},listTasks:o=>n.listTasks(o,r)}}}function us(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)}function tp(e,t){const r={...e};for(const n in t){const o=n,s=t[o];if(s===void 0)continue;const i=r[o];us(i)&&us(s)?r[o]={...i,...s}:r[o]=s}return r}function rp(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var er={exports:{}},gn={},Je={},ct={},yn={},wn={},$n={},ls;function Kr(){return ls||(ls=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.regexpCode=e.getEsmExportName=e.getProperty=e.safeStringify=e.stringify=e.strConcat=e.addCodeArg=e.str=e._=e.nil=e._Code=e.Name=e.IDENTIFIER=e._CodeOrName=void 0;class t{}e._CodeOrName=t,e.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class r extends t{constructor(d){if(super(),!e.IDENTIFIER.test(d))throw new Error("CodeGen: name must be a valid identifier");this.str=d}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}e.Name=r;class n extends t{constructor(d){super(),this._items=typeof d=="string"?[d]:d}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;const d=this._items[0];return d===""||d==='""'}get str(){var d;return(d=this._str)!==null&&d!==void 0?d:this._str=this._items.reduce((h,$)=>`${h}${$}`,"")}get names(){var d;return(d=this._names)!==null&&d!==void 0?d:this._names=this._items.reduce((h,$)=>($ instanceof r&&(h[$.str]=(h[$.str]||0)+1),h),{})}}e._Code=n,e.nil=new n("");function o(m,...d){const h=[m[0]];let $=0;for(;$<d.length;)a(h,d[$]),h.push(m[++$]);return new n(h)}e._=o;const s=new n("+");function i(m,...d){const h=[g(m[0])];let $=0;for(;$<d.length;)h.push(s),a(h,d[$]),h.push(s,g(m[++$]));return c(h),new n(h)}e.str=i;function a(m,d){d instanceof n?m.push(...d._items):d instanceof r?m.push(d):m.push(v(d))}e.addCodeArg=a;function c(m){let d=1;for(;d<m.length-1;){if(m[d]===s){const h=u(m[d-1],m[d+1]);if(h!==void 0){m.splice(d-1,3,h);continue}m[d++]="+"}d++}}function u(m,d){if(d==='""')return m;if(m==='""')return d;if(typeof m=="string")return d instanceof r||m[m.length-1]!=='"'?void 0:typeof d!="string"?`${m.slice(0,-1)}${d}"`:d[0]==='"'?m.slice(0,-1)+d.slice(1):void 0;if(typeof d=="string"&&d[0]==='"'&&!(m instanceof r))return`"${m}${d.slice(1)}`}function l(m,d){return d.emptyStr()?m:m.emptyStr()?d:i`${m}${d}`}e.strConcat=l;function v(m){return typeof m=="number"||typeof m=="boolean"||m===null?m:g(Array.isArray(m)?m.join(","):m)}function _(m){return new n(g(m))}e.stringify=_;function g(m){return JSON.stringify(m).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}e.safeStringify=g;function y(m){return typeof m=="string"&&e.IDENTIFIER.test(m)?new n(`.${m}`):o`[${m}]`}e.getProperty=y;function k(m){if(typeof m=="string"&&e.IDENTIFIER.test(m))return new n(`${m}`);throw new Error(`CodeGen: invalid export name: ${m}, use explicit $id name mapping`)}e.getEsmExportName=k;function f(m){return new n(m.toString())}e.regexpCode=f})($n)),$n}var bn={},ds;function fs(){return ds||(ds=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ValueScope=e.ValueScopeName=e.Scope=e.varKinds=e.UsedValueState=void 0;const t=Kr();class r extends Error{constructor(u){super(`CodeGen: "code" for ${u} not defined`),this.value=u.value}}var n;(function(c){c[c.Started=0]="Started",c[c.Completed=1]="Completed"})(n||(e.UsedValueState=n={})),e.varKinds={const:new t.Name("const"),let:new t.Name("let"),var:new t.Name("var")};class o{constructor({prefixes:u,parent:l}={}){this._names={},this._prefixes=u,this._parent=l}toName(u){return u instanceof t.Name?u:this.name(u)}name(u){return new t.Name(this._newName(u))}_newName(u){const l=this._names[u]||this._nameGroup(u);return`${u}${l.index++}`}_nameGroup(u){var l,v;if(!((v=(l=this._parent)===null||l===void 0?void 0:l._prefixes)===null||v===void 0)&&v.has(u)||this._prefixes&&!this._prefixes.has(u))throw new Error(`CodeGen: prefix "${u}" is not allowed in this scope`);return this._names[u]={prefix:u,index:0}}}e.Scope=o;class s extends t.Name{constructor(u,l){super(l),this.prefix=u}setValue(u,{property:l,itemIndex:v}){this.value=u,this.scopePath=(0,t._)`.${new t.Name(l)}[${v}]`}}e.ValueScopeName=s;const i=(0,t._)`\n`;class a extends o{constructor(u){super(u),this._values={},this._scope=u.scope,this.opts={...u,_n:u.lines?i:t.nil}}get(){return this._scope}name(u){return new s(u,this._newName(u))}value(u,l){var v;if(l.ref===void 0)throw new Error("CodeGen: ref must be passed in value");const _=this.toName(u),{prefix:g}=_,y=(v=l.key)!==null&&v!==void 0?v:l.ref;let k=this._values[g];if(k){const d=k.get(y);if(d)return d}else k=this._values[g]=new Map;k.set(y,_);const f=this._scope[g]||(this._scope[g]=[]),m=f.length;return f[m]=l.ref,_.setValue(l,{property:g,itemIndex:m}),_}getValue(u,l){const v=this._values[u];if(v)return v.get(l)}scopeRefs(u,l=this._values){return this._reduceValues(l,v=>{if(v.scopePath===void 0)throw new Error(`CodeGen: name "${v}" has no value`);return(0,t._)`${u}${v.scopePath}`})}scopeCode(u=this._values,l,v){return this._reduceValues(u,_=>{if(_.value===void 0)throw new Error(`CodeGen: name "${_}" has no value`);return _.value.code},l,v)}_reduceValues(u,l,v={},_){let g=t.nil;for(const y in u){const k=u[y];if(!k)continue;const f=v[y]=v[y]||new Map;k.forEach(m=>{if(f.has(m))return;f.set(m,n.Started);let d=l(m);if(d){const h=this.opts.es5?e.varKinds.var:e.varKinds.const;g=(0,t._)`${g}${h} ${m} = ${d};${this.opts._n}`}else if(d=_==null?void 0:_(m))g=(0,t._)`${g}${d}${this.opts._n}`;else throw new r(m);f.set(m,n.Completed)})}return g}}e.ValueScope=a})(bn)),bn}var hs;function te(){return hs||(hs=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.or=e.and=e.not=e.CodeGen=e.operators=e.varKinds=e.ValueScopeName=e.ValueScope=e.Scope=e.Name=e.regexpCode=e.stringify=e.getProperty=e.nil=e.strConcat=e.str=e._=void 0;const t=Kr(),r=fs();var n=Kr();Object.defineProperty(e,"_",{enumerable:!0,get:function(){return n._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return n.str}}),Object.defineProperty(e,"strConcat",{enumerable:!0,get:function(){return n.strConcat}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return n.nil}}),Object.defineProperty(e,"getProperty",{enumerable:!0,get:function(){return n.getProperty}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return n.stringify}}),Object.defineProperty(e,"regexpCode",{enumerable:!0,get:function(){return n.regexpCode}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return n.Name}});var o=fs();Object.defineProperty(e,"Scope",{enumerable:!0,get:function(){return o.Scope}}),Object.defineProperty(e,"ValueScope",{enumerable:!0,get:function(){return o.ValueScope}}),Object.defineProperty(e,"ValueScopeName",{enumerable:!0,get:function(){return o.ValueScopeName}}),Object.defineProperty(e,"varKinds",{enumerable:!0,get:function(){return o.varKinds}}),e.operators={GT:new t._Code(">"),GTE:new t._Code(">="),LT:new t._Code("<"),LTE:new t._Code("<="),EQ:new t._Code("==="),NEQ:new t._Code("!=="),NOT:new t._Code("!"),OR:new t._Code("||"),AND:new t._Code("&&"),ADD:new t._Code("+")};class s{optimizeNodes(){return this}optimizeNames(w,E){return this}}class i extends s{constructor(w,E,A){super(),this.varKind=w,this.name=E,this.rhs=A}render({es5:w,_n:E}){const A=w?r.varKinds.var:this.varKind,W=this.rhs===void 0?"":` = ${this.rhs}`;return`${A} ${this.name}${W};`+E}optimizeNames(w,E){if(w[this.name.str])return this.rhs&&(this.rhs=H(this.rhs,w,E)),this}get names(){return this.rhs instanceof t._CodeOrName?this.rhs.names:{}}}class a extends s{constructor(w,E,A){super(),this.lhs=w,this.rhs=E,this.sideEffects=A}render({_n:w}){return`${this.lhs} = ${this.rhs};`+w}optimizeNames(w,E){if(!(this.lhs instanceof t.Name&&!w[this.lhs.str]&&!this.sideEffects))return this.rhs=H(this.rhs,w,E),this}get names(){const w=this.lhs instanceof t.Name?{}:{...this.lhs.names};return x(w,this.rhs)}}class c extends a{constructor(w,E,A,W){super(w,A,W),this.op=E}render({_n:w}){return`${this.lhs} ${this.op}= ${this.rhs};`+w}}class u extends s{constructor(w){super(),this.label=w,this.names={}}render({_n:w}){return`${this.label}:`+w}}class l extends s{constructor(w){super(),this.label=w,this.names={}}render({_n:w}){return`break${this.label?` ${this.label}`:""};`+w}}class v extends s{constructor(w){super(),this.error=w}render({_n:w}){return`throw ${this.error};`+w}get names(){return this.error.names}}class _ extends s{constructor(w){super(),this.code=w}render({_n:w}){return`${this.code};`+w}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(w,E){return this.code=H(this.code,w,E),this}get names(){return this.code instanceof t._CodeOrName?this.code.names:{}}}class g extends s{constructor(w=[]){super(),this.nodes=w}render(w){return this.nodes.reduce((E,A)=>E+A.render(w),"")}optimizeNodes(){const{nodes:w}=this;let E=w.length;for(;E--;){const A=w[E].optimizeNodes();Array.isArray(A)?w.splice(E,1,...A):A?w[E]=A:w.splice(E,1)}return w.length>0?this:void 0}optimizeNames(w,E){const{nodes:A}=this;let W=A.length;for(;W--;){const Q=A[W];Q.optimizeNames(w,E)||(ae(w,Q.names),A.splice(W,1))}return A.length>0?this:void 0}get names(){return this.nodes.reduce((w,E)=>V(w,E.names),{})}}class y extends g{render(w){return"{"+w._n+super.render(w)+"}"+w._n}}class k extends g{}class f extends y{}f.kind="else";class m extends y{constructor(w,E){super(E),this.condition=w}render(w){let E=`if(${this.condition})`+super.render(w);return this.else&&(E+="else "+this.else.render(w)),E}optimizeNodes(){super.optimizeNodes();const w=this.condition;if(w===!0)return this.nodes;let E=this.else;if(E){const A=E.optimizeNodes();E=this.else=Array.isArray(A)?new f(A):A}if(E)return w===!1?E instanceof m?E:E.nodes:this.nodes.length?this:new m(Ie(w),E instanceof m?[E]:E.nodes);if(!(w===!1||!this.nodes.length))return this}optimizeNames(w,E){var A;if(this.else=(A=this.else)===null||A===void 0?void 0:A.optimizeNames(w,E),!!(super.optimizeNames(w,E)||this.else))return this.condition=H(this.condition,w,E),this}get names(){const w=super.names;return x(w,this.condition),this.else&&V(w,this.else.names),w}}m.kind="if";class d extends y{}d.kind="for";class h extends d{constructor(w){super(),this.iteration=w}render(w){return`for(${this.iteration})`+super.render(w)}optimizeNames(w,E){if(super.optimizeNames(w,E))return this.iteration=H(this.iteration,w,E),this}get names(){return V(super.names,this.iteration.names)}}class $ extends d{constructor(w,E,A,W){super(),this.varKind=w,this.name=E,this.from=A,this.to=W}render(w){const E=w.es5?r.varKinds.var:this.varKind,{name:A,from:W,to:Q}=this;return`for(${E} ${A}=${W}; ${A}<${Q}; ${A}++)`+super.render(w)}get names(){const w=x(super.names,this.from);return x(w,this.to)}}class p extends d{constructor(w,E,A,W){super(),this.loop=w,this.varKind=E,this.name=A,this.iterable=W}render(w){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(w)}optimizeNames(w,E){if(super.optimizeNames(w,E))return this.iterable=H(this.iterable,w,E),this}get names(){return V(super.names,this.iterable.names)}}class b extends y{constructor(w,E,A){super(),this.name=w,this.args=E,this.async=A}render(w){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(w)}}b.kind="func";class S extends g{render(w){return"return "+super.render(w)}}S.kind="return";class C extends y{render(w){let E="try"+super.render(w);return this.catch&&(E+=this.catch.render(w)),this.finally&&(E+=this.finally.render(w)),E}optimizeNodes(){var w,E;return super.optimizeNodes(),(w=this.catch)===null||w===void 0||w.optimizeNodes(),(E=this.finally)===null||E===void 0||E.optimizeNodes(),this}optimizeNames(w,E){var A,W;return super.optimizeNames(w,E),(A=this.catch)===null||A===void 0||A.optimizeNames(w,E),(W=this.finally)===null||W===void 0||W.optimizeNames(w,E),this}get names(){const w=super.names;return this.catch&&V(w,this.catch.names),this.finally&&V(w,this.finally.names),w}}class z extends y{constructor(w){super(),this.error=w}render(w){return`catch(${this.error})`+super.render(w)}}z.kind="catch";class D extends y{render(w){return"finally"+super.render(w)}}D.kind="finally";class q{constructor(w,E={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...E,_n:E.lines?`
`:""},this._extScope=w,this._scope=new r.Scope({parent:w}),this._nodes=[new k]}toString(){return this._root.render(this.opts)}name(w){return this._scope.name(w)}scopeName(w){return this._extScope.name(w)}scopeValue(w,E){const A=this._extScope.value(w,E);return(this._values[A.prefix]||(this._values[A.prefix]=new Set)).add(A),A}getScopeValue(w,E){return this._extScope.getValue(w,E)}scopeRefs(w){return this._extScope.scopeRefs(w,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(w,E,A,W){const Q=this._scope.toName(E);return A!==void 0&&W&&(this._constants[Q.str]=A),this._leafNode(new i(w,Q,A)),Q}const(w,E,A){return this._def(r.varKinds.const,w,E,A)}let(w,E,A){return this._def(r.varKinds.let,w,E,A)}var(w,E,A){return this._def(r.varKinds.var,w,E,A)}assign(w,E,A){return this._leafNode(new a(w,E,A))}add(w,E){return this._leafNode(new c(w,e.operators.ADD,E))}code(w){return typeof w=="function"?w():w!==t.nil&&this._leafNode(new _(w)),this}object(...w){const E=["{"];for(const[A,W]of w)E.length>1&&E.push(","),E.push(A),(A!==W||this.opts.es5)&&(E.push(":"),(0,t.addCodeArg)(E,W));return E.push("}"),new t._Code(E)}if(w,E,A){if(this._blockNode(new m(w)),E&&A)this.code(E).else().code(A).endIf();else if(E)this.code(E).endIf();else if(A)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(w){return this._elseNode(new m(w))}else(){return this._elseNode(new f)}endIf(){return this._endBlockNode(m,f)}_for(w,E){return this._blockNode(w),E&&this.code(E).endFor(),this}for(w,E){return this._for(new h(w),E)}forRange(w,E,A,W,Q=this.opts.es5?r.varKinds.var:r.varKinds.let){const ie=this._scope.toName(w);return this._for(new $(Q,ie,E,A),()=>W(ie))}forOf(w,E,A,W=r.varKinds.const){const Q=this._scope.toName(w);if(this.opts.es5){const ie=E instanceof t.Name?E:this.var("_arr",E);return this.forRange("_i",0,(0,t._)`${ie}.length`,oe=>{this.var(Q,(0,t._)`${ie}[${oe}]`),A(Q)})}return this._for(new p("of",W,Q,E),()=>A(Q))}forIn(w,E,A,W=this.opts.es5?r.varKinds.var:r.varKinds.const){if(this.opts.ownProperties)return this.forOf(w,(0,t._)`Object.keys(${E})`,A);const Q=this._scope.toName(w);return this._for(new p("in",W,Q,E),()=>A(Q))}endFor(){return this._endBlockNode(d)}label(w){return this._leafNode(new u(w))}break(w){return this._leafNode(new l(w))}return(w){const E=new S;if(this._blockNode(E),this.code(w),E.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(S)}try(w,E,A){if(!E&&!A)throw new Error('CodeGen: "try" without "catch" and "finally"');const W=new C;if(this._blockNode(W),this.code(w),E){const Q=this.name("e");this._currNode=W.catch=new z(Q),E(Q)}return A&&(this._currNode=W.finally=new D,this.code(A)),this._endBlockNode(z,D)}throw(w){return this._leafNode(new v(w))}block(w,E){return this._blockStarts.push(this._nodes.length),w&&this.code(w).endBlock(E),this}endBlock(w){const E=this._blockStarts.pop();if(E===void 0)throw new Error("CodeGen: not in self-balancing block");const A=this._nodes.length-E;if(A<0||w!==void 0&&A!==w)throw new Error(`CodeGen: wrong number of nodes: ${A} vs ${w} expected`);return this._nodes.length=E,this}func(w,E=t.nil,A,W){return this._blockNode(new b(w,E,A)),W&&this.code(W).endFunc(),this}endFunc(){return this._endBlockNode(b)}optimize(w=1){for(;w-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(w){return this._currNode.nodes.push(w),this}_blockNode(w){this._currNode.nodes.push(w),this._nodes.push(w)}_endBlockNode(w,E){const A=this._currNode;if(A instanceof w||E&&A instanceof E)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${E?`${w.kind}/${E.kind}`:w.kind}"`)}_elseNode(w){const E=this._currNode;if(!(E instanceof m))throw new Error('CodeGen: "else" without "if"');return this._currNode=E.else=w,this}get _root(){return this._nodes[0]}get _currNode(){const w=this._nodes;return w[w.length-1]}set _currNode(w){const E=this._nodes;E[E.length-1]=w}}e.CodeGen=q;function V(O,w){for(const E in w)O[E]=(O[E]||0)+(w[E]||0);return O}function x(O,w){return w instanceof t._CodeOrName?V(O,w.names):O}function H(O,w,E){if(O instanceof t.Name)return A(O);if(!W(O))return O;return new t._Code(O._items.reduce((Q,ie)=>(ie instanceof t.Name&&(ie=A(ie)),ie instanceof t._Code?Q.push(...ie._items):Q.push(ie),Q),[]));function A(Q){const ie=E[Q.str];return ie===void 0||w[Q.str]!==1?Q:(delete w[Q.str],ie)}function W(Q){return Q instanceof t._Code&&Q._items.some(ie=>ie instanceof t.Name&&w[ie.str]===1&&E[ie.str]!==void 0)}}function ae(O,w){for(const E in w)O[E]=(O[E]||0)-(w[E]||0)}function Ie(O){return typeof O=="boolean"||typeof O=="number"||O===null?!O:(0,t._)`!${M(O)}`}e.not=Ie;const Oe=R(e.operators.AND);function ue(...O){return O.reduce(Oe)}e.and=ue;const Fe=R(e.operators.OR);function L(...O){return O.reduce(Fe)}e.or=L;function R(O){return(w,E)=>w===t.nil?E:E===t.nil?w:(0,t._)`${M(w)} ${O} ${M(E)}`}function M(O){return O instanceof t.Name?O:(0,t._)`(${O})`}})(wn)),wn}var ee={},ps;function se(){if(ps)return ee;ps=1,Object.defineProperty(ee,"__esModule",{value:!0}),ee.checkStrictMode=ee.getErrorPath=ee.Type=ee.useFunc=ee.setEvaluated=ee.evaluatedPropsToName=ee.mergeEvaluated=ee.eachItem=ee.unescapeJsonPointer=ee.escapeJsonPointer=ee.escapeFragment=ee.unescapeFragment=ee.schemaRefOrVal=ee.schemaHasRulesButRef=ee.schemaHasRules=ee.checkUnknownRules=ee.alwaysValidSchema=ee.toHash=void 0;const e=te(),t=Kr();function r(p){const b={};for(const S of p)b[S]=!0;return b}ee.toHash=r;function n(p,b){return typeof b=="boolean"?b:Object.keys(b).length===0?!0:(o(p,b),!s(b,p.self.RULES.all))}ee.alwaysValidSchema=n;function o(p,b=p.schema){const{opts:S,self:C}=p;if(!S.strictSchema||typeof b=="boolean")return;const z=C.RULES.keywords;for(const D in b)z[D]||$(p,`unknown keyword: "${D}"`)}ee.checkUnknownRules=o;function s(p,b){if(typeof p=="boolean")return!p;for(const S in p)if(b[S])return!0;return!1}ee.schemaHasRules=s;function i(p,b){if(typeof p=="boolean")return!p;for(const S in p)if(S!=="$ref"&&b.all[S])return!0;return!1}ee.schemaHasRulesButRef=i;function a({topSchemaRef:p,schemaPath:b},S,C,z){if(!z){if(typeof S=="number"||typeof S=="boolean")return S;if(typeof S=="string")return(0,e._)`${S}`}return(0,e._)`${p}${b}${(0,e.getProperty)(C)}`}ee.schemaRefOrVal=a;function c(p){return v(decodeURIComponent(p))}ee.unescapeFragment=c;function u(p){return encodeURIComponent(l(p))}ee.escapeFragment=u;function l(p){return typeof p=="number"?`${p}`:p.replace(/~/g,"~0").replace(/\//g,"~1")}ee.escapeJsonPointer=l;function v(p){return p.replace(/~1/g,"/").replace(/~0/g,"~")}ee.unescapeJsonPointer=v;function _(p,b){if(Array.isArray(p))for(const S of p)b(S);else b(p)}ee.eachItem=_;function g({mergeNames:p,mergeToName:b,mergeValues:S,resultToName:C}){return(z,D,q,V)=>{const x=q===void 0?D:q instanceof e.Name?(D instanceof e.Name?p(z,D,q):b(z,D,q),q):D instanceof e.Name?(b(z,q,D),D):S(D,q);return V===e.Name&&!(x instanceof e.Name)?C(z,x):x}}ee.mergeEvaluated={props:g({mergeNames:(p,b,S)=>p.if((0,e._)`${S} !== true && ${b} !== undefined`,()=>{p.if((0,e._)`${b} === true`,()=>p.assign(S,!0),()=>p.assign(S,(0,e._)`${S} || {}`).code((0,e._)`Object.assign(${S}, ${b})`))}),mergeToName:(p,b,S)=>p.if((0,e._)`${S} !== true`,()=>{b===!0?p.assign(S,!0):(p.assign(S,(0,e._)`${S} || {}`),k(p,S,b))}),mergeValues:(p,b)=>p===!0?!0:{...p,...b},resultToName:y}),items:g({mergeNames:(p,b,S)=>p.if((0,e._)`${S} !== true && ${b} !== undefined`,()=>p.assign(S,(0,e._)`${b} === true ? true : ${S} > ${b} ? ${S} : ${b}`)),mergeToName:(p,b,S)=>p.if((0,e._)`${S} !== true`,()=>p.assign(S,b===!0?!0:(0,e._)`${S} > ${b} ? ${S} : ${b}`)),mergeValues:(p,b)=>p===!0?!0:Math.max(p,b),resultToName:(p,b)=>p.var("items",b)})};function y(p,b){if(b===!0)return p.var("props",!0);const S=p.var("props",(0,e._)`{}`);return b!==void 0&&k(p,S,b),S}ee.evaluatedPropsToName=y;function k(p,b,S){Object.keys(S).forEach(C=>p.assign((0,e._)`${b}${(0,e.getProperty)(C)}`,!0))}ee.setEvaluated=k;const f={};function m(p,b){return p.scopeValue("func",{ref:b,code:f[b.code]||(f[b.code]=new t._Code(b.code))})}ee.useFunc=m;var d;(function(p){p[p.Num=0]="Num",p[p.Str=1]="Str"})(d||(ee.Type=d={}));function h(p,b,S){if(p instanceof e.Name){const C=b===d.Num;return S?C?(0,e._)`"[" + ${p} + "]"`:(0,e._)`"['" + ${p} + "']"`:C?(0,e._)`"/" + ${p}`:(0,e._)`"/" + ${p}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return S?(0,e.getProperty)(p).toString():"/"+l(p)}ee.getErrorPath=h;function $(p,b,S=p.opts.strictSchema){if(S){if(b=`strict mode: ${b}`,S===!0)throw new Error(b);p.self.logger.warn(b)}}return ee.checkStrictMode=$,ee}var tr={},ms;function it(){if(ms)return tr;ms=1,Object.defineProperty(tr,"__esModule",{value:!0});const e=te(),t={data:new e.Name("data"),valCxt:new e.Name("valCxt"),instancePath:new e.Name("instancePath"),parentData:new e.Name("parentData"),parentDataProperty:new e.Name("parentDataProperty"),rootData:new e.Name("rootData"),dynamicAnchors:new e.Name("dynamicAnchors"),vErrors:new e.Name("vErrors"),errors:new e.Name("errors"),this:new e.Name("this"),self:new e.Name("self"),scope:new e.Name("scope"),json:new e.Name("json"),jsonPos:new e.Name("jsonPos"),jsonLen:new e.Name("jsonLen"),jsonPart:new e.Name("jsonPart")};return tr.default=t,tr}var _s;function un(){return _s||(_s=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.extendErrors=e.resetErrorsCount=e.reportExtraError=e.reportError=e.keyword$DataError=e.keywordError=void 0;const t=te(),r=se(),n=it();e.keywordError={message:({keyword:f})=>(0,t.str)`must pass "${f}" keyword validation`},e.keyword$DataError={message:({keyword:f,schemaType:m})=>m?(0,t.str)`"${f}" keyword must be ${m} ($data)`:(0,t.str)`"${f}" keyword is invalid ($data)`};function o(f,m=e.keywordError,d,h){const{it:$}=f,{gen:p,compositeRule:b,allErrors:S}=$,C=v(f,m,d);h??(b||S)?c(p,C):u($,(0,t._)`[${C}]`)}e.reportError=o;function s(f,m=e.keywordError,d){const{it:h}=f,{gen:$,compositeRule:p,allErrors:b}=h,S=v(f,m,d);c($,S),p||b||u(h,n.default.vErrors)}e.reportExtraError=s;function i(f,m){f.assign(n.default.errors,m),f.if((0,t._)`${n.default.vErrors} !== null`,()=>f.if(m,()=>f.assign((0,t._)`${n.default.vErrors}.length`,m),()=>f.assign(n.default.vErrors,null)))}e.resetErrorsCount=i;function a({gen:f,keyword:m,schemaValue:d,data:h,errsCount:$,it:p}){if($===void 0)throw new Error("ajv implementation error");const b=f.name("err");f.forRange("i",$,n.default.errors,S=>{f.const(b,(0,t._)`${n.default.vErrors}[${S}]`),f.if((0,t._)`${b}.instancePath === undefined`,()=>f.assign((0,t._)`${b}.instancePath`,(0,t.strConcat)(n.default.instancePath,p.errorPath))),f.assign((0,t._)`${b}.schemaPath`,(0,t.str)`${p.errSchemaPath}/${m}`),p.opts.verbose&&(f.assign((0,t._)`${b}.schema`,d),f.assign((0,t._)`${b}.data`,h))})}e.extendErrors=a;function c(f,m){const d=f.const("err",m);f.if((0,t._)`${n.default.vErrors} === null`,()=>f.assign(n.default.vErrors,(0,t._)`[${d}]`),(0,t._)`${n.default.vErrors}.push(${d})`),f.code((0,t._)`${n.default.errors}++`)}function u(f,m){const{gen:d,validateName:h,schemaEnv:$}=f;$.$async?d.throw((0,t._)`new ${f.ValidationError}(${m})`):(d.assign((0,t._)`${h}.errors`,m),d.return(!1))}const l={keyword:new t.Name("keyword"),schemaPath:new t.Name("schemaPath"),params:new t.Name("params"),propertyName:new t.Name("propertyName"),message:new t.Name("message"),schema:new t.Name("schema"),parentSchema:new t.Name("parentSchema")};function v(f,m,d){const{createErrors:h}=f.it;return h===!1?(0,t._)`{}`:_(f,m,d)}function _(f,m,d={}){const{gen:h,it:$}=f,p=[g($,d),y(f,d)];return k(f,m,p),h.object(...p)}function g({errorPath:f},{instancePath:m}){const d=m?(0,t.str)`${f}${(0,r.getErrorPath)(m,r.Type.Str)}`:f;return[n.default.instancePath,(0,t.strConcat)(n.default.instancePath,d)]}function y({keyword:f,it:{errSchemaPath:m}},{schemaPath:d,parentSchema:h}){let $=h?m:(0,t.str)`${m}/${f}`;return d&&($=(0,t.str)`${$}${(0,r.getErrorPath)(d,r.Type.Str)}`),[l.schemaPath,$]}function k(f,{params:m,message:d},h){const{keyword:$,data:p,schemaValue:b,it:S}=f,{opts:C,propertyName:z,topSchemaRef:D,schemaPath:q}=S;h.push([l.keyword,$],[l.params,typeof m=="function"?m(f):m||(0,t._)`{}`]),C.messages&&h.push([l.message,typeof d=="function"?d(f):d]),C.verbose&&h.push([l.schema,b],[l.parentSchema,(0,t._)`${D}${q}`],[n.default.data,p]),z&&h.push([l.propertyName,z])}})(yn)),yn}var vs;function np(){if(vs)return ct;vs=1,Object.defineProperty(ct,"__esModule",{value:!0}),ct.boolOrEmptySchema=ct.topBoolOrEmptySchema=void 0;const e=un(),t=te(),r=it(),n={message:"boolean schema is false"};function o(a){const{gen:c,schema:u,validateName:l}=a;u===!1?i(a,!1):typeof u=="object"&&u.$async===!0?c.return(r.default.data):(c.assign((0,t._)`${l}.errors`,null),c.return(!0))}ct.topBoolOrEmptySchema=o;function s(a,c){const{gen:u,schema:l}=a;l===!1?(u.var(c,!1),i(a)):u.var(c,!0)}ct.boolOrEmptySchema=s;function i(a,c){const{gen:u,data:l}=a,v={gen:u,keyword:"false schema",data:l,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:a};(0,e.reportError)(v,n,void 0,c)}return ct}var Ee={},ut={},gs;function Ua(){if(gs)return ut;gs=1,Object.defineProperty(ut,"__esModule",{value:!0}),ut.getRules=ut.isJSONType=void 0;const e=["string","number","integer","boolean","null","object","array"],t=new Set(e);function r(o){return typeof o=="string"&&t.has(o)}ut.isJSONType=r;function n(){const o={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...o,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},o.number,o.string,o.array,o.object],post:{rules:[]},all:{},keywords:{}}}return ut.getRules=n,ut}var Be={},ys;function Da(){if(ys)return Be;ys=1,Object.defineProperty(Be,"__esModule",{value:!0}),Be.shouldUseRule=Be.shouldUseGroup=Be.schemaHasRulesForType=void 0;function e({schema:n,self:o},s){const i=o.RULES.types[s];return i&&i!==!0&&t(n,i)}Be.schemaHasRulesForType=e;function t(n,o){return o.rules.some(s=>r(n,s))}Be.shouldUseGroup=t;function r(n,o){var s;return n[o.keyword]!==void 0||((s=o.definition.implements)===null||s===void 0?void 0:s.some(i=>n[i]!==void 0))}return Be.shouldUseRule=r,Be}var ws;function Wr(){if(ws)return Ee;ws=1,Object.defineProperty(Ee,"__esModule",{value:!0}),Ee.reportTypeError=Ee.checkDataTypes=Ee.checkDataType=Ee.coerceAndCheckDataType=Ee.getJSONTypes=Ee.getSchemaTypes=Ee.DataType=void 0;const e=Ua(),t=Da(),r=un(),n=te(),o=se();var s;(function(d){d[d.Correct=0]="Correct",d[d.Wrong=1]="Wrong"})(s||(Ee.DataType=s={}));function i(d){const h=a(d.type);if(h.includes("null")){if(d.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!h.length&&d.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');d.nullable===!0&&h.push("null")}return h}Ee.getSchemaTypes=i;function a(d){const h=Array.isArray(d)?d:d?[d]:[];if(h.every(e.isJSONType))return h;throw new Error("type must be JSONType or JSONType[]: "+h.join(","))}Ee.getJSONTypes=a;function c(d,h){const{gen:$,data:p,opts:b}=d,S=l(h,b.coerceTypes),C=h.length>0&&!(S.length===0&&h.length===1&&(0,t.schemaHasRulesForType)(d,h[0]));if(C){const z=y(h,p,b.strictNumbers,s.Wrong);$.if(z,()=>{S.length?v(d,h,S):f(d)})}return C}Ee.coerceAndCheckDataType=c;const u=new Set(["string","number","integer","boolean","null"]);function l(d,h){return h?d.filter($=>u.has($)||h==="array"&&$==="array"):[]}function v(d,h,$){const{gen:p,data:b,opts:S}=d,C=p.let("dataType",(0,n._)`typeof ${b}`),z=p.let("coerced",(0,n._)`undefined`);S.coerceTypes==="array"&&p.if((0,n._)`${C} == 'object' && Array.isArray(${b}) && ${b}.length == 1`,()=>p.assign(b,(0,n._)`${b}[0]`).assign(C,(0,n._)`typeof ${b}`).if(y(h,b,S.strictNumbers),()=>p.assign(z,b))),p.if((0,n._)`${z} !== undefined`);for(const q of $)(u.has(q)||q==="array"&&S.coerceTypes==="array")&&D(q);p.else(),f(d),p.endIf(),p.if((0,n._)`${z} !== undefined`,()=>{p.assign(b,z),_(d,z)});function D(q){switch(q){case"string":p.elseIf((0,n._)`${C} == "number" || ${C} == "boolean"`).assign(z,(0,n._)`"" + ${b}`).elseIf((0,n._)`${b} === null`).assign(z,(0,n._)`""`);return;case"number":p.elseIf((0,n._)`${C} == "boolean" || ${b} === null
              || (${C} == "string" && ${b} && ${b} == +${b})`).assign(z,(0,n._)`+${b}`);return;case"integer":p.elseIf((0,n._)`${C} === "boolean" || ${b} === null
              || (${C} === "string" && ${b} && ${b} == +${b} && !(${b} % 1))`).assign(z,(0,n._)`+${b}`);return;case"boolean":p.elseIf((0,n._)`${b} === "false" || ${b} === 0 || ${b} === null`).assign(z,!1).elseIf((0,n._)`${b} === "true" || ${b} === 1`).assign(z,!0);return;case"null":p.elseIf((0,n._)`${b} === "" || ${b} === 0 || ${b} === false`),p.assign(z,null);return;case"array":p.elseIf((0,n._)`${C} === "string" || ${C} === "number"
              || ${C} === "boolean" || ${b} === null`).assign(z,(0,n._)`[${b}]`)}}}function _({gen:d,parentData:h,parentDataProperty:$},p){d.if((0,n._)`${h} !== undefined`,()=>d.assign((0,n._)`${h}[${$}]`,p))}function g(d,h,$,p=s.Correct){const b=p===s.Correct?n.operators.EQ:n.operators.NEQ;let S;switch(d){case"null":return(0,n._)`${h} ${b} null`;case"array":S=(0,n._)`Array.isArray(${h})`;break;case"object":S=(0,n._)`${h} && typeof ${h} == "object" && !Array.isArray(${h})`;break;case"integer":S=C((0,n._)`!(${h} % 1) && !isNaN(${h})`);break;case"number":S=C();break;default:return(0,n._)`typeof ${h} ${b} ${d}`}return p===s.Correct?S:(0,n.not)(S);function C(z=n.nil){return(0,n.and)((0,n._)`typeof ${h} == "number"`,z,$?(0,n._)`isFinite(${h})`:n.nil)}}Ee.checkDataType=g;function y(d,h,$,p){if(d.length===1)return g(d[0],h,$,p);let b;const S=(0,o.toHash)(d);if(S.array&&S.object){const C=(0,n._)`typeof ${h} != "object"`;b=S.null?C:(0,n._)`!${h} || ${C}`,delete S.null,delete S.array,delete S.object}else b=n.nil;S.number&&delete S.integer;for(const C in S)b=(0,n.and)(b,g(C,h,$,p));return b}Ee.checkDataTypes=y;const k={message:({schema:d})=>`must be ${d}`,params:({schema:d,schemaValue:h})=>typeof d=="string"?(0,n._)`{type: ${d}}`:(0,n._)`{type: ${h}}`};function f(d){const h=m(d);(0,r.reportError)(h,k)}Ee.reportTypeError=f;function m(d){const{gen:h,data:$,schema:p}=d,b=(0,o.schemaRefOrVal)(d,p,"type");return{gen:h,keyword:"type",data:$,schema:p.type,schemaCode:b,schemaValue:b,parentSchema:p,params:{},it:d}}return Ee}var zt={},$s;function op(){if($s)return zt;$s=1,Object.defineProperty(zt,"__esModule",{value:!0}),zt.assignDefaults=void 0;const e=te(),t=se();function r(o,s){const{properties:i,items:a}=o.schema;if(s==="object"&&i)for(const c in i)n(o,c,i[c].default);else s==="array"&&Array.isArray(a)&&a.forEach((c,u)=>n(o,u,c.default))}zt.assignDefaults=r;function n(o,s,i){const{gen:a,compositeRule:c,data:u,opts:l}=o;if(i===void 0)return;const v=(0,e._)`${u}${(0,e.getProperty)(s)}`;if(c){(0,t.checkStrictMode)(o,`default is ignored for: ${v}`);return}let _=(0,e._)`${v} === undefined`;l.useDefaults==="empty"&&(_=(0,e._)`${_} || ${v} === null || ${v} === ""`),a.if(_,(0,e._)`${v} = ${(0,e.stringify)(i)}`)}return zt}var He={},ce={},bs;function We(){if(bs)return ce;bs=1,Object.defineProperty(ce,"__esModule",{value:!0}),ce.validateUnion=ce.validateArray=ce.usePattern=ce.callValidateCode=ce.schemaProperties=ce.allSchemaProperties=ce.noPropertyInData=ce.propertyInData=ce.isOwnProperty=ce.hasPropFunc=ce.reportMissingProp=ce.checkMissingProp=ce.checkReportMissingProp=void 0;const e=te(),t=se(),r=it(),n=se();function o(d,h){const{gen:$,data:p,it:b}=d;$.if(l($,p,h,b.opts.ownProperties),()=>{d.setParams({missingProperty:(0,e._)`${h}`},!0),d.error()})}ce.checkReportMissingProp=o;function s({gen:d,data:h,it:{opts:$}},p,b){return(0,e.or)(...p.map(S=>(0,e.and)(l(d,h,S,$.ownProperties),(0,e._)`${b} = ${S}`)))}ce.checkMissingProp=s;function i(d,h){d.setParams({missingProperty:h},!0),d.error()}ce.reportMissingProp=i;function a(d){return d.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,e._)`Object.prototype.hasOwnProperty`})}ce.hasPropFunc=a;function c(d,h,$){return(0,e._)`${a(d)}.call(${h}, ${$})`}ce.isOwnProperty=c;function u(d,h,$,p){const b=(0,e._)`${h}${(0,e.getProperty)($)} !== undefined`;return p?(0,e._)`${b} && ${c(d,h,$)}`:b}ce.propertyInData=u;function l(d,h,$,p){const b=(0,e._)`${h}${(0,e.getProperty)($)} === undefined`;return p?(0,e.or)(b,(0,e.not)(c(d,h,$))):b}ce.noPropertyInData=l;function v(d){return d?Object.keys(d).filter(h=>h!=="__proto__"):[]}ce.allSchemaProperties=v;function _(d,h){return v(h).filter($=>!(0,t.alwaysValidSchema)(d,h[$]))}ce.schemaProperties=_;function g({schemaCode:d,data:h,it:{gen:$,topSchemaRef:p,schemaPath:b,errorPath:S},it:C},z,D,q){const V=q?(0,e._)`${d}, ${h}, ${p}${b}`:h,x=[[r.default.instancePath,(0,e.strConcat)(r.default.instancePath,S)],[r.default.parentData,C.parentData],[r.default.parentDataProperty,C.parentDataProperty],[r.default.rootData,r.default.rootData]];C.opts.dynamicRef&&x.push([r.default.dynamicAnchors,r.default.dynamicAnchors]);const H=(0,e._)`${V}, ${$.object(...x)}`;return D!==e.nil?(0,e._)`${z}.call(${D}, ${H})`:(0,e._)`${z}(${H})`}ce.callValidateCode=g;const y=(0,e._)`new RegExp`;function k({gen:d,it:{opts:h}},$){const p=h.unicodeRegExp?"u":"",{regExp:b}=h.code,S=b($,p);return d.scopeValue("pattern",{key:S.toString(),ref:S,code:(0,e._)`${b.code==="new RegExp"?y:(0,n.useFunc)(d,b)}(${$}, ${p})`})}ce.usePattern=k;function f(d){const{gen:h,data:$,keyword:p,it:b}=d,S=h.name("valid");if(b.allErrors){const z=h.let("valid",!0);return C(()=>h.assign(z,!1)),z}return h.var(S,!0),C(()=>h.break()),S;function C(z){const D=h.const("len",(0,e._)`${$}.length`);h.forRange("i",0,D,q=>{d.subschema({keyword:p,dataProp:q,dataPropType:t.Type.Num},S),h.if((0,e.not)(S),z)})}}ce.validateArray=f;function m(d){const{gen:h,schema:$,keyword:p,it:b}=d;if(!Array.isArray($))throw new Error("ajv implementation error");if($.some(D=>(0,t.alwaysValidSchema)(b,D))&&!b.opts.unevaluated)return;const C=h.let("valid",!1),z=h.name("_valid");h.block(()=>$.forEach((D,q)=>{const V=d.subschema({keyword:p,schemaProp:q,compositeRule:!0},z);h.assign(C,(0,e._)`${C} || ${z}`),d.mergeValidEvaluated(V,z)||h.if((0,e.not)(C))})),d.result(C,()=>d.reset(),()=>d.error(!0))}return ce.validateUnion=m,ce}var ks;function sp(){if(ks)return He;ks=1,Object.defineProperty(He,"__esModule",{value:!0}),He.validateKeywordUsage=He.validSchemaType=He.funcKeywordCode=He.macroKeywordCode=void 0;const e=te(),t=it(),r=We(),n=un();function o(_,g){const{gen:y,keyword:k,schema:f,parentSchema:m,it:d}=_,h=g.macro.call(d.self,f,m,d),$=u(y,k,h);d.opts.validateSchema!==!1&&d.self.validateSchema(h,!0);const p=y.name("valid");_.subschema({schema:h,schemaPath:e.nil,errSchemaPath:`${d.errSchemaPath}/${k}`,topSchemaRef:$,compositeRule:!0},p),_.pass(p,()=>_.error(!0))}He.macroKeywordCode=o;function s(_,g){var y;const{gen:k,keyword:f,schema:m,parentSchema:d,$data:h,it:$}=_;c($,g);const p=!h&&g.compile?g.compile.call($.self,m,d,$):g.validate,b=u(k,f,p),S=k.let("valid");_.block$data(S,C),_.ok((y=g.valid)!==null&&y!==void 0?y:S);function C(){if(g.errors===!1)q(),g.modifying&&i(_),V(()=>_.error());else{const x=g.async?z():D();g.modifying&&i(_),V(()=>a(_,x))}}function z(){const x=k.let("ruleErrs",null);return k.try(()=>q((0,e._)`await `),H=>k.assign(S,!1).if((0,e._)`${H} instanceof ${$.ValidationError}`,()=>k.assign(x,(0,e._)`${H}.errors`),()=>k.throw(H))),x}function D(){const x=(0,e._)`${b}.errors`;return k.assign(x,null),q(e.nil),x}function q(x=g.async?(0,e._)`await `:e.nil){const H=$.opts.passContext?t.default.this:t.default.self,ae=!("compile"in g&&!h||g.schema===!1);k.assign(S,(0,e._)`${x}${(0,r.callValidateCode)(_,b,H,ae)}`,g.modifying)}function V(x){var H;k.if((0,e.not)((H=g.valid)!==null&&H!==void 0?H:S),x)}}He.funcKeywordCode=s;function i(_){const{gen:g,data:y,it:k}=_;g.if(k.parentData,()=>g.assign(y,(0,e._)`${k.parentData}[${k.parentDataProperty}]`))}function a(_,g){const{gen:y}=_;y.if((0,e._)`Array.isArray(${g})`,()=>{y.assign(t.default.vErrors,(0,e._)`${t.default.vErrors} === null ? ${g} : ${t.default.vErrors}.concat(${g})`).assign(t.default.errors,(0,e._)`${t.default.vErrors}.length`),(0,n.extendErrors)(_)},()=>_.error())}function c({schemaEnv:_},g){if(g.async&&!_.$async)throw new Error("async keyword in sync schema")}function u(_,g,y){if(y===void 0)throw new Error(`keyword "${g}" failed to compile`);return _.scopeValue("keyword",typeof y=="function"?{ref:y}:{ref:y,code:(0,e.stringify)(y)})}function l(_,g,y=!1){return!g.length||g.some(k=>k==="array"?Array.isArray(_):k==="object"?_&&typeof _=="object"&&!Array.isArray(_):typeof _==k||y&&typeof _>"u")}He.validSchemaType=l;function v({schema:_,opts:g,self:y,errSchemaPath:k},f,m){if(Array.isArray(f.keyword)?!f.keyword.includes(m):f.keyword!==m)throw new Error("ajv implementation error");const d=f.dependencies;if(d!=null&&d.some(h=>!Object.prototype.hasOwnProperty.call(_,h)))throw new Error(`parent schema must have dependencies of ${m}: ${d.join(",")}`);if(f.validateSchema&&!f.validateSchema(_[m])){const $=`keyword "${m}" value is invalid at path "${k}": `+y.errorsText(f.validateSchema.errors);if(g.validateSchema==="log")y.logger.error($);else throw new Error($)}}return He.validateKeywordUsage=v,He}var Qe={},Ss;function ip(){if(Ss)return Qe;Ss=1,Object.defineProperty(Qe,"__esModule",{value:!0}),Qe.extendSubschemaMode=Qe.extendSubschemaData=Qe.getSubschema=void 0;const e=te(),t=se();function r(s,{keyword:i,schemaProp:a,schema:c,schemaPath:u,errSchemaPath:l,topSchemaRef:v}){if(i!==void 0&&c!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(i!==void 0){const _=s.schema[i];return a===void 0?{schema:_,schemaPath:(0,e._)`${s.schemaPath}${(0,e.getProperty)(i)}`,errSchemaPath:`${s.errSchemaPath}/${i}`}:{schema:_[a],schemaPath:(0,e._)`${s.schemaPath}${(0,e.getProperty)(i)}${(0,e.getProperty)(a)}`,errSchemaPath:`${s.errSchemaPath}/${i}/${(0,t.escapeFragment)(a)}`}}if(c!==void 0){if(u===void 0||l===void 0||v===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:c,schemaPath:u,topSchemaRef:v,errSchemaPath:l}}throw new Error('either "keyword" or "schema" must be passed')}Qe.getSubschema=r;function n(s,i,{dataProp:a,dataPropType:c,data:u,dataTypes:l,propertyName:v}){if(u!==void 0&&a!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');const{gen:_}=i;if(a!==void 0){const{errorPath:y,dataPathArr:k,opts:f}=i,m=_.let("data",(0,e._)`${i.data}${(0,e.getProperty)(a)}`,!0);g(m),s.errorPath=(0,e.str)`${y}${(0,t.getErrorPath)(a,c,f.jsPropertySyntax)}`,s.parentDataProperty=(0,e._)`${a}`,s.dataPathArr=[...k,s.parentDataProperty]}if(u!==void 0){const y=u instanceof e.Name?u:_.let("data",u,!0);g(y),v!==void 0&&(s.propertyName=v)}l&&(s.dataTypes=l);function g(y){s.data=y,s.dataLevel=i.dataLevel+1,s.dataTypes=[],i.definedProperties=new Set,s.parentData=i.data,s.dataNames=[...i.dataNames,y]}}Qe.extendSubschemaData=n;function o(s,{jtdDiscriminator:i,jtdMetadata:a,compositeRule:c,createErrors:u,allErrors:l}){c!==void 0&&(s.compositeRule=c),u!==void 0&&(s.createErrors=u),l!==void 0&&(s.allErrors=l),s.jtdDiscriminator=i,s.jtdMetadata=a}return Qe.extendSubschemaMode=o,Qe}var Ce={},kn,Es;function La(){return Es||(Es=1,kn=function e(t,r){if(t===r)return!0;if(t&&r&&typeof t=="object"&&typeof r=="object"){if(t.constructor!==r.constructor)return!1;var n,o,s;if(Array.isArray(t)){if(n=t.length,n!=r.length)return!1;for(o=n;o--!==0;)if(!e(t[o],r[o]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if(s=Object.keys(t),n=s.length,n!==Object.keys(r).length)return!1;for(o=n;o--!==0;)if(!Object.prototype.hasOwnProperty.call(r,s[o]))return!1;for(o=n;o--!==0;){var i=s[o];if(!e(t[i],r[i]))return!1}return!0}return t!==t&&r!==r}),kn}var Sn={exports:{}},Ts;function ap(){if(Ts)return Sn.exports;Ts=1;var e=Sn.exports=function(n,o,s){typeof o=="function"&&(s=o,o={}),s=o.cb||s;var i=typeof s=="function"?s:s.pre||function(){},a=s.post||function(){};t(o,i,a,n,"",n)};e.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0},e.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},e.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},e.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function t(n,o,s,i,a,c,u,l,v,_){if(i&&typeof i=="object"&&!Array.isArray(i)){o(i,a,c,u,l,v,_);for(var g in i){var y=i[g];if(Array.isArray(y)){if(g in e.arrayKeywords)for(var k=0;k<y.length;k++)t(n,o,s,y[k],a+"/"+g+"/"+k,c,a,g,i,k)}else if(g in e.propsKeywords){if(y&&typeof y=="object")for(var f in y)t(n,o,s,y[f],a+"/"+g+"/"+r(f),c,a,g,i,f)}else(g in e.keywords||n.allKeys&&!(g in e.skipKeywords))&&t(n,o,s,y,a+"/"+g,c,a,g,i)}s(i,a,c,u,l,v,_)}}function r(n){return n.replace(/~/g,"~0").replace(/\//g,"~1")}return Sn.exports}var Ps;function ln(){if(Ps)return Ce;Ps=1,Object.defineProperty(Ce,"__esModule",{value:!0}),Ce.getSchemaRefs=Ce.resolveUrl=Ce.normalizeId=Ce._getFullPath=Ce.getFullPath=Ce.inlineRef=void 0;const e=se(),t=La(),r=ap(),n=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function o(k,f=!0){return typeof k=="boolean"?!0:f===!0?!i(k):f?a(k)<=f:!1}Ce.inlineRef=o;const s=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function i(k){for(const f in k){if(s.has(f))return!0;const m=k[f];if(Array.isArray(m)&&m.some(i)||typeof m=="object"&&i(m))return!0}return!1}function a(k){let f=0;for(const m in k){if(m==="$ref")return 1/0;if(f++,!n.has(m)&&(typeof k[m]=="object"&&(0,e.eachItem)(k[m],d=>f+=a(d)),f===1/0))return 1/0}return f}function c(k,f="",m){m!==!1&&(f=v(f));const d=k.parse(f);return u(k,d)}Ce.getFullPath=c;function u(k,f){return k.serialize(f).split("#")[0]+"#"}Ce._getFullPath=u;const l=/#\/?$/;function v(k){return k?k.replace(l,""):""}Ce.normalizeId=v;function _(k,f,m){return m=v(m),k.resolve(f,m)}Ce.resolveUrl=_;const g=/^[a-z_][-a-z0-9._]*$/i;function y(k,f){if(typeof k=="boolean")return{};const{schemaId:m,uriResolver:d}=this.opts,h=v(k[m]||f),$={"":h},p=c(d,h,!1),b={},S=new Set;return r(k,{allKeys:!0},(D,q,V,x)=>{if(x===void 0)return;const H=p+q;let ae=$[x];typeof D[m]=="string"&&(ae=Ie.call(this,D[m])),Oe.call(this,D.$anchor),Oe.call(this,D.$dynamicAnchor),$[q]=ae;function Ie(ue){const Fe=this.opts.uriResolver.resolve;if(ue=v(ae?Fe(ae,ue):ue),S.has(ue))throw z(ue);S.add(ue);let L=this.refs[ue];return typeof L=="string"&&(L=this.refs[L]),typeof L=="object"?C(D,L.schema,ue):ue!==v(H)&&(ue[0]==="#"?(C(D,b[ue],ue),b[ue]=D):this.refs[ue]=H),ue}function Oe(ue){if(typeof ue=="string"){if(!g.test(ue))throw new Error(`invalid anchor "${ue}"`);Ie.call(this,`#${ue}`)}}}),b;function C(D,q,V){if(q!==void 0&&!t(D,q))throw z(V)}function z(D){return new Error(`reference "${D}" resolves to more than one schema`)}}return Ce.getSchemaRefs=y,Ce}var Rs;function dn(){if(Rs)return Je;Rs=1,Object.defineProperty(Je,"__esModule",{value:!0}),Je.getData=Je.KeywordCxt=Je.validateFunctionCode=void 0;const e=np(),t=Wr(),r=Da(),n=Wr(),o=op(),s=sp(),i=ip(),a=te(),c=it(),u=ln(),l=se(),v=un();function _(P){if(p(P)&&(S(P),$(P))){f(P);return}g(P,()=>(0,e.topBoolOrEmptySchema)(P))}Je.validateFunctionCode=_;function g({gen:P,validateName:I,schema:j,schemaEnv:Z,opts:J},re){J.code.es5?P.func(I,(0,a._)`${c.default.data}, ${c.default.valCxt}`,Z.$async,()=>{P.code((0,a._)`"use strict"; ${d(j,J)}`),k(P,J),P.code(re)}):P.func(I,(0,a._)`${c.default.data}, ${y(J)}`,Z.$async,()=>P.code(d(j,J)).code(re))}function y(P){return(0,a._)`{${c.default.instancePath}="", ${c.default.parentData}, ${c.default.parentDataProperty}, ${c.default.rootData}=${c.default.data}${P.dynamicRef?(0,a._)`, ${c.default.dynamicAnchors}={}`:a.nil}}={}`}function k(P,I){P.if(c.default.valCxt,()=>{P.var(c.default.instancePath,(0,a._)`${c.default.valCxt}.${c.default.instancePath}`),P.var(c.default.parentData,(0,a._)`${c.default.valCxt}.${c.default.parentData}`),P.var(c.default.parentDataProperty,(0,a._)`${c.default.valCxt}.${c.default.parentDataProperty}`),P.var(c.default.rootData,(0,a._)`${c.default.valCxt}.${c.default.rootData}`),I.dynamicRef&&P.var(c.default.dynamicAnchors,(0,a._)`${c.default.valCxt}.${c.default.dynamicAnchors}`)},()=>{P.var(c.default.instancePath,(0,a._)`""`),P.var(c.default.parentData,(0,a._)`undefined`),P.var(c.default.parentDataProperty,(0,a._)`undefined`),P.var(c.default.rootData,c.default.data),I.dynamicRef&&P.var(c.default.dynamicAnchors,(0,a._)`{}`)})}function f(P){const{schema:I,opts:j,gen:Z}=P;g(P,()=>{j.$comment&&I.$comment&&x(P),D(P),Z.let(c.default.vErrors,null),Z.let(c.default.errors,0),j.unevaluated&&m(P),C(P),H(P)})}function m(P){const{gen:I,validateName:j}=P;P.evaluated=I.const("evaluated",(0,a._)`${j}.evaluated`),I.if((0,a._)`${P.evaluated}.dynamicProps`,()=>I.assign((0,a._)`${P.evaluated}.props`,(0,a._)`undefined`)),I.if((0,a._)`${P.evaluated}.dynamicItems`,()=>I.assign((0,a._)`${P.evaluated}.items`,(0,a._)`undefined`))}function d(P,I){const j=typeof P=="object"&&P[I.schemaId];return j&&(I.code.source||I.code.process)?(0,a._)`/*# sourceURL=${j} */`:a.nil}function h(P,I){if(p(P)&&(S(P),$(P))){b(P,I);return}(0,e.boolOrEmptySchema)(P,I)}function $({schema:P,self:I}){if(typeof P=="boolean")return!P;for(const j in P)if(I.RULES.all[j])return!0;return!1}function p(P){return typeof P.schema!="boolean"}function b(P,I){const{schema:j,gen:Z,opts:J}=P;J.$comment&&j.$comment&&x(P),q(P),V(P);const re=Z.const("_errs",c.default.errors);C(P,re),Z.var(I,(0,a._)`${re} === ${c.default.errors}`)}function S(P){(0,l.checkUnknownRules)(P),z(P)}function C(P,I){if(P.opts.jtd)return Ie(P,[],!1,I);const j=(0,t.getSchemaTypes)(P.schema),Z=(0,t.coerceAndCheckDataType)(P,j);Ie(P,j,!Z,I)}function z(P){const{schema:I,errSchemaPath:j,opts:Z,self:J}=P;I.$ref&&Z.ignoreKeywordsWithRef&&(0,l.schemaHasRulesButRef)(I,J.RULES)&&J.logger.warn(`$ref: keywords ignored in schema at path "${j}"`)}function D(P){const{schema:I,opts:j}=P;I.default!==void 0&&j.useDefaults&&j.strictSchema&&(0,l.checkStrictMode)(P,"default is ignored in the schema root")}function q(P){const I=P.schema[P.opts.schemaId];I&&(P.baseId=(0,u.resolveUrl)(P.opts.uriResolver,P.baseId,I))}function V(P){if(P.schema.$async&&!P.schemaEnv.$async)throw new Error("async schema in sync schema")}function x({gen:P,schemaEnv:I,schema:j,errSchemaPath:Z,opts:J}){const re=j.$comment;if(J.$comment===!0)P.code((0,a._)`${c.default.self}.logger.log(${re})`);else if(typeof J.$comment=="function"){const ke=(0,a.str)`${Z}/$comment`,xe=P.scopeValue("root",{ref:I.root});P.code((0,a._)`${c.default.self}.opts.$comment(${re}, ${ke}, ${xe}.schema)`)}}function H(P){const{gen:I,schemaEnv:j,validateName:Z,ValidationError:J,opts:re}=P;j.$async?I.if((0,a._)`${c.default.errors} === 0`,()=>I.return(c.default.data),()=>I.throw((0,a._)`new ${J}(${c.default.vErrors})`)):(I.assign((0,a._)`${Z}.errors`,c.default.vErrors),re.unevaluated&&ae(P),I.return((0,a._)`${c.default.errors} === 0`))}function ae({gen:P,evaluated:I,props:j,items:Z}){j instanceof a.Name&&P.assign((0,a._)`${I}.props`,j),Z instanceof a.Name&&P.assign((0,a._)`${I}.items`,Z)}function Ie(P,I,j,Z){const{gen:J,schema:re,data:ke,allErrors:xe,opts:ze,self:Ae}=P,{RULES:Se}=Ae;if(re.$ref&&(ze.ignoreKeywordsWithRef||!(0,l.schemaHasRulesButRef)(re,Se))){J.block(()=>W(P,"$ref",Se.all.$ref.definition));return}ze.jtd||ue(P,I),J.block(()=>{for(const Le of Se.rules)mt(Le);mt(Se.post)});function mt(Le){(0,r.shouldUseGroup)(re,Le)&&(Le.type?(J.if((0,n.checkDataType)(Le.type,ke,ze.strictNumbers)),Oe(P,Le),I.length===1&&I[0]===Le.type&&j&&(J.else(),(0,n.reportTypeError)(P)),J.endIf()):Oe(P,Le),xe||J.if((0,a._)`${c.default.errors} === ${Z||0}`))}}function Oe(P,I){const{gen:j,schema:Z,opts:{useDefaults:J}}=P;J&&(0,o.assignDefaults)(P,I.type),j.block(()=>{for(const re of I.rules)(0,r.shouldUseRule)(Z,re)&&W(P,re.keyword,re.definition,I.type)})}function ue(P,I){P.schemaEnv.meta||!P.opts.strictTypes||(Fe(P,I),P.opts.allowUnionTypes||L(P,I),R(P,P.dataTypes))}function Fe(P,I){if(I.length){if(!P.dataTypes.length){P.dataTypes=I;return}I.forEach(j=>{O(P.dataTypes,j)||E(P,`type "${j}" not allowed by context "${P.dataTypes.join(",")}"`)}),w(P,I)}}function L(P,I){I.length>1&&!(I.length===2&&I.includes("null"))&&E(P,"use allowUnionTypes to allow union type keyword")}function R(P,I){const j=P.self.RULES.all;for(const Z in j){const J=j[Z];if(typeof J=="object"&&(0,r.shouldUseRule)(P.schema,J)){const{type:re}=J.definition;re.length&&!re.some(ke=>M(I,ke))&&E(P,`missing type "${re.join(",")}" for keyword "${Z}"`)}}}function M(P,I){return P.includes(I)||I==="number"&&P.includes("integer")}function O(P,I){return P.includes(I)||I==="integer"&&P.includes("number")}function w(P,I){const j=[];for(const Z of P.dataTypes)O(I,Z)?j.push(Z):I.includes("integer")&&Z==="number"&&j.push("integer");P.dataTypes=j}function E(P,I){const j=P.schemaEnv.baseId+P.errSchemaPath;I+=` at "${j}" (strictTypes)`,(0,l.checkStrictMode)(P,I,P.opts.strictTypes)}class A{constructor(I,j,Z){if((0,s.validateKeywordUsage)(I,j,Z),this.gen=I.gen,this.allErrors=I.allErrors,this.keyword=Z,this.data=I.data,this.schema=I.schema[Z],this.$data=j.$data&&I.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,l.schemaRefOrVal)(I,this.schema,Z,this.$data),this.schemaType=j.schemaType,this.parentSchema=I.schema,this.params={},this.it=I,this.def=j,this.$data)this.schemaCode=I.gen.const("vSchema",oe(this.$data,I));else if(this.schemaCode=this.schemaValue,!(0,s.validSchemaType)(this.schema,j.schemaType,j.allowUndefined))throw new Error(`${Z} value must be ${JSON.stringify(j.schemaType)}`);("code"in j?j.trackErrors:j.errors!==!1)&&(this.errsCount=I.gen.const("_errs",c.default.errors))}result(I,j,Z){this.failResult((0,a.not)(I),j,Z)}failResult(I,j,Z){this.gen.if(I),Z?Z():this.error(),j?(this.gen.else(),j(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(I,j){this.failResult((0,a.not)(I),void 0,j)}fail(I){if(I===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(I),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(I){if(!this.$data)return this.fail(I);const{schemaCode:j}=this;this.fail((0,a._)`${j} !== undefined && (${(0,a.or)(this.invalid$data(),I)})`)}error(I,j,Z){if(j){this.setParams(j),this._error(I,Z),this.setParams({});return}this._error(I,Z)}_error(I,j){(I?v.reportExtraError:v.reportError)(this,this.def.error,j)}$dataError(){(0,v.reportError)(this,this.def.$dataError||v.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,v.resetErrorsCount)(this.gen,this.errsCount)}ok(I){this.allErrors||this.gen.if(I)}setParams(I,j){j?Object.assign(this.params,I):this.params=I}block$data(I,j,Z=a.nil){this.gen.block(()=>{this.check$data(I,Z),j()})}check$data(I=a.nil,j=a.nil){if(!this.$data)return;const{gen:Z,schemaCode:J,schemaType:re,def:ke}=this;Z.if((0,a.or)((0,a._)`${J} === undefined`,j)),I!==a.nil&&Z.assign(I,!0),(re.length||ke.validateSchema)&&(Z.elseIf(this.invalid$data()),this.$dataError(),I!==a.nil&&Z.assign(I,!1)),Z.else()}invalid$data(){const{gen:I,schemaCode:j,schemaType:Z,def:J,it:re}=this;return(0,a.or)(ke(),xe());function ke(){if(Z.length){if(!(j instanceof a.Name))throw new Error("ajv implementation error");const ze=Array.isArray(Z)?Z:[Z];return(0,a._)`${(0,n.checkDataTypes)(ze,j,re.opts.strictNumbers,n.DataType.Wrong)}`}return a.nil}function xe(){if(J.validateSchema){const ze=I.scopeValue("validate$data",{ref:J.validateSchema});return(0,a._)`!${ze}(${j})`}return a.nil}}subschema(I,j){const Z=(0,i.getSubschema)(this.it,I);(0,i.extendSubschemaData)(Z,this.it,I),(0,i.extendSubschemaMode)(Z,I);const J={...this.it,...Z,items:void 0,props:void 0};return h(J,j),J}mergeEvaluated(I,j){const{it:Z,gen:J}=this;Z.opts.unevaluated&&(Z.props!==!0&&I.props!==void 0&&(Z.props=l.mergeEvaluated.props(J,I.props,Z.props,j)),Z.items!==!0&&I.items!==void 0&&(Z.items=l.mergeEvaluated.items(J,I.items,Z.items,j)))}mergeValidEvaluated(I,j){const{it:Z,gen:J}=this;if(Z.opts.unevaluated&&(Z.props!==!0||Z.items!==!0))return J.if(j,()=>this.mergeEvaluated(I,a.Name)),!0}}Je.KeywordCxt=A;function W(P,I,j,Z){const J=new A(P,j,I);"code"in j?j.code(J,Z):J.$data&&j.validate?(0,s.funcKeywordCode)(J,j):"macro"in j?(0,s.macroKeywordCode)(J,j):(j.compile||j.validate)&&(0,s.funcKeywordCode)(J,j)}const Q=/^\/(?:[^~]|~0|~1)*$/,ie=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function oe(P,{dataLevel:I,dataNames:j,dataPathArr:Z}){let J,re;if(P==="")return c.default.rootData;if(P[0]==="/"){if(!Q.test(P))throw new Error(`Invalid JSON-pointer: ${P}`);J=P,re=c.default.rootData}else{const Ae=ie.exec(P);if(!Ae)throw new Error(`Invalid JSON-pointer: ${P}`);const Se=+Ae[1];if(J=Ae[2],J==="#"){if(Se>=I)throw new Error(ze("property/index",Se));return Z[I-Se]}if(Se>I)throw new Error(ze("data",Se));if(re=j[I-Se],!J)return re}let ke=re;const xe=J.split("/");for(const Ae of xe)Ae&&(re=(0,a._)`${re}${(0,a.getProperty)((0,l.unescapeJsonPointer)(Ae))}`,ke=(0,a._)`${ke} && ${re}`);return ke;function ze(Ae,Se){return`Cannot access ${Ae} ${Se} levels up, current level is ${I}`}}return Je.getData=oe,Je}var rr={},Is;function zo(){if(Is)return rr;Is=1,Object.defineProperty(rr,"__esModule",{value:!0});class e extends Error{constructor(r){super("validation failed"),this.errors=r,this.ajv=this.validation=!0}}return rr.default=e,rr}var nr={},Os;function fn(){if(Os)return nr;Os=1,Object.defineProperty(nr,"__esModule",{value:!0});const e=ln();class t extends Error{constructor(n,o,s,i){super(i||`can't resolve reference ${s} from id ${o}`),this.missingRef=(0,e.resolveUrl)(n,o,s),this.missingSchema=(0,e.normalizeId)((0,e.getFullPath)(n,this.missingRef))}}return nr.default=t,nr}var De={},Cs;function Ao(){if(Cs)return De;Cs=1,Object.defineProperty(De,"__esModule",{value:!0}),De.resolveSchema=De.getCompilingSchema=De.resolveRef=De.compileSchema=De.SchemaEnv=void 0;const e=te(),t=zo(),r=it(),n=ln(),o=se(),s=dn();class i{constructor(m){var d;this.refs={},this.dynamicAnchors={};let h;typeof m.schema=="object"&&(h=m.schema),this.schema=m.schema,this.schemaId=m.schemaId,this.root=m.root||this,this.baseId=(d=m.baseId)!==null&&d!==void 0?d:(0,n.normalizeId)(h==null?void 0:h[m.schemaId||"$id"]),this.schemaPath=m.schemaPath,this.localRefs=m.localRefs,this.meta=m.meta,this.$async=h==null?void 0:h.$async,this.refs={}}}De.SchemaEnv=i;function a(f){const m=l.call(this,f);if(m)return m;const d=(0,n.getFullPath)(this.opts.uriResolver,f.root.baseId),{es5:h,lines:$}=this.opts.code,{ownProperties:p}=this.opts,b=new e.CodeGen(this.scope,{es5:h,lines:$,ownProperties:p});let S;f.$async&&(S=b.scopeValue("Error",{ref:t.default,code:(0,e._)`require("ajv/dist/runtime/validation_error").default`}));const C=b.scopeName("validate");f.validateName=C;const z={gen:b,allErrors:this.opts.allErrors,data:r.default.data,parentData:r.default.parentData,parentDataProperty:r.default.parentDataProperty,dataNames:[r.default.data],dataPathArr:[e.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:b.scopeValue("schema",this.opts.code.source===!0?{ref:f.schema,code:(0,e.stringify)(f.schema)}:{ref:f.schema}),validateName:C,ValidationError:S,schema:f.schema,schemaEnv:f,rootId:d,baseId:f.baseId||d,schemaPath:e.nil,errSchemaPath:f.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,e._)`""`,opts:this.opts,self:this};let D;try{this._compilations.add(f),(0,s.validateFunctionCode)(z),b.optimize(this.opts.code.optimize);const q=b.toString();D=`${b.scopeRefs(r.default.scope)}return ${q}`,this.opts.code.process&&(D=this.opts.code.process(D,f));const x=new Function(`${r.default.self}`,`${r.default.scope}`,D)(this,this.scope.get());if(this.scope.value(C,{ref:x}),x.errors=null,x.schema=f.schema,x.schemaEnv=f,f.$async&&(x.$async=!0),this.opts.code.source===!0&&(x.source={validateName:C,validateCode:q,scopeValues:b._values}),this.opts.unevaluated){const{props:H,items:ae}=z;x.evaluated={props:H instanceof e.Name?void 0:H,items:ae instanceof e.Name?void 0:ae,dynamicProps:H instanceof e.Name,dynamicItems:ae instanceof e.Name},x.source&&(x.source.evaluated=(0,e.stringify)(x.evaluated))}return f.validate=x,f}catch(q){throw delete f.validate,delete f.validateName,D&&this.logger.error("Error compiling schema, function code:",D),q}finally{this._compilations.delete(f)}}De.compileSchema=a;function c(f,m,d){var h;d=(0,n.resolveUrl)(this.opts.uriResolver,m,d);const $=f.refs[d];if($)return $;let p=_.call(this,f,d);if(p===void 0){const b=(h=f.localRefs)===null||h===void 0?void 0:h[d],{schemaId:S}=this.opts;b&&(p=new i({schema:b,schemaId:S,root:f,baseId:m}))}if(p!==void 0)return f.refs[d]=u.call(this,p)}De.resolveRef=c;function u(f){return(0,n.inlineRef)(f.schema,this.opts.inlineRefs)?f.schema:f.validate?f:a.call(this,f)}function l(f){for(const m of this._compilations)if(v(m,f))return m}De.getCompilingSchema=l;function v(f,m){return f.schema===m.schema&&f.root===m.root&&f.baseId===m.baseId}function _(f,m){let d;for(;typeof(d=this.refs[m])=="string";)m=d;return d||this.schemas[m]||g.call(this,f,m)}function g(f,m){const d=this.opts.uriResolver.parse(m),h=(0,n._getFullPath)(this.opts.uriResolver,d);let $=(0,n.getFullPath)(this.opts.uriResolver,f.baseId,void 0);if(Object.keys(f.schema).length>0&&h===$)return k.call(this,d,f);const p=(0,n.normalizeId)(h),b=this.refs[p]||this.schemas[p];if(typeof b=="string"){const S=g.call(this,f,b);return typeof(S==null?void 0:S.schema)!="object"?void 0:k.call(this,d,S)}if(typeof(b==null?void 0:b.schema)=="object"){if(b.validate||a.call(this,b),p===(0,n.normalizeId)(m)){const{schema:S}=b,{schemaId:C}=this.opts,z=S[C];return z&&($=(0,n.resolveUrl)(this.opts.uriResolver,$,z)),new i({schema:S,schemaId:C,root:f,baseId:$})}return k.call(this,d,b)}}De.resolveSchema=g;const y=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function k(f,{baseId:m,schema:d,root:h}){var $;if((($=f.fragment)===null||$===void 0?void 0:$[0])!=="/")return;for(const S of f.fragment.slice(1).split("/")){if(typeof d=="boolean")return;const C=d[(0,o.unescapeFragment)(S)];if(C===void 0)return;d=C;const z=typeof d=="object"&&d[this.opts.schemaId];!y.has(S)&&z&&(m=(0,n.resolveUrl)(this.opts.uriResolver,m,z))}let p;if(typeof d!="boolean"&&d.$ref&&!(0,o.schemaHasRulesButRef)(d,this.RULES)){const S=(0,n.resolveUrl)(this.opts.uriResolver,m,d.$ref);p=g.call(this,h,S)}const{schemaId:b}=this.opts;if(p=p||new i({schema:d,schemaId:b,root:h,baseId:m}),p.schema!==p.root.schema)return p}return De}const cp="https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",up="Meta-schema for $data reference (JSON AnySchema extension proposal)",lp="object",dp=["$data"],fp={$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},hp=!1,pp={$id:cp,description:up,type:lp,required:dp,properties:fp,additionalProperties:hp};var or={},At={exports:{}},En,Ns;function Za(){if(Ns)return En;Ns=1;const e=RegExp.prototype.test.bind(/^[\da-f]{8}-[\da-f]{4}-[\da-f]{4}-[\da-f]{4}-[\da-f]{12}$/iu),t=RegExp.prototype.test.bind(/^(?:(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)$/u);function r(_){let g="",y=0,k=0;for(k=0;k<_.length;k++)if(y=_[k].charCodeAt(0),y!==48){if(!(y>=48&&y<=57||y>=65&&y<=70||y>=97&&y<=102))return"";g+=_[k];break}for(k+=1;k<_.length;k++){if(y=_[k].charCodeAt(0),!(y>=48&&y<=57||y>=65&&y<=70||y>=97&&y<=102))return"";g+=_[k]}return g}const n=RegExp.prototype.test.bind(/[^!"$&'()*+,\-.;=_`a-z{}~]/u);function o(_){return _.length=0,!0}function s(_,g,y){if(_.length){const k=r(_);if(k!=="")g.push(k);else return y.error=!0,!1;_.length=0}return!0}function i(_){let g=0;const y={error:!1,address:"",zone:""},k=[],f=[];let m=!1,d=!1,h=s;for(let $=0;$<_.length;$++){const p=_[$];if(!(p==="["||p==="]"))if(p===":"){if(m===!0&&(d=!0),!h(f,k,y))break;if(++g>7){y.error=!0;break}$>0&&_[$-1]===":"&&(m=!0),k.push(":");continue}else if(p==="%"){if(!h(f,k,y))break;h=o}else{f.push(p);continue}}return f.length&&(h===o?y.zone=f.join(""):d?k.push(f.join("")):k.push(r(f))),y.address=k.join(""),y}function a(_){if(c(_,":")<2)return{host:_,isIPV6:!1};const g=i(_);if(g.error)return{host:_,isIPV6:!1};{let y=g.address,k=g.address;return g.zone&&(y+="%"+g.zone,k+="%25"+g.zone),{host:y,isIPV6:!0,escapedHost:k}}}function c(_,g){let y=0;for(let k=0;k<_.length;k++)_[k]===g&&y++;return y}function u(_){let g=_;const y=[];let k=-1,f=0;for(;f=g.length;){if(f===1){if(g===".")break;if(g==="/"){y.push("/");break}else{y.push(g);break}}else if(f===2){if(g[0]==="."){if(g[1]===".")break;if(g[1]==="/"){g=g.slice(2);continue}}else if(g[0]==="/"&&(g[1]==="."||g[1]==="/")){y.push("/");break}}else if(f===3&&g==="/.."){y.length!==0&&y.pop(),y.push("/");break}if(g[0]==="."){if(g[1]==="."){if(g[2]==="/"){g=g.slice(3);continue}}else if(g[1]==="/"){g=g.slice(2);continue}}else if(g[0]==="/"&&g[1]==="."){if(g[2]==="/"){g=g.slice(2);continue}else if(g[2]==="."&&g[3]==="/"){g=g.slice(3),y.length!==0&&y.pop();continue}}if((k=g.indexOf("/",1))===-1){y.push(g);break}else y.push(g.slice(0,k)),g=g.slice(k)}return y.join("")}function l(_,g){const y=g!==!0?escape:unescape;return _.scheme!==void 0&&(_.scheme=y(_.scheme)),_.userinfo!==void 0&&(_.userinfo=y(_.userinfo)),_.host!==void 0&&(_.host=y(_.host)),_.path!==void 0&&(_.path=y(_.path)),_.query!==void 0&&(_.query=y(_.query)),_.fragment!==void 0&&(_.fragment=y(_.fragment)),_}function v(_){const g=[];if(_.userinfo!==void 0&&(g.push(_.userinfo),g.push("@")),_.host!==void 0){let y=unescape(_.host);if(!t(y)){const k=a(y);k.isIPV6===!0?y=`[${k.escapedHost}]`:y=_.host}g.push(y)}return(typeof _.port=="number"||typeof _.port=="string")&&(g.push(":"),g.push(String(_.port))),g.length?g.join(""):void 0}return En={nonSimpleDomain:n,recomposeAuthority:v,normalizeComponentEncoding:l,removeDotSegments:u,isIPv4:t,isUUID:e,normalizeIPv6:a,stringArrayToHexStripped:r},En}var Tn,zs;function mp(){if(zs)return Tn;zs=1;const{isUUID:e}=Za(),t=/([\da-z][\d\-a-z]{0,31}):((?:[\w!$'()*+,\-.:;=@]|%[\da-f]{2})+)/iu,r=["http","https","ws","wss","urn","urn:uuid"];function n(p){return r.indexOf(p)!==-1}function o(p){return p.secure===!0?!0:p.secure===!1?!1:p.scheme?p.scheme.length===3&&(p.scheme[0]==="w"||p.scheme[0]==="W")&&(p.scheme[1]==="s"||p.scheme[1]==="S")&&(p.scheme[2]==="s"||p.scheme[2]==="S"):!1}function s(p){return p.host||(p.error=p.error||"HTTP URIs must have a host."),p}function i(p){const b=String(p.scheme).toLowerCase()==="https";return(p.port===(b?443:80)||p.port==="")&&(p.port=void 0),p.path||(p.path="/"),p}function a(p){return p.secure=o(p),p.resourceName=(p.path||"/")+(p.query?"?"+p.query:""),p.path=void 0,p.query=void 0,p}function c(p){if((p.port===(o(p)?443:80)||p.port==="")&&(p.port=void 0),typeof p.secure=="boolean"&&(p.scheme=p.secure?"wss":"ws",p.secure=void 0),p.resourceName){const[b,S]=p.resourceName.split("?");p.path=b&&b!=="/"?b:void 0,p.query=S,p.resourceName=void 0}return p.fragment=void 0,p}function u(p,b){if(!p.path)return p.error="URN can not be parsed",p;const S=p.path.match(t);if(S){const C=b.scheme||p.scheme||"urn";p.nid=S[1].toLowerCase(),p.nss=S[2];const z=`${C}:${b.nid||p.nid}`,D=$(z);p.path=void 0,D&&(p=D.parse(p,b))}else p.error=p.error||"URN can not be parsed.";return p}function l(p,b){if(p.nid===void 0)throw new Error("URN without nid cannot be serialized");const S=b.scheme||p.scheme||"urn",C=p.nid.toLowerCase(),z=`${S}:${b.nid||C}`,D=$(z);D&&(p=D.serialize(p,b));const q=p,V=p.nss;return q.path=`${C||b.nid}:${V}`,b.skipEscape=!0,q}function v(p,b){const S=p;return S.uuid=S.nss,S.nss=void 0,!b.tolerant&&(!S.uuid||!e(S.uuid))&&(S.error=S.error||"UUID is not valid."),S}function _(p){const b=p;return b.nss=(p.uuid||"").toLowerCase(),b}const g={scheme:"http",domainHost:!0,parse:s,serialize:i},y={scheme:"https",domainHost:g.domainHost,parse:s,serialize:i},k={scheme:"ws",domainHost:!0,parse:a,serialize:c},f={scheme:"wss",domainHost:k.domainHost,parse:k.parse,serialize:k.serialize},h={http:g,https:y,ws:k,wss:f,urn:{scheme:"urn",parse:u,serialize:l,skipNormalize:!0},"urn:uuid":{scheme:"urn:uuid",parse:v,serialize:_,skipNormalize:!0}};Object.setPrototypeOf(h,null);function $(p){return p&&(h[p]||h[p.toLowerCase()])||void 0}return Tn={wsIsSecure:o,SCHEMES:h,isValidSchemeName:n,getSchemeHandler:$},Tn}var As;function _p(){if(As)return At.exports;As=1;const{normalizeIPv6:e,removeDotSegments:t,recomposeAuthority:r,normalizeComponentEncoding:n,isIPv4:o,nonSimpleDomain:s}=Za(),{SCHEMES:i,getSchemeHandler:a}=mp();function c(f,m){return typeof f=="string"?f=_(y(f,m),m):typeof f=="object"&&(f=y(_(f,m),m)),f}function u(f,m,d){const h=d?Object.assign({scheme:"null"},d):{scheme:"null"},$=l(y(f,h),y(m,h),h,!0);return h.skipEscape=!0,_($,h)}function l(f,m,d,h){const $={};return h||(f=y(_(f,d),d),m=y(_(m,d),d)),d=d||{},!d.tolerant&&m.scheme?($.scheme=m.scheme,$.userinfo=m.userinfo,$.host=m.host,$.port=m.port,$.path=t(m.path||""),$.query=m.query):(m.userinfo!==void 0||m.host!==void 0||m.port!==void 0?($.userinfo=m.userinfo,$.host=m.host,$.port=m.port,$.path=t(m.path||""),$.query=m.query):(m.path?(m.path[0]==="/"?$.path=t(m.path):((f.userinfo!==void 0||f.host!==void 0||f.port!==void 0)&&!f.path?$.path="/"+m.path:f.path?$.path=f.path.slice(0,f.path.lastIndexOf("/")+1)+m.path:$.path=m.path,$.path=t($.path)),$.query=m.query):($.path=f.path,m.query!==void 0?$.query=m.query:$.query=f.query),$.userinfo=f.userinfo,$.host=f.host,$.port=f.port),$.scheme=f.scheme),$.fragment=m.fragment,$}function v(f,m,d){return typeof f=="string"?(f=unescape(f),f=_(n(y(f,d),!0),{...d,skipEscape:!0})):typeof f=="object"&&(f=_(n(f,!0),{...d,skipEscape:!0})),typeof m=="string"?(m=unescape(m),m=_(n(y(m,d),!0),{...d,skipEscape:!0})):typeof m=="object"&&(m=_(n(m,!0),{...d,skipEscape:!0})),f.toLowerCase()===m.toLowerCase()}function _(f,m){const d={host:f.host,scheme:f.scheme,userinfo:f.userinfo,port:f.port,path:f.path,query:f.query,nid:f.nid,nss:f.nss,uuid:f.uuid,fragment:f.fragment,reference:f.reference,resourceName:f.resourceName,secure:f.secure,error:""},h=Object.assign({},m),$=[],p=a(h.scheme||d.scheme);p&&p.serialize&&p.serialize(d,h),d.path!==void 0&&(h.skipEscape?d.path=unescape(d.path):(d.path=escape(d.path),d.scheme!==void 0&&(d.path=d.path.split("%3A").join(":")))),h.reference!=="suffix"&&d.scheme&&$.push(d.scheme,":");const b=r(d);if(b!==void 0&&(h.reference!=="suffix"&&$.push("//"),$.push(b),d.path&&d.path[0]!=="/"&&$.push("/")),d.path!==void 0){let S=d.path;!h.absolutePath&&(!p||!p.absolutePath)&&(S=t(S)),b===void 0&&S[0]==="/"&&S[1]==="/"&&(S="/%2F"+S.slice(2)),$.push(S)}return d.query!==void 0&&$.push("?",d.query),d.fragment!==void 0&&$.push("#",d.fragment),$.join("")}const g=/^(?:([^#/:?]+):)?(?:\/\/((?:([^#/?@]*)@)?(\[[^#/?\]]+\]|[^#/:?]*)(?::(\d*))?))?([^#?]*)(?:\?([^#]*))?(?:#((?:.|[\n\r])*))?/u;function y(f,m){const d=Object.assign({},m),h={scheme:void 0,userinfo:void 0,host:"",port:void 0,path:"",query:void 0,fragment:void 0};let $=!1;d.reference==="suffix"&&(d.scheme?f=d.scheme+":"+f:f="//"+f);const p=f.match(g);if(p){if(h.scheme=p[1],h.userinfo=p[3],h.host=p[4],h.port=parseInt(p[5],10),h.path=p[6]||"",h.query=p[7],h.fragment=p[8],isNaN(h.port)&&(h.port=p[5]),h.host)if(o(h.host)===!1){const C=e(h.host);h.host=C.host.toLowerCase(),$=C.isIPV6}else $=!0;h.scheme===void 0&&h.userinfo===void 0&&h.host===void 0&&h.port===void 0&&h.query===void 0&&!h.path?h.reference="same-document":h.scheme===void 0?h.reference="relative":h.fragment===void 0?h.reference="absolute":h.reference="uri",d.reference&&d.reference!=="suffix"&&d.reference!==h.reference&&(h.error=h.error||"URI is not a "+d.reference+" reference.");const b=a(d.scheme||h.scheme);if(!d.unicodeSupport&&(!b||!b.unicodeSupport)&&h.host&&(d.domainHost||b&&b.domainHost)&&$===!1&&s(h.host))try{h.host=URL.domainToASCII(h.host.toLowerCase())}catch(S){h.error=h.error||"Host's domain name can not be converted to ASCII: "+S}(!b||b&&!b.skipNormalize)&&(f.indexOf("%")!==-1&&(h.scheme!==void 0&&(h.scheme=unescape(h.scheme)),h.host!==void 0&&(h.host=unescape(h.host))),h.path&&(h.path=escape(unescape(h.path))),h.fragment&&(h.fragment=encodeURI(decodeURIComponent(h.fragment)))),b&&b.parse&&b.parse(h,d)}else h.error=h.error||"URI can not be parsed.";return h}const k={SCHEMES:i,normalize:c,resolve:u,resolveComponent:l,equal:v,serialize:_,parse:y};return At.exports=k,At.exports.default=k,At.exports.fastUri=k,At.exports}var qs;function vp(){if(qs)return or;qs=1,Object.defineProperty(or,"__esModule",{value:!0});const e=_p();return e.code='require("ajv/dist/runtime/uri").default',or.default=e,or}var js;function gp(){return js||(js=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.CodeGen=e.Name=e.nil=e.stringify=e.str=e._=e.KeywordCxt=void 0;var t=dn();Object.defineProperty(e,"KeywordCxt",{enumerable:!0,get:function(){return t.KeywordCxt}});var r=te();Object.defineProperty(e,"_",{enumerable:!0,get:function(){return r._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return r.str}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return r.stringify}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return r.nil}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return r.Name}}),Object.defineProperty(e,"CodeGen",{enumerable:!0,get:function(){return r.CodeGen}});const n=zo(),o=fn(),s=Ua(),i=Ao(),a=te(),c=ln(),u=Wr(),l=se(),v=pp,_=vp(),g=(L,R)=>new RegExp(L,R);g.code="new RegExp";const y=["removeAdditional","useDefaults","coerceTypes"],k=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),f={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},m={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},d=200;function h(L){var R,M,O,w,E,A,W,Q,ie,oe,P,I,j,Z,J,re,ke,xe,ze,Ae,Se,mt,Le,hn,pn;const Nt=L.strict,mn=(R=L.code)===null||R===void 0?void 0:R.optimize,Do=mn===!0||mn===void 0?1:mn||0,Lo=(O=(M=L.code)===null||M===void 0?void 0:M.regExp)!==null&&O!==void 0?O:g,Ba=(w=L.uriResolver)!==null&&w!==void 0?w:_.default;return{strictSchema:(A=(E=L.strictSchema)!==null&&E!==void 0?E:Nt)!==null&&A!==void 0?A:!0,strictNumbers:(Q=(W=L.strictNumbers)!==null&&W!==void 0?W:Nt)!==null&&Q!==void 0?Q:!0,strictTypes:(oe=(ie=L.strictTypes)!==null&&ie!==void 0?ie:Nt)!==null&&oe!==void 0?oe:"log",strictTuples:(I=(P=L.strictTuples)!==null&&P!==void 0?P:Nt)!==null&&I!==void 0?I:"log",strictRequired:(Z=(j=L.strictRequired)!==null&&j!==void 0?j:Nt)!==null&&Z!==void 0?Z:!1,code:L.code?{...L.code,optimize:Do,regExp:Lo}:{optimize:Do,regExp:Lo},loopRequired:(J=L.loopRequired)!==null&&J!==void 0?J:d,loopEnum:(re=L.loopEnum)!==null&&re!==void 0?re:d,meta:(ke=L.meta)!==null&&ke!==void 0?ke:!0,messages:(xe=L.messages)!==null&&xe!==void 0?xe:!0,inlineRefs:(ze=L.inlineRefs)!==null&&ze!==void 0?ze:!0,schemaId:(Ae=L.schemaId)!==null&&Ae!==void 0?Ae:"$id",addUsedSchema:(Se=L.addUsedSchema)!==null&&Se!==void 0?Se:!0,validateSchema:(mt=L.validateSchema)!==null&&mt!==void 0?mt:!0,validateFormats:(Le=L.validateFormats)!==null&&Le!==void 0?Le:!0,unicodeRegExp:(hn=L.unicodeRegExp)!==null&&hn!==void 0?hn:!0,int32range:(pn=L.int32range)!==null&&pn!==void 0?pn:!0,uriResolver:Ba}}class ${constructor(R={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,R=this.opts={...R,...h(R)};const{es5:M,lines:O}=this.opts.code;this.scope=new a.ValueScope({scope:{},prefixes:k,es5:M,lines:O}),this.logger=V(R.logger);const w=R.validateFormats;R.validateFormats=!1,this.RULES=(0,s.getRules)(),p.call(this,f,R,"NOT SUPPORTED"),p.call(this,m,R,"DEPRECATED","warn"),this._metaOpts=D.call(this),R.formats&&C.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),R.keywords&&z.call(this,R.keywords),typeof R.meta=="object"&&this.addMetaSchema(R.meta),S.call(this),R.validateFormats=w}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:R,meta:M,schemaId:O}=this.opts;let w=v;O==="id"&&(w={...v},w.id=w.$id,delete w.$id),M&&R&&this.addMetaSchema(w,w[O],!1)}defaultMeta(){const{meta:R,schemaId:M}=this.opts;return this.opts.defaultMeta=typeof R=="object"?R[M]||R:void 0}validate(R,M){let O;if(typeof R=="string"){if(O=this.getSchema(R),!O)throw new Error(`no schema with key or ref "${R}"`)}else O=this.compile(R);const w=O(M);return"$async"in O||(this.errors=O.errors),w}compile(R,M){const O=this._addSchema(R,M);return O.validate||this._compileSchemaEnv(O)}compileAsync(R,M){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");const{loadSchema:O}=this.opts;return w.call(this,R,M);async function w(oe,P){await E.call(this,oe.$schema);const I=this._addSchema(oe,P);return I.validate||A.call(this,I)}async function E(oe){oe&&!this.getSchema(oe)&&await w.call(this,{$ref:oe},!0)}async function A(oe){try{return this._compileSchemaEnv(oe)}catch(P){if(!(P instanceof o.default))throw P;return W.call(this,P),await Q.call(this,P.missingSchema),A.call(this,oe)}}function W({missingSchema:oe,missingRef:P}){if(this.refs[oe])throw new Error(`AnySchema ${oe} is loaded but ${P} cannot be resolved`)}async function Q(oe){const P=await ie.call(this,oe);this.refs[oe]||await E.call(this,P.$schema),this.refs[oe]||this.addSchema(P,oe,M)}async function ie(oe){const P=this._loading[oe];if(P)return P;try{return await(this._loading[oe]=O(oe))}finally{delete this._loading[oe]}}}addSchema(R,M,O,w=this.opts.validateSchema){if(Array.isArray(R)){for(const A of R)this.addSchema(A,void 0,O,w);return this}let E;if(typeof R=="object"){const{schemaId:A}=this.opts;if(E=R[A],E!==void 0&&typeof E!="string")throw new Error(`schema ${A} must be string`)}return M=(0,c.normalizeId)(M||E),this._checkUnique(M),this.schemas[M]=this._addSchema(R,O,M,w,!0),this}addMetaSchema(R,M,O=this.opts.validateSchema){return this.addSchema(R,M,!0,O),this}validateSchema(R,M){if(typeof R=="boolean")return!0;let O;if(O=R.$schema,O!==void 0&&typeof O!="string")throw new Error("$schema must be a string");if(O=O||this.opts.defaultMeta||this.defaultMeta(),!O)return this.logger.warn("meta-schema not available"),this.errors=null,!0;const w=this.validate(O,R);if(!w&&M){const E="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(E);else throw new Error(E)}return w}getSchema(R){let M;for(;typeof(M=b.call(this,R))=="string";)R=M;if(M===void 0){const{schemaId:O}=this.opts,w=new i.SchemaEnv({schema:{},schemaId:O});if(M=i.resolveSchema.call(this,w,R),!M)return;this.refs[R]=M}return M.validate||this._compileSchemaEnv(M)}removeSchema(R){if(R instanceof RegExp)return this._removeAllSchemas(this.schemas,R),this._removeAllSchemas(this.refs,R),this;switch(typeof R){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{const M=b.call(this,R);return typeof M=="object"&&this._cache.delete(M.schema),delete this.schemas[R],delete this.refs[R],this}case"object":{const M=R;this._cache.delete(M);let O=R[this.opts.schemaId];return O&&(O=(0,c.normalizeId)(O),delete this.schemas[O],delete this.refs[O]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(R){for(const M of R)this.addKeyword(M);return this}addKeyword(R,M){let O;if(typeof R=="string")O=R,typeof M=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),M.keyword=O);else if(typeof R=="object"&&M===void 0){if(M=R,O=M.keyword,Array.isArray(O)&&!O.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(H.call(this,O,M),!M)return(0,l.eachItem)(O,E=>ae.call(this,E)),this;Oe.call(this,M);const w={...M,type:(0,u.getJSONTypes)(M.type),schemaType:(0,u.getJSONTypes)(M.schemaType)};return(0,l.eachItem)(O,w.type.length===0?E=>ae.call(this,E,w):E=>w.type.forEach(A=>ae.call(this,E,w,A))),this}getKeyword(R){const M=this.RULES.all[R];return typeof M=="object"?M.definition:!!M}removeKeyword(R){const{RULES:M}=this;delete M.keywords[R],delete M.all[R];for(const O of M.rules){const w=O.rules.findIndex(E=>E.keyword===R);w>=0&&O.rules.splice(w,1)}return this}addFormat(R,M){return typeof M=="string"&&(M=new RegExp(M)),this.formats[R]=M,this}errorsText(R=this.errors,{separator:M=", ",dataVar:O="data"}={}){return!R||R.length===0?"No errors":R.map(w=>`${O}${w.instancePath} ${w.message}`).reduce((w,E)=>w+M+E)}$dataMetaSchema(R,M){const O=this.RULES.all;R=JSON.parse(JSON.stringify(R));for(const w of M){const E=w.split("/").slice(1);let A=R;for(const W of E)A=A[W];for(const W in O){const Q=O[W];if(typeof Q!="object")continue;const{$data:ie}=Q.definition,oe=A[W];ie&&oe&&(A[W]=Fe(oe))}}return R}_removeAllSchemas(R,M){for(const O in R){const w=R[O];(!M||M.test(O))&&(typeof w=="string"?delete R[O]:w&&!w.meta&&(this._cache.delete(w.schema),delete R[O]))}}_addSchema(R,M,O,w=this.opts.validateSchema,E=this.opts.addUsedSchema){let A;const{schemaId:W}=this.opts;if(typeof R=="object")A=R[W];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof R!="boolean")throw new Error("schema must be object or boolean")}let Q=this._cache.get(R);if(Q!==void 0)return Q;O=(0,c.normalizeId)(A||O);const ie=c.getSchemaRefs.call(this,R,O);return Q=new i.SchemaEnv({schema:R,schemaId:W,meta:M,baseId:O,localRefs:ie}),this._cache.set(Q.schema,Q),E&&!O.startsWith("#")&&(O&&this._checkUnique(O),this.refs[O]=Q),w&&this.validateSchema(R,!0),Q}_checkUnique(R){if(this.schemas[R]||this.refs[R])throw new Error(`schema with key or id "${R}" already exists`)}_compileSchemaEnv(R){if(R.meta?this._compileMetaSchema(R):i.compileSchema.call(this,R),!R.validate)throw new Error("ajv implementation error");return R.validate}_compileMetaSchema(R){const M=this.opts;this.opts=this._metaOpts;try{i.compileSchema.call(this,R)}finally{this.opts=M}}}$.ValidationError=n.default,$.MissingRefError=o.default,e.default=$;function p(L,R,M,O="error"){for(const w in L){const E=w;E in R&&this.logger[O](`${M}: option ${w}. ${L[E]}`)}}function b(L){return L=(0,c.normalizeId)(L),this.schemas[L]||this.refs[L]}function S(){const L=this.opts.schemas;if(L)if(Array.isArray(L))this.addSchema(L);else for(const R in L)this.addSchema(L[R],R)}function C(){for(const L in this.opts.formats){const R=this.opts.formats[L];R&&this.addFormat(L,R)}}function z(L){if(Array.isArray(L)){this.addVocabulary(L);return}this.logger.warn("keywords option as map is deprecated, pass array");for(const R in L){const M=L[R];M.keyword||(M.keyword=R),this.addKeyword(M)}}function D(){const L={...this.opts};for(const R of y)delete L[R];return L}const q={log(){},warn(){},error(){}};function V(L){if(L===!1)return q;if(L===void 0)return console;if(L.log&&L.warn&&L.error)return L;throw new Error("logger must implement log, warn and error methods")}const x=/^[a-z_$][a-z0-9_$:-]*$/i;function H(L,R){const{RULES:M}=this;if((0,l.eachItem)(L,O=>{if(M.keywords[O])throw new Error(`Keyword ${O} is already defined`);if(!x.test(O))throw new Error(`Keyword ${O} has invalid name`)}),!!R&&R.$data&&!("code"in R||"validate"in R))throw new Error('$data keyword must have "code" or "validate" function')}function ae(L,R,M){var O;const w=R==null?void 0:R.post;if(M&&w)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:E}=this;let A=w?E.post:E.rules.find(({type:Q})=>Q===M);if(A||(A={type:M,rules:[]},E.rules.push(A)),E.keywords[L]=!0,!R)return;const W={keyword:L,definition:{...R,type:(0,u.getJSONTypes)(R.type),schemaType:(0,u.getJSONTypes)(R.schemaType)}};R.before?Ie.call(this,A,W,R.before):A.rules.push(W),E.all[L]=W,(O=R.implements)===null||O===void 0||O.forEach(Q=>this.addKeyword(Q))}function Ie(L,R,M){const O=L.rules.findIndex(w=>w.keyword===M);O>=0?L.rules.splice(O,0,R):(L.rules.push(R),this.logger.warn(`rule ${M} is not defined`))}function Oe(L){let{metaSchema:R}=L;R!==void 0&&(L.$data&&this.opts.$data&&(R=Fe(R)),L.validateSchema=this.compile(R,!0))}const ue={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function Fe(L){return{anyOf:[L,ue]}}})(gn)),gn}var sr={},ir={},ar={},Ms;function yp(){if(Ms)return ar;Ms=1,Object.defineProperty(ar,"__esModule",{value:!0});const e={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};return ar.default=e,ar}var et={},Us;function wp(){if(Us)return et;Us=1,Object.defineProperty(et,"__esModule",{value:!0}),et.callRef=et.getValidate=void 0;const e=fn(),t=We(),r=te(),n=it(),o=Ao(),s=se(),i={keyword:"$ref",schemaType:"string",code(u){const{gen:l,schema:v,it:_}=u,{baseId:g,schemaEnv:y,validateName:k,opts:f,self:m}=_,{root:d}=y;if((v==="#"||v==="#/")&&g===d.baseId)return $();const h=o.resolveRef.call(m,d,g,v);if(h===void 0)throw new e.default(_.opts.uriResolver,g,v);if(h instanceof o.SchemaEnv)return p(h);return b(h);function $(){if(y===d)return c(u,k,y,y.$async);const S=l.scopeValue("root",{ref:d});return c(u,(0,r._)`${S}.validate`,d,d.$async)}function p(S){const C=a(u,S);c(u,C,S,S.$async)}function b(S){const C=l.scopeValue("schema",f.code.source===!0?{ref:S,code:(0,r.stringify)(S)}:{ref:S}),z=l.name("valid"),D=u.subschema({schema:S,dataTypes:[],schemaPath:r.nil,topSchemaRef:C,errSchemaPath:v},z);u.mergeEvaluated(D),u.ok(z)}}};function a(u,l){const{gen:v}=u;return l.validate?v.scopeValue("validate",{ref:l.validate}):(0,r._)`${v.scopeValue("wrapper",{ref:l})}.validate`}et.getValidate=a;function c(u,l,v,_){const{gen:g,it:y}=u,{allErrors:k,schemaEnv:f,opts:m}=y,d=m.passContext?n.default.this:r.nil;_?h():$();function h(){if(!f.$async)throw new Error("async schema referenced by sync schema");const S=g.let("valid");g.try(()=>{g.code((0,r._)`await ${(0,t.callValidateCode)(u,l,d)}`),b(l),k||g.assign(S,!0)},C=>{g.if((0,r._)`!(${C} instanceof ${y.ValidationError})`,()=>g.throw(C)),p(C),k||g.assign(S,!1)}),u.ok(S)}function $(){u.result((0,t.callValidateCode)(u,l,d),()=>b(l),()=>p(l))}function p(S){const C=(0,r._)`${S}.errors`;g.assign(n.default.vErrors,(0,r._)`${n.default.vErrors} === null ? ${C} : ${n.default.vErrors}.concat(${C})`),g.assign(n.default.errors,(0,r._)`${n.default.vErrors}.length`)}function b(S){var C;if(!y.opts.unevaluated)return;const z=(C=v==null?void 0:v.validate)===null||C===void 0?void 0:C.evaluated;if(y.props!==!0)if(z&&!z.dynamicProps)z.props!==void 0&&(y.props=s.mergeEvaluated.props(g,z.props,y.props));else{const D=g.var("props",(0,r._)`${S}.evaluated.props`);y.props=s.mergeEvaluated.props(g,D,y.props,r.Name)}if(y.items!==!0)if(z&&!z.dynamicItems)z.items!==void 0&&(y.items=s.mergeEvaluated.items(g,z.items,y.items));else{const D=g.var("items",(0,r._)`${S}.evaluated.items`);y.items=s.mergeEvaluated.items(g,D,y.items,r.Name)}}}return et.callRef=c,et.default=i,et}var Ds;function $p(){if(Ds)return ir;Ds=1,Object.defineProperty(ir,"__esModule",{value:!0});const e=yp(),t=wp(),r=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",e.default,t.default];return ir.default=r,ir}var cr={},ur={},Ls;function bp(){if(Ls)return ur;Ls=1,Object.defineProperty(ur,"__esModule",{value:!0});const e=te(),t=e.operators,r={maximum:{okStr:"<=",ok:t.LTE,fail:t.GT},minimum:{okStr:">=",ok:t.GTE,fail:t.LT},exclusiveMaximum:{okStr:"<",ok:t.LT,fail:t.GTE},exclusiveMinimum:{okStr:">",ok:t.GT,fail:t.LTE}},n={message:({keyword:s,schemaCode:i})=>(0,e.str)`must be ${r[s].okStr} ${i}`,params:({keyword:s,schemaCode:i})=>(0,e._)`{comparison: ${r[s].okStr}, limit: ${i}}`},o={keyword:Object.keys(r),type:"number",schemaType:"number",$data:!0,error:n,code(s){const{keyword:i,data:a,schemaCode:c}=s;s.fail$data((0,e._)`${a} ${r[i].fail} ${c} || isNaN(${a})`)}};return ur.default=o,ur}var lr={},Zs;function kp(){if(Zs)return lr;Zs=1,Object.defineProperty(lr,"__esModule",{value:!0});const e=te(),r={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:{message:({schemaCode:n})=>(0,e.str)`must be multiple of ${n}`,params:({schemaCode:n})=>(0,e._)`{multipleOf: ${n}}`},code(n){const{gen:o,data:s,schemaCode:i,it:a}=n,c=a.opts.multipleOfPrecision,u=o.let("res"),l=c?(0,e._)`Math.abs(Math.round(${u}) - ${u}) > 1e-${c}`:(0,e._)`${u} !== parseInt(${u})`;n.fail$data((0,e._)`(${i} === 0 || (${u} = ${s}/${i}, ${l}))`)}};return lr.default=r,lr}var dr={},fr={},Vs;function Sp(){if(Vs)return fr;Vs=1,Object.defineProperty(fr,"__esModule",{value:!0});function e(t){const r=t.length;let n=0,o=0,s;for(;o<r;)n++,s=t.charCodeAt(o++),s>=55296&&s<=56319&&o<r&&(s=t.charCodeAt(o),(s&64512)===56320&&o++);return n}return fr.default=e,e.code='require("ajv/dist/runtime/ucs2length").default',fr}var Fs;function Ep(){if(Fs)return dr;Fs=1,Object.defineProperty(dr,"__esModule",{value:!0});const e=te(),t=se(),r=Sp(),o={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:{message({keyword:s,schemaCode:i}){const a=s==="maxLength"?"more":"fewer";return(0,e.str)`must NOT have ${a} than ${i} characters`},params:({schemaCode:s})=>(0,e._)`{limit: ${s}}`},code(s){const{keyword:i,data:a,schemaCode:c,it:u}=s,l=i==="maxLength"?e.operators.GT:e.operators.LT,v=u.opts.unicode===!1?(0,e._)`${a}.length`:(0,e._)`${(0,t.useFunc)(s.gen,r.default)}(${a})`;s.fail$data((0,e._)`${v} ${l} ${c}`)}};return dr.default=o,dr}var hr={},xs;function Tp(){if(xs)return hr;xs=1,Object.defineProperty(hr,"__esModule",{value:!0});const e=We(),t=te(),n={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:{message:({schemaCode:o})=>(0,t.str)`must match pattern "${o}"`,params:({schemaCode:o})=>(0,t._)`{pattern: ${o}}`},code(o){const{data:s,$data:i,schema:a,schemaCode:c,it:u}=o,l=u.opts.unicodeRegExp?"u":"",v=i?(0,t._)`(new RegExp(${c}, ${l}))`:(0,e.usePattern)(o,a);o.fail$data((0,t._)`!${v}.test(${s})`)}};return hr.default=n,hr}var pr={},Hs;function Pp(){if(Hs)return pr;Hs=1,Object.defineProperty(pr,"__esModule",{value:!0});const e=te(),r={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:{message({keyword:n,schemaCode:o}){const s=n==="maxProperties"?"more":"fewer";return(0,e.str)`must NOT have ${s} than ${o} properties`},params:({schemaCode:n})=>(0,e._)`{limit: ${n}}`},code(n){const{keyword:o,data:s,schemaCode:i}=n,a=o==="maxProperties"?e.operators.GT:e.operators.LT;n.fail$data((0,e._)`Object.keys(${s}).length ${a} ${i}`)}};return pr.default=r,pr}var mr={},Ks;function Rp(){if(Ks)return mr;Ks=1,Object.defineProperty(mr,"__esModule",{value:!0});const e=We(),t=te(),r=se(),o={keyword:"required",type:"object",schemaType:"array",$data:!0,error:{message:({params:{missingProperty:s}})=>(0,t.str)`must have required property '${s}'`,params:({params:{missingProperty:s}})=>(0,t._)`{missingProperty: ${s}}`},code(s){const{gen:i,schema:a,schemaCode:c,data:u,$data:l,it:v}=s,{opts:_}=v;if(!l&&a.length===0)return;const g=a.length>=_.loopRequired;if(v.allErrors?y():k(),_.strictRequired){const d=s.parentSchema.properties,{definedProperties:h}=s.it;for(const $ of a)if((d==null?void 0:d[$])===void 0&&!h.has($)){const p=v.schemaEnv.baseId+v.errSchemaPath,b=`required property "${$}" is not defined at "${p}" (strictRequired)`;(0,r.checkStrictMode)(v,b,v.opts.strictRequired)}}function y(){if(g||l)s.block$data(t.nil,f);else for(const d of a)(0,e.checkReportMissingProp)(s,d)}function k(){const d=i.let("missing");if(g||l){const h=i.let("valid",!0);s.block$data(h,()=>m(d,h)),s.ok(h)}else i.if((0,e.checkMissingProp)(s,a,d)),(0,e.reportMissingProp)(s,d),i.else()}function f(){i.forOf("prop",c,d=>{s.setParams({missingProperty:d}),i.if((0,e.noPropertyInData)(i,u,d,_.ownProperties),()=>s.error())})}function m(d,h){s.setParams({missingProperty:d}),i.forOf(d,c,()=>{i.assign(h,(0,e.propertyInData)(i,u,d,_.ownProperties)),i.if((0,t.not)(h),()=>{s.error(),i.break()})},t.nil)}}};return mr.default=o,mr}var _r={},Ws;function Ip(){if(Ws)return _r;Ws=1,Object.defineProperty(_r,"__esModule",{value:!0});const e=te(),r={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:{message({keyword:n,schemaCode:o}){const s=n==="maxItems"?"more":"fewer";return(0,e.str)`must NOT have ${s} than ${o} items`},params:({schemaCode:n})=>(0,e._)`{limit: ${n}}`},code(n){const{keyword:o,data:s,schemaCode:i}=n,a=o==="maxItems"?e.operators.GT:e.operators.LT;n.fail$data((0,e._)`${s}.length ${a} ${i}`)}};return _r.default=r,_r}var vr={},gr={},Gs;function qo(){if(Gs)return gr;Gs=1,Object.defineProperty(gr,"__esModule",{value:!0});const e=La();return e.code='require("ajv/dist/runtime/equal").default',gr.default=e,gr}var Js;function Op(){if(Js)return vr;Js=1,Object.defineProperty(vr,"__esModule",{value:!0});const e=Wr(),t=te(),r=se(),n=qo(),s={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:{message:({params:{i,j:a}})=>(0,t.str)`must NOT have duplicate items (items ## ${a} and ${i} are identical)`,params:({params:{i,j:a}})=>(0,t._)`{i: ${i}, j: ${a}}`},code(i){const{gen:a,data:c,$data:u,schema:l,parentSchema:v,schemaCode:_,it:g}=i;if(!u&&!l)return;const y=a.let("valid"),k=v.items?(0,e.getSchemaTypes)(v.items):[];i.block$data(y,f,(0,t._)`${_} === false`),i.ok(y);function f(){const $=a.let("i",(0,t._)`${c}.length`),p=a.let("j");i.setParams({i:$,j:p}),a.assign(y,!0),a.if((0,t._)`${$} > 1`,()=>(m()?d:h)($,p))}function m(){return k.length>0&&!k.some($=>$==="object"||$==="array")}function d($,p){const b=a.name("item"),S=(0,e.checkDataTypes)(k,b,g.opts.strictNumbers,e.DataType.Wrong),C=a.const("indices",(0,t._)`{}`);a.for((0,t._)`;${$}--;`,()=>{a.let(b,(0,t._)`${c}[${$}]`),a.if(S,(0,t._)`continue`),k.length>1&&a.if((0,t._)`typeof ${b} == "string"`,(0,t._)`${b} += "_"`),a.if((0,t._)`typeof ${C}[${b}] == "number"`,()=>{a.assign(p,(0,t._)`${C}[${b}]`),i.error(),a.assign(y,!1).break()}).code((0,t._)`${C}[${b}] = ${$}`)})}function h($,p){const b=(0,r.useFunc)(a,n.default),S=a.name("outer");a.label(S).for((0,t._)`;${$}--;`,()=>a.for((0,t._)`${p} = ${$}; ${p}--;`,()=>a.if((0,t._)`${b}(${c}[${$}], ${c}[${p}])`,()=>{i.error(),a.assign(y,!1).break(S)})))}}};return vr.default=s,vr}var yr={},Bs;function Cp(){if(Bs)return yr;Bs=1,Object.defineProperty(yr,"__esModule",{value:!0});const e=te(),t=se(),r=qo(),o={keyword:"const",$data:!0,error:{message:"must be equal to constant",params:({schemaCode:s})=>(0,e._)`{allowedValue: ${s}}`},code(s){const{gen:i,data:a,$data:c,schemaCode:u,schema:l}=s;c||l&&typeof l=="object"?s.fail$data((0,e._)`!${(0,t.useFunc)(i,r.default)}(${a}, ${u})`):s.fail((0,e._)`${l} !== ${a}`)}};return yr.default=o,yr}var wr={},Qs;function Np(){if(Qs)return wr;Qs=1,Object.defineProperty(wr,"__esModule",{value:!0});const e=te(),t=se(),r=qo(),o={keyword:"enum",schemaType:"array",$data:!0,error:{message:"must be equal to one of the allowed values",params:({schemaCode:s})=>(0,e._)`{allowedValues: ${s}}`},code(s){const{gen:i,data:a,$data:c,schema:u,schemaCode:l,it:v}=s;if(!c&&u.length===0)throw new Error("enum must have non-empty array");const _=u.length>=v.opts.loopEnum;let g;const y=()=>g??(g=(0,t.useFunc)(i,r.default));let k;if(_||c)k=i.let("valid"),s.block$data(k,f);else{if(!Array.isArray(u))throw new Error("ajv implementation error");const d=i.const("vSchema",l);k=(0,e.or)(...u.map((h,$)=>m(d,$)))}s.pass(k);function f(){i.assign(k,!1),i.forOf("v",l,d=>i.if((0,e._)`${y()}(${a}, ${d})`,()=>i.assign(k,!0).break()))}function m(d,h){const $=u[h];return typeof $=="object"&&$!==null?(0,e._)`${y()}(${a}, ${d}[${h}])`:(0,e._)`${a} === ${$}`}}};return wr.default=o,wr}var Ys;function zp(){if(Ys)return cr;Ys=1,Object.defineProperty(cr,"__esModule",{value:!0});const e=bp(),t=kp(),r=Ep(),n=Tp(),o=Pp(),s=Rp(),i=Ip(),a=Op(),c=Cp(),u=Np(),l=[e.default,t.default,r.default,n.default,o.default,s.default,i.default,a.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},c.default,u.default];return cr.default=l,cr}var $r={},_t={},Xs;function Va(){if(Xs)return _t;Xs=1,Object.defineProperty(_t,"__esModule",{value:!0}),_t.validateAdditionalItems=void 0;const e=te(),t=se(),n={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:{message:({params:{len:s}})=>(0,e.str)`must NOT have more than ${s} items`,params:({params:{len:s}})=>(0,e._)`{limit: ${s}}`},code(s){const{parentSchema:i,it:a}=s,{items:c}=i;if(!Array.isArray(c)){(0,t.checkStrictMode)(a,'"additionalItems" is ignored when "items" is not an array of schemas');return}o(s,c)}};function o(s,i){const{gen:a,schema:c,data:u,keyword:l,it:v}=s;v.items=!0;const _=a.const("len",(0,e._)`${u}.length`);if(c===!1)s.setParams({len:i.length}),s.pass((0,e._)`${_} <= ${i.length}`);else if(typeof c=="object"&&!(0,t.alwaysValidSchema)(v,c)){const y=a.var("valid",(0,e._)`${_} <= ${i.length}`);a.if((0,e.not)(y),()=>g(y)),s.ok(y)}function g(y){a.forRange("i",i.length,_,k=>{s.subschema({keyword:l,dataProp:k,dataPropType:t.Type.Num},y),v.allErrors||a.if((0,e.not)(y),()=>a.break())})}}return _t.validateAdditionalItems=o,_t.default=n,_t}var br={},vt={},ei;function Fa(){if(ei)return vt;ei=1,Object.defineProperty(vt,"__esModule",{value:!0}),vt.validateTuple=void 0;const e=te(),t=se(),r=We(),n={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(s){const{schema:i,it:a}=s;if(Array.isArray(i))return o(s,"additionalItems",i);a.items=!0,!(0,t.alwaysValidSchema)(a,i)&&s.ok((0,r.validateArray)(s))}};function o(s,i,a=s.schema){const{gen:c,parentSchema:u,data:l,keyword:v,it:_}=s;k(u),_.opts.unevaluated&&a.length&&_.items!==!0&&(_.items=t.mergeEvaluated.items(c,a.length,_.items));const g=c.name("valid"),y=c.const("len",(0,e._)`${l}.length`);a.forEach((f,m)=>{(0,t.alwaysValidSchema)(_,f)||(c.if((0,e._)`${y} > ${m}`,()=>s.subschema({keyword:v,schemaProp:m,dataProp:m},g)),s.ok(g))});function k(f){const{opts:m,errSchemaPath:d}=_,h=a.length,$=h===f.minItems&&(h===f.maxItems||f[i]===!1);if(m.strictTuples&&!$){const p=`"${v}" is ${h}-tuple, but minItems or maxItems/${i} are not specified or different at path "${d}"`;(0,t.checkStrictMode)(_,p,m.strictTuples)}}}return vt.validateTuple=o,vt.default=n,vt}var ti;function Ap(){if(ti)return br;ti=1,Object.defineProperty(br,"__esModule",{value:!0});const e=Fa(),t={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:r=>(0,e.validateTuple)(r,"items")};return br.default=t,br}var kr={},ri;function qp(){if(ri)return kr;ri=1,Object.defineProperty(kr,"__esModule",{value:!0});const e=te(),t=se(),r=We(),n=Va(),s={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:{message:({params:{len:i}})=>(0,e.str)`must NOT have more than ${i} items`,params:({params:{len:i}})=>(0,e._)`{limit: ${i}}`},code(i){const{schema:a,parentSchema:c,it:u}=i,{prefixItems:l}=c;u.items=!0,!(0,t.alwaysValidSchema)(u,a)&&(l?(0,n.validateAdditionalItems)(i,l):i.ok((0,r.validateArray)(i)))}};return kr.default=s,kr}var Sr={},ni;function jp(){if(ni)return Sr;ni=1,Object.defineProperty(Sr,"__esModule",{value:!0});const e=te(),t=se(),n={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:{message:({params:{min:o,max:s}})=>s===void 0?(0,e.str)`must contain at least ${o} valid item(s)`:(0,e.str)`must contain at least ${o} and no more than ${s} valid item(s)`,params:({params:{min:o,max:s}})=>s===void 0?(0,e._)`{minContains: ${o}}`:(0,e._)`{minContains: ${o}, maxContains: ${s}}`},code(o){const{gen:s,schema:i,parentSchema:a,data:c,it:u}=o;let l,v;const{minContains:_,maxContains:g}=a;u.opts.next?(l=_===void 0?1:_,v=g):l=1;const y=s.const("len",(0,e._)`${c}.length`);if(o.setParams({min:l,max:v}),v===void 0&&l===0){(0,t.checkStrictMode)(u,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(v!==void 0&&l>v){(0,t.checkStrictMode)(u,'"minContains" > "maxContains" is always invalid'),o.fail();return}if((0,t.alwaysValidSchema)(u,i)){let h=(0,e._)`${y} >= ${l}`;v!==void 0&&(h=(0,e._)`${h} && ${y} <= ${v}`),o.pass(h);return}u.items=!0;const k=s.name("valid");v===void 0&&l===1?m(k,()=>s.if(k,()=>s.break())):l===0?(s.let(k,!0),v!==void 0&&s.if((0,e._)`${c}.length > 0`,f)):(s.let(k,!1),f()),o.result(k,()=>o.reset());function f(){const h=s.name("_valid"),$=s.let("count",0);m(h,()=>s.if(h,()=>d($)))}function m(h,$){s.forRange("i",0,y,p=>{o.subschema({keyword:"contains",dataProp:p,dataPropType:t.Type.Num,compositeRule:!0},h),$()})}function d(h){s.code((0,e._)`${h}++`),v===void 0?s.if((0,e._)`${h} >= ${l}`,()=>s.assign(k,!0).break()):(s.if((0,e._)`${h} > ${v}`,()=>s.assign(k,!1).break()),l===1?s.assign(k,!0):s.if((0,e._)`${h} >= ${l}`,()=>s.assign(k,!0)))}}};return Sr.default=n,Sr}var Pn={},oi;function Mp(){return oi||(oi=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.validateSchemaDeps=e.validatePropertyDeps=e.error=void 0;const t=te(),r=se(),n=We();e.error={message:({params:{property:c,depsCount:u,deps:l}})=>{const v=u===1?"property":"properties";return(0,t.str)`must have ${v} ${l} when property ${c} is present`},params:({params:{property:c,depsCount:u,deps:l,missingProperty:v}})=>(0,t._)`{property: ${c},
    missingProperty: ${v},
    depsCount: ${u},
    deps: ${l}}`};const o={keyword:"dependencies",type:"object",schemaType:"object",error:e.error,code(c){const[u,l]=s(c);i(c,u),a(c,l)}};function s({schema:c}){const u={},l={};for(const v in c){if(v==="__proto__")continue;const _=Array.isArray(c[v])?u:l;_[v]=c[v]}return[u,l]}function i(c,u=c.schema){const{gen:l,data:v,it:_}=c;if(Object.keys(u).length===0)return;const g=l.let("missing");for(const y in u){const k=u[y];if(k.length===0)continue;const f=(0,n.propertyInData)(l,v,y,_.opts.ownProperties);c.setParams({property:y,depsCount:k.length,deps:k.join(", ")}),_.allErrors?l.if(f,()=>{for(const m of k)(0,n.checkReportMissingProp)(c,m)}):(l.if((0,t._)`${f} && (${(0,n.checkMissingProp)(c,k,g)})`),(0,n.reportMissingProp)(c,g),l.else())}}e.validatePropertyDeps=i;function a(c,u=c.schema){const{gen:l,data:v,keyword:_,it:g}=c,y=l.name("valid");for(const k in u)(0,r.alwaysValidSchema)(g,u[k])||(l.if((0,n.propertyInData)(l,v,k,g.opts.ownProperties),()=>{const f=c.subschema({keyword:_,schemaProp:k},y);c.mergeValidEvaluated(f,y)},()=>l.var(y,!0)),c.ok(y))}e.validateSchemaDeps=a,e.default=o})(Pn)),Pn}var Er={},si;function Up(){if(si)return Er;si=1,Object.defineProperty(Er,"__esModule",{value:!0});const e=te(),t=se(),n={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:{message:"property name must be valid",params:({params:o})=>(0,e._)`{propertyName: ${o.propertyName}}`},code(o){const{gen:s,schema:i,data:a,it:c}=o;if((0,t.alwaysValidSchema)(c,i))return;const u=s.name("valid");s.forIn("key",a,l=>{o.setParams({propertyName:l}),o.subschema({keyword:"propertyNames",data:l,dataTypes:["string"],propertyName:l,compositeRule:!0},u),s.if((0,e.not)(u),()=>{o.error(!0),c.allErrors||s.break()})}),o.ok(u)}};return Er.default=n,Er}var Tr={},ii;function xa(){if(ii)return Tr;ii=1,Object.defineProperty(Tr,"__esModule",{value:!0});const e=We(),t=te(),r=it(),n=se(),s={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:{message:"must NOT have additional properties",params:({params:i})=>(0,t._)`{additionalProperty: ${i.additionalProperty}}`},code(i){const{gen:a,schema:c,parentSchema:u,data:l,errsCount:v,it:_}=i;if(!v)throw new Error("ajv implementation error");const{allErrors:g,opts:y}=_;if(_.props=!0,y.removeAdditional!=="all"&&(0,n.alwaysValidSchema)(_,c))return;const k=(0,e.allSchemaProperties)(u.properties),f=(0,e.allSchemaProperties)(u.patternProperties);m(),i.ok((0,t._)`${v} === ${r.default.errors}`);function m(){a.forIn("key",l,b=>{!k.length&&!f.length?$(b):a.if(d(b),()=>$(b))})}function d(b){let S;if(k.length>8){const C=(0,n.schemaRefOrVal)(_,u.properties,"properties");S=(0,e.isOwnProperty)(a,C,b)}else k.length?S=(0,t.or)(...k.map(C=>(0,t._)`${b} === ${C}`)):S=t.nil;return f.length&&(S=(0,t.or)(S,...f.map(C=>(0,t._)`${(0,e.usePattern)(i,C)}.test(${b})`))),(0,t.not)(S)}function h(b){a.code((0,t._)`delete ${l}[${b}]`)}function $(b){if(y.removeAdditional==="all"||y.removeAdditional&&c===!1){h(b);return}if(c===!1){i.setParams({additionalProperty:b}),i.error(),g||a.break();return}if(typeof c=="object"&&!(0,n.alwaysValidSchema)(_,c)){const S=a.name("valid");y.removeAdditional==="failing"?(p(b,S,!1),a.if((0,t.not)(S),()=>{i.reset(),h(b)})):(p(b,S),g||a.if((0,t.not)(S),()=>a.break()))}}function p(b,S,C){const z={keyword:"additionalProperties",dataProp:b,dataPropType:n.Type.Str};C===!1&&Object.assign(z,{compositeRule:!0,createErrors:!1,allErrors:!1}),i.subschema(z,S)}}};return Tr.default=s,Tr}var Pr={},ai;function Dp(){if(ai)return Pr;ai=1,Object.defineProperty(Pr,"__esModule",{value:!0});const e=dn(),t=We(),r=se(),n=xa(),o={keyword:"properties",type:"object",schemaType:"object",code(s){const{gen:i,schema:a,parentSchema:c,data:u,it:l}=s;l.opts.removeAdditional==="all"&&c.additionalProperties===void 0&&n.default.code(new e.KeywordCxt(l,n.default,"additionalProperties"));const v=(0,t.allSchemaProperties)(a);for(const f of v)l.definedProperties.add(f);l.opts.unevaluated&&v.length&&l.props!==!0&&(l.props=r.mergeEvaluated.props(i,(0,r.toHash)(v),l.props));const _=v.filter(f=>!(0,r.alwaysValidSchema)(l,a[f]));if(_.length===0)return;const g=i.name("valid");for(const f of _)y(f)?k(f):(i.if((0,t.propertyInData)(i,u,f,l.opts.ownProperties)),k(f),l.allErrors||i.else().var(g,!0),i.endIf()),s.it.definedProperties.add(f),s.ok(g);function y(f){return l.opts.useDefaults&&!l.compositeRule&&a[f].default!==void 0}function k(f){s.subschema({keyword:"properties",schemaProp:f,dataProp:f},g)}}};return Pr.default=o,Pr}var Rr={},ci;function Lp(){if(ci)return Rr;ci=1,Object.defineProperty(Rr,"__esModule",{value:!0});const e=We(),t=te(),r=se(),n=se(),o={keyword:"patternProperties",type:"object",schemaType:"object",code(s){const{gen:i,schema:a,data:c,parentSchema:u,it:l}=s,{opts:v}=l,_=(0,e.allSchemaProperties)(a),g=_.filter($=>(0,r.alwaysValidSchema)(l,a[$]));if(_.length===0||g.length===_.length&&(!l.opts.unevaluated||l.props===!0))return;const y=v.strictSchema&&!v.allowMatchingProperties&&u.properties,k=i.name("valid");l.props!==!0&&!(l.props instanceof t.Name)&&(l.props=(0,n.evaluatedPropsToName)(i,l.props));const{props:f}=l;m();function m(){for(const $ of _)y&&d($),l.allErrors?h($):(i.var(k,!0),h($),i.if(k))}function d($){for(const p in y)new RegExp($).test(p)&&(0,r.checkStrictMode)(l,`property ${p} matches pattern ${$} (use allowMatchingProperties)`)}function h($){i.forIn("key",c,p=>{i.if((0,t._)`${(0,e.usePattern)(s,$)}.test(${p})`,()=>{const b=g.includes($);b||s.subschema({keyword:"patternProperties",schemaProp:$,dataProp:p,dataPropType:n.Type.Str},k),l.opts.unevaluated&&f!==!0?i.assign((0,t._)`${f}[${p}]`,!0):!b&&!l.allErrors&&i.if((0,t.not)(k),()=>i.break())})})}}};return Rr.default=o,Rr}var Ir={},ui;function Zp(){if(ui)return Ir;ui=1,Object.defineProperty(Ir,"__esModule",{value:!0});const e=se(),t={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(r){const{gen:n,schema:o,it:s}=r;if((0,e.alwaysValidSchema)(s,o)){r.fail();return}const i=n.name("valid");r.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},i),r.failResult(i,()=>r.reset(),()=>r.error())},error:{message:"must NOT be valid"}};return Ir.default=t,Ir}var Or={},li;function Vp(){if(li)return Or;li=1,Object.defineProperty(Or,"__esModule",{value:!0});const t={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:We().validateUnion,error:{message:"must match a schema in anyOf"}};return Or.default=t,Or}var Cr={},di;function Fp(){if(di)return Cr;di=1,Object.defineProperty(Cr,"__esModule",{value:!0});const e=te(),t=se(),n={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:{message:"must match exactly one schema in oneOf",params:({params:o})=>(0,e._)`{passingSchemas: ${o.passing}}`},code(o){const{gen:s,schema:i,parentSchema:a,it:c}=o;if(!Array.isArray(i))throw new Error("ajv implementation error");if(c.opts.discriminator&&a.discriminator)return;const u=i,l=s.let("valid",!1),v=s.let("passing",null),_=s.name("_valid");o.setParams({passing:v}),s.block(g),o.result(l,()=>o.reset(),()=>o.error(!0));function g(){u.forEach((y,k)=>{let f;(0,t.alwaysValidSchema)(c,y)?s.var(_,!0):f=o.subschema({keyword:"oneOf",schemaProp:k,compositeRule:!0},_),k>0&&s.if((0,e._)`${_} && ${l}`).assign(l,!1).assign(v,(0,e._)`[${v}, ${k}]`).else(),s.if(_,()=>{s.assign(l,!0),s.assign(v,k),f&&o.mergeEvaluated(f,e.Name)})})}}};return Cr.default=n,Cr}var Nr={},fi;function xp(){if(fi)return Nr;fi=1,Object.defineProperty(Nr,"__esModule",{value:!0});const e=se(),t={keyword:"allOf",schemaType:"array",code(r){const{gen:n,schema:o,it:s}=r;if(!Array.isArray(o))throw new Error("ajv implementation error");const i=n.name("valid");o.forEach((a,c)=>{if((0,e.alwaysValidSchema)(s,a))return;const u=r.subschema({keyword:"allOf",schemaProp:c},i);r.ok(i),r.mergeEvaluated(u)})}};return Nr.default=t,Nr}var zr={},hi;function Hp(){if(hi)return zr;hi=1,Object.defineProperty(zr,"__esModule",{value:!0});const e=te(),t=se(),n={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:{message:({params:s})=>(0,e.str)`must match "${s.ifClause}" schema`,params:({params:s})=>(0,e._)`{failingKeyword: ${s.ifClause}}`},code(s){const{gen:i,parentSchema:a,it:c}=s;a.then===void 0&&a.else===void 0&&(0,t.checkStrictMode)(c,'"if" without "then" and "else" is ignored');const u=o(c,"then"),l=o(c,"else");if(!u&&!l)return;const v=i.let("valid",!0),_=i.name("_valid");if(g(),s.reset(),u&&l){const k=i.let("ifClause");s.setParams({ifClause:k}),i.if(_,y("then",k),y("else",k))}else u?i.if(_,y("then")):i.if((0,e.not)(_),y("else"));s.pass(v,()=>s.error(!0));function g(){const k=s.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},_);s.mergeEvaluated(k)}function y(k,f){return()=>{const m=s.subschema({keyword:k},_);i.assign(v,_),s.mergeValidEvaluated(m,v),f?i.assign(f,(0,e._)`${k}`):s.setParams({ifClause:k})}}}};function o(s,i){const a=s.schema[i];return a!==void 0&&!(0,t.alwaysValidSchema)(s,a)}return zr.default=n,zr}var Ar={},pi;function Kp(){if(pi)return Ar;pi=1,Object.defineProperty(Ar,"__esModule",{value:!0});const e=se(),t={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:r,parentSchema:n,it:o}){n.if===void 0&&(0,e.checkStrictMode)(o,`"${r}" without "if" is ignored`)}};return Ar.default=t,Ar}var mi;function Wp(){if(mi)return $r;mi=1,Object.defineProperty($r,"__esModule",{value:!0});const e=Va(),t=Ap(),r=Fa(),n=qp(),o=jp(),s=Mp(),i=Up(),a=xa(),c=Dp(),u=Lp(),l=Zp(),v=Vp(),_=Fp(),g=xp(),y=Hp(),k=Kp();function f(m=!1){const d=[l.default,v.default,_.default,g.default,y.default,k.default,i.default,a.default,s.default,c.default,u.default];return m?d.push(t.default,n.default):d.push(e.default,r.default),d.push(o.default),d}return $r.default=f,$r}var qr={},jr={},_i;function Gp(){if(_i)return jr;_i=1,Object.defineProperty(jr,"__esModule",{value:!0});const e=te(),r={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:{message:({schemaCode:n})=>(0,e.str)`must match format "${n}"`,params:({schemaCode:n})=>(0,e._)`{format: ${n}}`},code(n,o){const{gen:s,data:i,$data:a,schema:c,schemaCode:u,it:l}=n,{opts:v,errSchemaPath:_,schemaEnv:g,self:y}=l;if(!v.validateFormats)return;a?k():f();function k(){const m=s.scopeValue("formats",{ref:y.formats,code:v.code.formats}),d=s.const("fDef",(0,e._)`${m}[${u}]`),h=s.let("fType"),$=s.let("format");s.if((0,e._)`typeof ${d} == "object" && !(${d} instanceof RegExp)`,()=>s.assign(h,(0,e._)`${d}.type || "string"`).assign($,(0,e._)`${d}.validate`),()=>s.assign(h,(0,e._)`"string"`).assign($,d)),n.fail$data((0,e.or)(p(),b()));function p(){return v.strictSchema===!1?e.nil:(0,e._)`${u} && !${$}`}function b(){const S=g.$async?(0,e._)`(${d}.async ? await ${$}(${i}) : ${$}(${i}))`:(0,e._)`${$}(${i})`,C=(0,e._)`(typeof ${$} == "function" ? ${S} : ${$}.test(${i}))`;return(0,e._)`${$} && ${$} !== true && ${h} === ${o} && !${C}`}}function f(){const m=y.formats[c];if(!m){p();return}if(m===!0)return;const[d,h,$]=b(m);d===o&&n.pass(S());function p(){if(v.strictSchema===!1){y.logger.warn(C());return}throw new Error(C());function C(){return`unknown format "${c}" ignored in schema at path "${_}"`}}function b(C){const z=C instanceof RegExp?(0,e.regexpCode)(C):v.code.formats?(0,e._)`${v.code.formats}${(0,e.getProperty)(c)}`:void 0,D=s.scopeValue("formats",{key:c,ref:C,code:z});return typeof C=="object"&&!(C instanceof RegExp)?[C.type||"string",C.validate,(0,e._)`${D}.validate`]:["string",C,D]}function S(){if(typeof m=="object"&&!(m instanceof RegExp)&&m.async){if(!g.$async)throw new Error("async format in sync schema");return(0,e._)`await ${$}(${i})`}return typeof h=="function"?(0,e._)`${$}(${i})`:(0,e._)`${$}.test(${i})`}}}};return jr.default=r,jr}var vi;function Jp(){if(vi)return qr;vi=1,Object.defineProperty(qr,"__esModule",{value:!0});const t=[Gp().default];return qr.default=t,qr}var lt={},gi;function Bp(){return gi||(gi=1,Object.defineProperty(lt,"__esModule",{value:!0}),lt.contentVocabulary=lt.metadataVocabulary=void 0,lt.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"],lt.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]),lt}var yi;function Qp(){if(yi)return sr;yi=1,Object.defineProperty(sr,"__esModule",{value:!0});const e=$p(),t=zp(),r=Wp(),n=Jp(),o=Bp(),s=[e.default,t.default,(0,r.default)(),n.default,o.metadataVocabulary,o.contentVocabulary];return sr.default=s,sr}var Mr={},qt={},wi;function Yp(){if(wi)return qt;wi=1,Object.defineProperty(qt,"__esModule",{value:!0}),qt.DiscrError=void 0;var e;return(function(t){t.Tag="tag",t.Mapping="mapping"})(e||(qt.DiscrError=e={})),qt}var $i;function Xp(){if($i)return Mr;$i=1,Object.defineProperty(Mr,"__esModule",{value:!0});const e=te(),t=Yp(),r=Ao(),n=fn(),o=se(),i={keyword:"discriminator",type:"object",schemaType:"object",error:{message:({params:{discrError:a,tagName:c}})=>a===t.DiscrError.Tag?`tag "${c}" must be string`:`value of tag "${c}" must be in oneOf`,params:({params:{discrError:a,tag:c,tagName:u}})=>(0,e._)`{error: ${a}, tag: ${u}, tagValue: ${c}}`},code(a){const{gen:c,data:u,schema:l,parentSchema:v,it:_}=a,{oneOf:g}=v;if(!_.opts.discriminator)throw new Error("discriminator: requires discriminator option");const y=l.propertyName;if(typeof y!="string")throw new Error("discriminator: requires propertyName");if(l.mapping)throw new Error("discriminator: mapping is not supported");if(!g)throw new Error("discriminator: requires oneOf keyword");const k=c.let("valid",!1),f=c.const("tag",(0,e._)`${u}${(0,e.getProperty)(y)}`);c.if((0,e._)`typeof ${f} == "string"`,()=>m(),()=>a.error(!1,{discrError:t.DiscrError.Tag,tag:f,tagName:y})),a.ok(k);function m(){const $=h();c.if(!1);for(const p in $)c.elseIf((0,e._)`${f} === ${p}`),c.assign(k,d($[p]));c.else(),a.error(!1,{discrError:t.DiscrError.Mapping,tag:f,tagName:y}),c.endIf()}function d($){const p=c.name("valid"),b=a.subschema({keyword:"oneOf",schemaProp:$},p);return a.mergeEvaluated(b,e.Name),p}function h(){var $;const p={},b=C(v);let S=!0;for(let q=0;q<g.length;q++){let V=g[q];if(V!=null&&V.$ref&&!(0,o.schemaHasRulesButRef)(V,_.self.RULES)){const H=V.$ref;if(V=r.resolveRef.call(_.self,_.schemaEnv.root,_.baseId,H),V instanceof r.SchemaEnv&&(V=V.schema),V===void 0)throw new n.default(_.opts.uriResolver,_.baseId,H)}const x=($=V==null?void 0:V.properties)===null||$===void 0?void 0:$[y];if(typeof x!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${y}"`);S=S&&(b||C(V)),z(x,q)}if(!S)throw new Error(`discriminator: "${y}" must be required`);return p;function C({required:q}){return Array.isArray(q)&&q.includes(y)}function z(q,V){if(q.const)D(q.const,V);else if(q.enum)for(const x of q.enum)D(x,V);else throw new Error(`discriminator: "properties/${y}" must have "const" or "enum"`)}function D(q,V){if(typeof q!="string"||q in p)throw new Error(`discriminator: "${y}" values must be unique strings`);p[q]=V}}}};return Mr.default=i,Mr}const em="http://json-schema.org/draft-07/schema#",tm="http://json-schema.org/draft-07/schema#",rm="Core schema meta-schema",nm={schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},om=["object","boolean"],sm={$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},im={$schema:em,$id:tm,title:rm,definitions:nm,type:om,properties:sm,default:!0};var bi;function Ha(){return bi||(bi=1,(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MissingRefError=t.ValidationError=t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=t.Ajv=void 0;const r=gp(),n=Qp(),o=Xp(),s=im,i=["/properties"],a="http://json-schema.org/draft-07/schema";class c extends r.default{_addVocabularies(){super._addVocabularies(),n.default.forEach(y=>this.addVocabulary(y)),this.opts.discriminator&&this.addKeyword(o.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;const y=this.opts.$data?this.$dataMetaSchema(s,i):s;this.addMetaSchema(y,a,!1),this.refs["http://json-schema.org/schema"]=a}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(a)?a:void 0)}}t.Ajv=c,e.exports=t=c,e.exports.Ajv=c,Object.defineProperty(t,"__esModule",{value:!0}),t.default=c;var u=dn();Object.defineProperty(t,"KeywordCxt",{enumerable:!0,get:function(){return u.KeywordCxt}});var l=te();Object.defineProperty(t,"_",{enumerable:!0,get:function(){return l._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return l.str}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return l.stringify}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return l.nil}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return l.Name}}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:function(){return l.CodeGen}});var v=zo();Object.defineProperty(t,"ValidationError",{enumerable:!0,get:function(){return v.default}});var _=fn();Object.defineProperty(t,"MissingRefError",{enumerable:!0,get:function(){return _.default}})})(er,er.exports)),er.exports}var am=Ha(),Ur={exports:{}},Rn={},ki;function cm(){return ki||(ki=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.formatNames=e.fastFormats=e.fullFormats=void 0;function t(q,V){return{validate:q,compare:V}}e.fullFormats={date:t(s,i),time:t(c(!0),u),"date-time":t(_(!0),g),"iso-time":t(c(),l),"iso-date-time":t(_(),y),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:m,"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:D,uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:h,int32:{type:"number",validate:b},int64:{type:"number",validate:S},float:{type:"number",validate:C},double:{type:"number",validate:C},password:!0,binary:!0},e.fastFormats={...e.fullFormats,date:t(/^\d\d\d\d-[0-1]\d-[0-3]\d$/,i),time:t(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,u),"date-time":t(/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,g),"iso-time":t(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,l),"iso-date-time":t(/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,y),uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i},e.formatNames=Object.keys(e.fullFormats);function r(q){return q%4===0&&(q%100!==0||q%400===0)}const n=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,o=[0,31,28,31,30,31,30,31,31,30,31,30,31];function s(q){const V=n.exec(q);if(!V)return!1;const x=+V[1],H=+V[2],ae=+V[3];return H>=1&&H<=12&&ae>=1&&ae<=(H===2&&r(x)?29:o[H])}function i(q,V){if(q&&V)return q>V?1:q<V?-1:0}const a=/^(\d\d):(\d\d):(\d\d(?:\.\d+)?)(z|([+-])(\d\d)(?::?(\d\d))?)?$/i;function c(q){return function(x){const H=a.exec(x);if(!H)return!1;const ae=+H[1],Ie=+H[2],Oe=+H[3],ue=H[4],Fe=H[5]==="-"?-1:1,L=+(H[6]||0),R=+(H[7]||0);if(L>23||R>59||q&&!ue)return!1;if(ae<=23&&Ie<=59&&Oe<60)return!0;const M=Ie-R*Fe,O=ae-L*Fe-(M<0?1:0);return(O===23||O===-1)&&(M===59||M===-1)&&Oe<61}}function u(q,V){if(!(q&&V))return;const x=new Date("2020-01-01T"+q).valueOf(),H=new Date("2020-01-01T"+V).valueOf();if(x&&H)return x-H}function l(q,V){if(!(q&&V))return;const x=a.exec(q),H=a.exec(V);if(x&&H)return q=x[1]+x[2]+x[3],V=H[1]+H[2]+H[3],q>V?1:q<V?-1:0}const v=/t|\s/i;function _(q){const V=c(q);return function(H){const ae=H.split(v);return ae.length===2&&s(ae[0])&&V(ae[1])}}function g(q,V){if(!(q&&V))return;const x=new Date(q).valueOf(),H=new Date(V).valueOf();if(x&&H)return x-H}function y(q,V){if(!(q&&V))return;const[x,H]=q.split(v),[ae,Ie]=V.split(v),Oe=i(x,ae);if(Oe!==void 0)return Oe||u(H,Ie)}const k=/\/|:/,f=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;function m(q){return k.test(q)&&f.test(q)}const d=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm;function h(q){return d.lastIndex=0,d.test(q)}const $=-2147483648,p=2**31-1;function b(q){return Number.isInteger(q)&&q<=p&&q>=$}function S(q){return Number.isInteger(q)}function C(){return!0}const z=/[^\\]\\Z/;function D(q){if(z.test(q))return!1;try{return new RegExp(q),!0}catch{return!1}}})(Rn)),Rn}var In={},Si;function um(){return Si||(Si=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.formatLimitDefinition=void 0;const t=Ha(),r=te(),n=r.operators,o={formatMaximum:{okStr:"<=",ok:n.LTE,fail:n.GT},formatMinimum:{okStr:">=",ok:n.GTE,fail:n.LT},formatExclusiveMaximum:{okStr:"<",ok:n.LT,fail:n.GTE},formatExclusiveMinimum:{okStr:">",ok:n.GT,fail:n.LTE}},s={message:({keyword:a,schemaCode:c})=>(0,r.str)`should be ${o[a].okStr} ${c}`,params:({keyword:a,schemaCode:c})=>(0,r._)`{comparison: ${o[a].okStr}, limit: ${c}}`};e.formatLimitDefinition={keyword:Object.keys(o),type:"string",schemaType:"string",$data:!0,error:s,code(a){const{gen:c,data:u,schemaCode:l,keyword:v,it:_}=a,{opts:g,self:y}=_;if(!g.validateFormats)return;const k=new t.KeywordCxt(_,y.RULES.all.format.definition,"format");k.$data?f():m();function f(){const h=c.scopeValue("formats",{ref:y.formats,code:g.code.formats}),$=c.const("fmt",(0,r._)`${h}[${k.schemaCode}]`);a.fail$data((0,r.or)((0,r._)`typeof ${$} != "object"`,(0,r._)`${$} instanceof RegExp`,(0,r._)`typeof ${$}.compare != "function"`,d($)))}function m(){const h=k.schema,$=y.formats[h];if(!$||$===!0)return;if(typeof $!="object"||$ instanceof RegExp||typeof $.compare!="function")throw new Error(`"${v}": format "${h}" does not define "compare" function`);const p=c.scopeValue("formats",{key:h,ref:$,code:g.code.formats?(0,r._)`${g.code.formats}${(0,r.getProperty)(h)}`:void 0});a.fail$data(d(p))}function d(h){return(0,r._)`${h}.compare(${u}, ${l}) ${o[v].fail} 0`}},dependencies:["format"]};const i=a=>(a.addKeyword(e.formatLimitDefinition),a);e.default=i})(In)),In}var Ei;function lm(){return Ei||(Ei=1,(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const r=cm(),n=um(),o=te(),s=new o.Name("fullFormats"),i=new o.Name("fastFormats"),a=(u,l={keywords:!0})=>{if(Array.isArray(l))return c(u,l,r.fullFormats,s),u;const[v,_]=l.mode==="fast"?[r.fastFormats,i]:[r.fullFormats,s],g=l.formats||r.formatNames;return c(u,g,v,_),l.keywords&&(0,n.default)(u),u};a.get=(u,l="full")=>{const _=(l==="fast"?r.fastFormats:r.fullFormats)[u];if(!_)throw new Error(`Unknown format "${u}"`);return _};function c(u,l,v,_){var g,y;(g=(y=u.opts.code).formats)!==null&&g!==void 0||(y.formats=(0,o._)`require("ajv-formats/dist/formats").${_}`);for(const k of l)u.addFormat(k,v[k])}e.exports=t=a,Object.defineProperty(t,"__esModule",{value:!0}),t.default=a})(Ur,Ur.exports)),Ur.exports}var dm=lm();const fm=rp(dm);function hm(){const e=new am.Ajv({strict:!1,validateFormats:!0,validateSchema:!1,allErrors:!0});return fm(e),e}class pm{constructor(t){this._ajv=t??hm()}getValidator(t){var r;const n="$id"in t&&typeof t.$id=="string"?(r=this._ajv.getSchema(t.$id))!==null&&r!==void 0?r:this._ajv.compile(t):this._ajv.compile(t);return o=>n(o)?{valid:!0,data:o,errorMessage:void 0}:{valid:!1,data:void 0,errorMessage:this._ajv.errorsText(n.errors)}}}class mm{constructor(t){this._client=t}async*callToolStream(t,r=cn,n){var o;const s=this._client,i={...n,task:(o=n==null?void 0:n.task)!==null&&o!==void 0?o:s.isToolTask(t.name)?{}:void 0},a=s.requestStream({method:"tools/call",params:t},r,i),c=s.getToolOutputValidator(t.name);for await(const u of a){if(u.type==="result"&&c){const l=u.result;if(!l.structuredContent&&!l.isError){yield{type:"error",error:new Y(X.InvalidRequest,`Tool ${t.name} has an output schema but did not return structured content`)};return}if(l.structuredContent)try{const v=c(l.structuredContent);if(!v.valid){yield{type:"error",error:new Y(X.InvalidParams,`Structured content does not match the tool's output schema: ${v.errorMessage}`)};return}}catch(v){if(v instanceof Y){yield{type:"error",error:v};return}yield{type:"error",error:new Y(X.InvalidParams,`Failed to validate structured content: ${v instanceof Error?v.message:String(v)}`)};return}}yield u}}async getTask(t,r){return this._client.getTask({taskId:t},r)}async getTaskResult(t,r,n){return this._client.getTaskResult({taskId:t},r,n)}async listTasks(t,r){return this._client.listTasks(t?{cursor:t}:void 0,r)}async cancelTask(t,r){return this._client.cancelTask({taskId:t},r)}requestStream(t,r,n){return this._client.requestStream(t,r,n)}}function _m(e,t,r){var n;if(!e)throw new Error(`${r} does not support task creation (required for ${t})`);switch(t){case"tools/call":if(!(!((n=e.tools)===null||n===void 0)&&n.call))throw new Error(`${r} does not support task creation for tools/call (required for ${t})`);break}}function vm(e,t,r){var n,o;if(!e)throw new Error(`${r} does not support task creation (required for ${t})`);switch(t){case"sampling/createMessage":if(!(!((n=e.sampling)===null||n===void 0)&&n.createMessage))throw new Error(`${r} does not support task creation for sampling/createMessage (required for ${t})`);break;case"elicitation/create":if(!(!((o=e.elicitation)===null||o===void 0)&&o.create))throw new Error(`${r} does not support task creation for elicitation/create (required for ${t})`);break}}function Dr(e,t){if(!(!e||t===null||typeof t!="object")){if(e.type==="object"&&e.properties&&typeof e.properties=="object"){const r=t,n=e.properties;for(const o of Object.keys(n)){const s=n[o];r[o]===void 0&&Object.prototype.hasOwnProperty.call(s,"default")&&(r[o]=s.default),r[o]!==void 0&&Dr(s,r[o])}}if(Array.isArray(e.anyOf))for(const r of e.anyOf)Dr(r,t);if(Array.isArray(e.oneOf))for(const r of e.oneOf)Dr(r,t)}}function gm(e){if(!e)return{supportsFormMode:!1,supportsUrlMode:!1};const t=e.form!==void 0,r=e.url!==void 0;return{supportsFormMode:t||!t&&!r,supportsUrlMode:r}}class ym extends ep{constructor(t,r){var n,o;super(r),this._clientInfo=t,this._cachedToolOutputValidators=new Map,this._cachedKnownTaskTools=new Set,this._cachedRequiredTaskTools=new Set,this._capabilities=(n=r==null?void 0:r.capabilities)!==null&&n!==void 0?n:{},this._jsonSchemaValidator=(o=r==null?void 0:r.jsonSchemaValidator)!==null&&o!==void 0?o:new pm}get experimental(){return this._experimental||(this._experimental={tasks:new mm(this)}),this._experimental}registerCapabilities(t){if(this.transport)throw new Error("Cannot register capabilities after connecting to transport");this._capabilities=tp(this._capabilities,t)}setRequestHandler(t,r){var n,o,s;const i=ta(t),a=i==null?void 0:i.method;if(!a)throw new Error("Schema is missing a method literal");let c;if(nn(a)){const l=a,v=(n=l._zod)===null||n===void 0?void 0:n.def;c=(o=v==null?void 0:v.value)!==null&&o!==void 0?o:l.value}else{const l=a,v=l._def;c=(s=v==null?void 0:v.value)!==null&&s!==void 0?s:l.value}if(typeof c!="string")throw new Error("Schema method literal must be a string");const u=c;if(u==="elicitation/create"){const l=async(v,_)=>{var g,y,k;const f=tt(qa,v);if(!f.success){const z=f.error instanceof Error?f.error.message:String(f.error);throw new Y(X.InvalidParams,`Invalid elicitation request: ${z}`)}const{params:m}=f.data,d=(g=m.mode)!==null&&g!==void 0?g:"form",{supportsFormMode:h,supportsUrlMode:$}=gm(this._capabilities.elicitation);if(d==="form"&&!h)throw new Y(X.InvalidParams,"Client does not support form-mode elicitation requests");if(d==="url"&&!$)throw new Y(X.InvalidParams,"Client does not support URL-mode elicitation requests");const p=await Promise.resolve(r(v,_));if(m.task){const z=tt(xt,p);if(!z.success){const D=z.error instanceof Error?z.error.message:String(z.error);throw new Y(X.InvalidParams,`Invalid task creation result: ${D}`)}return z.data}const b=tt(ja,p);if(!b.success){const z=b.error instanceof Error?b.error.message:String(b.error);throw new Y(X.InvalidParams,`Invalid elicitation result: ${z}`)}const S=b.data,C=d==="form"?m.requestedSchema:void 0;if(d==="form"&&S.action==="accept"&&S.content&&C&&!((k=(y=this._capabilities.elicitation)===null||y===void 0?void 0:y.form)===null||k===void 0)&&k.applyDefaults)try{Dr(C,S.content)}catch{}return S};return super.setRequestHandler(t,l)}if(u==="sampling/createMessage"){const l=async(v,_)=>{const g=tt(za,v);if(!g.success){const m=g.error instanceof Error?g.error.message:String(g.error);throw new Y(X.InvalidParams,`Invalid sampling request: ${m}`)}const{params:y}=g.data,k=await Promise.resolve(r(v,_));if(y.task){const m=tt(xt,k);if(!m.success){const d=m.error instanceof Error?m.error.message:String(m.error);throw new Y(X.InvalidParams,`Invalid task creation result: ${d}`)}return m.data}const f=tt(Aa,k);if(!f.success){const m=f.error instanceof Error?f.error.message:String(f.error);throw new Y(X.InvalidParams,`Invalid sampling result: ${m}`)}return f.data};return super.setRequestHandler(t,l)}return super.setRequestHandler(t,r)}assertCapability(t,r){var n;if(!(!((n=this._serverCapabilities)===null||n===void 0)&&n[t]))throw new Error(`Server does not support ${t} (required for ${r})`)}async connect(t,r){if(await super.connect(t),t.sessionId===void 0)try{const n=await this.request({method:"initialize",params:{protocolVersion:on,capabilities:this._capabilities,clientInfo:this._clientInfo}},wa,r);if(n===void 0)throw new Error(`Server sent invalid initialize result: ${n}`);if(!gf.includes(n.protocolVersion))throw new Error(`Server's protocol version is not supported: ${n.protocolVersion}`);this._serverCapabilities=n.capabilities,this._serverVersion=n.serverInfo,t.setProtocolVersion&&t.setProtocolVersion(n.protocolVersion),this._instructions=n.instructions,await this.notification({method:"notifications/initialized"})}catch(n){throw this.close(),n}}getServerCapabilities(){return this._serverCapabilities}getServerVersion(){return this._serverVersion}getInstructions(){return this._instructions}assertCapabilityForMethod(t){var r,n,o,s,i;switch(t){case"logging/setLevel":if(!(!((r=this._serverCapabilities)===null||r===void 0)&&r.logging))throw new Error(`Server does not support logging (required for ${t})`);break;case"prompts/get":case"prompts/list":if(!(!((n=this._serverCapabilities)===null||n===void 0)&&n.prompts))throw new Error(`Server does not support prompts (required for ${t})`);break;case"resources/list":case"resources/templates/list":case"resources/read":case"resources/subscribe":case"resources/unsubscribe":if(!(!((o=this._serverCapabilities)===null||o===void 0)&&o.resources))throw new Error(`Server does not support resources (required for ${t})`);if(t==="resources/subscribe"&&!this._serverCapabilities.resources.subscribe)throw new Error(`Server does not support resource subscriptions (required for ${t})`);break;case"tools/call":case"tools/list":if(!(!((s=this._serverCapabilities)===null||s===void 0)&&s.tools))throw new Error(`Server does not support tools (required for ${t})`);break;case"completion/complete":if(!(!((i=this._serverCapabilities)===null||i===void 0)&&i.completions))throw new Error(`Server does not support completions (required for ${t})`);break}}assertNotificationCapability(t){var r;switch(t){case"notifications/roots/list_changed":if(!(!((r=this._capabilities.roots)===null||r===void 0)&&r.listChanged))throw new Error(`Client does not support roots list changed notifications (required for ${t})`);break}}assertRequestHandlerCapability(t){if(this._capabilities)switch(t){case"sampling/createMessage":if(!this._capabilities.sampling)throw new Error(`Client does not support sampling capability (required for ${t})`);break;case"elicitation/create":if(!this._capabilities.elicitation)throw new Error(`Client does not support elicitation capability (required for ${t})`);break;case"roots/list":if(!this._capabilities.roots)throw new Error(`Client does not support roots capability (required for ${t})`);break;case"tasks/get":case"tasks/list":case"tasks/result":case"tasks/cancel":if(!this._capabilities.tasks)throw new Error(`Client does not support tasks capability (required for ${t})`);break}}assertTaskCapability(t){var r,n;_m((n=(r=this._serverCapabilities)===null||r===void 0?void 0:r.tasks)===null||n===void 0?void 0:n.requests,t,"Server")}assertTaskHandlerCapability(t){var r;this._capabilities&&vm((r=this._capabilities.tasks)===null||r===void 0?void 0:r.requests,t,"Client")}async ping(t){return this.request({method:"ping"},kt,t)}async complete(t,r){return this.request({method:"completion/complete",params:t},Ma,r)}async setLoggingLevel(t,r){return this.request({method:"logging/setLevel",params:{level:t}},kt,r)}async getPrompt(t,r){return this.request({method:"prompts/get",params:t},Ia,r)}async listPrompts(t,r){return this.request({method:"prompts/list",params:t},Ra,r)}async listResources(t,r){return this.request({method:"resources/list",params:t},Ea,r)}async listResourceTemplates(t,r){return this.request({method:"resources/templates/list",params:t},Ta,r)}async readResource(t,r){return this.request({method:"resources/read",params:t},Pa,r)}async subscribeResource(t,r){return this.request({method:"resources/subscribe",params:t},kt,r)}async unsubscribeResource(t,r){return this.request({method:"resources/unsubscribe",params:t},kt,r)}async callTool(t,r=cn,n){if(this.isToolTaskRequired(t.name))throw new Y(X.InvalidRequest,`Tool "${t.name}" requires task-based execution. Use client.experimental.tasks.callToolStream() instead.`);const o=await this.request({method:"tools/call",params:t},r,n),s=this.getToolOutputValidator(t.name);if(s){if(!o.structuredContent&&!o.isError)throw new Y(X.InvalidRequest,`Tool ${t.name} has an output schema but did not return structured content`);if(o.structuredContent)try{const i=s(o.structuredContent);if(!i.valid)throw new Y(X.InvalidParams,`Structured content does not match the tool's output schema: ${i.errorMessage}`)}catch(i){throw i instanceof Y?i:new Y(X.InvalidParams,`Failed to validate structured content: ${i instanceof Error?i.message:String(i)}`)}}return o}isToolTask(t){var r,n,o,s;return!((s=(o=(n=(r=this._serverCapabilities)===null||r===void 0?void 0:r.tasks)===null||n===void 0?void 0:n.requests)===null||o===void 0?void 0:o.tools)===null||s===void 0)&&s.call?this._cachedKnownTaskTools.has(t):!1}isToolTaskRequired(t){return this._cachedRequiredTaskTools.has(t)}cacheToolMetadata(t){var r;this._cachedToolOutputValidators.clear(),this._cachedKnownTaskTools.clear(),this._cachedRequiredTaskTools.clear();for(const n of t){if(n.outputSchema){const s=this._jsonSchemaValidator.getValidator(n.outputSchema);this._cachedToolOutputValidators.set(n.name,s)}const o=(r=n.execution)===null||r===void 0?void 0:r.taskSupport;(o==="required"||o==="optional")&&this._cachedKnownTaskTools.add(n.name),o==="required"&&this._cachedRequiredTaskTools.add(n.name)}}getToolOutputValidator(t){return this._cachedToolOutputValidators.get(t)}async listTools(t,r){const n=await this.request({method:"tools/list",params:t},Ca,r);return this.cacheToolMetadata(n.tools),n}async sendRootsListChanged(){return this.notification({method:"notifications/roots/list_changed"})}}class Ti extends Error{constructor(t,r){super(t),this.name="ParseError",this.type=r.type,this.field=r.field,this.value=r.value,this.line=r.line}}function On(e){}function wm(e){if(typeof e=="function")throw new TypeError("`callbacks` must be an object, got a function instead. Did you mean `{onEvent: fn}`?");const{onEvent:t=On,onError:r=On,onRetry:n=On,onComment:o}=e;let s="",i=!0,a,c="",u="";function l(k){const f=i?k.replace(/^\xEF\xBB\xBF/,""):k,[m,d]=$m(`${s}${f}`);for(const h of m)v(h);s=d,i=!1}function v(k){if(k===""){g();return}if(k.startsWith(":")){o&&o(k.slice(k.startsWith(": ")?2:1));return}const f=k.indexOf(":");if(f!==-1){const m=k.slice(0,f),d=k[f+1]===" "?2:1,h=k.slice(f+d);_(m,h,k);return}_(k,"",k)}function _(k,f,m){switch(k){case"event":u=f;break;case"data":c=`${c}${f}
`;break;case"id":a=f.includes("\0")?void 0:f;break;case"retry":/^\d+$/.test(f)?n(parseInt(f,10)):r(new Ti(`Invalid \`retry\` value: "${f}"`,{type:"invalid-retry",value:f,line:m}));break;default:r(new Ti(`Unknown field "${k.length>20?`${k.slice(0,20)}`:k}"`,{type:"unknown-field",field:k,value:f,line:m}));break}}function g(){c.length>0&&t({id:a,event:u||void 0,data:c.endsWith(`
`)?c.slice(0,-1):c}),a=void 0,c="",u=""}function y(k={}){s&&k.consume&&v(s),i=!0,a=void 0,c="",u="",s=""}return{feed:l,reset:y}}function $m(e){const t=[];let r="",n=0;for(;n<e.length;){const o=e.indexOf("\r",n),s=e.indexOf(`
`,n);let i=-1;if(o!==-1&&s!==-1?i=Math.min(o,s):o!==-1?o===e.length-1?i=-1:i=o:s!==-1&&(i=s),i===-1){r=e.slice(n);break}else{const a=e.slice(n,i);t.push(a),n=i+1,e[n-1]==="\r"&&e[n]===`
`&&n++}}return[t,r]}class Pi extends Event{constructor(t,r){var n,o;super(t),this.code=(n=r==null?void 0:r.code)!=null?n:void 0,this.message=(o=r==null?void 0:r.message)!=null?o:void 0}[Symbol.for("nodejs.util.inspect.custom")](t,r,n){return n(Ri(this),r)}[Symbol.for("Deno.customInspect")](t,r){return t(Ri(this),r)}}function bm(e){const t=globalThis.DOMException;return typeof t=="function"?new t(e,"SyntaxError"):new SyntaxError(e)}function Vn(e){return e instanceof Error?"errors"in e&&Array.isArray(e.errors)?e.errors.map(Vn).join(", "):"cause"in e&&e.cause instanceof Error?`${e}: ${Vn(e.cause)}`:e.message:`${e}`}function Ri(e){return{type:e.type,message:e.message,code:e.code,defaultPrevented:e.defaultPrevented,cancelable:e.cancelable,timeStamp:e.timeStamp}}var Ka=e=>{throw TypeError(e)},jo=(e,t,r)=>t.has(e)||Ka("Cannot "+r),ne=(e,t,r)=>(jo(e,t,"read from private field"),r?r.call(e):t.get(e)),ye=(e,t,r)=>t.has(e)?Ka("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),he=(e,t,r,n)=>(jo(e,t,"write to private field"),t.set(e,r),r),Ye=(e,t,r)=>(jo(e,t,"access private method"),r),qe,dt,gt,Lr,Gr,Lt,St,Zt,rt,yt,Tt,wt,Ut,Ke,Fn,xn,Hn,Ii,Kn,Wn,Dt,Gn,Jn;class Zr extends EventTarget{constructor(t,r){var n,o;super(),ye(this,Ke),this.CONNECTING=0,this.OPEN=1,this.CLOSED=2,ye(this,qe),ye(this,dt),ye(this,gt),ye(this,Lr),ye(this,Gr),ye(this,Lt),ye(this,St),ye(this,Zt,null),ye(this,rt),ye(this,yt),ye(this,Tt,null),ye(this,wt,null),ye(this,Ut,null),ye(this,xn,async s=>{var i;ne(this,yt).reset();const{body:a,redirected:c,status:u,headers:l}=s;if(u===204){Ye(this,Ke,Dt).call(this,"Server sent HTTP 204, not reconnecting",204),this.close();return}if(c?he(this,gt,new URL(s.url)):he(this,gt,void 0),u!==200){Ye(this,Ke,Dt).call(this,`Non-200 status code (${u})`,u);return}if(!(l.get("content-type")||"").startsWith("text/event-stream")){Ye(this,Ke,Dt).call(this,'Invalid content type, expected "text/event-stream"',u);return}if(ne(this,qe)===this.CLOSED)return;he(this,qe,this.OPEN);const v=new Event("open");if((i=ne(this,Ut))==null||i.call(this,v),this.dispatchEvent(v),typeof a!="object"||!a||!("getReader"in a)){Ye(this,Ke,Dt).call(this,"Invalid response body, expected a web ReadableStream",u),this.close();return}const _=new TextDecoder,g=a.getReader();let y=!0;do{const{done:k,value:f}=await g.read();f&&ne(this,yt).feed(_.decode(f,{stream:!k})),k&&(y=!1,ne(this,yt).reset(),Ye(this,Ke,Gn).call(this))}while(y)}),ye(this,Hn,s=>{he(this,rt,void 0),!(s.name==="AbortError"||s.type==="aborted")&&Ye(this,Ke,Gn).call(this,Vn(s))}),ye(this,Kn,s=>{typeof s.id=="string"&&he(this,Zt,s.id);const i=new MessageEvent(s.event||"message",{data:s.data,origin:ne(this,gt)?ne(this,gt).origin:ne(this,dt).origin,lastEventId:s.id||""});ne(this,wt)&&(!s.event||s.event==="message")&&ne(this,wt).call(this,i),this.dispatchEvent(i)}),ye(this,Wn,s=>{he(this,Lt,s)}),ye(this,Jn,()=>{he(this,St,void 0),ne(this,qe)===this.CONNECTING&&Ye(this,Ke,Fn).call(this)});try{if(t instanceof URL)he(this,dt,t);else if(typeof t=="string")he(this,dt,new URL(t,km()));else throw new Error("Invalid URL")}catch{throw bm("An invalid or illegal string was specified")}he(this,yt,wm({onEvent:ne(this,Kn),onRetry:ne(this,Wn)})),he(this,qe,this.CONNECTING),he(this,Lt,3e3),he(this,Gr,(n=r==null?void 0:r.fetch)!=null?n:globalThis.fetch),he(this,Lr,(o=r==null?void 0:r.withCredentials)!=null?o:!1),Ye(this,Ke,Fn).call(this)}get readyState(){return ne(this,qe)}get url(){return ne(this,dt).href}get withCredentials(){return ne(this,Lr)}get onerror(){return ne(this,Tt)}set onerror(t){he(this,Tt,t)}get onmessage(){return ne(this,wt)}set onmessage(t){he(this,wt,t)}get onopen(){return ne(this,Ut)}set onopen(t){he(this,Ut,t)}addEventListener(t,r,n){const o=r;super.addEventListener(t,o,n)}removeEventListener(t,r,n){const o=r;super.removeEventListener(t,o,n)}close(){ne(this,St)&&clearTimeout(ne(this,St)),ne(this,qe)!==this.CLOSED&&(ne(this,rt)&&ne(this,rt).abort(),he(this,qe,this.CLOSED),he(this,rt,void 0))}}qe=new WeakMap,dt=new WeakMap,gt=new WeakMap,Lr=new WeakMap,Gr=new WeakMap,Lt=new WeakMap,St=new WeakMap,Zt=new WeakMap,rt=new WeakMap,yt=new WeakMap,Tt=new WeakMap,wt=new WeakMap,Ut=new WeakMap,Ke=new WeakSet,Fn=function(){he(this,qe,this.CONNECTING),he(this,rt,new AbortController),ne(this,Gr)(ne(this,dt),Ye(this,Ke,Ii).call(this)).then(ne(this,xn)).catch(ne(this,Hn))},xn=new WeakMap,Hn=new WeakMap,Ii=function(){var e;const t={mode:"cors",redirect:"follow",headers:{Accept:"text/event-stream",...ne(this,Zt)?{"Last-Event-ID":ne(this,Zt)}:void 0},cache:"no-store",signal:(e=ne(this,rt))==null?void 0:e.signal};return"window"in globalThis&&(t.credentials=this.withCredentials?"include":"same-origin"),t},Kn=new WeakMap,Wn=new WeakMap,Dt=function(e,t){var r;ne(this,qe)!==this.CLOSED&&he(this,qe,this.CLOSED);const n=new Pi("error",{code:t,message:e});(r=ne(this,Tt))==null||r.call(this,n),this.dispatchEvent(n)},Gn=function(e,t){var r;if(ne(this,qe)===this.CLOSED)return;he(this,qe,this.CONNECTING);const n=new Pi("error",{code:t,message:e});(r=ne(this,Tt))==null||r.call(this,n),this.dispatchEvent(n),he(this,St,setTimeout(ne(this,Jn),ne(this,Lt)))},Jn=new WeakMap,Zr.CONNECTING=0,Zr.OPEN=1,Zr.CLOSED=2;function km(){const e="document"in globalThis?globalThis.document:void 0;return e&&typeof e=="object"&&"baseURI"in e&&typeof e.baseURI=="string"?e.baseURI:void 0}function Bn(e){return e?e instanceof Headers?Object.fromEntries(e.entries()):Array.isArray(e)?Object.fromEntries(e):{...e}:{}}function Sm(e=fetch,t){return t?async(r,n)=>{const o={...t,...n,headers:n!=null&&n.headers?{...Bn(t.headers),...Bn(n.headers)}:t.headers};return e(r,o)}:e}let Mo;Mo=globalThis.crypto;async function Em(e){return(await Mo).getRandomValues(new Uint8Array(e))}async function Tm(e){const t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-._~",r=Math.pow(2,8)-Math.pow(2,8)%t.length;let n="";for(;n.length<e;){const o=await Em(e-n.length);for(const s of o)s<r&&(n+=t[s%t.length])}return n}async function Pm(e){return await Tm(e)}async function Rm(e){const t=await(await Mo).subtle.digest("SHA-256",new TextEncoder().encode(e));return btoa(String.fromCharCode(...new Uint8Array(t))).replace(/\//g,"_").replace(/\+/g,"-").replace(/=/g,"")}async function Im(e){if(e||(e=43),e<43||e>128)throw`Expected a length between 43 and 128. Received ${e}.`;const t=await Pm(e),r=await Rm(t);return{code_verifier:t,code_challenge:r}}const Te=Td().superRefine((e,t)=>{if(!URL.canParse(e))return t.addIssue({code:_f.custom,message:"URL must be parseable",fatal:!0}),Qa}).refine(e=>{const t=new URL(e);return t.protocol!=="javascript:"&&t.protocol!=="data:"&&t.protocol!=="vbscript:"},{message:"URL cannot use javascript:, data:, or vbscript: scheme"}),Om=je({resource:T().url(),authorization_servers:F(Te).optional(),jwks_uri:T().url().optional(),scopes_supported:F(T()).optional(),bearer_methods_supported:F(T()).optional(),resource_signing_alg_values_supported:F(T()).optional(),resource_name:T().optional(),resource_documentation:T().optional(),resource_policy_uri:T().url().optional(),resource_tos_uri:T().url().optional(),tls_client_certificate_bound_access_tokens:pe().optional(),authorization_details_types_supported:F(T()).optional(),dpop_signing_alg_values_supported:F(T()).optional(),dpop_bound_access_tokens_required:pe().optional()}),Wa=je({issuer:T(),authorization_endpoint:Te,token_endpoint:Te,registration_endpoint:Te.optional(),scopes_supported:F(T()).optional(),response_types_supported:F(T()),response_modes_supported:F(T()).optional(),grant_types_supported:F(T()).optional(),token_endpoint_auth_methods_supported:F(T()).optional(),token_endpoint_auth_signing_alg_values_supported:F(T()).optional(),service_documentation:Te.optional(),revocation_endpoint:Te.optional(),revocation_endpoint_auth_methods_supported:F(T()).optional(),revocation_endpoint_auth_signing_alg_values_supported:F(T()).optional(),introspection_endpoint:T().optional(),introspection_endpoint_auth_methods_supported:F(T()).optional(),introspection_endpoint_auth_signing_alg_values_supported:F(T()).optional(),code_challenge_methods_supported:F(T()).optional(),client_id_metadata_document_supported:pe().optional()}),Cm=je({issuer:T(),authorization_endpoint:Te,token_endpoint:Te,userinfo_endpoint:Te.optional(),jwks_uri:Te,registration_endpoint:Te.optional(),scopes_supported:F(T()).optional(),response_types_supported:F(T()),response_modes_supported:F(T()).optional(),grant_types_supported:F(T()).optional(),acr_values_supported:F(T()).optional(),subject_types_supported:F(T()),id_token_signing_alg_values_supported:F(T()),id_token_encryption_alg_values_supported:F(T()).optional(),id_token_encryption_enc_values_supported:F(T()).optional(),userinfo_signing_alg_values_supported:F(T()).optional(),userinfo_encryption_alg_values_supported:F(T()).optional(),userinfo_encryption_enc_values_supported:F(T()).optional(),request_object_signing_alg_values_supported:F(T()).optional(),request_object_encryption_alg_values_supported:F(T()).optional(),request_object_encryption_enc_values_supported:F(T()).optional(),token_endpoint_auth_methods_supported:F(T()).optional(),token_endpoint_auth_signing_alg_values_supported:F(T()).optional(),display_values_supported:F(T()).optional(),claim_types_supported:F(T()).optional(),claims_supported:F(T()).optional(),service_documentation:T().optional(),claims_locales_supported:F(T()).optional(),ui_locales_supported:F(T()).optional(),claims_parameter_supported:pe().optional(),request_parameter_supported:pe().optional(),request_uri_parameter_supported:pe().optional(),require_request_uri_registration:pe().optional(),op_policy_uri:Te.optional(),op_tos_uri:Te.optional(),client_id_metadata_document_supported:pe().optional()}),Nm=U({...Cm.shape,...Wa.pick({code_challenge_methods_supported:!0}).shape}),zm=U({access_token:T(),id_token:T().optional(),token_type:T(),expires_in:vf().optional(),scope:T().optional(),refresh_token:T().optional()}).strip(),Am=U({error:T(),error_description:T().optional(),error_uri:T().optional()}),Oi=Te.optional().or(G("").transform(()=>{})),qm=U({redirect_uris:F(Te),token_endpoint_auth_method:T().optional(),grant_types:F(T()).optional(),response_types:F(T()).optional(),client_name:T().optional(),client_uri:Te.optional(),logo_uri:Oi,scope:T().optional(),contacts:F(T()).optional(),tos_uri:Oi,policy_uri:T().optional(),jwks_uri:Te.optional(),jwks:Dn().optional(),software_id:T().optional(),software_version:T().optional(),software_statement:T().optional()}).strip(),jm=U({client_id:T(),client_secret:T().optional(),client_id_issued_at:de().optional(),client_secret_expires_at:de().optional()}).strip(),Mm=qm.merge(jm);U({error:T(),error_description:T().optional()}).strip();U({token:T(),token_type_hint:T().optional()}).strip();function Um(e){const t=typeof e=="string"?new URL(e):new URL(e.href);return t.hash="",t}function Dm({requestedResource:e,configuredResource:t}){const r=typeof e=="string"?new URL(e):new URL(e.href),n=typeof t=="string"?new URL(t):new URL(t.href);if(r.origin!==n.origin||r.pathname.length<n.pathname.length)return!1;const o=r.pathname.endsWith("/")?r.pathname:r.pathname+"/",s=n.pathname.endsWith("/")?n.pathname:n.pathname+"/";return o.startsWith(s)}class be extends Error{constructor(t,r){super(t),this.errorUri=r,this.name=this.constructor.name}toResponseObject(){const t={error:this.errorCode,error_description:this.message};return this.errorUri&&(t.error_uri=this.errorUri),t}get errorCode(){return this.constructor.errorCode}}class Qn extends be{}Qn.errorCode="invalid_request";class Jr extends be{}Jr.errorCode="invalid_client";class Br extends be{}Br.errorCode="invalid_grant";class Qr extends be{}Qr.errorCode="unauthorized_client";class Yn extends be{}Yn.errorCode="unsupported_grant_type";class Xn extends be{}Xn.errorCode="invalid_scope";class eo extends be{}eo.errorCode="access_denied";class Ot extends be{}Ot.errorCode="server_error";class to extends be{}to.errorCode="temporarily_unavailable";class ro extends be{}ro.errorCode="unsupported_response_type";class no extends be{}no.errorCode="unsupported_token_type";class oo extends be{}oo.errorCode="invalid_token";class so extends be{}so.errorCode="method_not_allowed";class io extends be{}io.errorCode="too_many_requests";class Yr extends be{}Yr.errorCode="invalid_client_metadata";class ao extends be{}ao.errorCode="insufficient_scope";class co extends be{}co.errorCode="invalid_target";const Lm={[Qn.errorCode]:Qn,[Jr.errorCode]:Jr,[Br.errorCode]:Br,[Qr.errorCode]:Qr,[Yn.errorCode]:Yn,[Xn.errorCode]:Xn,[eo.errorCode]:eo,[Ot.errorCode]:Ot,[to.errorCode]:to,[ro.errorCode]:ro,[no.errorCode]:no,[oo.errorCode]:oo,[so.errorCode]:so,[io.errorCode]:io,[Yr.errorCode]:Yr,[ao.errorCode]:ao,[co.errorCode]:co};class jt extends Error{constructor(t){super(t??"Unauthorized")}}function Zm(e){return["client_secret_basic","client_secret_post","none"].includes(e)}const Cn="code",Nn="S256";function Vm(e,t){const r=e.client_secret!==void 0;return t.length===0?r?"client_secret_post":"none":"token_endpoint_auth_method"in e&&e.token_endpoint_auth_method&&Zm(e.token_endpoint_auth_method)&&t.includes(e.token_endpoint_auth_method)?e.token_endpoint_auth_method:r&&t.includes("client_secret_basic")?"client_secret_basic":r&&t.includes("client_secret_post")?"client_secret_post":t.includes("none")?"none":r?"client_secret_post":"none"}function Fm(e,t,r,n){const{client_id:o,client_secret:s}=t;switch(e){case"client_secret_basic":xm(o,s,r);return;case"client_secret_post":Hm(o,s,n);return;case"none":Km(o,n);return;default:throw new Error(`Unsupported client authentication method: ${e}`)}}function xm(e,t,r){if(!t)throw new Error("client_secret_basic authentication requires a client_secret");const n=btoa(`${e}:${t}`);r.set("Authorization",`Basic ${n}`)}function Hm(e,t,r){r.set("client_id",e),t&&r.set("client_secret",t)}function Km(e,t){t.set("client_id",e)}async function Ga(e){const t=e instanceof Response?e.status:void 0,r=e instanceof Response?await e.text():e;try{const n=Am.parse(JSON.parse(r)),{error:o,error_description:s,error_uri:i}=n,a=Lm[o]||Ot;return new a(s||"",i)}catch(n){const o=`${t?`HTTP ${t}: `:""}Invalid OAuth error response: ${n}. Raw body: ${r}`;return new Ot(o)}}async function zn(e,t){var r,n;try{return await An(e,t)}catch(o){if(o instanceof Jr||o instanceof Qr)return await((r=e.invalidateCredentials)===null||r===void 0?void 0:r.call(e,"all")),await An(e,t);if(o instanceof Br)return await((n=e.invalidateCredentials)===null||n===void 0?void 0:n.call(e,"tokens")),await An(e,t);throw o}}async function An(e,{serverUrl:t,authorizationCode:r,scope:n,resourceMetadataUrl:o,fetchFn:s}){var i,a;let c,u;try{c=await Jm(t,{resourceMetadataUrl:o},s),c.authorization_servers&&c.authorization_servers.length>0&&(u=c.authorization_servers[0])}catch{}u||(u=new URL("/",t));const l=await Gm(t,e,c),v=await e_(u,{fetchFn:s});let _=await Promise.resolve(e.clientInformation());if(!_){if(r!==void 0)throw new Error("Existing OAuth client information is required when exchanging an authorization code");const d=(v==null?void 0:v.client_id_metadata_document_supported)===!0,h=e.clientMetadataUrl;if(h&&!Wm(h))throw new Yr(`clientMetadataUrl must be a valid HTTPS URL with a non-root pathname, got: ${h}`);if(d&&h)_={client_id:h},await((i=e.saveClientInformation)===null||i===void 0?void 0:i.call(e,_));else{if(!e.saveClientInformation)throw new Error("OAuth client information must be saveable for dynamic registration");const p=await s_(u,{metadata:v,clientMetadata:e.clientMetadata,fetchFn:s});await e.saveClientInformation(p),_=p}}const g=!e.redirectUrl;if(r!==void 0||g){const d=await o_(e,u,{metadata:v,resource:l,authorizationCode:r,fetchFn:s});return await e.saveTokens(d),"AUTHORIZED"}const y=await e.tokens();if(y!=null&&y.refresh_token)try{const d=await n_(u,{metadata:v,clientInformation:_,refreshToken:y.refresh_token,resource:l,addClientAuthentication:e.addClientAuthentication,fetchFn:s});return await e.saveTokens(d),"AUTHORIZED"}catch(d){if(!(!(d instanceof be)||d instanceof Ot))throw d}const k=e.state?await e.state():void 0,{authorizationUrl:f,codeVerifier:m}=await t_(u,{metadata:v,clientInformation:_,state:k,redirectUrl:e.redirectUrl,scope:n||((a=c==null?void 0:c.scopes_supported)===null||a===void 0?void 0:a.join(" "))||e.clientMetadata.scope,resource:l});return await e.saveCodeVerifier(m),await e.redirectToAuthorization(f),"REDIRECT"}function Wm(e){if(!e)return!1;try{const t=new URL(e);return t.protocol==="https:"&&t.pathname!=="/"}catch{return!1}}async function Gm(e,t,r){const n=Um(e);if(t.validateResourceURL)return await t.validateResourceURL(n,r==null?void 0:r.resource);if(r){if(!Dm({requestedResource:n,configuredResource:r.resource}))throw new Error(`Protected resource ${r.resource} does not match expected ${n} (or origin)`);return new URL(r.resource)}}function Ci(e){const t=e.headers.get("WWW-Authenticate");if(!t)return{};const[r,n]=t.split(" ");if(r.toLowerCase()!=="bearer"||!n)return{};const o=qn(e,"resource_metadata")||void 0;let s;if(o)try{s=new URL(o)}catch{}const i=qn(e,"scope")||void 0,a=qn(e,"error")||void 0;return{resourceMetadataUrl:s,scope:i,error:a}}function qn(e,t){const r=e.headers.get("WWW-Authenticate");if(!r)return null;const n=new RegExp(`${t}=(?:"([^"]+)"|([^\\s,]+))`),o=r.match(n);return o?o[1]||o[2]:null}async function Jm(e,t,r=fetch){var n,o;const s=await Ym(e,"oauth-protected-resource",r,{protocolVersion:t==null?void 0:t.protocolVersion,metadataUrl:t==null?void 0:t.resourceMetadataUrl});if(!s||s.status===404)throw await((n=s==null?void 0:s.body)===null||n===void 0?void 0:n.cancel()),new Error("Resource server does not implement OAuth 2.0 Protected Resource Metadata.");if(!s.ok)throw await((o=s.body)===null||o===void 0?void 0:o.cancel()),new Error(`HTTP ${s.status} trying to load well-known OAuth protected resource metadata.`);return Om.parse(await s.json())}async function Uo(e,t,r=fetch){try{return await r(e,{headers:t})}catch(n){if(n instanceof TypeError)return t?Uo(e,void 0,r):void 0;throw n}}function Bm(e,t="",r={}){return t.endsWith("/")&&(t=t.slice(0,-1)),r.prependPathname?`${t}/.well-known/${e}`:`/.well-known/${e}${t}`}async function Ni(e,t,r=fetch){return await Uo(e,{"MCP-Protocol-Version":t},r)}function Qm(e,t){return!e||e.status>=400&&e.status<500&&t!=="/"}async function Ym(e,t,r,n){var o,s;const i=new URL(e),a=(o=n==null?void 0:n.protocolVersion)!==null&&o!==void 0?o:on;let c;if(n!=null&&n.metadataUrl)c=new URL(n.metadataUrl);else{const l=Bm(t,i.pathname);c=new URL(l,(s=n==null?void 0:n.metadataServerUrl)!==null&&s!==void 0?s:i),c.search=i.search}let u=await Ni(c,a,r);if(!(n!=null&&n.metadataUrl)&&Qm(u,i.pathname)){const l=new URL(`/.well-known/${t}`,i);u=await Ni(l,a,r)}return u}function Xm(e){const t=typeof e=="string"?new URL(e):e,r=t.pathname!=="/",n=[];if(!r)return n.push({url:new URL("/.well-known/oauth-authorization-server",t.origin),type:"oauth"}),n.push({url:new URL("/.well-known/openid-configuration",t.origin),type:"oidc"}),n;let o=t.pathname;return o.endsWith("/")&&(o=o.slice(0,-1)),n.push({url:new URL(`/.well-known/oauth-authorization-server${o}`,t.origin),type:"oauth"}),n.push({url:new URL(`/.well-known/openid-configuration${o}`,t.origin),type:"oidc"}),n.push({url:new URL(`${o}/.well-known/openid-configuration`,t.origin),type:"oidc"}),n}async function e_(e,{fetchFn:t=fetch,protocolVersion:r=on}={}){var n;const o={"MCP-Protocol-Version":r,Accept:"application/json"},s=Xm(e);for(const{url:i,type:a}of s){const c=await Uo(i,o,t);if(c){if(!c.ok){if(await((n=c.body)===null||n===void 0?void 0:n.cancel()),c.status>=400&&c.status<500)continue;throw new Error(`HTTP ${c.status} trying to load ${a==="oauth"?"OAuth":"OpenID provider"} metadata from ${i}`)}return a==="oauth"?Wa.parse(await c.json()):Nm.parse(await c.json())}}}async function t_(e,{metadata:t,clientInformation:r,redirectUrl:n,scope:o,state:s,resource:i}){let a;if(t){if(a=new URL(t.authorization_endpoint),!t.response_types_supported.includes(Cn))throw new Error(`Incompatible auth server: does not support response type ${Cn}`);if(t.code_challenge_methods_supported&&!t.code_challenge_methods_supported.includes(Nn))throw new Error(`Incompatible auth server: does not support code challenge method ${Nn}`)}else a=new URL("/authorize",e);const c=await Im(),u=c.code_verifier,l=c.code_challenge;return a.searchParams.set("response_type",Cn),a.searchParams.set("client_id",r.client_id),a.searchParams.set("code_challenge",l),a.searchParams.set("code_challenge_method",Nn),a.searchParams.set("redirect_uri",String(n)),s&&a.searchParams.set("state",s),o&&a.searchParams.set("scope",o),o!=null&&o.includes("offline_access")&&a.searchParams.append("prompt","consent"),i&&a.searchParams.set("resource",i.href),{authorizationUrl:a,codeVerifier:u}}function r_(e,t,r){return new URLSearchParams({grant_type:"authorization_code",code:e,code_verifier:t,redirect_uri:String(r)})}async function Ja(e,{metadata:t,tokenRequestParams:r,clientInformation:n,addClientAuthentication:o,resource:s,fetchFn:i}){var a;const c=t!=null&&t.token_endpoint?new URL(t.token_endpoint):new URL("/token",e),u=new Headers({"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"});if(s&&r.set("resource",s.href),o)await o(u,r,c,t);else if(n){const v=(a=t==null?void 0:t.token_endpoint_auth_methods_supported)!==null&&a!==void 0?a:[],_=Vm(n,v);Fm(_,n,u,r)}const l=await(i??fetch)(c,{method:"POST",headers:u,body:r});if(!l.ok)throw await Ga(l);return zm.parse(await l.json())}async function n_(e,{metadata:t,clientInformation:r,refreshToken:n,resource:o,addClientAuthentication:s,fetchFn:i}){const a=new URLSearchParams({grant_type:"refresh_token",refresh_token:n}),c=await Ja(e,{metadata:t,tokenRequestParams:a,clientInformation:r,addClientAuthentication:s,resource:o,fetchFn:i});return{refresh_token:n,...c}}async function o_(e,t,{metadata:r,resource:n,authorizationCode:o,fetchFn:s}={}){const i=e.clientMetadata.scope;let a;if(e.prepareTokenRequest&&(a=await e.prepareTokenRequest(i)),!a){if(!o)throw new Error("Either provider.prepareTokenRequest() or authorizationCode is required");if(!e.redirectUrl)throw new Error("redirectUrl is required for authorization_code flow");const u=await e.codeVerifier();a=r_(o,u,e.redirectUrl)}const c=await e.clientInformation();return Ja(t,{metadata:r,tokenRequestParams:a,clientInformation:c??void 0,addClientAuthentication:e.addClientAuthentication,resource:n,fetchFn:s})}async function s_(e,{metadata:t,clientMetadata:r,fetchFn:n}){let o;if(t){if(!t.registration_endpoint)throw new Error("Incompatible auth server: does not support dynamic client registration");o=new URL(t.registration_endpoint)}else o=new URL("/register",e);const s=await(n??fetch)(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!s.ok)throw await Ga(s);return Mm.parse(await s.json())}class i_ extends Error{constructor(t,r,n){super(`SSE error: ${r}`),this.code=t,this.event=n}}class a_{constructor(t,r){this._url=t,this._resourceMetadataUrl=void 0,this._scope=void 0,this._eventSourceInit=r==null?void 0:r.eventSourceInit,this._requestInit=r==null?void 0:r.requestInit,this._authProvider=r==null?void 0:r.authProvider,this._fetch=r==null?void 0:r.fetch,this._fetchWithInit=Sm(r==null?void 0:r.fetch,r==null?void 0:r.requestInit)}async _authThenStart(){var t;if(!this._authProvider)throw new jt("No auth provider");let r;try{r=await zn(this._authProvider,{serverUrl:this._url,resourceMetadataUrl:this._resourceMetadataUrl,scope:this._scope,fetchFn:this._fetchWithInit})}catch(n){throw(t=this.onerror)===null||t===void 0||t.call(this,n),n}if(r!=="AUTHORIZED")throw new jt;return await this._startOrAuth()}async _commonHeaders(){var t;const r={};if(this._authProvider){const o=await this._authProvider.tokens();o&&(r.Authorization=`Bearer ${o.access_token}`)}this._protocolVersion&&(r["mcp-protocol-version"]=this._protocolVersion);const n=Bn((t=this._requestInit)===null||t===void 0?void 0:t.headers);return new Headers({...r,...n})}_startOrAuth(){var t,r,n;const o=(n=(r=(t=this===null||this===void 0?void 0:this._eventSourceInit)===null||t===void 0?void 0:t.fetch)!==null&&r!==void 0?r:this._fetch)!==null&&n!==void 0?n:fetch;return new Promise((s,i)=>{this._eventSource=new Zr(this._url.href,{...this._eventSourceInit,fetch:async(a,c)=>{const u=await this._commonHeaders();u.set("Accept","text/event-stream");const l=await o(a,{...c,headers:u});if(l.status===401&&l.headers.has("www-authenticate")){const{resourceMetadataUrl:v,scope:_}=Ci(l);this._resourceMetadataUrl=v,this._scope=_}return l}}),this._abortController=new AbortController,this._eventSource.onerror=a=>{var c;if(a.code===401&&this._authProvider){this._authThenStart().then(s,i);return}const u=new i_(a.code,a.message,a);i(u),(c=this.onerror)===null||c===void 0||c.call(this,u)},this._eventSource.onopen=()=>{},this._eventSource.addEventListener("endpoint",a=>{var c;const u=a;try{if(this._endpoint=new URL(u.data,this._url),this._endpoint.origin!==this._url.origin)throw new Error(`Endpoint origin does not match connection origin: ${this._endpoint.origin}`)}catch(l){i(l),(c=this.onerror)===null||c===void 0||c.call(this,l),this.close();return}s()}),this._eventSource.onmessage=a=>{var c,u;const l=a;let v;try{v=kf.parse(JSON.parse(l.data))}catch(_){(c=this.onerror)===null||c===void 0||c.call(this,_);return}(u=this.onmessage)===null||u===void 0||u.call(this,v)}})}async start(){if(this._eventSource)throw new Error("SSEClientTransport already started! If using Client class, note that connect() calls start() automatically.");return await this._startOrAuth()}async finishAuth(t){if(!this._authProvider)throw new jt("No auth provider");if(await zn(this._authProvider,{serverUrl:this._url,authorizationCode:t,resourceMetadataUrl:this._resourceMetadataUrl,scope:this._scope,fetchFn:this._fetchWithInit})!=="AUTHORIZED")throw new jt("Failed to authorize")}async close(){var t,r,n;(t=this._abortController)===null||t===void 0||t.abort(),(r=this._eventSource)===null||r===void 0||r.close(),(n=this.onclose)===null||n===void 0||n.call(this)}async send(t){var r,n,o;if(!this._endpoint)throw new Error("Not connected");try{const s=await this._commonHeaders();s.set("content-type","application/json");const i={...this._requestInit,method:"POST",headers:s,body:JSON.stringify(t),signal:(r=this._abortController)===null||r===void 0?void 0:r.signal},a=await((n=this._fetch)!==null&&n!==void 0?n:fetch)(this._endpoint,i);if(!a.ok){const c=await a.text().catch(()=>null);if(a.status===401&&this._authProvider){const{resourceMetadataUrl:u,scope:l}=Ci(a);if(this._resourceMetadataUrl=u,this._scope=l,await zn(this._authProvider,{serverUrl:this._url,resourceMetadataUrl:this._resourceMetadataUrl,scope:this._scope,fetchFn:this._fetchWithInit})!=="AUTHORIZED")throw new jt;return this.send(t)}throw new Error(`Error POSTing to endpoint (HTTP ${a.status}): ${c}`)}}catch(s){throw(o=this.onerror)===null||o===void 0||o.call(this,s),s}}setProtocolVersion(t){this._protocolVersion=t}}const c_={INIT:0};class u_{constructor(t,r={name:"nstrumenta-client",version:"1.0.0"}){this.ws=null,this.resourceSubscriptions=new Map,this.reconnection={hasVerified:!1,attempts:0,timeout:null},this.clientId=null,this.connection={status:c_.INIT},this.addSubscription=async(n,o)=>(console.warn("addSubscription() is deprecated - WebSocket support removed. Use AgentClient resource subscriptions instead."),async()=>{}),this.apiKey=t,this.clientInfo=r,this.listeners=new Map,this.subscriptions=new Map,this.datalogs=new Map,this.messageBuffer=[],this.endpoints=jn(t||"http://localhost:5999"),this.addSubscription=this.addSubscription.bind(this),this.addListener=this.addListener.bind(this),this.connect=this.connect.bind(this),this.storage=new l_({apiKey:t??""})}async shutdown(){var t,r;this.listeners.clear(),this.subscriptions.clear(),this.datalogs.clear(),this.messageBuffer=[],this.reconnection.timeout&&(clearTimeout(this.reconnection.timeout),this.reconnection.timeout=null),(t=this.ws)==null||t.removeAllListeners(),(r=this.ws)==null||r.close()}rollOff(t){return t==0?0:Math.min(Math.pow(t,2)*1e3,1800*1e3)}send(t,r){console.warn("send() is deprecated - WebSocket support removed. Use McpClient instead.")}sendBuffer(t,r){console.warn("sendBuffer() is deprecated - WebSocket support removed. Use McpClient instead.")}bufferedSend(t){console.warn("bufferedSend() is deprecated - WebSocket support removed.")}addListener(t,r){this.listeners.get(t)||this.listeners.set(t,[]);const n=this.listeners.get(t);n&&n.push(r)}addStringToDataLog(t,r){const n=this.datalogs.get(t);n?n.push(r):(console.log(`starting new log: ${t}`),this.datalogs.set(t,[r]))}async uploadData(t,r,n){var u;const o=r.size;let s;const i=await fetch(this.endpoints.GET_UPLOAD_URL,{method:"POST",headers:{"Content-Type":"application/json","x-api-key":(u=this.apiKey)==null?void 0:u.split(":")[0]},body:JSON.stringify({path:t,size:o,meta:n})});if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const a=await i.json();s=a==null?void 0:a.uploadUrl;const c=await fetch(s,{method:"PUT",headers:{"Content-Type":"application/octet-stream"},body:r});if(!c.ok)throw new Error(`HTTP error! status: ${c.status}`)}async ping(){return this.callRPC("ping",{sendTimestamp:Date.now()})}async startLog(t,r,n){console.warn("startLog() is deprecated - WebSocket support removed.")}async startRecording(t,r,n){return console.warn("startRecording() is deprecated - WebSocket support removed."),Promise.resolve({})}async stopRecording(t){return console.warn("stopRecording() is deprecated - WebSocket support removed."),Promise.resolve({})}async finishLog(t){console.warn("finishLog() is deprecated - WebSocket support removed.")}async connectMcp(){if(!this.apiKey)throw new Error("apiKey required for MCP");const t=new a_(new URL(`${this.endpoints.MCP_SSE}?apiKey=${this.apiKey.split(":")[0]}`));this.mcp=new ym(this.clientInfo,{capabilities:{}}),this.mcp.setNotificationHandler(U({method:G("notifications/resources/updated"),params:U({uri:T()})}),async r=>{const n=r.params.uri,o=this.resourceSubscriptions.get(n);o==null||o.forEach(s=>s(n))}),await this.mcp.connect(t)}async subscribeToMcpResource(t,r){this.mcp||await this.connectMcp();let n=this.resourceSubscriptions.get(t);n||(n=[],this.resourceSubscriptions.set(t,n),await this.mcp.request({method:"resources/subscribe",params:{uri:t}},Dn())),n.push(r)}async subscribeToAction(t,r,n){const o=`projects://${t}/actions/${r}`;await this.subscribeToMcpResource(o,async s=>{var c;const a=(c=(await this.mcp.request({method:"resources/read",params:{uri:o}},Dn())).contents)==null?void 0:c[0];a&&a.text&&n(JSON.parse(a.text))})}async callMcpTool(t,r){var i,a,c,u;if(!this.apiKey)throw new Error("apiKey not set");const n=await fetch(this.endpoints.MCP,{method:"POST",headers:{"Content-Type":"application/json","x-api-key":this.apiKey},body:JSON.stringify({jsonrpc:"2.0",method:"tools/call",params:{name:t,arguments:r},id:Date.now()})});if(!n.ok){const l=await n.text();throw new Error(`MCP request failed: ${n.status} ${l}`)}const o=await n.json();if(o.error)throw new Error(`MCP error: ${o.error.message||"Unknown error"}`);const s=o.result;if(s.isError)throw new Error(`Tool error: ${((a=(i=s.content)==null?void 0:i[0])==null?void 0:a.text)||"Unknown error"}`);return s.structuredContent?s.structuredContent:(u=(c=s.content)==null?void 0:c[0])!=null&&u.text?JSON.parse(s.content[0].text):s}async callRPC(t,r){return console.log("callRPC",t,r),console.warn("callRPC() is deprecated - WebSocket support removed."),Promise.reject(new Error("WebSocket support removed - use McpClient or AgentClient"))}}class l_{constructor(t){var r;this.apiKey=t.apiKey,this.apiKeyHeader=(r=this.apiKey)==null?void 0:r.split(":")[0],this.endpoints=jn(this.apiKey)}async getDownloadUrl(t){if(!this.apiKey)throw new Error("apiKey not set");const r=await fetch(this.endpoints.GET_PROJECT_DOWNLOAD_URL,{method:"POST",headers:{"x-api-key":this.apiKeyHeader,"content-type":"application/json"},body:JSON.stringify({path:t})});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);return console.log("REQ:",r),(await r.json()).url}async download(t){if(!this.apiKey)throw new Error("apiKey not set");const r=await fetch(this.endpoints.GET_PROJECT_DOWNLOAD_URL,{method:"POST",headers:{"x-api-key":this.apiKeyHeader,"content-type":"application/json"},body:JSON.stringify({path:t})});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const n=await r.json();console.log("REQ:",r);const o=await fetch(n.url,{method:"GET"});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return await o.blob()}async query({field:t,comparison:r,compareValue:n}){if(!this.apiKey)throw new Error("apiKey not set");const o={field:t,comparison:r,compareValue:n},s={method:"POST",headers:{"x-api-key":this.apiKeyHeader,"Content-Type":"application/json"},body:JSON.stringify(o)};try{const i=await fetch(this.endpoints.QUERY_COLLECTION,s);if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);return await i.json()}catch(i){return console.log(`Something went wrong: ${i.message}`),[]}}async list(t){if(!this.apiKey)throw new Error("apiKey not set");const r=await fetch(this.endpoints.LIST_STORAGE_OBJECTS,{method:"POST",headers:{"x-api-key":this.apiKeyHeader,"Content-Type":"application/json"},body:JSON.stringify({type:t})});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);return await r.json()}async upload({filename:t,data:r,meta:n,overwrite:o}){const s=r.size||r.length;let i;const a={method:"POST",headers:{"x-api-key":this.apiKeyHeader,"Content-Type":"application/json"},body:JSON.stringify({name:t,size:s,metadata:n,overwrite:o})};let c=await fetch(this.endpoints.GET_UPLOAD_DATA_URL,a);if(!c.ok){console.warn(`HTTP error! status: ${c.status}`);return}const u=await c.json();if(i=u==null?void 0:u.uploadUrl,!i){console.warn(`no upload url returned, can't upload ${t}`),console.log(u);return}const l=u==null?void 0:u.remoteFilePath,v={method:"PUT",headers:{"Content-Type":"application/octet-stream"},body:r};console.log({remoteFilePath:l,uploadConfig:v});const _=await fetch(i,v);if(!_.ok){console.warn(`HTTP error! status: ${_.status}`);return}}}const d_="3.1.48";class f_ extends u_{constructor(){super(void 0,{name:"nstrumenta-browser",version:d_}),console.warn("NstrumentaBrowserClient is deprecated - WebSocket support removed. Use McpClient instead.")}async connect(t){return console.warn("NstrumentaBrowserClient.connect() is deprecated - WebSocket support removed. Use McpClient instead."),Promise.reject(new Error("WebSocket support removed - use McpClient"))}}const Mt=new f_,h_=async()=>{if(document.readyState!=="complete")return;const e=document.getElementById("outputTextArea");Mt.addListener("open",()=>{let a=!1;console.log("client open"),Mt.addSubscription("__event",c=>{switch(c.event){case"health":const u=document.getElementById("health");u&&(u.innerText=new Date(Date.now()).toLocaleString());break}}),Mt.addSubscription("_status",c=>{const{agentId:u}=c,l=document.getElementById("status");l&&(l.innerText=JSON.stringify(c)),u&&!a&&(a=!0,Mt.addSubscription(`_${u}/stdout`,v=>{const _=new TextDecoder().decode(v);e.textContent+=`${_}
`}))})});const t=new URL(window.location.href).searchParams,r=t.get("wsUrl"),n=r||window.location.origin.replace("http","ws"),o=t.get("apiKey");o&&localStorage.setItem("apiKey",o);const s=localStorage.getItem("apiKey"),i=o||s;await Mt.connect({apiKey:i||void 0,wsUrl:n})};document.addEventListener("readystatechange",h_);
